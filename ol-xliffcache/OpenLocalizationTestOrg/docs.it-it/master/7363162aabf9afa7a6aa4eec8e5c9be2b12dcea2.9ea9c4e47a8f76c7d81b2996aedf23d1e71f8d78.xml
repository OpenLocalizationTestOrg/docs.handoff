{"content":"---\ntitle: \"Walkthrough: Validating Data in the Windows Forms DataGridView Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"validating data, Windows Forms\"\n  - \"data [Windows Forms], validation\"\n  - \"DataGridView control [Windows Forms], data validation\"\n  - \"data grids, validating data\"\n  - \"data validation, Windows Forms\"\n  - \"walkthroughs [Windows Forms], DataGridView control\"\nms.assetid: a4f1d015-2969-430c-8ea2-b612d179c290\ncaps.latest.revision: 22\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Validating Data in the Windows Forms DataGridView Control\nWhen you display data entry functionality to users, you frequently have to validate the data entered into your form. The <xref:System.Windows.Forms.DataGridView> class provides a convenient way to perform validation before data is committed to the data store. You can validate data by handling the <xref:System.Windows.Forms.DataGridView.CellValidating> event, which is raised by the <xref:System.Windows.Forms.DataGridView> when the current cell changes.  \n  \n In this walkthrough, you will retrieve rows from the `Customers` table in the Northwind sample database and display them in a <xref:System.Windows.Forms.DataGridView> control. When a user edits a cell in the `CompanyName` column and tries to leave the cell, the <xref:System.Windows.Forms.DataGridView.CellValidating> event handler will examine new company name string to make sure it is not empty; if the new value is an empty string, the <xref:System.Windows.Forms.DataGridView> will prevent the user's cursor from leaving the cell until a non-empty string is entered.  \n  \n To copy the code in this topic as a single listing, see [How to: Validate Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md).  \n  \n## Prerequisites  \n In order to complete this walkthrough, you will need:  \n  \n-   Access to a server that has the Northwind SQL Server sample database.  \n  \n## Creating the Form  \n  \n#### To validate data entered in a DataGridView  \n  \n1.  Create a class that derives from <xref:System.Windows.Forms.Form> and contains a <xref:System.Windows.Forms.DataGridView> control and a <xref:System.Windows.Forms.BindingSource> component.  \n  \n     The following code example provides basic initialization and includes a `Main` method.  \n  \n     [!code-csharp[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#01)]\n     [!code-vb[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#01)]  \n    [!code-csharp[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#02)]\n    [!code-vb[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#02)]  \n  \n2.  Implement a method in your form's class definition for handling the details of connecting to the database.  \n  \n     This code example uses a `GetData` method that returns a populated <xref:System.Data.DataTable> object. Be sure that you set the `connectionString` variable to a value that is appropriate for your database.  \n  \n    > [!IMPORTANT]\n    >  Storing sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication, also known as integrated security, is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).  \n  \n     [!code-csharp[System.Windows.Forms.DataGridViewDataValidation#30](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#30)]\n     [!code-vb[System.Windows.Forms.DataGridViewDataValidation#30](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#30)]  \n  \n3.  Implement a handler for your form's <xref:System.Windows.Forms.Form.Load> event that initializes the <xref:System.Windows.Forms.DataGridView> and <xref:System.Windows.Forms.BindingSource> and sets up the data binding.  \n  \n     [!code-csharp[System.Windows.Forms.DataGridViewDataValidation#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#10)]\n     [!code-vb[System.Windows.Forms.DataGridViewDataValidation#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#10)]  \n  \n4.  Implement handlers for the <xref:System.Windows.Forms.DataGridView> control's <xref:System.Windows.Forms.DataGridView.CellValidating> and <xref:System.Windows.Forms.DataGridView.CellEndEdit> events.  \n  \n     The <xref:System.Windows.Forms.DataGridView.CellValidating> event handler is where you determine whether the value of a cell in the `CompanyName` column is empty. If the cell value fails validation, set the <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> property of the <xref:System.Windows.Forms.DataGridViewCellValidatingEventArgs?displayProperty=fullName> class to `true`. This causes the <xref:System.Windows.Forms.DataGridView> control to prevent the cursor from leaving the cell. Set the <xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A> property on the row to an explanatory string. This displays an error icon with a ToolTip that contains the error text. In the <xref:System.Windows.Forms.DataGridView.CellEndEdit> event handler, set the <xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A> property on the row to the empty string. The <xref:System.Windows.Forms.DataGridView.CellEndEdit> event occurs only when the cell exits edit mode, which it cannot do if it fails validation.  \n  \n     [!code-csharp[System.Windows.Forms.DataGridViewDataValidation#20](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#20)]\n     [!code-vb[System.Windows.Forms.DataGridViewDataValidation#20](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#20)]  \n  \n## Testing the Application  \n You can now test the form to make sure it behaves as expected.  \n  \n#### To test the form  \n  \n-   Compile and run the application.  \n  \n     You will see a <xref:System.Windows.Forms.DataGridView> filled with data from the `Customers` table. When you double-click a cell in the `CompanyName` column, you can edit the value. If you delete all the characters and hit the TAB key to exit the cell, the <xref:System.Windows.Forms.DataGridView> prevents you from exiting. When you type a non-empty string into the cell, the <xref:System.Windows.Forms.DataGridView> control lets you exit the cell.  \n  \n## Next Steps  \n This application gives you a basic understanding of the <xref:System.Windows.Forms.DataGridView> control's capabilities. You can customize the appearance and behavior of the <xref:System.Windows.Forms.DataGridView> control in several ways:  \n  \n-   Change border and header styles. For more information, see [How to: Change the Border and Gridline Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/change-the-border-and-gridline-styles-in-the-datagrid.md).  \n  \n-   Enable or restrict user input to the <xref:System.Windows.Forms.DataGridView> control. For more information, see [How to: Prevent Row Addition and Deletion in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/prevent-row-addition-and-deletion-datagridview.md), and [How to: Make Columns Read-Only in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-make-columns-read-only-in-the-windows-forms-datagridview-control.md).  \n  \n-   Check user input for database-related errors. For more information, see [Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md).  \n  \n-   Handle very large data sets using virtual mode. For more information, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md).  \n  \n-   Customize the appearance of cells. For more information, see [How to: Customize the Appearance of Cells in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/customize-the-appearance-of-cells-in-the-datagrid.md) and [How to: Set Font and Color Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-font-and-color-styles-in-the-windows-forms-datagridview-control.md).  \n  \n## See Also  \n <xref:System.Windows.Forms.DataGridView>   \n <xref:System.Windows.Forms.BindingSource>   \n [Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-entry-in-the-windows-forms-datagridview-control.md)   \n [How to: Validate Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md)   \n [Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md)   \n [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md)","nodes":[{"pos":[12,99],"content":"Walkthrough: Validating Data in the Windows Forms DataGridView Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Validating Data in the Windows Forms DataGridView Control | Microsoft Docs","pos":[0,87]}]},{"pos":[723,793],"content":"Walkthrough: Validating Data in the Windows Forms DataGridView Control","linkify":"Walkthrough: Validating Data in the Windows Forms DataGridView Control","nodes":[{"content":"Walkthrough: Validating Data in the Windows Forms DataGridView Control","pos":[0,70]}]},{"content":"When you display data entry functionality to users, you frequently have to validate the data entered into your form.","pos":[794,910]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> class provides a convenient way to perform validation before data is committed to the data store.","pos":[911,1053],"source":" The <xref:System.Windows.Forms.DataGridView> class provides a convenient way to perform validation before data is committed to the data store."},{"content":"You can validate data by handling the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellValidating&gt;</ph> event, which is raised by the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> when the current cell changes.","pos":[1054,1249],"source":" You can validate data by handling the <xref:System.Windows.Forms.DataGridView.CellValidating> event, which is raised by the <xref:System.Windows.Forms.DataGridView> when the current cell changes."},{"content":"In this walkthrough, you will retrieve rows from the <ph id=\"ph1\">`Customers`</ph> table in the Northwind sample database and display them in a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control.","pos":[1256,1431],"source":"In this walkthrough, you will retrieve rows from the `Customers` table in the Northwind sample database and display them in a <xref:System.Windows.Forms.DataGridView> control."},{"content":"When a user edits a cell in the <ph id=\"ph1\">`CompanyName`</ph> column and tries to leave the cell, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.CellValidating&gt;</ph> event handler will examine new company name string to make sure it is not empty; if the new value is an empty string, the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> will prevent the user's cursor from leaving the cell until a non-empty string is entered.","pos":[1432,1826],"source":" When a user edits a cell in the `CompanyName` column and tries to leave the cell, the <xref:System.Windows.Forms.DataGridView.CellValidating> event handler will examine new company name string to make sure it is not empty; if the new value is an empty string, the <xref:System.Windows.Forms.DataGridView> will prevent the user's cursor from leaving the cell until a non-empty string is entered."},{"pos":[1833,2067],"content":"To copy the code in this topic as a single listing, see <bpt id=\"p1\">[</bpt>How to: Validate Data in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md)</ept>.","source":"To copy the code in this topic as a single listing, see [How to: Validate Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md)."},{"pos":[2076,2089],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"In order to complete this walkthrough, you will need:","pos":[2093,2146]},{"content":"Access to a server that has the Northwind SQL Server sample database.","pos":[2156,2225]},{"pos":[2234,2251],"content":"Creating the Form","linkify":"Creating the Form","nodes":[{"content":"Creating the Form","pos":[0,17]}]},{"pos":[2262,2304],"content":"To validate data entered in a DataGridView","linkify":"To validate data entered in a DataGridView","nodes":[{"content":"To validate data entered in a DataGridView","pos":[0,42]}]},{"content":"Create a class that derives from <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph> and contains a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control and a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component.","pos":[2314,2502],"source":"Create a class that derives from <xref:System.Windows.Forms.Form> and contains a <xref:System.Windows.Forms.DataGridView> control and a <xref:System.Windows.Forms.BindingSource> component."},{"pos":[2513,2599],"content":"The following code example provides basic initialization and includes a <ph id=\"ph1\">`Main`</ph> method.","source":"The following code example provides basic initialization and includes a `Main` method."},{"pos":[2610,3414],"content":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#01)]\n [!code-vb[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#01)]  \n[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#02)]\n[!code-vb[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#02)]","leadings":["","    ","    ","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#01<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#01)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#01<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#01)</ept><ept id=\"p3\">]</ept>","pos":[0,395],"source":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#01)]\n [!code-vb[System.Windows.Forms.DataGridViewDataValidation#01](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#01)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#02<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#02)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#02<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#02)</ept><ept id=\"p3\">]</ept>","pos":[398,792],"source":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#02)]\n[!code-vb[System.Windows.Forms.DataGridViewDataValidation#02](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#02)]"}]},{"content":"Implement a method in your form's class definition for handling the details of connecting to the database.","pos":[3424,3530]},{"content":"This code example uses a <ph id=\"ph1\">`GetData`</ph> method that returns a populated <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> object.","pos":[3541,3644],"source":"This code example uses a `GetData` method that returns a populated <xref:System.Data.DataTable> object."},{"content":"Be sure that you set the <ph id=\"ph1\">`connectionString`</ph> variable to a value that is appropriate for your database.","pos":[3645,3747],"source":" Be sure that you set the `connectionString` variable to a value that is appropriate for your database."},{"pos":[3759,4162],"content":"[!IMPORTANT]\nStoring sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication, also known as integrated security, is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).","leadings":["","    >  "],"nodes":[{"content":"Storing sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication, also known as integrated security, is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).","pos":[13,396],"nodes":[{"content":"Storing sensitive information, such as a password, within the connection string can affect the security of your application.","pos":[0,124]},{"content":"Using Windows Authentication, also known as integrated security, is a more secure way to control access to a database.","pos":[125,243]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Protecting Connection Information<ept id=\"p1\">](../../../../docs/framework/data/adonet/protecting-connection-information.md)</ept>.","pos":[244,383],"source":" For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md)."}]}]},{"pos":[4173,4572],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#30<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#30)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#30<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#30)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#30](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#30)]\n [!code-vb[System.Windows.Forms.DataGridViewDataValidation#30](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#30)]"},{"content":"Implement a handler for your form's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event that initializes the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> and sets up the data binding.","pos":[4582,4799],"source":"Implement a handler for your form's <xref:System.Windows.Forms.Form.Load> event that initializes the <xref:System.Windows.Forms.DataGridView> and <xref:System.Windows.Forms.BindingSource> and sets up the data binding."},{"pos":[4810,5209],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#10<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#10)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#10<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#10)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#10)]\n [!code-vb[System.Windows.Forms.DataGridViewDataValidation#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#10)]"},{"content":"Implement handlers for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.CellValidating&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridView.CellEndEdit&gt;</ph> events.","pos":[5219,5417],"source":"Implement handlers for the <xref:System.Windows.Forms.DataGridView> control's <xref:System.Windows.Forms.DataGridView.CellValidating> and <xref:System.Windows.Forms.DataGridView.CellEndEdit> events."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellValidating&gt;</ph> event handler is where you determine whether the value of a cell in the <ph id=\"ph2\">`CompanyName`</ph> column is empty.","pos":[5428,5590],"source":"The <xref:System.Windows.Forms.DataGridView.CellValidating> event handler is where you determine whether the value of a cell in the `CompanyName` column is empty."},{"content":"If the cell value fails validation, set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.CancelEventArgs.Cancel%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridViewCellValidatingEventArgs?displayProperty=fullName&gt;</ph> class to <ph id=\"ph3\">`true`</ph>.","pos":[5591,5811],"source":" If the cell value fails validation, set the <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> property of the <xref:System.Windows.Forms.DataGridViewCellValidatingEventArgs?displayProperty=fullName> class to `true`."},{"content":"This causes the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control to prevent the cursor from leaving the cell.","pos":[5812,5921],"source":" This causes the <xref:System.Windows.Forms.DataGridView> control to prevent the cursor from leaving the cell."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A&gt;</ph> property on the row to an explanatory string.","pos":[5922,6032],"source":" Set the <xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A> property on the row to an explanatory string."},{"content":"This displays an error icon with a ToolTip that contains the error text.","pos":[6033,6105]},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellEndEdit&gt;</ph> event handler, set the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A&gt;</ph> property on the row to the empty string.","pos":[6106,6286],"source":" In the <xref:System.Windows.Forms.DataGridView.CellEndEdit> event handler, set the <xref:System.Windows.Forms.DataGridViewRow.ErrorText%2A> property on the row to the empty string."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellEndEdit&gt;</ph> event occurs only when the cell exits edit mode, which it cannot do if it fails validation.","pos":[6287,6435],"source":" The <xref:System.Windows.Forms.DataGridView.CellEndEdit> event occurs only when the cell exits edit mode, which it cannot do if it fails validation."},{"pos":[6446,6845],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#20<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#20)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewDataValidation#20<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#20)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.Windows.Forms.DataGridViewDataValidation#20](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/CS/datavalidation.cs#20)]\n [!code-vb[System.Windows.Forms.DataGridViewDataValidation#20](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewDataValidation/VB/datavalidation.vb#20)]"},{"pos":[6854,6877],"content":"Testing the Application","linkify":"Testing the Application","nodes":[{"content":"Testing the Application","pos":[0,23]}]},{"content":"You can now test the form to make sure it behaves as expected.","pos":[6881,6943]},{"pos":[6954,6970],"content":"To test the form","linkify":"To test the form","nodes":[{"content":"To test the form","pos":[0,16]}]},{"content":"Compile and run the application.","pos":[6980,7012]},{"content":"You will see a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> filled with data from the <ph id=\"ph2\">`Customers`</ph> table.","pos":[7023,7123],"source":"You will see a <xref:System.Windows.Forms.DataGridView> filled with data from the `Customers` table."},{"content":"When you double-click a cell in the <ph id=\"ph1\">`CompanyName`</ph> column, you can edit the value.","pos":[7124,7205],"source":" When you double-click a cell in the `CompanyName` column, you can edit the value."},{"content":"If you delete all the characters and hit the TAB key to exit the cell, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> prevents you from exiting.","pos":[7206,7348],"source":" If you delete all the characters and hit the TAB key to exit the cell, the <xref:System.Windows.Forms.DataGridView> prevents you from exiting."},{"content":"When you type a non-empty string into the cell, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control lets you exit the cell.","pos":[7349,7473],"source":" When you type a non-empty string into the cell, the <xref:System.Windows.Forms.DataGridView> control lets you exit the cell."},{"pos":[7482,7492],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"This application gives you a basic understanding of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control's capabilities.","pos":[7496,7616],"source":"This application gives you a basic understanding of the <xref:System.Windows.Forms.DataGridView> control's capabilities."},{"content":"You can customize the appearance and behavior of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control in several ways:","pos":[7617,7735],"source":" You can customize the appearance and behavior of the <xref:System.Windows.Forms.DataGridView> control in several ways:"},{"content":"Change border and header styles.","pos":[7745,7777]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Change the Border and Gridline Styles in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/change-the-border-and-gridline-styles-in-the-datagrid.md)</ept>.","pos":[7778,7997],"source":" For more information, see [How to: Change the Border and Gridline Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/change-the-border-and-gridline-styles-in-the-datagrid.md)."},{"content":"Enable or restrict user input to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control.","pos":[8007,8093],"source":"Enable or restrict user input to the <xref:System.Windows.Forms.DataGridView> control."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Prevent Row Addition and Deletion in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/prevent-row-addition-and-deletion-datagridview.md)</ept>, and <bpt id=\"p2\">[</bpt>How to: Make Columns Read-Only in the Windows Forms DataGridView Control<ept id=\"p2\">](../../../../docs/framework/winforms/controls/how-to-make-columns-read-only-in-the-windows-forms-datagridview-control.md)</ept>.","pos":[8094,8503],"source":" For more information, see [How to: Prevent Row Addition and Deletion in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/prevent-row-addition-and-deletion-datagridview.md), and [How to: Make Columns Read-Only in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-make-columns-read-only-in-the-windows-forms-datagridview-control.md)."},{"content":"Check user input for database-related errors.","pos":[8513,8558]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md)</ept>.","pos":[8559,8797],"source":" For more information, see [Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md)."},{"content":"Handle very large data sets using virtual mode.","pos":[8807,8854]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)</ept>.","pos":[8855,9063],"source":" For more information, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)."},{"content":"Customize the appearance of cells.","pos":[9073,9107]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Customize the Appearance of Cells in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/customize-the-appearance-of-cells-in-the-datagrid.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Set Font and Color Styles in the Windows Forms DataGridView Control<ept id=\"p2\">](../../../../docs/framework/winforms/controls/how-to-set-font-and-color-styles-in-the-windows-forms-datagridview-control.md)</ept>.","pos":[9108,9525],"source":" For more information, see [How to: Customize the Appearance of Cells in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/customize-the-appearance-of-cells-in-the-datagrid.md) and [How to: Set Font and Color Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-font-and-color-styles-in-the-windows-forms-datagridview-control.md)."},{"pos":[9534,9542],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph>","pos":[9546,9586],"source":"<xref:System.Windows.Forms.DataGridView> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph>","pos":[9591,9632],"source":" <xref:System.Windows.Forms.BindingSource> "},{"content":"<bpt id=\"p1\"> [</bpt>Data Entry in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/data-entry-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9636,9794],"source":" [Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-entry-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Validate Data in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9797,9976],"source":" [How to: Validate Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-validate-data-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md)</ept><ph id=\"ph1\"> </ph>","pos":[9979,10192],"source":" [Walkthrough: Handling Errors that Occur During Data Entry in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/handling-errors-that-occur-during-data-entry-in-the-datagrid.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Protecting Connection Information<ept id=\"p1\">](../../../../docs/framework/data/adonet/protecting-connection-information.md)</ept>","pos":[10195,10308],"source":" [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md)"}]}