{"content":"---\ntitle: \"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"examples [Windows Forms], text boxes\"\n  - \"drag and drop [Windows Forms], richTextBox control\"\n  - \"text boxes [Windows Forms], drag-and-drop operations\"\n  - \"RichTextBox control [Windows Forms], drag-and-drop operations\"\nms.assetid: ca167d1c-2014-4cf0-96a0-20598470be3b\n---\n# How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control\nDrag-and-drop operations with the Windows Forms <xref:System.Windows.Forms.RichTextBox> control are done by handling the <xref:System.Windows.Forms.RichTextBox.DragEnter> and <xref:System.Windows.Forms.RichTextBox.DragDrop> events. Thus, drag-and-drop operations are extremely simple with the <xref:System.Windows.Forms.RichTextBox> control.  \n  \n### To enable drag operations in a RichTextBox control  \n  \n1.  Set the <xref:System.Windows.Forms.RichTextBox.AllowDrop%2A> property of the <xref:System.Windows.Forms.RichTextBox> control to `true`.  \n  \n2.  Write code in the event handler of the <xref:System.Windows.Forms.RichTextBox.DragEnter> event. Use an `if` statement to ensure that the data being dragged is of an acceptable type (in this case, text). The <xref:System.Windows.Forms.DragEventArgs.Effect%2A?displayProperty=nameWithType> property can be set to any value of the <xref:System.Windows.Forms.DragDropEffects> enumeration.  \n  \n    ```vb  \n    Private Sub RichTextBox1_DragEnter(ByVal sender As Object, _   \n       ByVal e As System.Windows.Forms.DragEventArgs) _   \n       Handles RichTextBox1.DragEnter  \n       If (e.Data.GetDataPresent(DataFormats.Text)) Then  \n          e.Effect = DragDropEffects.Copy  \n       Else  \n          e.Effect = DragDropEffects.None  \n       End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void richTextBox1_DragEnter(object sender,   \n    System.Windows.Forms.DragEventArgs e)  \n    {  \n       if (e.Data.GetDataPresent(DataFormats.Text))   \n          e.Effect = DragDropEffects.Copy;  \n       else  \n          e.Effect = DragDropEffects.None;  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       void richTextBox1_DragEnter(System::Object ^  sender,  \n          System::Windows::Forms::DragEventArgs ^  e)  \n       {  \n          if (e->Data->GetDataPresent(DataFormats::Text))  \n             e->Effect = DragDropEffects::Copy;  \n          else  \n             e->Effect = DragDropEffects::None;  \n       }  \n    ```  \n  \n     (Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.richTextBox1.DragEnter += new  \n        System.Windows.Forms.DragEventHandler  \n        (this.richTextBox1_DragEnter);  \n    ```  \n  \n    ```cpp  \n    this->richTextBox1->DragEnter += gcnew  \n       System::Windows::Forms::DragEventHandler  \n       (this, &Form1::richTextBox1_DragEnter);  \n    ```  \n  \n3.  Write code to handle the <xref:System.Windows.Forms.RichTextBox.DragDrop> event. Use the <xref:System.Windows.Forms.DataObject.GetData%2A?displayProperty=nameWithType> method to retrieve the data being dragged.  \n  \n     In the example below, the code sets the <xref:System.Windows.Forms.RichTextBox.Text%2A> property of the <xref:System.Windows.Forms.RichTextBox> control equal to the data being dragged. If there is already text in the <xref:System.Windows.Forms.RichTextBox> control, the dragged text is inserted at the insertion point.  \n  \n    ```vb  \n    Private Sub RichTextBox1_DragDrop(ByVal sender As Object, _   \n       ByVal e As System.Windows.Forms.DragEventArgs) _   \n       Handles RichTextBox1.DragDrop  \n       Dim i As Int16   \n       Dim s As String  \n  \n       ' Get start position to drop the text.  \n       i = RichTextBox1.SelectionStart  \n       s = RichTextBox1.Text.Substring(i)  \n       RichTextBox1.Text = RichTextBox1.Text.Substring(0, i)  \n  \n       ' Drop the text on to the RichTextBox.  \n       RichTextBox1.Text = RichTextBox1.Text + _  \n          e.Data.GetData(DataFormats.Text).ToString()  \n       RichTextBox1.Text = RichTextBox1.Text + s  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void richTextBox1_DragDrop(object sender,   \n    System.Windows.Forms.DragEventArgs e)  \n    {  \n       int i;  \n       String s;  \n  \n       // Get start position to drop the text.  \n       i = richTextBox1.SelectionStart;  \n       s = richTextBox1.Text.Substring(i);  \n       richTextBox1.Text = richTextBox1.Text.Substring(0,i);  \n  \n       // Drop the text on to the RichTextBox.  \n       richTextBox1.Text = richTextBox1.Text +   \n          e.Data.GetData(DataFormats.Text).ToString();  \n       richTextBox1.Text = richTextBox1.Text + s;  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       System::Void richTextBox1_DragDrop(System::Object ^  sender,  \n          System::Windows::Forms::DragEventArgs ^  e)  \n       {  \n          int i;  \n          String ^s;  \n  \n       // Get start position to drop the text.  \n       i = richTextBox1->SelectionStart;  \n       s = richTextBox1->Text->Substring(i);  \n       richTextBox1->Text = richTextBox1->Text->Substring(0,i);  \n  \n       // Drop the text on to the RichTextBox.  \n       String ^str = String::Concat(richTextBox1->Text, e->Data  \n       ->GetData(DataFormats->Text)->ToString());   \n       richTextBox1->Text = String::Concat(str, s);  \n       }  \n    ```  \n  \n     (Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.richTextBox1.DragDrop += new  \n        System.Windows.Forms.DragEventHandler  \n        (this.richTextBox1_DragDrop);  \n    ```  \n  \n    ```cpp  \n    this->richTextBox1->DragDrop += gcnew   \n       System::Windows::Forms::DragEventHandler  \n       (this, &Form1::richTextBox1_DragDrop);  \n    ```  \n  \n### To test the drag-and-drop functionality in your application  \n  \n1.  Save and build your application. While it is running, run WordPad.  \n  \n     WordPad is a text editor installed by Windows that allows drag-and-drop operations. It is accessible by clicking the **Start** button, selecting **Run**, typing `WordPad` in the text box of the **Run** dialog box, and then clicking **OK**.  \n  \n2.  Once WordPad is open, type a string of text in it. Using the mouse, select the text, and then drag the selected text over to the <xref:System.Windows.Forms.RichTextBox> control in your Windows application.  \n  \n     Notice that when you point the mouse at the <xref:System.Windows.Forms.RichTextBox> control (and, consequently, raise the <xref:System.Windows.Forms.RichTextBox.DragEnter> event), the mouse pointer changes and you can drop the selected text into the <xref:System.Windows.Forms.RichTextBox> control.  \n  \n     When you release the mouse button, the selected text is dropped (that is, the <xref:System.Windows.Forms.RichTextBox.DragDrop> event is raised) and is inserted within the <xref:System.Windows.Forms.RichTextBox> control.  \n  \n## See also\n\n- <xref:System.Windows.Forms.RichTextBox>\n- [How to: Perform Drag-and-Drop Operations Between Applications](../advanced/how-to-perform-drag-and-drop-operations-between-applications.md)\n- [RichTextBox Control](richtextbox-control-windows-forms.md)\n- [Controls to Use on Windows Forms](controls-to-use-on-windows-forms.md)\n","nodes":[{"pos":[4,459],"embed":true,"restype":"x-metadata","content":"title: \"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"examples [Windows Forms], text boxes\"\n  - \"drag and drop [Windows Forms], richTextBox control\"\n  - \"text boxes [Windows Forms], drag-and-drop operations\"\n  - \"RichTextBox control [Windows Forms], drag-and-drop operations\"\nms.assetid: ca167d1c-2014-4cf0-96a0-20598470be3b","nodes":[{"content":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","nodes":[{"pos":[0,82],"content":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","pos":[0,82]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[466,548],"content":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","linkify":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Enable Drag-and-Drop Operations with the Windows Forms RichTextBox Control","pos":[0,82]}]},{"content":"Drag-and-drop operations with the Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control are done by handling the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox.DragEnter&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.RichTextBox.DragDrop&gt;</ph> events.","pos":[549,780],"source":"Drag-and-drop operations with the Windows Forms <xref:System.Windows.Forms.RichTextBox> control are done by handling the <xref:System.Windows.Forms.RichTextBox.DragEnter> and <xref:System.Windows.Forms.RichTextBox.DragDrop> events."},{"content":"Thus, drag-and-drop operations are extremely simple with the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","pos":[781,890],"source":" Thus, drag-and-drop operations are extremely simple with the <xref:System.Windows.Forms.RichTextBox> control."},{"pos":[900,950],"content":"To enable drag operations in a RichTextBox control","linkify":"To enable drag operations in a RichTextBox control","nodes":[{"content":"To enable drag operations in a RichTextBox control","pos":[0,50]}]},{"pos":[960,1095],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.AllowDrop%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control to <ph id=\"ph3\">`true`</ph>.","source":"Set the <xref:System.Windows.Forms.RichTextBox.AllowDrop%2A> property of the <xref:System.Windows.Forms.RichTextBox> control to `true`."},{"content":"Write code in the event handler of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.DragEnter&gt;</ph> event.","pos":[1105,1200],"source":"Write code in the event handler of the <xref:System.Windows.Forms.RichTextBox.DragEnter> event."},{"content":"Use an <ph id=\"ph1\">`if`</ph> statement to ensure that the data being dragged is of an acceptable type (in this case, text).","pos":[1201,1307],"source":" Use an `if` statement to ensure that the data being dragged is of an acceptable type (in this case, text)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DragEventArgs.Effect%2A?displayProperty=nameWithType&gt;</ph> property can be set to any value of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DragDropEffects&gt;</ph> enumeration.","pos":[1308,1489],"source":" The <xref:System.Windows.Forms.DragEventArgs.Effect%2A?displayProperty=nameWithType> property can be set to any value of the <xref:System.Windows.Forms.DragDropEffects> enumeration."},{"pos":[2548,2699],"content":"(Visual C# and <ph id=\"ph1\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"(Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"content":"Write code to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.DragDrop&gt;</ph> event.","pos":[3038,3118],"source":"Write code to handle the <xref:System.Windows.Forms.RichTextBox.DragDrop> event."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataObject.GetData%2A?displayProperty=nameWithType&gt;</ph> method to retrieve the data being dragged.","pos":[3119,3248],"source":" Use the <xref:System.Windows.Forms.DataObject.GetData%2A?displayProperty=nameWithType> method to retrieve the data being dragged."},{"content":"In the example below, the code sets the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.Text%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control equal to the data being dragged.","pos":[3259,3443],"source":"In the example below, the code sets the <xref:System.Windows.Forms.RichTextBox.Text%2A> property of the <xref:System.Windows.Forms.RichTextBox> control equal to the data being dragged."},{"content":"If there is already text in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control, the dragged text is inserted at the insertion point.","pos":[3444,3577],"source":" If there is already text in the <xref:System.Windows.Forms.RichTextBox> control, the dragged text is inserted at the insertion point."},{"pos":[5508,5659],"content":"(Visual C# and <ph id=\"ph1\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"(Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"pos":[5995,6054],"content":"To test the drag-and-drop functionality in your application","linkify":"To test the drag-and-drop functionality in your application","nodes":[{"content":"To test the drag-and-drop functionality in your application","pos":[0,59]}]},{"content":"Save and build your application.","pos":[6064,6096]},{"content":"While it is running, run WordPad.","pos":[6097,6130]},{"content":"WordPad is a text editor installed by Windows that allows drag-and-drop operations.","pos":[6141,6224]},{"content":"It is accessible by clicking the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> button, selecting <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, typing <ph id=\"ph1\">`WordPad`</ph> in the text box of the <bpt id=\"p3\">**</bpt>Run<ept id=\"p3\">**</ept> dialog box, and then clicking <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[6225,6380],"source":" It is accessible by clicking the **Start** button, selecting **Run**, typing `WordPad` in the text box of the **Run** dialog box, and then clicking **OK**."},{"content":"Once WordPad is open, type a string of text in it.","pos":[6390,6440]},{"content":"Using the mouse, select the text, and then drag the selected text over to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control in your Windows application.","pos":[6441,6595],"source":" Using the mouse, select the text, and then drag the selected text over to the <xref:System.Windows.Forms.RichTextBox> control in your Windows application."},{"pos":[6606,6904],"content":"Notice that when you point the mouse at the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control (and, consequently, raise the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox.DragEnter&gt;</ph> event), the mouse pointer changes and you can drop the selected text into the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","source":"Notice that when you point the mouse at the <xref:System.Windows.Forms.RichTextBox> control (and, consequently, raise the <xref:System.Windows.Forms.RichTextBox.DragEnter> event), the mouse pointer changes and you can drop the selected text into the <xref:System.Windows.Forms.RichTextBox> control."},{"pos":[6915,7134],"content":"When you release the mouse button, the selected text is dropped (that is, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.DragDrop&gt;</ph> event is raised) and is inserted within the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","source":"When you release the mouse button, the selected text is dropped (that is, the <xref:System.Windows.Forms.RichTextBox.DragDrop> event is raised) and is inserted within the <xref:System.Windows.Forms.RichTextBox> control."},{"pos":[7143,7151],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7197,7337],"content":"<bpt id=\"p1\">[</bpt>How to: Perform Drag-and-Drop Operations Between Applications<ept id=\"p1\">](../advanced/how-to-perform-drag-and-drop-operations-between-applications.md)</ept>","source":"[How to: Perform Drag-and-Drop Operations Between Applications](../advanced/how-to-perform-drag-and-drop-operations-between-applications.md)"},{"pos":[7340,7399],"content":"<bpt id=\"p1\">[</bpt>RichTextBox Control<ept id=\"p1\">](richtextbox-control-windows-forms.md)</ept>","source":"[RichTextBox Control](richtextbox-control-windows-forms.md)"},{"pos":[7402,7473],"content":"<bpt id=\"p1\">[</bpt>Controls to Use on Windows Forms<ept id=\"p1\">](controls-to-use-on-windows-forms.md)</ept>","source":"[Controls to Use on Windows Forms](controls-to-use-on-windows-forms.md)"}]}