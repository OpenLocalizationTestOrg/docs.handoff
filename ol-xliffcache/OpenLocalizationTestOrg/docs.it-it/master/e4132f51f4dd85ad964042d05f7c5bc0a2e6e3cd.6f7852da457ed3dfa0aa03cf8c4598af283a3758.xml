{"content":"---\ntitle: \"How to: Declare Custom Events To Conserve Memory (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declaring events [Visual Basic], custom\"\n  - \"events [Visual Basic], custom\"\n  - \"custom events [Visual Basic]\"\nms.assetid: 87ebee87-260c-462f-979c-407874debd19\n---\n# How to: Declare Custom Events To Conserve Memory (Visual Basic)\nThere are several circumstances when it is important that an application keep its memory usage low. Custom events allow the application to use memory only for the events that it handles.  \n  \n By default, when a class declares an event, the compiler allocates memory for a field to store the event information. If a class has many unused events, they needlessly take up memory.  \n  \n Instead of using the default implementation of events that Visual Basic provides, you can use custom events to manage the memory usage more carefully.  \n  \n## Example  \n In this example, the class uses one instance of the <xref:System.ComponentModel.EventHandlerList> class, stored in the `Events` field, to store information about the events in use. The <xref:System.ComponentModel.EventHandlerList> class is an optimized list class designed to hold delegates.  \n  \n All events in the class use the `Events` field to keep track of what methods are handling each event.  \n  \n [!code-vb[VbVbalrEvents#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#22)]  \n  \n## See also\n\n- <xref:System.ComponentModel.EventHandlerList>\n- [Events](../../../../visual-basic/programming-guide/language-features/events/index.md)\n- [How to: Declare Custom Events To Avoid Blocking](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)\n","nodes":[{"pos":[4,284],"embed":true,"restype":"x-metadata","content":"title: \"How to: Declare Custom Events To Conserve Memory (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declaring events [Visual Basic], custom\"\n  - \"events [Visual Basic], custom\"\n  - \"custom events [Visual Basic]\"\nms.assetid: 87ebee87-260c-462f-979c-407874debd19","nodes":[{"content":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","nodes":[{"pos":[0,63],"content":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","nodes":[{"content":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[291,354],"content":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","linkify":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","nodes":[{"content":"How to: Declare Custom Events To Conserve Memory (Visual Basic)","pos":[0,63]}]},{"content":"There are several circumstances when it is important that an application keep its memory usage low.","pos":[355,454]},{"content":"Custom events allow the application to use memory only for the events that it handles.","pos":[455,541]},{"content":"By default, when a class declares an event, the compiler allocates memory for a field to store the event information.","pos":[548,665]},{"content":"If a class has many unused events, they needlessly take up memory.","pos":[666,732]},{"content":"Instead of using the default implementation of events that Visual Basic provides, you can use custom events to manage the memory usage more carefully.","pos":[739,889]},{"pos":[898,905],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In this example, the class uses one instance of the <ph id=\"ph1\">&lt;xref:System.ComponentModel.EventHandlerList&gt;</ph> class, stored in the <ph id=\"ph2\">`Events`</ph> field, to store information about the events in use.","pos":[909,1089],"source":"In this example, the class uses one instance of the <xref:System.ComponentModel.EventHandlerList> class, stored in the `Events` field, to store information about the events in use."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.EventHandlerList&gt;</ph> class is an optimized list class designed to hold delegates.","pos":[1090,1200],"source":" The <xref:System.ComponentModel.EventHandlerList> class is an optimized list class designed to hold delegates."},{"pos":[1207,1308],"content":"All events in the class use the <ph id=\"ph1\">`Events`</ph> field to keep track of what methods are handling each event.","source":"All events in the class use the `Events` field to keep track of what methods are handling each event."},{"pos":[1435,1443],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1495,1581],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)"},{"pos":[1584,1752],"content":"<bpt id=\"p1\">[</bpt>How to: Declare Custom Events To Avoid Blocking<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)</ept>","source":"[How to: Declare Custom Events To Avoid Blocking](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)"}]}