{"content":"---\ntitle: \"<add>\"\nms.date: \"03/30/2017\"\nms.assetid: 4712a888-f154-4395-8887-ef14a88a6497\nauthor: \"BrucePerlerMS\"\n---\n# \\<add>\nAdds the specified security token handler to the token handler collection.  \n  \n \\<system.identityModel>  \n\\<identityConfiguration>  \n\\<securityTokenHandlers>  \n\\<add>  \n  \n## Syntax  \n  \n```xml  \n<system.identityModel>  \n  <identityConfiguration>  \n    <securityTokenHandlers>  \n      <add type=xs:string>  \n        <optionalConfigurationElement>  \n        </optionalConfigurationElement>  \n      </add>  \n    </securityTokenHandlers>  \n  </identityConfiguration>  \n</system.identityModel>  \n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|type|The CLR type name of the token handler to be added. For more information about how to specify the `type` attribute, see [Custom Type References](https://docs.microsoft.com/previous-versions/windows-identity-foundation/gg638728(v=msdn.10)#custom-type-references).|  \n  \n### Child Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|[\\<samlSecurityTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler> class, the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class, or a derived class of either of these classes.|  \n|[\\<sessionTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> class or derived classes.|  \n|[\\<userNameSecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler> class or derived classes.|  \n|[\\<x509SecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)|Provides optional configuration for the <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler> class or derived classes.|  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|[\\<securityTokenHandlers>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)|Specifies a collection of security token handlers that are registered with the endpoint.|  \n  \n## Remarks  \n The `<add>` element can take a single child element that specifies the configuration for the token handler. This is dependent on whether the handler class referenced through the `type` attribute of the `<add>` element provides support for this feature. Token handler classes that provide this feature must expose a constructor that takes an <xref:System.Xml.XmlElement> object.  \n  \n```  \npublic class CustomTokenHandler : Microsoft.IdentityModel.Tokens.SecurityTokenHandler  \n{  \n    public CustomTokenHandler( XmlElement customConfig )  \n    {  \n    }  \n}  \n```  \n  \n Several of the built-in security token handler classes do provide this functionality. These classes are <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler>, and <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>.  \n  \n> [!IMPORTANT]\n>  The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.  \n  \n Settings specified on a handler override equivalent settings specified on the token handler collection under the [\\<securityTokenHandlerConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md) element and those specified at the service-level under the [\\<identityConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element.  \n  \n## Example  \n The following XML shows the use of the `<add>` and `<remove>` elements to replace the default session token handler with a custom session token handler. The XML is taken from the `ClaimsAwareWebFarm` sample.  \n  \n```xml  \n<securityTokenHandlers>  \n  <remove type=\"System.IdentityModel.Tokens.SessionSecurityTokenHandler, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n  <add type=\"System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n</securityTokenHandlers>  \n```\n","nodes":[{"pos":[4,113],"embed":true,"restype":"x-metadata","content":"title: \"<add>\"\nms.date: \"03/30/2017\"\nms.assetid: 4712a888-f154-4395-8887-ef14a88a6497\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"<add>","nodes":[],"path":["title"],"nosxs":false}],"yml":true},{"pos":[120,126],"content":"\\<add>","linkify":"\\<add>","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>add&gt;","pos":[0,6],"source":"\\<add>"}]},{"content":"Adds the specified security token handler to the token handler collection.","pos":[127,201]},{"content":"<ph id=\"ph1\">\\&lt;</ph>system.identityModel&gt;","pos":[208,231],"source":"\\<system.identityModel>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>identityConfiguration&gt;","pos":[234,258],"source":"\\<identityConfiguration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>securityTokenHandlers&gt;","pos":[261,285],"source":"\\<securityTokenHandlers>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>add&gt;","pos":[288,294],"source":"\\<add>"},{"pos":[303,309],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[632,655],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[659,739]},{"pos":[749,759],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[766,775]},{"content":"Description","pos":[776,787]},{"content":"type","pos":[830,834]},{"content":"The CLR type name of the token handler to be added.","pos":[835,886]},{"content":"For more information about how to specify the <ph id=\"ph1\">`type`</ph> attribute, see <bpt id=\"p1\">[</bpt>Custom Type References<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/windows-identity-foundation/gg638728(v=msdn.10)#custom-type-references)</ept>.","pos":[887,1097],"source":" For more information about how to specify the `type` attribute, see [Custom Type References](https://docs.microsoft.com/previous-versions/windows-identity-foundation/gg638728(v=msdn.10)#custom-type-references)."},{"pos":[1108,1122],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"Element","pos":[1129,1136]},{"content":"Description","pos":[1137,1148]},{"pos":[1189,1340],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>samlSecurityTokenRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)</ept>","source":"[\\<samlSecurityTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)"},{"pos":[1341,1557],"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler&gt;</ph> class, the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph> class, or a derived class of either of these classes.","source":"Provides configuration for the <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler> class, the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class, or a derived class of either of these classes."},{"pos":[1562,1703],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>sessionTokenRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)</ept>","source":"[\\<sessionTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)"},{"pos":[1704,1823],"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler&gt;</ph> class or derived classes.","source":"Provides configuration for the <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> class or derived classes."},{"pos":[1828,2001],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>userNameSecurityTokenHandlerRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)</ept>","source":"[\\<userNameSecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)"},{"pos":[2002,2141],"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler&gt;</ph> class or derived classes.","source":"Provides configuration for the <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler> class or derived classes."},{"pos":[2146,2311],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>x509SecurityTokenHandlerRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)</ept>","source":"[\\<x509SecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)"},{"pos":[2312,2437],"content":"Provides optional configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.X509SecurityTokenHandler&gt;</ph> class or derived classes.","source":"Provides optional configuration for the <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler> class or derived classes."},{"pos":[2448,2463],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[2470,2477]},{"content":"Description","pos":[2478,2489]},{"pos":[2530,2667],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>securityTokenHandlers&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)</ept>","source":"[\\<securityTokenHandlers>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)"},{"content":"Specifies a collection of security token handlers that are registered with the endpoint.","pos":[2668,2756]},{"pos":[2766,2773],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`&lt;add&gt;`</ph> element can take a single child element that specifies the configuration for the token handler.","pos":[2777,2884],"source":"The `<add>` element can take a single child element that specifies the configuration for the token handler."},{"content":"This is dependent on whether the handler class referenced through the <ph id=\"ph1\">`type`</ph> attribute of the <ph id=\"ph2\">`&lt;add&gt;`</ph> element provides support for this feature.","pos":[2885,3029],"source":" This is dependent on whether the handler class referenced through the `type` attribute of the `<add>` element provides support for this feature."},{"content":"Token handler classes that provide this feature must expose a constructor that takes an <ph id=\"ph1\">&lt;xref:System.Xml.XmlElement&gt;</ph> object.","pos":[3030,3154],"source":" Token handler classes that provide this feature must expose a constructor that takes an <xref:System.Xml.XmlElement> object."},{"content":"Several of the built-in security token handler classes do provide this functionality.","pos":[3347,3432]},{"content":"These classes are <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.IdentityModel.Tokens.X509SecurityTokenHandler&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler&gt;</ph>.","pos":[3433,3786],"source":" These classes are <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler>, and <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>."},{"pos":[3794,4547],"content":"[!IMPORTANT]\n The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.","leadings":["","> "],"nodes":[{"content":"The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.","pos":[14,751],"nodes":[{"content":"The token handler collection can only contain a single handler of any given type.","pos":[0,81]},{"content":"This means, for example, that if you want to add a handler that is derived from the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph> class to the collection, you must first remove the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph>, which is present by default, from the collection.","pos":[82,389],"source":" This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection."},{"content":"You can use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>remove&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md)</ept> element to remove a single handler from the collection or use the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>clear&gt;<ept id=\"p2\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md)</ept> element to remove all handlers from the collection.","pos":[390,737],"source":" You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection."}]}]},{"pos":[4554,5034],"content":"Settings specified on a handler override equivalent settings specified on the token handler collection under the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>securityTokenHandlerConfiguration&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md)</ept> element and those specified at the service-level under the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>identityConfiguration&gt;<ept id=\"p2\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md)</ept> element.","source":"Settings specified on a handler override equivalent settings specified on the token handler collection under the [\\<securityTokenHandlerConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md) element and those specified at the service-level under the [\\<identityConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element."},{"pos":[5043,5050],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following XML shows the use of the <ph id=\"ph1\">`&lt;add&gt;`</ph> and <ph id=\"ph2\">`&lt;remove&gt;`</ph> elements to replace the default session token handler with a custom session token handler.","pos":[5054,5206],"source":"The following XML shows the use of the `<add>` and `<remove>` elements to replace the default session token handler with a custom session token handler."},{"content":"The XML is taken from the <ph id=\"ph1\">`ClaimsAwareWebFarm`</ph> sample.","pos":[5207,5261],"source":" The XML is taken from the `ClaimsAwareWebFarm` sample."}]}