{"content":"---\ntitle: \"How to: Instantiate a TimeZoneInfo object\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"instantiating time zone objects\"\n  - \"time zone objects [.NET Framework], instantiation\"\nms.assetid: 8cb620e5-c6a6-4267-a52e-beeb73cd1a34\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Instantiate a TimeZoneInfo object\n\nThe most common way to instantiate a <xref:System.TimeZoneInfo> object is to retrieve information about it from the registry. This topic discusses how to instantiate a <xref:System.TimeZoneInfo> object from the local system registry.\n\n### To instantiate a TimeZoneInfo object\n\n1. Declare a <xref:System.TimeZoneInfo> object.\n\n2. Call the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType> method.\n\n3. Handle any exceptions thrown by the method, particularly the <xref:System.TimeZoneNotFoundException> that is thrown if the time zone is not defined in the registry.\n\n## Example\n\nThe following code retrieves a <xref:System.TimeZoneInfo> object that represents the Eastern Standard Time zone and displays the Eastern Standard time that corresponds to the local time.\n\n[!code-csharp[System.TimeZone2.Concepts#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#5)]\n[!code-vb[System.TimeZone2.Concepts#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#5)]\n\nThe <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType> method's single parameter is the identifier of the time zone that you want to retrieve, which corresponds to the object's <xref:System.TimeZoneInfo.Id%2A?displayProperty=nameWithType> property. The time zone identifier is a key field that uniquely identifies the time zone. While most keys are relatively short, the time zone identifier is comparatively long. In most cases, its value corresponds to the <xref:System.TimeZoneInfo.StandardName%2A> property of a <xref:System.TimeZoneInfo> object, which is used to provide the name of the time zone's standard time. However, there are exceptions. The best way to make sure that you supply a valid identifier is to enumerate the time zones available on your system and note the identifiers of the time zones present on them. For an illustration, see [How to: Enumerate time zones present on a computer](../../../docs/standard/datetime/enumerate-time-zones.md). The [Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md) topic also contains a list of selected time zone identifiers.\n\nIf the time zone is found, the method returns its <xref:System.TimeZoneInfo> object. If the time zone is not found, the method throws a <xref:System.TimeZoneNotFoundException>. If the time zone is found but its data is corrupted or incomplete, the method throws an <xref:System.InvalidTimeZoneException>.\n\nIf your application relies on a time zone that must be present, you should first call the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method to retrieve the time zone information from the registry. If the method call fails, your exception handler should then either create a new instance of the time zone or re-create it by deserializing a serialized <xref:System.TimeZoneInfo> object. See [How to: Restore time zones from an embedded resource](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md) for an example.\n\n## See also\n\n- [Dates, times, and time zones](../../../docs/standard/datetime/index.md)\n- [Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)\n- [How to: Access the predefined UTC and local time zone objects](../../../docs/standard/datetime/access-utc-and-local.md)\n","nodes":[{"pos":[4,346],"embed":true,"restype":"x-metadata","content":"title: \"How to: Instantiate a TimeZoneInfo object\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"instantiating time zone objects\"\n  - \"time zone objects [.NET Framework], instantiation\"\nms.assetid: 8cb620e5-c6a6-4267-a52e-beeb73cd1a34\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Instantiate a TimeZoneInfo object","nodes":[{"pos":[0,41],"content":"How to: Instantiate a TimeZoneInfo object","nodes":[{"content":"How to: Instantiate a TimeZoneInfo object","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[353,394],"content":"How to: Instantiate a TimeZoneInfo object","linkify":"How to: Instantiate a TimeZoneInfo object","nodes":[{"content":"How to: Instantiate a TimeZoneInfo object","pos":[0,41]}]},{"content":"The most common way to instantiate a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object is to retrieve information about it from the registry.","pos":[396,521],"source":"The most common way to instantiate a <xref:System.TimeZoneInfo> object is to retrieve information about it from the registry."},{"content":"This topic discusses how to instantiate a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object from the local system registry.","pos":[522,629],"source":" This topic discusses how to instantiate a <xref:System.TimeZoneInfo> object from the local system registry."},{"pos":[635,671],"content":"To instantiate a TimeZoneInfo object","linkify":"To instantiate a TimeZoneInfo object","nodes":[{"content":"To instantiate a TimeZoneInfo object","pos":[0,36]}]},{"pos":[676,720],"content":"Declare a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object.","source":"Declare a <xref:System.TimeZoneInfo> object."},{"pos":[725,859],"content":"Call the <ph id=\"ph1\">`static`</ph> (<ph id=\"ph2\">`Shared`</ph> in Visual Basic) <ph id=\"ph3\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Call the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType> method."},{"pos":[864,1028],"content":"Handle any exceptions thrown by the method, particularly the <ph id=\"ph1\">&lt;xref:System.TimeZoneNotFoundException&gt;</ph> that is thrown if the time zone is not defined in the registry.","source":"Handle any exceptions thrown by the method, particularly the <xref:System.TimeZoneNotFoundException> that is thrown if the time zone is not defined in the registry."},{"pos":[1033,1040],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1042,1228],"content":"The following code retrieves a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object that represents the Eastern Standard Time zone and displays the Eastern Standard time that corresponds to the local time.","source":"The following code retrieves a <xref:System.TimeZoneInfo> object that represents the Eastern Standard Time zone and displays the Eastern Standard time that corresponds to the local time."},{"content":"The <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType&gt;</ph> method's single parameter is the identifier of the time zone that you want to retrieve, which corresponds to the object's <ph id=\"ph2\">&lt;xref:System.TimeZoneInfo.Id%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[1538,1817],"source":"The <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A?displayProperty=nameWithType> method's single parameter is the identifier of the time zone that you want to retrieve, which corresponds to the object's <xref:System.TimeZoneInfo.Id%2A?displayProperty=nameWithType> property."},{"content":"The time zone identifier is a key field that uniquely identifies the time zone.","pos":[1818,1897]},{"content":"While most keys are relatively short, the time zone identifier is comparatively long.","pos":[1898,1983]},{"content":"In most cases, its value corresponds to the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.StandardName%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.TimeZoneInfo&gt;</ph> object, which is used to provide the name of the time zone's standard time.","pos":[1984,2187],"source":" In most cases, its value corresponds to the <xref:System.TimeZoneInfo.StandardName%2A> property of a <xref:System.TimeZoneInfo> object, which is used to provide the name of the time zone's standard time."},{"content":"However, there are exceptions.","pos":[2188,2218]},{"content":"The best way to make sure that you supply a valid identifier is to enumerate the time zones available on your system and note the identifiers of the time zones present on them.","pos":[2219,2395]},{"content":"For an illustration, see <bpt id=\"p1\">[</bpt>How to: Enumerate time zones present on a computer<ept id=\"p1\">](../../../docs/standard/datetime/enumerate-time-zones.md)</ept>.","pos":[2396,2531],"source":" For an illustration, see [How to: Enumerate time zones present on a computer](../../../docs/standard/datetime/enumerate-time-zones.md)."},{"content":"The <bpt id=\"p1\">[</bpt>Finding the time zones defined on a local system<ept id=\"p1\">](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)</ept> topic also contains a list of selected time zone identifiers.","pos":[2532,2723],"source":" The [Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md) topic also contains a list of selected time zone identifiers."},{"content":"If the time zone is found, the method returns its <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object.","pos":[2725,2809],"source":"If the time zone is found, the method returns its <xref:System.TimeZoneInfo> object."},{"content":"If the time zone is not found, the method throws a <ph id=\"ph1\">&lt;xref:System.TimeZoneNotFoundException&gt;</ph>.","pos":[2810,2901],"source":" If the time zone is not found, the method throws a <xref:System.TimeZoneNotFoundException>."},{"content":"If the time zone is found but its data is corrupted or incomplete, the method throws an <ph id=\"ph1\">&lt;xref:System.InvalidTimeZoneException&gt;</ph>.","pos":[2902,3029],"source":" If the time zone is found but its data is corrupted or incomplete, the method throws an <xref:System.InvalidTimeZoneException>."},{"content":"If your application relies on a time zone that must be present, you should first call the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A&gt;</ph> method to retrieve the time zone information from the registry.","pos":[3031,3237],"source":"If your application relies on a time zone that must be present, you should first call the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method to retrieve the time zone information from the registry."},{"content":"If the method call fails, your exception handler should then either create a new instance of the time zone or re-create it by deserializing a serialized <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object.","pos":[3238,3425],"source":" If the method call fails, your exception handler should then either create a new instance of the time zone or re-create it by deserializing a serialized <xref:System.TimeZoneInfo> object."},{"content":"See <bpt id=\"p1\">[</bpt>How to: Restore time zones from an embedded resource<ept id=\"p1\">](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md)</ept> for an example.","pos":[3426,3581],"source":" See [How to: Restore time zones from an embedded resource](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md) for an example."},{"pos":[3586,3594],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3598,3670],"content":"<bpt id=\"p1\">[</bpt>Dates, times, and time zones<ept id=\"p1\">](../../../docs/standard/datetime/index.md)</ept>","source":"[Dates, times, and time zones](../../../docs/standard/datetime/index.md)"},{"pos":[3673,3798],"content":"<bpt id=\"p1\">[</bpt>Finding the time zones defined on a local system<ept id=\"p1\">](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)</ept>","source":"[Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)"},{"pos":[3801,3921],"content":"<bpt id=\"p1\">[</bpt>How to: Access the predefined UTC and local time zone objects<ept id=\"p1\">](../../../docs/standard/datetime/access-utc-and-local.md)</ept>","source":"[How to: Access the predefined UTC and local time zone objects](../../../docs/standard/datetime/access-utc-and-local.md)"}]}