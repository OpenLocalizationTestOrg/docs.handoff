{"content":"---\ntitle: \"How to: Write Queries with Complex Filtering (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: bf286ffc-7990-4b00-a4eb-ee3d70129950\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# How to: Write Queries with Complex Filtering (Visual Basic)\nSometimes you want to write LINQ to XML queries with complex filters. For example, you might have to find all elements that have a child element with a particular name and value. This topic gives an example of writing a query with complex filtering.  \n  \n## Example  \n This example shows how to find all `PurchaseOrder` elements that have a child `Address` element that has a `Type` attribute equal to \"Shipping\" and a child `State` element equal to \"NY\". It uses a nested query in the `Where` clause, and the `Any` operator returns `True` if the collection has any elements in it.  \n  \n This example uses the following XML document: [Sample XML File: Multiple Purchase Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-linq-to-xml.md).  \n  \n For more information about the `Any` operator, see [Quantifier Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md).  \n  \n```vb  \nDim root As XElement = XElement.Load(\"PurchaseOrders.xml\")  \nDim purchaseOrders As IEnumerable(Of XElement) = _  \n    From el In root.<PurchaseOrder> _  \n    Where _  \n        (From add In el.<Address> _  \n        Where _  \n             add.@Type = \"Shipping\" And _  \n             add.<State>.Value = \"NY\" _  \n        Select add) _  \n    .Any() _  \n    Select el  \nFor Each el As XElement In purchaseOrders  \n    Console.WriteLine(el.@PurchaseOrderNumber)  \nNext  \n```  \n  \n This code produces the following output:  \n  \n```  \n99505  \n```  \n  \n## Example  \n The following example shows the same query for XML that is in a namespace. For more information, see [Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md).  \n  \n This example uses the following XML document: [Sample XML File: Multiple Purchase Orders in a Namespace](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-in-a-namespace.md).  \n  \n```vb  \nImports <xmlns:aw='http://www.adventure-works.com'>  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = XElement.Load(\"PurchaseOrdersInNamespace.xml\")  \n        Dim purchaseOrders As IEnumerable(Of XElement) = _  \n            From el In root.<aw:PurchaseOrder> _  \n            Where _  \n                (From add In el.<aw:Address> _  \n                Where _  \n                     add.@aw:Type = \"Shipping\" And _  \n                     add.<aw:State>.Value = \"NY\" _  \n                Select add) _  \n            .Any() _  \n            Select el  \n        For Each el As XElement In purchaseOrders  \n            Console.WriteLine(el.@aw:PurchaseOrderNumber)  \n        Next  \n    End Sub  \nEnd Module  \n```  \n  \n This code produces the following output:  \n  \n```  \n99505  \n```  \n  \n## See Also  \n <xref:System.Xml.Linq.XElement.Attribute%2A>   \n <xref:System.Xml.Linq.XContainer.Elements%2A>   \n [Basic Queries (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md)   \n [XML Child Axis Property](../../../../visual-basic/language-reference/xml-axis/xml-child-axis-property.md)   \n [XML Attribute Axis Property](../../../../visual-basic/language-reference/xml-axis/xml-attribute-axis-property.md)   \n [XML Value Property](../../../../visual-basic/language-reference/xml-axis/xml-value-property.md)   \n [Projection Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/projection-operations.md)   \n [Quantifier Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md)","nodes":[{"pos":[12,88],"content":"How to: Write Queries with Complex Filtering (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Write Queries with Complex Filtering (Visual Basic) | Microsoft Docs","pos":[0,76]}]},{"pos":[395,454],"content":"How to: Write Queries with Complex Filtering (Visual Basic)","linkify":"How to: Write Queries with Complex Filtering (Visual Basic)","nodes":[{"content":"How to: Write Queries with Complex Filtering (Visual Basic)","pos":[0,59]}]},{"content":"Sometimes you want to write LINQ to XML queries with complex filters.","pos":[455,524]},{"content":"For example, you might have to find all elements that have a child element with a particular name and value.","pos":[525,633]},{"content":"This topic gives an example of writing a query with complex filtering.","pos":[634,704]},{"pos":[713,720],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example shows how to find all <ph id=\"ph1\">`PurchaseOrder`</ph> elements that have a child <ph id=\"ph2\">`Address`</ph> element that has a <ph id=\"ph3\">`Type`</ph> attribute equal to \"Shipping\" and a child <ph id=\"ph4\">`State`</ph> element equal to \"NY\".","pos":[724,910],"source":"This example shows how to find all `PurchaseOrder` elements that have a child `Address` element that has a `Type` attribute equal to \"Shipping\" and a child `State` element equal to \"NY\"."},{"content":"It uses a nested query in the <ph id=\"ph1\">`Where`</ph> clause, and the <ph id=\"ph2\">`Any`</ph> operator returns <ph id=\"ph3\">`True`</ph> if the collection has any elements in it.","pos":[911,1036],"source":" It uses a nested query in the `Where` clause, and the `Any` operator returns `True` if the collection has any elements in it."},{"pos":[1043,1261],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Multiple Purchase Orders (LINQ to XML)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-linq-to-xml.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Multiple Purchase Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-linq-to-xml.md)."},{"pos":[1268,1441],"content":"For more information about the <ph id=\"ph1\">`Any`</ph> operator, see <bpt id=\"p1\">[</bpt>Quantifier Operations (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md)</ept>.","source":"For more information about the `Any` operator, see [Quantifier Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md)."},{"content":"This code produces the following output:","pos":[1930,1970]},{"pos":[2002,2009],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows the same query for XML that is in a namespace.","pos":[2013,2087]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Working with XML Namespaces (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)</ept>.","pos":[2088,2248],"source":" For more information, see [Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)."},{"pos":[2255,2477],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Multiple Purchase Orders in a Namespace<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-in-a-namespace.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Multiple Purchase Orders in a Namespace](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-multiple-purchase-orders-in-a-namespace.md)."},{"content":"This code produces the following output:","pos":[3222,3262]},{"pos":[3294,3302],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Basic Queries (LINQ to XML) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md)</ept><ph id=\"ph1\"> </ph>","pos":[3404,3537],"source":" [Basic Queries (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md) "},{"content":"<bpt id=\"p1\"> [</bpt>XML Child Axis Property<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-axis/xml-child-axis-property.md)</ept><ph id=\"ph1\"> </ph>","pos":[3540,3648],"source":" [XML Child Axis Property](../../../../visual-basic/language-reference/xml-axis/xml-child-axis-property.md) "},{"content":"<bpt id=\"p1\"> [</bpt>XML Attribute Axis Property<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-axis/xml-attribute-axis-property.md)</ept><ph id=\"ph1\"> </ph>","pos":[3651,3767],"source":" [XML Attribute Axis Property](../../../../visual-basic/language-reference/xml-axis/xml-attribute-axis-property.md) "},{"content":"<bpt id=\"p1\"> [</bpt>XML Value Property<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-axis/xml-value-property.md)</ept><ph id=\"ph1\"> </ph>","pos":[3770,3868],"source":" [XML Value Property](../../../../visual-basic/language-reference/xml-axis/xml-value-property.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Projection Operations (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/projection-operations.md)</ept><ph id=\"ph1\"> </ph>","pos":[3871,3994],"source":" [Projection Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/projection-operations.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Quantifier Operations (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md)</ept>","pos":[3997,4119],"source":" [Quantifier Operations (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/quantifier-operations.md)"}]}