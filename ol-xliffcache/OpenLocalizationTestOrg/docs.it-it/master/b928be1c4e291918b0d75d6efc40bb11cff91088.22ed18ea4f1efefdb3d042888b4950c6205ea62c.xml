{"content":"---\ntitle: \"How to: Access Office Interop Objects by Using Visual C# Features - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"optional parameters [C#], Office programming\"\n  - \"named and optional arguments [C#], Office programming\"\n  - \"dynamic [C#], Office programming\"\n  - \"optional arguments [C#], Office programming\"\n  - \"named arguments [C#], Office programming\"\n  - \"Office programming [C#]\"\nms.assetid: 041b25c2-3512-4e0f-a4ea-ceb2999e4d5e\n---\n# How to: Access Office Interop Objects by Using Visual C# Features (C# Programming Guide)\nVisual C# has features that simplify access to Office API objects. The new features include named and optional arguments, a new type called `dynamic`, and the ability to pass arguments to reference parameters in COM methods as if they were value parameters.  \n  \n In this topic you will use the new features to write code that creates and displays a Microsoft Office Excel worksheet. You will then write code to add an Office Word document that contains an icon that is linked to the Excel worksheet.  \n  \n To complete this walkthrough, you must have Microsoft Office Excel 2007 and Microsoft Office Word 2007, or later versions, installed on your computer.  \n  \n If you are using an operating system that is older than [!INCLUDE[windowsver](~/includes/windowsver-md.md)], make sure that [!INCLUDE[dnprdnlong](~/includes/dnprdnlong-md.md)] is installed.  \n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n## To create a new console application  \n  \n1.  Start Visual Studio.  \n  \n2.  On the **File** menu, point to **New**, and then click **Project**. The **New Project** dialog box appears.  \n  \n3.  In the **Installed Templates** pane, expand **Visual C#**, and then click **Windows**.  \n  \n4.  Look at the top of the **New Project** dialog box to make sure that **.NET Framework 4** (or later version) is selected as a target framework.  \n  \n5.  In the **Templates** pane, click **Console Application**.  \n  \n6.  Type a name for your project in the **Name** field.  \n  \n7.  Click **OK**.  \n  \n     The new project appears in **Solution Explorer**.  \n  \n## To add references  \n  \n1.  In **Solution Explorer**, right-click your project's name and then click **Add Reference**. The **Add Reference** dialog box appears.  \n  \n2.  On the **Assemblies**  page, select **Microsoft.Office.Interop.Word** in the **Component Name** list, and then hold down the CTRL key and select **Microsoft.Office.Interop.Excel**.  If you do not see the assemblies, you may need to ensure they are installed and displayed (see [How to: Install Office Primary Interop Assemblies](/visualstudio/vsto/how-to-install-office-primary-interop-assemblies))  \n  \n3.  Click **OK**.  \n  \n## To add necessary using directives  \n  \n1.  In **Solution Explorer**, right-click the **Program.cs** file and then click **View Code**.  \n  \n2.  Add the following `using` directives to the top of the code file.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#1)]  \n  \n## To create a list of bank accounts  \n  \n1.  Paste the following class definition into **Program.cs**, under the `Program` class.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#2)]  \n  \n2.  Add the following code to the `Main` method to create a `bankAccounts` list that contains two accounts.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#3)]  \n  \n## To declare a method that exports account information to Excel  \n  \n1.  Add the following method to the `Program` class to set up an Excel worksheet.  \n  \n     Method <xref:Microsoft.Office.Interop.Excel.Workbooks.Add%2A> has an optional parameter for specifying a particular template. Optional parameters, new in [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], enable you to omit the argument for that parameter if you want to use the parameter's default value. Because no argument is sent in the following code, `Add` uses the default template and creates a new workbook. The equivalent statement in earlier versions of C# requires a placeholder argument: `ExcelApp.Workbooks.Add(Type.Missing)`.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#4)]  \n  \n2.  Add the following code at the end of `DisplayInExcel`. The code inserts values into the first two columns of the first row of the worksheet.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#5)]  \n  \n3.  Add the following code at the end of `DisplayInExcel`. The `foreach` loop puts the information from the list of accounts into the first two columns of successive rows of the worksheet.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#7)]  \n  \n4.  Add the following code at the end of `DisplayInExcel` to adjust the column widths to fit the content.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#13](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#13)]  \n  \n     Earlier versions of C# require explicit casting for these operations because `ExcelApp.Columns[1]` returns an `Object`, and `AutoFit` is an Excel <xref:Microsoft.Office.Interop.Excel.Range> method. The following lines show the casting.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#14](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#14)]  \n  \n     [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], and later versions, converts the returned `Object` to `dynamic` automatically if the assembly is referenced by the [/link](../../../csharp/language-reference/compiler-options/link-compiler-option.md) compiler option or, equivalently, if the Excel **Embed Interop Types** property is set to true. True is the default value for this property.  \n  \n## To run the project  \n  \n1.  Add the following line at the end of `Main`.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#8)]  \n  \n2.  Press CTRL+F5.  \n  \n     An Excel worksheet appears that contains the data from the two accounts.  \n  \n## To add a Word document  \n  \n1.  To illustrate additional ways in which [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], and later versions, enhances Office programming, the following code opens a Word application and creates an icon that links to the Excel worksheet.  \n  \n     Paste method `CreateIconInWordDoc`, provided later in this step, into the `Program` class. `CreateIconInWordDoc` uses named and optional arguments to reduce the complexity of the method calls to <xref:Microsoft.Office.Interop.Word.Documents.Add%2A> and <xref:Microsoft.Office.Interop.Word.Selection.PasteSpecial%2A>. These calls incorporate two other new features introduced in [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] that simplify calls to COM methods that have reference parameters. First, you can send arguments to the reference parameters as if they were value parameters. That is, you can send values directly, without creating a variable for each reference parameter. The compiler generates temporary variables to hold the argument values, and discards the variables when you return from the call. Second, you can omit the `ref` keyword in the argument list.  \n  \n     The `Add` method has four reference parameters, all of which are optional. In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], or later versions, you can omit arguments for any or all of the parameters if you want to use their default values. In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] and earlier versions, an argument must be provided for each parameter, and the argument must be a variable because the parameters are reference parameters.  \n  \n     The `PasteSpecial` method inserts the contents of the Clipboard. The method has seven reference parameters, all of which are optional. The following code specifies arguments for two of them: `Link`, to create a link to the source of the Clipboard contents, and `DisplayAsIcon`, to display the link as an icon. In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], you can use named arguments for those two and omit the others. Although these are reference parameters, you do not have to use the `ref` keyword, or to create variables to send in as arguments. You can send the values directly. In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] and earlier versions, you must send a variable argument for each reference parameter.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#9](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#9)]  \n  \n     In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] or earlier versions of the language, the following more complex code is required.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#10](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#10)]  \n  \n2.  Add the following statement at the end of `Main`.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#11](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#11)]  \n  \n3.  Add the following statement at the end of `DisplayInExcel`. The `Copy` method adds the worksheet to the Clipboard.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#12](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#12)]  \n  \n4.  Press CTRL+F5.  \n  \n     A Word document appears that contains an icon. Double-click the icon to bring the worksheet to the foreground.  \n  \n## To set the Embed Interop Types property  \n  \n1.  Additional enhancements are possible when you call a COM type that does not require a primary interop assembly (PIA) at run time. Removing the dependency on PIAs results in version independence and easier deployment. For more information about the advantages of programming without PIAs, see [Walkthrough: Embedding Types from Managed Assemblies](../../../csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-visual-studio.md).  \n  \n     In addition, programming is easier because the types that are required and returned by COM methods can be represented by using the type `dynamic` instead of `Object`. Variables that have type `dynamic` are not evaluated until run time, which eliminates the need for explicit casting. For more information, see [Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md).  \n  \n     In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], embedding type information instead of using PIAs is default behavior. Because of that default, several of the previous examples are simplified because explicit casting is not required. For example, the declaration of `worksheet` in `DisplayInExcel` is written as `Excel._Worksheet workSheet = excelApp.ActiveSheet` rather than `Excel._Worksheet workSheet = (Excel.Worksheet)excelApp.ActiveSheet`. The calls to `AutoFit` in the same method also would require explicit casting without the default, because `ExcelApp.Columns[1]` returns an `Object`, and `AutoFit` is an Excel  method. The following code shows the casting.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#14](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#14)]  \n  \n2.  To change the default and use PIAs instead of embedding type information, expand the **References** node in **Solution Explorer** and then select **Microsoft.Office.Interop.Excel** or **Microsoft.Office.Interop.Word**.  \n  \n3.  If you cannot see the **Properties** window, press **F4**.  \n  \n4.  Find **Embed Interop Types** in the list of properties, and change its value to **False**. Equivalently, you can compile by using the [/reference](../../../csharp/language-reference/compiler-options/reference-compiler-option.md) compiler option instead of [/link](../../../csharp/language-reference/compiler-options/link-compiler-option.md) at a command prompt.  \n  \n## To add additional formatting to the table  \n  \n1.  Replace the two calls to `AutoFit` in `DisplayInExcel` with the following statement.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#15](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#15)]  \n  \n     The <xref:Microsoft.Office.Interop.Excel.Range.AutoFormat%2A> method has seven value parameters, all of which are optional. Named and optional arguments enable you to provide arguments for none, some, or all of them. In the previous statement, an argument is supplied for only one of the parameters, `Format`. Because `Format` is the first parameter in the parameter list, you do not have to provide the parameter name. However, the statement might be easier to understand if the parameter name is included, as is shown in the following code.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#16](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#16)]  \n  \n2.  Press CTRL+F5 to see the result. Other formats are listed in the <xref:Microsoft.Office.Interop.Excel.XlRangeAutoFormat> enumeration.  \n  \n3.  Compare the statement in step 1 with the following code, which shows the arguments that are required in [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] or earlier versions.  \n  \n     [!code-csharp[csProgGuideOfficeHowTo#17](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/program.cs#17)]  \n  \n## Example  \n The following code shows the complete example.  \n  \n [!code-csharp[csProgGuideOfficeHowTo#18](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csprogguideofficehowto/cs/walkthrough.cs#18)]  \n  \n## See also\n\n- <xref:System.Type.Missing?displayProperty=nameWithType>\n- [dynamic](../../../csharp/language-reference/keywords/dynamic.md)\n- [Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)\n- [Named and Optional Arguments](../../../csharp/programming-guide/classes-and-structs/named-and-optional-arguments.md)\n- [How to: Use Named and Optional Arguments in Office Programming](../../../csharp/programming-guide/classes-and-structs/how-to-use-named-and-optional-arguments-in-office-programming.md)\n","nodes":[{"pos":[4,489],"embed":true,"restype":"x-metadata","content":"title: \"How to: Access Office Interop Objects by Using Visual C# Features - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"optional parameters [C#], Office programming\"\n  - \"named and optional arguments [C#], Office programming\"\n  - \"dynamic [C#], Office programming\"\n  - \"optional arguments [C#], Office programming\"\n  - \"named arguments [C#], Office programming\"\n  - \"Office programming [C#]\"\nms.assetid: 041b25c2-3512-4e0f-a4ea-ceb2999e4d5e","nodes":[{"content":"How to: Access Office Interop Objects by Using Visual C# Features - C# Programming Guide","nodes":[{"pos":[0,88],"content":"How to: Access Office Interop Objects by Using Visual C# Features - C# Programming Guide","nodes":[{"content":"How to: Access Office Interop Objects by Using Visual C# Features - C# Programming Guide","pos":[0,88]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[496,584],"content":"How to: Access Office Interop Objects by Using Visual C# Features (C# Programming Guide)","linkify":"How to: Access Office Interop Objects by Using Visual C# Features (C# Programming Guide)","nodes":[{"content":"How to: Access Office Interop Objects by Using Visual C# Features (C# Programming Guide)","pos":[0,88]}]},{"content":"Visual C# has features that simplify access to Office API objects.","pos":[585,651]},{"content":"The new features include named and optional arguments, a new type called <ph id=\"ph1\">`dynamic`</ph>, and the ability to pass arguments to reference parameters in COM methods as if they were value parameters.","pos":[652,842],"source":" The new features include named and optional arguments, a new type called `dynamic`, and the ability to pass arguments to reference parameters in COM methods as if they were value parameters."},{"content":"In this topic you will use the new features to write code that creates and displays a Microsoft Office Excel worksheet.","pos":[849,968]},{"content":"You will then write code to add an Office Word document that contains an icon that is linked to the Excel worksheet.","pos":[969,1085]},{"content":"To complete this walkthrough, you must have Microsoft Office Excel 2007 and Microsoft Office Word 2007, or later versions, installed on your computer.","pos":[1092,1242]},{"pos":[1249,1438],"content":"If you are using an operating system that is older than <ph id=\"ph1\">[!INCLUDE[windowsver](~/includes/windowsver-md.md)]</ph>, make sure that <ph id=\"ph2\">[!INCLUDE[dnprdnlong](~/includes/dnprdnlong-md.md)]</ph> is installed.","source":"If you are using an operating system that is older than [!INCLUDE[windowsver](~/includes/windowsver-md.md)], make sure that [!INCLUDE[dnprdnlong](~/includes/dnprdnlong-md.md)] is installed."},{"pos":[1526,1561],"content":"To create a new console application","linkify":"To create a new console application","nodes":[{"content":"To create a new console application","pos":[0,35]}]},{"content":"Start Visual Studio.","pos":[1571,1591]},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[1601,1668],"source":"On the **File** menu, point to **New**, and then click **Project**."},{"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box appears.","pos":[1669,1708],"source":" The **New Project** dialog box appears."},{"pos":[1718,1804],"content":"In the <bpt id=\"p1\">**</bpt>Installed Templates<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Visual C#<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept>.","source":"In the **Installed Templates** pane, expand **Visual C#**, and then click **Windows**."},{"pos":[1814,1956],"content":"Look at the top of the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box to make sure that <bpt id=\"p2\">**</bpt>.NET Framework 4<ept id=\"p2\">**</ept> (or later version) is selected as a target framework.","source":"Look at the top of the **New Project** dialog box to make sure that **.NET Framework 4** (or later version) is selected as a target framework."},{"pos":[1966,2023],"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Console Application<ept id=\"p2\">**</ept>.","source":"In the **Templates** pane, click **Console Application**."},{"pos":[2033,2084],"content":"Type a name for your project in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> field.","source":"Type a name for your project in the **Name** field."},{"pos":[2094,2107],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"pos":[2118,2167],"content":"The new project appears in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","source":"The new project appears in **Solution Explorer**."},{"pos":[2176,2193],"content":"To add references","linkify":"To add references","nodes":[{"content":"To add references","pos":[0,17]}]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click your project's name and then click <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept>.","pos":[2203,2294],"source":"In **Solution Explorer**, right-click your project's name and then click **Add Reference**."},{"content":"The <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box appears.","pos":[2295,2336],"source":" The **Add Reference** dialog box appears."},{"content":"On the <bpt id=\"p1\">**</bpt>Assemblies<ept id=\"p1\">**</ept>  page, select <bpt id=\"p2\">**</bpt>Microsoft.Office.Interop.Word<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Component Name<ept id=\"p3\">**</ept> list, and then hold down the CTRL key and select <bpt id=\"p4\">**</bpt>Microsoft.Office.Interop.Excel<ept id=\"p4\">**</ept>.","pos":[2346,2526],"source":"On the **Assemblies**  page, select **Microsoft.Office.Interop.Word** in the **Component Name** list, and then hold down the CTRL key and select **Microsoft.Office.Interop.Excel**."},{"content":"If you do not see the assemblies, you may need to ensure they are installed and displayed (see <bpt id=\"p1\">[</bpt>How to: Install Office Primary Interop Assemblies<ept id=\"p1\">](/visualstudio/vsto/how-to-install-office-primary-interop-assemblies)</ept>)","pos":[2528,2744],"source":"  If you do not see the assemblies, you may need to ensure they are installed and displayed (see [How to: Install Office Primary Interop Assemblies](/visualstudio/vsto/how-to-install-office-primary-interop-assemblies))"},{"pos":[2754,2767],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"pos":[2776,2809],"content":"To add necessary using directives","linkify":"To add necessary using directives","nodes":[{"content":"To add necessary using directives","pos":[0,33]}]},{"pos":[2819,2910],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>Program.cs<ept id=\"p2\">**</ept> file and then click <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click the **Program.cs** file and then click **View Code**."},{"pos":[2920,2985],"content":"Add the following <ph id=\"ph1\">`using`</ph> directives to the top of the code file.","source":"Add the following `using` directives to the top of the code file."},{"pos":[3132,3165],"content":"To create a list of bank accounts","linkify":"To create a list of bank accounts","nodes":[{"content":"To create a list of bank accounts","pos":[0,33]}]},{"pos":[3175,3259],"content":"Paste the following class definition into <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept>, under the <ph id=\"ph1\">`Program`</ph> class.","source":"Paste the following class definition into **Program.cs**, under the `Program` class."},{"pos":[3407,3510],"content":"Add the following code to the <ph id=\"ph1\">`Main`</ph> method to create a <ph id=\"ph2\">`bankAccounts`</ph> list that contains two accounts.","source":"Add the following code to the `Main` method to create a `bankAccounts` list that contains two accounts."},{"pos":[3657,3718],"content":"To declare a method that exports account information to Excel","linkify":"To declare a method that exports account information to Excel","nodes":[{"content":"To declare a method that exports account information to Excel","pos":[0,61]}]},{"pos":[3728,3805],"content":"Add the following method to the <ph id=\"ph1\">`Program`</ph> class to set up an Excel worksheet.","source":"Add the following method to the `Program` class to set up an Excel worksheet."},{"content":"Method <ph id=\"ph1\">&lt;xref:Microsoft.Office.Interop.Excel.Workbooks.Add%2A&gt;</ph> has an optional parameter for specifying a particular template.","pos":[3816,3941],"source":"Method <xref:Microsoft.Office.Interop.Excel.Workbooks.Add%2A> has an optional parameter for specifying a particular template."},{"content":"Optional parameters, new in <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, enable you to omit the argument for that parameter if you want to use the parameter's default value.","pos":[3942,4137],"source":" Optional parameters, new in [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], enable you to omit the argument for that parameter if you want to use the parameter's default value."},{"content":"Because no argument is sent in the following code, <ph id=\"ph1\">`Add`</ph> uses the default template and creates a new workbook.","pos":[4138,4248],"source":" Because no argument is sent in the following code, `Add` uses the default template and creates a new workbook."},{"content":"The equivalent statement in earlier versions of C# requires a placeholder argument: <ph id=\"ph1\">`ExcelApp.Workbooks.Add(Type.Missing)`</ph>.","pos":[4249,4372],"source":" The equivalent statement in earlier versions of C# requires a placeholder argument: `ExcelApp.Workbooks.Add(Type.Missing)`."},{"content":"Add the following code at the end of <ph id=\"ph1\">`DisplayInExcel`</ph>.","pos":[4520,4574],"source":"Add the following code at the end of `DisplayInExcel`."},{"content":"The code inserts values into the first two columns of the first row of the worksheet.","pos":[4575,4660]},{"content":"Add the following code at the end of <ph id=\"ph1\">`DisplayInExcel`</ph>.","pos":[4808,4862],"source":"Add the following code at the end of `DisplayInExcel`."},{"content":"The <ph id=\"ph1\">`foreach`</ph> loop puts the information from the list of accounts into the first two columns of successive rows of the worksheet.","pos":[4863,4992],"source":" The `foreach` loop puts the information from the list of accounts into the first two columns of successive rows of the worksheet."},{"pos":[5140,5241],"content":"Add the following code at the end of <ph id=\"ph1\">`DisplayInExcel`</ph> to adjust the column widths to fit the content.","source":"Add the following code at the end of `DisplayInExcel` to adjust the column widths to fit the content."},{"content":"Earlier versions of C# require explicit casting for these operations because <ph id=\"ph1\">`ExcelApp.Columns[1]`</ph> returns an <ph id=\"ph2\">`Object`</ph>, and <ph id=\"ph3\">`AutoFit`</ph> is an Excel <ph id=\"ph4\">&lt;xref:Microsoft.Office.Interop.Excel.Range&gt;</ph> method.","pos":[5392,5589],"source":"Earlier versions of C# require explicit casting for these operations because `ExcelApp.Columns[1]` returns an `Object`, and `AutoFit` is an Excel <xref:Microsoft.Office.Interop.Excel.Range> method."},{"content":"The following lines show the casting.","pos":[5590,5627]},{"content":"<ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, and later versions, converts the returned <ph id=\"ph2\">`Object`</ph> to <ph id=\"ph3\">`dynamic`</ph> automatically if the assembly is referenced by the <bpt id=\"p1\">[</bpt>/link<ept id=\"p1\">](../../../csharp/language-reference/compiler-options/link-compiler-option.md)</ept> compiler option or, equivalently, if the Excel <bpt id=\"p2\">**</bpt>Embed Interop Types<ept id=\"p2\">**</ept> property is set to true.","pos":[5778,6140],"source":"[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], and later versions, converts the returned `Object` to `dynamic` automatically if the assembly is referenced by the [/link](../../../csharp/language-reference/compiler-options/link-compiler-option.md) compiler option or, equivalently, if the Excel **Embed Interop Types** property is set to true."},{"content":"True is the default value for this property.","pos":[6141,6185]},{"pos":[6194,6212],"content":"To run the project","linkify":"To run the project","nodes":[{"content":"To run the project","pos":[0,18]}]},{"pos":[6222,6266],"content":"Add the following line at the end of <ph id=\"ph1\">`Main`</ph>.","source":"Add the following line at the end of `Main`."},{"content":"Press CTRL+F5.","pos":[6414,6428]},{"content":"An Excel worksheet appears that contains the data from the two accounts.","pos":[6439,6511]},{"pos":[6520,6542],"content":"To add a Word document","linkify":"To add a Word document","nodes":[{"content":"To add a Word document","pos":[0,22]}]},{"pos":[6552,6805],"content":"To illustrate additional ways in which <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, and later versions, enhances Office programming, the following code opens a Word application and creates an icon that links to the Excel worksheet.","source":"To illustrate additional ways in which [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], and later versions, enhances Office programming, the following code opens a Word application and creates an icon that links to the Excel worksheet."},{"content":"Paste method <ph id=\"ph1\">`CreateIconInWordDoc`</ph>, provided later in this step, into the <ph id=\"ph2\">`Program`</ph> class.","pos":[6816,6906],"source":"Paste method `CreateIconInWordDoc`, provided later in this step, into the `Program` class."},{"content":"<ph id=\"ph1\">`CreateIconInWordDoc`</ph> uses named and optional arguments to reduce the complexity of the method calls to <ph id=\"ph2\">&lt;xref:Microsoft.Office.Interop.Word.Documents.Add%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:Microsoft.Office.Interop.Word.Selection.PasteSpecial%2A&gt;</ph>.","pos":[6907,7132],"source":"`CreateIconInWordDoc` uses named and optional arguments to reduce the complexity of the method calls to <xref:Microsoft.Office.Interop.Word.Documents.Add%2A> and <xref:Microsoft.Office.Interop.Word.Selection.PasteSpecial%2A>."},{"content":"These calls incorporate two other new features introduced in <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph> that simplify calls to COM methods that have reference parameters.","pos":[7133,7326],"source":" These calls incorporate two other new features introduced in [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] that simplify calls to COM methods that have reference parameters."},{"content":"First, you can send arguments to the reference parameters as if they were value parameters.","pos":[7327,7418]},{"content":"That is, you can send values directly, without creating a variable for each reference parameter.","pos":[7419,7515]},{"content":"The compiler generates temporary variables to hold the argument values, and discards the variables when you return from the call.","pos":[7516,7645]},{"content":"Second, you can omit the <ph id=\"ph1\">`ref`</ph> keyword in the argument list.","pos":[7646,7706],"source":" Second, you can omit the `ref` keyword in the argument list."},{"content":"The <ph id=\"ph1\">`Add`</ph> method has four reference parameters, all of which are optional.","pos":[7717,7791],"source":"The `Add` method has four reference parameters, all of which are optional."},{"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, or later versions, you can omit arguments for any or all of the parameters if you want to use their default values.","pos":[7792,7977],"source":" In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], or later versions, you can omit arguments for any or all of the parameters if you want to use their default values."},{"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)]</ph> and earlier versions, an argument must be provided for each parameter, and the argument must be a variable because the parameters are reference parameters.","pos":[7978,8202],"source":" In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] and earlier versions, an argument must be provided for each parameter, and the argument must be a variable because the parameters are reference parameters."},{"content":"The <ph id=\"ph1\">`PasteSpecial`</ph> method inserts the contents of the Clipboard.","pos":[8213,8277],"source":"The `PasteSpecial` method inserts the contents of the Clipboard."},{"content":"The method has seven reference parameters, all of which are optional.","pos":[8278,8347]},{"content":"The following code specifies arguments for two of them: <ph id=\"ph1\">`Link`</ph>, to create a link to the source of the Clipboard contents, and <ph id=\"ph2\">`DisplayAsIcon`</ph>, to display the link as an icon.","pos":[8348,8522],"source":" The following code specifies arguments for two of them: `Link`, to create a link to the source of the Clipboard contents, and `DisplayAsIcon`, to display the link as an icon."},{"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, you can use named arguments for those two and omit the others.","pos":[8523,8655],"source":" In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], you can use named arguments for those two and omit the others."},{"content":"Although these are reference parameters, you do not have to use the <ph id=\"ph1\">`ref`</ph> keyword, or to create variables to send in as arguments.","pos":[8656,8786],"source":" Although these are reference parameters, you do not have to use the `ref` keyword, or to create variables to send in as arguments."},{"content":"You can send the values directly.","pos":[8787,8820]},{"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)]</ph> and earlier versions, you must send a variable argument for each reference parameter.","pos":[8821,8975],"source":" In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] and earlier versions, you must send a variable argument for each reference parameter."},{"pos":[9124,9274],"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)]</ph> or earlier versions of the language, the following more complex code is required.","source":"In [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] or earlier versions of the language, the following more complex code is required."},{"pos":[9424,9473],"content":"Add the following statement at the end of <ph id=\"ph1\">`Main`</ph>.","source":"Add the following statement at the end of `Main`."},{"content":"Add the following statement at the end of <ph id=\"ph1\">`DisplayInExcel`</ph>.","pos":[9623,9682],"source":"Add the following statement at the end of `DisplayInExcel`."},{"content":"The <ph id=\"ph1\">`Copy`</ph> method adds the worksheet to the Clipboard.","pos":[9683,9737],"source":" The `Copy` method adds the worksheet to the Clipboard."},{"content":"Press CTRL+F5.","pos":[9887,9901]},{"content":"A Word document appears that contains an icon.","pos":[9912,9958]},{"content":"Double-click the icon to bring the worksheet to the foreground.","pos":[9959,10022]},{"pos":[10031,10070],"content":"To set the Embed Interop Types property","linkify":"To set the Embed Interop Types property","nodes":[{"content":"To set the Embed Interop Types property","pos":[0,39]}]},{"content":"Additional enhancements are possible when you call a COM type that does not require a primary interop assembly (PIA) at run time.","pos":[10080,10209]},{"content":"Removing the dependency on PIAs results in version independence and easier deployment.","pos":[10210,10296]},{"content":"For more information about the advantages of programming without PIAs, see <bpt id=\"p1\">[</bpt>Walkthrough: Embedding Types from Managed Assemblies<ept id=\"p1\">](../../../csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-visual-studio.md)</ept>.","pos":[10297,10558],"source":" For more information about the advantages of programming without PIAs, see [Walkthrough: Embedding Types from Managed Assemblies](../../../csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-visual-studio.md)."},{"content":"In addition, programming is easier because the types that are required and returned by COM methods can be represented by using the type <ph id=\"ph1\">`dynamic`</ph> instead of <ph id=\"ph2\">`Object`</ph>.","pos":[10569,10735],"source":"In addition, programming is easier because the types that are required and returned by COM methods can be represented by using the type `dynamic` instead of `Object`."},{"content":"Variables that have type <ph id=\"ph1\">`dynamic`</ph> are not evaluated until run time, which eliminates the need for explicit casting.","pos":[10736,10852],"source":" Variables that have type `dynamic` are not evaluated until run time, which eliminates the need for explicit casting."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Using Type dynamic<ept id=\"p1\">](../../../csharp/programming-guide/types/using-type-dynamic.md)</ept>.","pos":[10853,10963],"source":" For more information, see [Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)."},{"content":"In <ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph>, embedding type information instead of using PIAs is default behavior.","pos":[10974,11113],"source":"In [!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)], embedding type information instead of using PIAs is default behavior."},{"content":"Because of that default, several of the previous examples are simplified because explicit casting is not required.","pos":[11114,11228]},{"content":"For example, the declaration of <ph id=\"ph1\">`worksheet`</ph> in <ph id=\"ph2\">`DisplayInExcel`</ph> is written as <ph id=\"ph3\">`Excel._Worksheet workSheet = excelApp.ActiveSheet`</ph> rather than <ph id=\"ph4\">`Excel._Worksheet workSheet = (Excel.Worksheet)excelApp.ActiveSheet`</ph>.","pos":[11229,11440],"source":" For example, the declaration of `worksheet` in `DisplayInExcel` is written as `Excel._Worksheet workSheet = excelApp.ActiveSheet` rather than `Excel._Worksheet workSheet = (Excel.Worksheet)excelApp.ActiveSheet`."},{"content":"The calls to <ph id=\"ph1\">`AutoFit`</ph> in the same method also would require explicit casting without the default, because <ph id=\"ph2\">`ExcelApp.Columns[1]`</ph> returns an <ph id=\"ph3\">`Object`</ph>, and <ph id=\"ph4\">`AutoFit`</ph> is an Excel  method.","pos":[11441,11625],"source":" The calls to `AutoFit` in the same method also would require explicit casting without the default, because `ExcelApp.Columns[1]` returns an `Object`, and `AutoFit` is an Excel  method."},{"content":"The following code shows the casting.","pos":[11626,11663]},{"pos":[11813,12031],"content":"To change the default and use PIAs instead of embedding type information, expand the <bpt id=\"p1\">**</bpt>References<ept id=\"p1\">**</ept> node in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and then select <bpt id=\"p3\">**</bpt>Microsoft.Office.Interop.Excel<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>Microsoft.Office.Interop.Word<ept id=\"p4\">**</ept>.","source":"To change the default and use PIAs instead of embedding type information, expand the **References** node in **Solution Explorer** and then select **Microsoft.Office.Interop.Excel** or **Microsoft.Office.Interop.Word**."},{"pos":[12041,12099],"content":"If you cannot see the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, press <bpt id=\"p2\">**</bpt>F4<ept id=\"p2\">**</ept>.","source":"If you cannot see the **Properties** window, press **F4**."},{"content":"Find <bpt id=\"p1\">**</bpt>Embed Interop Types<ept id=\"p1\">**</ept> in the list of properties, and change its value to <bpt id=\"p2\">**</bpt>False<ept id=\"p2\">**</ept>.","pos":[12109,12199],"source":"Find **Embed Interop Types** in the list of properties, and change its value to **False**."},{"content":"Equivalently, you can compile by using the <bpt id=\"p1\">[</bpt>/reference<ept id=\"p1\">](../../../csharp/language-reference/compiler-options/reference-compiler-option.md)</ept> compiler option instead of <bpt id=\"p2\">[</bpt>/link<ept id=\"p2\">](../../../csharp/language-reference/compiler-options/link-compiler-option.md)</ept> at a command prompt.","pos":[12200,12470],"source":" Equivalently, you can compile by using the [/reference](../../../csharp/language-reference/compiler-options/reference-compiler-option.md) compiler option instead of [/link](../../../csharp/language-reference/compiler-options/link-compiler-option.md) at a command prompt."},{"pos":[12479,12520],"content":"To add additional formatting to the table","linkify":"To add additional formatting to the table","nodes":[{"content":"To add additional formatting to the table","pos":[0,41]}]},{"pos":[12530,12614],"content":"Replace the two calls to <ph id=\"ph1\">`AutoFit`</ph> in <ph id=\"ph2\">`DisplayInExcel`</ph> with the following statement.","source":"Replace the two calls to `AutoFit` in `DisplayInExcel` with the following statement."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.Office.Interop.Excel.Range.AutoFormat%2A&gt;</ph> method has seven value parameters, all of which are optional.","pos":[12765,12888],"source":"The <xref:Microsoft.Office.Interop.Excel.Range.AutoFormat%2A> method has seven value parameters, all of which are optional."},{"content":"Named and optional arguments enable you to provide arguments for none, some, or all of them.","pos":[12889,12981]},{"content":"In the previous statement, an argument is supplied for only one of the parameters, <ph id=\"ph1\">`Format`</ph>.","pos":[12982,13074],"source":" In the previous statement, an argument is supplied for only one of the parameters, `Format`."},{"content":"Because <ph id=\"ph1\">`Format`</ph> is the first parameter in the parameter list, you do not have to provide the parameter name.","pos":[13075,13184],"source":" Because `Format` is the first parameter in the parameter list, you do not have to provide the parameter name."},{"content":"However, the statement might be easier to understand if the parameter name is included, as is shown in the following code.","pos":[13185,13307]},{"content":"Press CTRL+F5 to see the result.","pos":[13457,13489]},{"content":"Other formats are listed in the <ph id=\"ph1\">&lt;xref:Microsoft.Office.Interop.Excel.XlRangeAutoFormat&gt;</ph> enumeration.","pos":[13490,13590],"source":" Other formats are listed in the <xref:Microsoft.Office.Interop.Excel.XlRangeAutoFormat> enumeration."},{"pos":[13600,13790],"content":"Compare the statement in step 1 with the following code, which shows the arguments that are required in <ph id=\"ph1\">[!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)]</ph> or earlier versions.","source":"Compare the statement in step 1 with the following code, which shows the arguments that are required in [!INCLUDE[csharp_orcas_long](~/includes/csharp-orcas-long-md.md)] or earlier versions."},{"pos":[13939,13946],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code shows the complete example.","pos":[13950,13996]},{"pos":[14145,14153],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14215,14280],"content":"<bpt id=\"p1\">[</bpt>dynamic<ept id=\"p1\">](../../../csharp/language-reference/keywords/dynamic.md)</ept>","source":"[dynamic](../../../csharp/language-reference/keywords/dynamic.md)"},{"pos":[14283,14366],"content":"<bpt id=\"p1\">[</bpt>Using Type dynamic<ept id=\"p1\">](../../../csharp/programming-guide/types/using-type-dynamic.md)</ept>","source":"[Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)"},{"pos":[14369,14486],"content":"<bpt id=\"p1\">[</bpt>Named and Optional Arguments<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/named-and-optional-arguments.md)</ept>","source":"[Named and Optional Arguments](../../../csharp/programming-guide/classes-and-structs/named-and-optional-arguments.md)"},{"pos":[14489,14673],"content":"<bpt id=\"p1\">[</bpt>How to: Use Named and Optional Arguments in Office Programming<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/how-to-use-named-and-optional-arguments-in-office-programming.md)</ept>","source":"[How to: Use Named and Optional Arguments in Office Programming](../../../csharp/programming-guide/classes-and-structs/how-to-use-named-and-optional-arguments-in-office-programming.md)"}]}