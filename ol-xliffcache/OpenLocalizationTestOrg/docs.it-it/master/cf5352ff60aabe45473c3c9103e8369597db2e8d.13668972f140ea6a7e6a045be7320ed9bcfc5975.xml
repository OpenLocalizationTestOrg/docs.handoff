{"content":"---\ntitle: \"How to: Bind to a Web Service Using the Windows Forms BindingSource\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"Web services [Windows Forms], binding controls\"\n  - \"BindingSource component [Windows Forms], binding to a Web service\"\n  - \"examples [Windows Forms], BindingSource component\"\n  - \"controls [Windows Forms], binding to Web service\"\n  - \"BindingSource component [Windows Forms], examples\"\nms.assetid: ee261207-4573-4cb9-a8cb-5185037e0fba\n---\n# How to: Bind to a Web Service Using the Windows Forms BindingSource\nIf you want to bind a Windows Form control to the results obtained from calling an XML Web service, you can use a <xref:System.Windows.Forms.BindingSource> component. This procedure is similar to binding a <xref:System.Windows.Forms.BindingSource> component to a type. You must create a client-side proxy that contains the methods and types exposed by the Web service. You generate a client-side proxy from the Web service (.asmx) itself, or its Web Services Description Language (WSDL) file. Additionally, your client-side proxy must expose the fields of complex types used by the Web service as public properties. You then bind the <xref:System.Windows.Forms.BindingSource> to one of the types exposed in the Web service proxy.  \n  \n### To create and bind to a client-side proxy  \n  \n1.  Create a Windows Form in the directory of your choice, with an appropriate namespace.  \n  \n2.  Add a <xref:System.Windows.Forms.BindingSource> component to the form.  \n  \n3.  Open the [!INCLUDE[winsdklong](../../../../includes/winsdklong-md.md)] command prompt, and navigate to the same directory that your form is located in.  \n  \n4.  Using the WSDL tool, enter `wsdl` and the URL for the .asmx or WSDL file for the Web service, followed by the namespace of your application, and optionally the language you are working in.  \n  \n     The following code example uses the Web service located at `http://webservices.eraserver.net/zipcoderesolver/zipcoderesolver.asmx`. For example, for C# type `wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService`, or for Visual Basic type `wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService /language:VB`. Passing the path as an argument to the WSDL tool will generate a client-side proxy in the same directory and namespace as your application, in the specified language. If you are using Visual Studio, add the file to your project.  \n  \n5.  Select a type in the client-side proxy to bind to.  \n  \n     This is typically a type returned by a method offered by the Web service. The fields of the chosen type must be exposed as public properties for binding purposes.  \n  \n     [!code-cpp[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#4)]\n     [!code-csharp[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#4)]\n     [!code-vb[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#4)]  \n  \n6.  Set the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property of the <xref:System.Windows.Forms.BindingSource> to the type you want that is contained in the Web service client-side proxy.  \n  \n     [!code-cpp[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#2)]\n     [!code-csharp[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#2)]\n     [!code-vb[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#2)]  \n  \n### To bind controls to the BindingSource that is bound to a Web service  \n  \n-   Bind controls to the <xref:System.Windows.Forms.BindingSource>, passing the public property of the Web service type that you want as a parameter.  \n  \n     [!code-cpp[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#3)]\n     [!code-csharp[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#3)]\n     [!code-vb[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#3)]  \n  \n## Example  \n The following code example demonstrates how to bind a <xref:System.Windows.Forms.BindingSource> component to a Web service, and then how to bind a text box to the <xref:System.Windows.Forms.BindingSource> component. When you click the button, a Web service method is called and the results will appear in `textbox1`.  \n  \n [!code-cpp[System.Windows.Forms.DataConnectorWebService#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#1)]\n [!code-csharp[System.Windows.Forms.DataConnectorWebService#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#1)]\n [!code-vb[System.Windows.Forms.DataConnectorWebService#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#1)]  \n  \n## Compiling the Code  \n This is a complete example that includes a `Main` method, and a shortened version of client-side proxy code.  \n  \n This example requires:  \n  \n-   References to the System, System.Drawing, System.Web.Services, System.Windows.Forms and System.Xml assemblies.  \n  \n For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in Visual Studio by pasting the code into a new project.  \n  \n## See also\n\n- [BindingSource Component](bindingsource-component.md)\n- [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md)\n","nodes":[{"pos":[4,509],"embed":true,"restype":"x-metadata","content":"title: \"How to: Bind to a Web Service Using the Windows Forms BindingSource\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"Web services [Windows Forms], binding controls\"\n  - \"BindingSource component [Windows Forms], binding to a Web service\"\n  - \"examples [Windows Forms], BindingSource component\"\n  - \"controls [Windows Forms], binding to Web service\"\n  - \"BindingSource component [Windows Forms], examples\"\nms.assetid: ee261207-4573-4cb9-a8cb-5185037e0fba","nodes":[{"content":"How to: Bind to a Web Service Using the Windows Forms BindingSource","nodes":[{"pos":[0,67],"content":"How to: Bind to a Web Service Using the Windows Forms BindingSource","nodes":[{"content":"How to: Bind to a Web Service Using the Windows Forms BindingSource","pos":[0,67]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[516,583],"content":"How to: Bind to a Web Service Using the Windows Forms BindingSource","linkify":"How to: Bind to a Web Service Using the Windows Forms BindingSource","nodes":[{"content":"How to: Bind to a Web Service Using the Windows Forms BindingSource","pos":[0,67]}]},{"content":"If you want to bind a Windows Form control to the results obtained from calling an XML Web service, you can use a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component.","pos":[584,750],"source":"If you want to bind a Windows Form control to the results obtained from calling an XML Web service, you can use a <xref:System.Windows.Forms.BindingSource> component."},{"content":"This procedure is similar to binding a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component to a type.","pos":[751,852],"source":" This procedure is similar to binding a <xref:System.Windows.Forms.BindingSource> component to a type."},{"content":"You must create a client-side proxy that contains the methods and types exposed by the Web service.","pos":[853,952]},{"content":"You generate a client-side proxy from the Web service (.asmx) itself, or its Web Services Description Language (WSDL) file.","pos":[953,1076]},{"content":"Additionally, your client-side proxy must expose the fields of complex types used by the Web service as public properties.","pos":[1077,1199]},{"content":"You then bind the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> to one of the types exposed in the Web service proxy.","pos":[1200,1313],"source":" You then bind the <xref:System.Windows.Forms.BindingSource> to one of the types exposed in the Web service proxy."},{"pos":[1323,1364],"content":"To create and bind to a client-side proxy","linkify":"To create and bind to a client-side proxy","nodes":[{"content":"To create and bind to a client-side proxy","pos":[0,41]}]},{"content":"Create a Windows Form in the directory of your choice, with an appropriate namespace.","pos":[1374,1459]},{"pos":[1469,1539],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component to the form.","source":"Add a <xref:System.Windows.Forms.BindingSource> component to the form."},{"pos":[1549,1700],"content":"Open the <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../../includes/winsdklong-md.md)]</ph> command prompt, and navigate to the same directory that your form is located in.","source":"Open the [!INCLUDE[winsdklong](../../../../includes/winsdklong-md.md)] command prompt, and navigate to the same directory that your form is located in."},{"pos":[1710,1898],"content":"Using the WSDL tool, enter <ph id=\"ph1\">`wsdl`</ph> and the URL for the .asmx or WSDL file for the Web service, followed by the namespace of your application, and optionally the language you are working in.","source":"Using the WSDL tool, enter `wsdl` and the URL for the .asmx or WSDL file for the Web service, followed by the namespace of your application, and optionally the language you are working in."},{"content":"The following code example uses the Web service located at <ph id=\"ph1\">`http://webservices.eraserver.net/zipcoderesolver/zipcoderesolver.asmx`</ph>.","pos":[1909,2040],"source":"The following code example uses the Web service located at `http://webservices.eraserver.net/zipcoderesolver/zipcoderesolver.asmx`."},{"content":"For example, for C# type <ph id=\"ph1\">`wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService`</ph>, or for Visual Basic type <ph id=\"ph2\">`wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService /language:VB`</ph>.","pos":[2041,2299],"source":" For example, for C# type `wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService`, or for Visual Basic type `wsdl http://webservices.eraserver.net.zipcoderesolver/zipcoderesolver.asmx /n:BindToWebService /language:VB`."},{"content":"Passing the path as an argument to the WSDL tool will generate a client-side proxy in the same directory and namespace as your application, in the specified language.","pos":[2300,2466]},{"content":"If you are using Visual Studio, add the file to your project.","pos":[2467,2528]},{"content":"Select a type in the client-side proxy to bind to.","pos":[2538,2588]},{"content":"This is typically a type returned by a method offered by the Web service.","pos":[2599,2672]},{"content":"The fields of the chosen type must be exposed as public properties for binding purposes.","pos":[2673,2761]},{"pos":[2772,3288],"content":"[!code-cpp[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#4)]\n [!code-csharp[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#4)]\n [!code-vb[System.Windows.Forms.DataConnectorWebService#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#4)]","leadings":["","    ","    "],"nodes":[]},{"pos":[3298,3496],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource.DataSource%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> to the type you want that is contained in the Web service client-side proxy.","source":"Set the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property of the <xref:System.Windows.Forms.BindingSource> to the type you want that is contained in the Web service client-side proxy."},{"pos":[3507,4023],"content":"[!code-cpp[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#2)]\n [!code-csharp[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#2)]\n [!code-vb[System.Windows.Forms.DataConnectorWebService#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#2)]","leadings":["","    ","    "],"nodes":[]},{"pos":[4033,4101],"content":"To bind controls to the BindingSource that is bound to a Web service","linkify":"To bind controls to the BindingSource that is bound to a Web service","nodes":[{"content":"To bind controls to the BindingSource that is bound to a Web service","pos":[0,68]}]},{"pos":[4111,4256],"content":"Bind controls to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph>, passing the public property of the Web service type that you want as a parameter.","source":"Bind controls to the <xref:System.Windows.Forms.BindingSource>, passing the public property of the Web service type that you want as a parameter."},{"pos":[4267,4783],"content":"[!code-cpp[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CPP/form1.cpp#3)]\n [!code-csharp[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/CS/form1.cs#3)]\n [!code-vb[System.Windows.Forms.DataConnectorWebService#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataConnectorWebService/VB/form1.vb#3)]","leadings":["","    ","    "],"nodes":[]},{"pos":[4792,4799],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to bind a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component to a Web service, and then how to bind a text box to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component.","pos":[4803,5018],"source":"The following code example demonstrates how to bind a <xref:System.Windows.Forms.BindingSource> component to a Web service, and then how to bind a text box to the <xref:System.Windows.Forms.BindingSource> component."},{"content":"When you click the button, a Web service method is called and the results will appear in <ph id=\"ph1\">`textbox1`</ph>.","pos":[5019,5119],"source":" When you click the button, a Web service method is called and the results will appear in `textbox1`."},{"pos":[5643,5661],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[5665,5773],"content":"This is a complete example that includes a <ph id=\"ph1\">`Main`</ph> method, and a shortened version of client-side proxy code.","source":"This is a complete example that includes a `Main` method, and a shortened version of client-side proxy code."},{"content":"This example requires:","pos":[5780,5802]},{"content":"References to the System, System.Drawing, System.Web.Services, System.Windows.Forms and System.Xml assemblies.","pos":[5812,5922]},{"content":"For information about building this example from the command line for Visual Basic or Visual C#, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[5929,6283],"source":"For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in Visual Studio by pasting the code into a new project.","pos":[6284,6372]},{"pos":[6381,6389],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6393,6446],"content":"<bpt id=\"p1\">[</bpt>BindingSource Component<ept id=\"p1\">](bindingsource-component.md)</ept>","source":"[BindingSource Component](bindingsource-component.md)"},{"pos":[6449,6547],"content":"<bpt id=\"p1\">[</bpt>How to: Bind a Windows Forms Control to a Type<ept id=\"p1\">](how-to-bind-a-windows-forms-control-to-a-type.md)</ept>","source":"[How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md)"}]}