{"content":"---\ntitle: \"Compiler Error CS1666\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"CS1666\"\nhelpviewer_keywords: \n  - \"CS1666\"\nms.assetid: 4d62aa9c-71b9-4c6e-8141-2426d20ac243\n---\n# Compiler Error CS1666\nYou cannot use fixed size buffers contained in unfixed expressions. Try using the fixed statement.  \n  \n This error occurs if you use the fixed sized buffer in an expression involving a class that is not itself fixed. The runtime is free to move the unfixed class around to optimize memory access, which could lead to errors when using the fixed sized buffer. To avoid this error, use the `fixed` keyword on the statement.  \n  \n## Example  \n The following sample generates CS1666.  \n  \n```csharp  \n// CS1666.cs  \n// compile with: /unsafe /target:library  \nunsafe struct S  \n{  \n   public fixed int buffer[1];  \n}  \n  \nunsafe class Test  \n{  \n   S field = new S();  \n  \n   private bool example1()  \n   {  \n      return (field.buffer[0] == 0);   // CS1666 error  \n   }  \n  \n   private bool example2()  \n   {  \n      // OK  \n      fixed (S* p = &field)  \n      {  \n         return (p->buffer[0] == 0);  \n      }  \n   }  \n  \n   private bool example3()  \n   {  \n      S local = new S();  \n      return (local.buffer[0] == 0);   \n   }   \n}  \n```\n","nodes":[{"pos":[4,165],"embed":true,"restype":"x-metadata","content":"title: \"Compiler Error CS1666\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"CS1666\"\nhelpviewer_keywords: \n  - \"CS1666\"\nms.assetid: 4d62aa9c-71b9-4c6e-8141-2426d20ac243","nodes":[{"content":"Compiler Error CS1666","nodes":[{"pos":[0,21],"content":"Compiler Error CS1666","nodes":[{"content":"Compiler Error CS1666","pos":[0,21]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[172,193],"content":"Compiler Error CS1666","linkify":"Compiler Error CS1666","nodes":[{"content":"Compiler Error CS1666","pos":[0,21]}]},{"content":"You cannot use fixed size buffers contained in unfixed expressions.","pos":[194,261]},{"content":"Try using the fixed statement.","pos":[262,292]},{"content":"This error occurs if you use the fixed sized buffer in an expression involving a class that is not itself fixed.","pos":[299,411]},{"content":"The runtime is free to move the unfixed class around to optimize memory access, which could lead to errors when using the fixed sized buffer.","pos":[412,553]},{"content":"To avoid this error, use the <ph id=\"ph1\">`fixed`</ph> keyword on the statement.","pos":[554,616],"source":" To avoid this error, use the `fixed` keyword on the statement."},{"pos":[625,632],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following sample generates CS1666.","pos":[636,674]}]}