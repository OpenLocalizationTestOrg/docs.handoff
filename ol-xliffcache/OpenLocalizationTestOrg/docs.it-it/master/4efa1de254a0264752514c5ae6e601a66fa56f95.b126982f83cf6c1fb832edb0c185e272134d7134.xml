{"content":"---\ntitle: \"How to: Write Queries on XML in Namespaces (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 7d4131b5-3288-414f-b77c-b2edc2a1f465\n---\n# How to: Write Queries on XML in Namespaces (Visual Basic)\nTo write a query on XML that is in a namespace, you must use <xref:System.Xml.Linq.XName> objects that have the correct namespace.  \n  \n In Visual Basic, the most common approach is to define a global namespace, and then use XML literals and XML properties that use the global namespace. You can define a global default namespace, in which case elements in the XML literals will be in the namespace by default. Alternatively, you can define a global namespace with a prefix, and then use the prefix as required in the XML literals, and in XML properties. As with other forms of XML, attributes are always in no namespace by default.  \n  \n The first set of examples in this topic shows how to create an XML tree in a default namespace. The second set shows how to create an XML tree in a namespace with a prefix.  \n  \n## Example  \n The following example creates an XML tree that is in a default namespace. It then retrieves a collection of elements.  \n  \n```vb  \nImports <xmlns=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <Root>  \n                <Child>1</Child>  \n                <Child>2</Child>  \n                <Child>3</Child>  \n                <AnotherChild>4</AnotherChild>  \n                <AnotherChild>5</AnotherChild>  \n                <AnotherChild>6</AnotherChild>  \n            </Root>  \n        Dim c1 As IEnumerable(Of XElement) = _  \n            From el In root.<Child> _  \n            Select el  \n        For Each el As XElement In c1  \n            Console.WriteLine(el.Value)  \n        Next  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```  \n1  \n2  \n3  \n```  \n  \n## Example  \n In Visual Basic, however, writing queries on an XML tree that uses a namespace with a prefix is quite different from querying an XML tree in a default namespace. Typically you use the `Imports` statement to import the namespace with a prefix. You then use the prefix in the element and attribute names when you construct the XML tree. You also use the prefix when querying an XML tree using XML properties.  \n  \n The following example creates an XML tree that is in a namespace with a prefix. It then retrieves a collection of elements.  \n  \n```vb  \nImports <xmlns:aw=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <aw:Root>  \n                <aw:Child>1</aw:Child>  \n                <aw:Child>2</aw:Child>  \n                <aw:Child>3</aw:Child>  \n                <aw:AnotherChild>4</aw:AnotherChild>  \n                <aw:AnotherChild>5</aw:AnotherChild>  \n                <aw:AnotherChild>6</aw:AnotherChild>  \n            </aw:Root>  \n        Dim c1 As IEnumerable(Of XElement) = _  \n            From el In root.<aw:Child> _  \n            Select el  \n        For Each el As XElement In c1  \n            Console.WriteLine(CInt(el))  \n        Next  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```  \n1  \n2  \n3  \n```  \n  \n## See also\n\n- [Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)\n","nodes":[{"pos":[4,139],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write Queries on XML in Namespaces (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 7d4131b5-3288-414f-b77c-b2edc2a1f465","nodes":[{"content":"How to: Write Queries on XML in Namespaces (Visual Basic)","nodes":[{"pos":[0,57],"content":"How to: Write Queries on XML in Namespaces (Visual Basic)","nodes":[{"content":"How to: Write Queries on XML in Namespaces (Visual Basic)","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[146,203],"content":"How to: Write Queries on XML in Namespaces (Visual Basic)","linkify":"How to: Write Queries on XML in Namespaces (Visual Basic)","nodes":[{"content":"How to: Write Queries on XML in Namespaces (Visual Basic)","pos":[0,57]}]},{"pos":[204,334],"content":"To write a query on XML that is in a namespace, you must use <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XName&gt;</ph> objects that have the correct namespace.","source":"To write a query on XML that is in a namespace, you must use <xref:System.Xml.Linq.XName> objects that have the correct namespace."},{"content":"In Visual Basic, the most common approach is to define a global namespace, and then use XML literals and XML properties that use the global namespace.","pos":[341,491]},{"content":"You can define a global default namespace, in which case elements in the XML literals will be in the namespace by default.","pos":[492,614]},{"content":"Alternatively, you can define a global namespace with a prefix, and then use the prefix as required in the XML literals, and in XML properties.","pos":[615,758]},{"content":"As with other forms of XML, attributes are always in no namespace by default.","pos":[759,836]},{"content":"The first set of examples in this topic shows how to create an XML tree in a default namespace.","pos":[843,938]},{"content":"The second set shows how to create an XML tree in a namespace with a prefix.","pos":[939,1015]},{"pos":[1024,1031],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example creates an XML tree that is in a default namespace.","pos":[1035,1108]},{"content":"It then retrieves a collection of elements.","pos":[1109,1152]},{"content":"This example produces the following output:","pos":[1831,1874]},{"pos":[1910,1917],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In Visual Basic, however, writing queries on an XML tree that uses a namespace with a prefix is quite different from querying an XML tree in a default namespace.","pos":[1921,2082]},{"content":"Typically you use the <ph id=\"ph1\">`Imports`</ph> statement to import the namespace with a prefix.","pos":[2083,2163],"source":" Typically you use the `Imports` statement to import the namespace with a prefix."},{"content":"You then use the prefix in the element and attribute names when you construct the XML tree.","pos":[2164,2255]},{"content":"You also use the prefix when querying an XML tree using XML properties.","pos":[2256,2327]},{"content":"The following example creates an XML tree that is in a namespace with a prefix.","pos":[2334,2413]},{"content":"It then retrieves a collection of elements.","pos":[2414,2457]},{"content":"This example produces the following output:","pos":[3184,3227]},{"pos":[3263,3271],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3275,3408],"content":"<bpt id=\"p1\">[</bpt>Working with XML Namespaces (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)</ept>","source":"[Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)"}]}