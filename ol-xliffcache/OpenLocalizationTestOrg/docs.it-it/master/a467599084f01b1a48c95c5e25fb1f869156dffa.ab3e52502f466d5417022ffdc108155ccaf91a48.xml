{"content":"---\ntitle: \"<useLegacyJit> Element\"\nms.date: \"04/26/2017\"\nms.assetid: c2cf97f0-9262-4f1f-a754-5568b51110ad\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n\n# \\<useLegacyJit> Element\n\nDetermines whether the common language runtime uses the legacy 64-bit JIT compiler for just-in-time compilation.  \n  \n\\<configuration>  \n\\<runtime>  \n\\<useLegacyJit>\n  \n## Syntax  \n  \n```xml\n<useLegacyJit enabled=0|1 />\n```\n\nThe element name `useLegacyJit` is case-sensitive.\n  \n## Attributes and elements\n\nThe following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n| Attribute | Description                                                                                   |  \n| --------- | --------------------------------------------------------------------------------------------- |  \n| `enabled` | Required attribute.<br><br>Specifies whether the runtime uses the legacy 64-bit JIT compiler. |  \n  \n### enabled attribute  \n  \n| Value | Description                                                                                                         |  \n| ----- | ------------------------------------------------------------------------------------------------------------------- |  \n| 0     | The common language runtime uses the new 64-bit JIT compiler included in the .NET Framework 4.6 and later versions. |  \n| 1     | The common language runtime uses the older 64-bit JIT compiler.                                                     |  \n  \n### Child elements\n\nNone\n  \n### Parent elements  \n  \n| Element         | Description                                                                                                       |  \n| --------------- | ----------------------------------------------------------------------------------------------------------------- |  \n| `configuration` | The root element in every configuration file used by the common language runtime and .NET Framework applications. |  \n| `runtime`       | Contains information about runtime initialization options.                                                        |  \n  \n## Remarks  \n\nStarting with the .NET Framework 4.6, the common language runtime uses a new 64-bit compiler for Just-In-Time (JIT) compilation by default. In some cases, this may result in a difference in behavior from application code that was JIT-compiled by the previous version of the 64-bit JIT compiler. By setting the `enabled` attribute of the `<useLegacyJit>` element to `1`, you can disable the new 64-bit JIT compiler and instead compile your app using the legacy 64-bit JIT compiler.  \n  \n> [!NOTE]\n> The `<useLegacyJit>` element affects 64-bit JIT compilation only. Compilation with the 32-bit JIT compiler is unaffected.  \n  \nInstead of using a configuration file setting, you can enable the legacy 64-bit JIT compiler in two other ways:  \n  \n- Setting an environment variable\n\n  Set the `COMPLUS_useLegacyJit` environment variable to either `0` (use the new 64-bit JIT compiler) or `1` (use the older 64-bit JIT compiler):\n  \n  ```  \n  COMPLUS_useLegacyJit=0|1  \n  ```  \n  \n  The environment variable has *global scope*, which means that it affects all applications run on the machine. If set, it can be overridden by the application configuration file setting. The environment variable name is not case-sensitive.\n  \n- Adding a registry key\n\n  You can enable the legacy 64-bit JIT compiler by adding a `REG_DWORD` value to either the `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework` or `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework` key in the registry. The value is named `useLegacyJit`. If the value is 0, the new compiler is used. If the value is 1, the legacy 64-bit JIT compiler is enabled. The registry value name is not case-sensitive.\n  \n  Adding the value to the `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework` key affects all apps running on the machine. Adding the value to the `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework` key affects all apps run by the current user. If a machine is configured with multiple user accounts, only apps run by the current user are affected, unless the value is added to the registry keys for other users as well. Adding the `<useLegacyJit>` element to a configuration file overrides the registry settings, if they're present.  \n  \n## Example  \n\nThe following configuration file disables compilation with the new 64-bit JIT compiler and instead uses the legacy 64-bit JIT compiler.  \n  \n```xml  \n<?xml version =\"1.0\"?>  \n<configuration>  \n  <runtime>  \n    <useLegacyJit enabled=\"1\" />  \n  </runtime>  \n</configuration>  \n```  \n  \n## See also\n\n- [\\<runtime> Element](../../../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)\n- [\\<configuration> Element](../../../../../docs/framework/configure-apps/file-schema/configuration-element.md)\n- [Mitigation: New 64-bit JIT Compiler](../../../../../docs/framework/migration-guide/mitigation-new-64-bit-jit-compiler.md)\n","nodes":[{"pos":[4,146],"embed":true,"restype":"x-metadata","content":"title: \"<useLegacyJit> Element\"\nms.date: \"04/26/2017\"\nms.assetid: c2cf97f0-9262-4f1f-a754-5568b51110ad\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"<useLegacyJit> Element","nodes":[{"pos":[0,22],"content":"<ph id=\"ph1\">&lt;useLegacyJit&gt;</ph> Element","source":"<useLegacyJit> Element"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[154,177],"content":"\\<useLegacyJit> Element","linkify":"\\<useLegacyJit> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>useLegacyJit&gt; Element","pos":[0,23],"source":"\\<useLegacyJit> Element"}]},{"content":"Determines whether the common language runtime uses the legacy 64-bit JIT compiler for just-in-time compilation.","pos":[179,291]},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;","pos":[297,313],"source":"\\<configuration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>runtime&gt;","pos":[316,326],"source":"\\<runtime>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>useLegacyJit&gt;","pos":[329,344],"source":"\\<useLegacyJit>"},{"pos":[351,357],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[404,454],"content":"The element name <ph id=\"ph1\">`useLegacyJit`</ph> is case-sensitive.","source":"The element name `useLegacyJit` is case-sensitive."},{"pos":[461,484],"content":"Attributes and elements","linkify":"Attributes and elements","nodes":[{"content":"Attributes and elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[486,566]},{"pos":[576,586],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[594,603]},{"content":"Description","pos":[606,617]},{"content":"Required attribute.","pos":[830,849]},{"content":"Specifies whether the runtime uses the legacy 64-bit JIT compiler.","pos":[857,923]},{"pos":[935,952],"content":"enabled attribute","linkify":"enabled attribute","nodes":[{"content":"enabled attribute","pos":[0,17]}]},{"content":"Value","pos":[960,965]},{"content":"Description","pos":[968,979]},{"content":"0","pos":[1220,1221]},{"content":"The common language runtime uses the new 64-bit JIT compiler included in the .NET Framework 4.6 and later versions.","pos":[1228,1343]},{"content":"1","pos":[1350,1351]},{"content":"The common language runtime uses the older 64-bit JIT compiler.","pos":[1358,1421]},{"pos":[1485,1499],"content":"Child elements","linkify":"Child elements","nodes":[{"content":"Child elements","pos":[0,14]}]},{"content":"None","pos":[1501,1505]},{"pos":[1513,1528],"content":"Parent elements","linkify":"Parent elements","nodes":[{"content":"Parent elements","pos":[0,15]}]},{"content":"Element","pos":[1536,1543]},{"content":"Description","pos":[1554,1565]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1830,1943]},{"content":"Contains information about runtime initialization options.","pos":[1968,2026]},{"pos":[2092,2099],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Starting with the .NET Framework 4.6, the common language runtime uses a new 64-bit compiler for Just-In-Time (JIT) compilation by default.","pos":[2103,2242]},{"content":"In some cases, this may result in a difference in behavior from application code that was JIT-compiled by the previous version of the 64-bit JIT compiler.","pos":[2243,2397]},{"content":"By setting the <ph id=\"ph1\">`enabled`</ph> attribute of the <ph id=\"ph2\">`&lt;useLegacyJit&gt;`</ph> element to <ph id=\"ph3\">`1`</ph>, you can disable the new 64-bit JIT compiler and instead compile your app using the legacy 64-bit JIT compiler.","pos":[2398,2583],"source":" By setting the `enabled` attribute of the `<useLegacyJit>` element to `1`, you can disable the new 64-bit JIT compiler and instead compile your app using the legacy 64-bit JIT compiler."},{"pos":[2591,2722],"content":"[!NOTE]\nThe `<useLegacyJit>` element affects 64-bit JIT compilation only. Compilation with the 32-bit JIT compiler is unaffected.","leadings":["","> "],"nodes":[{"content":"The `<useLegacyJit>` element affects 64-bit JIT compilation only. Compilation with the 32-bit JIT compiler is unaffected.","pos":[8,129],"nodes":[{"content":"The <ph id=\"ph1\">`&lt;useLegacyJit&gt;`</ph> element affects 64-bit JIT compilation only.","pos":[0,65],"source":"The `<useLegacyJit>` element affects 64-bit JIT compilation only."},{"content":"Compilation with the 32-bit JIT compiler is unaffected.","pos":[66,121]}]}]},{"content":"Instead of using a configuration file setting, you can enable the legacy 64-bit JIT compiler in two other ways:","pos":[2728,2839]},{"content":"Setting an environment variable","pos":[2847,2878]},{"pos":[2882,3025],"content":"Set the <ph id=\"ph1\">`COMPLUS_useLegacyJit`</ph> environment variable to either <ph id=\"ph2\">`0`</ph> (use the new 64-bit JIT compiler) or <ph id=\"ph3\">`1`</ph> (use the older 64-bit JIT compiler):","source":"Set the `COMPLUS_useLegacyJit` environment variable to either `0` (use the new 64-bit JIT compiler) or `1` (use the older 64-bit JIT compiler):"},{"content":"The environment variable has <bpt id=\"p1\">*</bpt>global scope<ept id=\"p1\">*</ept>, which means that it affects all applications run on the machine.","pos":[3079,3188],"source":"The environment variable has *global scope*, which means that it affects all applications run on the machine."},{"content":"If set, it can be overridden by the application configuration file setting.","pos":[3189,3264]},{"content":"The environment variable name is not case-sensitive.","pos":[3265,3317]},{"content":"Adding a registry key","pos":[3323,3344]},{"content":"You can enable the legacy 64-bit JIT compiler by adding a <ph id=\"ph1\">`REG_DWORD`</ph> value to either the <ph id=\"ph2\">`HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework`</ph> or <ph id=\"ph3\">`HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework`</ph> key in the registry.","pos":[3348,3568],"source":"You can enable the legacy 64-bit JIT compiler by adding a `REG_DWORD` value to either the `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework` or `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework` key in the registry."},{"content":"The value is named <ph id=\"ph1\">`useLegacyJit`</ph>.","pos":[3569,3603],"source":" The value is named `useLegacyJit`."},{"content":"If the value is 0, the new compiler is used.","pos":[3604,3648]},{"content":"If the value is 1, the legacy 64-bit JIT compiler is enabled.","pos":[3649,3710]},{"content":"The registry value name is not case-sensitive.","pos":[3711,3757]},{"content":"Adding the value to the <ph id=\"ph1\">`HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework`</ph> key affects all apps running on the machine.","pos":[3763,3885],"source":"Adding the value to the `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework` key affects all apps running on the machine."},{"content":"Adding the value to the <ph id=\"ph1\">`HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework`</ph> key affects all apps run by the current user.","pos":[3886,4008],"source":" Adding the value to the `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\.NETFramework` key affects all apps run by the current user."},{"content":"If a machine is configured with multiple user accounts, only apps run by the current user are affected, unless the value is added to the registry keys for other users as well.","pos":[4009,4184]},{"content":"Adding the <ph id=\"ph1\">`&lt;useLegacyJit&gt;`</ph> element to a configuration file overrides the registry settings, if they're present.","pos":[4185,4297],"source":" Adding the `<useLegacyJit>` element to a configuration file overrides the registry settings, if they're present."},{"pos":[4306,4313],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following configuration file disables compilation with the new 64-bit JIT compiler and instead uses the legacy 64-bit JIT compiler.","pos":[4317,4452]},{"pos":[4605,4613],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4617,4722],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>runtime&gt; Element<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)</ept>","source":"[\\<runtime> Element](../../../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)"},{"pos":[4725,4834],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>configuration&gt; Element<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/configuration-element.md)</ept>","source":"[\\<configuration> Element](../../../../../docs/framework/configure-apps/file-schema/configuration-element.md)"},{"pos":[4837,4959],"content":"<bpt id=\"p1\">[</bpt>Mitigation: New 64-bit JIT Compiler<ept id=\"p1\">](../../../../../docs/framework/migration-guide/mitigation-new-64-bit-jit-compiler.md)</ept>","source":"[Mitigation: New 64-bit JIT Compiler](../../../../../docs/framework/migration-guide/mitigation-new-64-bit-jit-compiler.md)"}]}