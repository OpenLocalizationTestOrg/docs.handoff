{"content":"---\ntitle: \"Lambda Expressions (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.LambdaFunction\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"functions [Visual Basic], lambda expressions\"\n  - \"lambda expressions [Visual Basic]\"\n  - \"expressions [Visual Basic], lambda\"\n  - \"inline functions [Visual Basic]\"\nms.assetid: 137064b0-3928-4bfa-ba71-c3f9cbd951e2\ncaps.latest.revision: 52\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Lambda Expressions (Visual Basic)\nA *lambda expression* is a function or subroutine without a name that can be used wherever a delegate is valid. Lambda expressions can be functions or subroutines and can be single-line or multi-line. You can pass values from the current scope to a lambda expression.  \n  \n> [!NOTE]\n>  The `RemoveHandler` statement is an exception. You cannot pass a lambda expression in for the delegate parameter of `RemoveHandler`.  \n  \n You create lambda expressions by using the `Function` or `Sub` keyword, just as you create a standard function or subroutine. However, lambda expressions are included in a statement.  \n  \n The following example is a lambda expression that increments its argument and returns the value. The example shows both the single-line and multi-line lambda expression syntax for a function.  \n  \n [!code-vb[VbVbalrLambdas#14](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_1.vb)]  \n  \n The following example is a lambda expression that writes a value to the console. The example shows both the single-line and multi-line lambda expression syntax for a subroutine.  \n  \n [!code-vb[VbVbalrLambdas#15](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_2.vb)]  \n  \n Notice that in the previous examples the lambda expressions are assigned to a variable name. Whenever you refer to the variable, you invoke the lambda expression. You can also declare and invoke a lambda expression at the same time, as shown in the following example.  \n  \n [!code-vb[VbVbalrLambdas#3](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_3.vb)]  \n  \n A lambda expression can be returned as the value of a function call (as is shown in the example in the [Context](#context) section later in this topic), or passed in as an argument to a parameter that takes a delegate type, as shown in the following example.  \n  \n [!code-vb[VbVbalrLambdas#8](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_4.vb)]  \n  \n## Lambda Expression Syntax  \n The syntax of a lambda expression resembles that of a standard function or subroutine. The differences are as follows:  \n  \n-   A lambda expression does not have a name.  \n  \n-   Lambda expressions cannot have modifiers, such as `Overloads` or `Overrides`.  \n  \n-   Single-line lambda functions do not use an `As` clause to designate the return type. Instead, the type is inferred from the value that the body of the lambda expression evaluates to. For example, if the body of the lambda expression is `cust.City = \"London\"`, its return type is `Boolean`.  \n  \n-   In multi-line lambda functions, you can either specify a return type by using an `As` clause, or omit the `As` clause so that the return type is inferred. When the `As` clause is omitted for a multi-line lambda function, the return type is inferred to be the dominant type from all the `Return` statements in the multi-line lambda function. The *dominant type* is a unique type that all other types can widen to. If this unique type cannot be determined, the dominant type is the unique type that all other types in the array can narrow to. If neither of these unique types can be determined, the dominant type is `Object`. In this case, if `Option Strict` is set to `On`, a compiler error occurs.  \n  \n     For example, if the expressions supplied to the `Return` statement contain values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`. Both `Integer` and `Long` widen to `Double` and only `Double`. Therefore, `Double` is the dominant type. For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).  \n  \n-   The body of a single-line function must be an expression that returns a value, not a statement. There is no `Return` statement for single-line functions. The value returned by the single-line function is the value of the expression in the body of the function.  \n  \n-   The body of a single-line subroutine must be single-line statement.  \n  \n-   Single-line functions and subroutines do not include an `End Function` or `End Sub` statement.  \n  \n-   You can specify the data type of a lambda expression parameter by using the `As` keyword, or the data type of the parameter can be inferred. Either all parameters must have specified data types or all must be inferred.  \n  \n-   `Optional` and `Paramarray` parameters are not permitted.  \n  \n-   Generic parameters are not permitted.  \n  \n## Async Lambdas  \n You can easily create lambda expressions and statements that incorporate asynchronous processing by using the [Async](../../../../visual-basic/language-reference/modifiers/async.md) and [Await Operator](../../../../visual-basic/language-reference/operators/await-operator.md) keywords. For example, the following Windows Forms example contains an event handler that calls and awaits an async method, `ExampleMethodAsync`.  \n  \n```vb  \nPublic Class Form1  \n  \n    Async Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click  \n        ' ExampleMethodAsync returns a Task.  \n        Await ExampleMethodAsync()  \n        TextBox1.Text = vbCrLf & \"Control returned to button1_Click.\"  \n    End Sub  \n  \n    Async Function ExampleMethodAsync() As Task  \n        ' The following line simulates a task-returning asynchronous process.  \n        Await Task.Delay(1000)  \n    End Function  \n  \nEnd Class  \n  \n```  \n  \n You can add the same event handler by using an async lambda in an [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md). To add this handler, add an `Async` modifier before the lambda parameter list, as the following example shows.  \n  \n```vb  \nPublic Class Form1  \n  \n    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load  \n        AddHandler Button1.Click,   \n            Async Sub(sender1, e1)  \n                ' ExampleMethodAsync returns a Task.  \n                Await ExampleMethodAsync()  \n                TextBox1.Text = vbCrLf & \"Control returned to Button1_ Click.\"  \n            End Sub  \n    End Sub  \n  \n    Async Function ExampleMethodAsync() As Task  \n        ' The following line simulates a task-returning asynchronous process.  \n        Await Task.Delay(1000)  \n    End Function  \n  \nEnd Class  \n  \n```  \n  \n For more information about how to create and use async methods, see [Asynchronous Programming with Async and Await](../../../../visual-basic/programming-guide/concepts/async/index.md).  \n  \n##  <a name=\"context\"></a> Context  \n A lambda expression shares its context with the scope within which it is defined. It has the same access rights as any code written in the containing scope. This includes access to member variables, functions and subs, `Me`, and parameters and local variables in the containing scope.  \n  \n Access to local variables and parameters in the containing scope can extend beyond the lifetime of that scope. As long as a delegate referring to a lambda expression is not available to garbage collection, access to the variables in the original environment is retained. In the following example, variable `target` is local to `makeTheGame`, the method in which the lambda expression `playTheGame` is defined. Note that the returned lambda expression, assigned to `takeAGuess` in `Main`, still has access to the local variable `target`.  \n  \n [!code-vb[VbVbalrLambdas#12](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_5.vb)]  \n  \n The following example demonstrates the wide range of access rights of the nested lambda expression. When the returned lambda expression is executed from `Main` as `aDel`, it accesses these elements:  \n  \n-   A field of the class in which it is defined: `aField`  \n  \n-   A property of the class in which it is defined: `aProp`  \n  \n-   A parameter of method `functionWithNestedLambda`, in which it is defined: `level1`  \n  \n-   A local variable of `functionWithNestedLambda`: `localVar`  \n  \n-   A parameter of the lambda expression in which it is nested: `level2`  \n  \n [!code-vb[VbVbalrLambdas#9](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_6.vb)]  \n  \n## Converting to a Delegate Type  \n A lambda expression can be implicitly converted to a compatible delegate type. For information about the general requirements for compatibility, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md). For example, the following code example shows a lambda expression that implicitly converts to `Func(Of Integer, Boolean)` or a matching delegate signature.  \n  \n [!code-vb[VbVbalrLambdas#16](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_7.vb)]  \n  \n The following code example shows a lambda expression that implicitly converts to `Sub(Of Double, String, Double)` or a matching delegate signature.  \n  \n [!code-vb[VbVbalrLambdas#23](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_8.vb)]  \n  \n When you assign lambda expressions to delegates or pass them as arguments to procedures, you can specify the parameter names but omit their data types, letting the types be taken from the delegate.  \n  \n## Examples  \n  \n-   The following example defines a lambda expression that returns `True` if the nullable argument has an assigned value, and `False` if its value is `Nothing`.  \n  \n     [!code-vb[VbVbalrLambdas#4](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_9.vb)]  \n  \n-   The following example defines a lambda expression that returns the index of the last element in an array.  \n  \n     [!code-vb[VbVbalrLambdas#5](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_10.vb)]  \n  \n## See Also  \n [Procedures](./index.md)   \n [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)   \n [Delegates](../../../../visual-basic/programming-guide/language-features/delegates/index.md)   \n [Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md)   \n [Sub Statement](../../../../visual-basic/language-reference/statements/sub-statement.md)   \n [Nullable Value Types](../../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)   \n [How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)   \n [How to: Create a Lambda Expression](./how-to-create-a-lambda-expression.md)   \n [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)","nodes":[{"pos":[4,758],"nodes":[{"content":"Lambda Expressions (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,50],"content":"Lambda Expressions (Visual Basic) | Microsoft Docs","nodes":[{"content":"Lambda Expressions (Visual Basic) | Microsoft Docs","pos":[0,50]}]}],"pos":[6,59],"yaml":true}],"content":"title: \"Lambda Expressions (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.LambdaFunction\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"functions [Visual Basic], lambda expressions\"\n  - \"lambda expressions [Visual Basic]\"\n  - \"expressions [Visual Basic], lambda\"\n  - \"inline functions [Visual Basic]\"\nms.assetid: 137064b0-3928-4bfa-ba71-c3f9cbd951e2\ncaps.latest.revision: 52\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[765,798],"content":"Lambda Expressions (Visual Basic)","linkify":"Lambda Expressions (Visual Basic)","nodes":[{"content":"Lambda Expressions (Visual Basic)","pos":[0,33]}]},{"content":"A <bpt id=\"p1\">*</bpt>lambda expression<ept id=\"p1\">*</ept> is a function or subroutine without a name that can be used wherever a delegate is valid.","pos":[799,910],"source":"A *lambda expression* is a function or subroutine without a name that can be used wherever a delegate is valid."},{"content":"Lambda expressions can be functions or subroutines and can be single-line or multi-line.","pos":[911,999]},{"content":"You can pass values from the current scope to a lambda expression.","pos":[1000,1066]},{"pos":[1074,1217],"content":"[!NOTE]\n The `RemoveHandler` statement is an exception. You cannot pass a lambda expression in for the delegate parameter of `RemoveHandler`.","leadings":["","> "],"nodes":[{"content":"The `RemoveHandler` statement is an exception. You cannot pass a lambda expression in for the delegate parameter of `RemoveHandler`.","pos":[9,141],"nodes":[{"content":"The <ph id=\"ph1\">`RemoveHandler`</ph> statement is an exception.","pos":[0,46],"source":"The `RemoveHandler` statement is an exception."},{"content":"You cannot pass a lambda expression in for the delegate parameter of <ph id=\"ph1\">`RemoveHandler`</ph>.","pos":[47,132],"source":" You cannot pass a lambda expression in for the delegate parameter of `RemoveHandler`."}]}]},{"content":"You create lambda expressions by using the <ph id=\"ph1\">`Function`</ph> or <ph id=\"ph2\">`Sub`</ph> keyword, just as you create a standard function or subroutine.","pos":[1224,1349],"source":"You create lambda expressions by using the `Function` or `Sub` keyword, just as you create a standard function or subroutine."},{"content":"However, lambda expressions are included in a statement.","pos":[1350,1406]},{"content":"The following example is a lambda expression that increments its argument and returns the value.","pos":[1413,1509]},{"content":"The example shows both the single-line and multi-line lambda expression syntax for a function.","pos":[1510,1604]},{"pos":[1611,1743],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#14<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#14](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_1.vb)]"},{"content":"The following example is a lambda expression that writes a value to the console.","pos":[1750,1830]},{"content":"The example shows both the single-line and multi-line lambda expression syntax for a subroutine.","pos":[1831,1927]},{"pos":[1934,2066],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#15<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#15](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_2.vb)]"},{"content":"Notice that in the previous examples the lambda expressions are assigned to a variable name.","pos":[2073,2165]},{"content":"Whenever you refer to the variable, you invoke the lambda expression.","pos":[2166,2235]},{"content":"You can also declare and invoke a lambda expression at the same time, as shown in the following example.","pos":[2236,2340]},{"pos":[2347,2478],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#3<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#3](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_3.vb)]"},{"pos":[2485,2743],"content":"A lambda expression can be returned as the value of a function call (as is shown in the example in the <bpt id=\"p1\">[</bpt>Context<ept id=\"p1\">](#context)</ept> section later in this topic), or passed in as an argument to a parameter that takes a delegate type, as shown in the following example.","source":"A lambda expression can be returned as the value of a function call (as is shown in the example in the [Context](#context) section later in this topic), or passed in as an argument to a parameter that takes a delegate type, as shown in the following example."},{"pos":[2750,2881],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#8<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#8](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_4.vb)]"},{"pos":[2890,2914],"content":"Lambda Expression Syntax","linkify":"Lambda Expression Syntax","nodes":[{"content":"Lambda Expression Syntax","pos":[0,24]}]},{"content":"The syntax of a lambda expression resembles that of a standard function or subroutine.","pos":[2918,3004]},{"content":"The differences are as follows:","pos":[3005,3036]},{"content":"A lambda expression does not have a name.","pos":[3046,3087]},{"pos":[3097,3174],"content":"Lambda expressions cannot have modifiers, such as <ph id=\"ph1\">`Overloads`</ph> or <ph id=\"ph2\">`Overrides`</ph>.","source":"Lambda expressions cannot have modifiers, such as `Overloads` or `Overrides`."},{"content":"Single-line lambda functions do not use an <ph id=\"ph1\">`As`</ph> clause to designate the return type.","pos":[3184,3268],"source":"Single-line lambda functions do not use an `As` clause to designate the return type."},{"content":"Instead, the type is inferred from the value that the body of the lambda expression evaluates to.","pos":[3269,3366]},{"content":"For example, if the body of the lambda expression is <ph id=\"ph1\">`cust.City = \"London\"`</ph>, its return type is <ph id=\"ph2\">`Boolean`</ph>.","pos":[3367,3473],"source":" For example, if the body of the lambda expression is `cust.City = \"London\"`, its return type is `Boolean`."},{"content":"In multi-line lambda functions, you can either specify a return type by using an <ph id=\"ph1\">`As`</ph> clause, or omit the <ph id=\"ph2\">`As`</ph> clause so that the return type is inferred.","pos":[3483,3637],"source":"In multi-line lambda functions, you can either specify a return type by using an `As` clause, or omit the `As` clause so that the return type is inferred."},{"content":"When the <ph id=\"ph1\">`As`</ph> clause is omitted for a multi-line lambda function, the return type is inferred to be the dominant type from all the <ph id=\"ph2\">`Return`</ph> statements in the multi-line lambda function.","pos":[3638,3823],"source":" When the `As` clause is omitted for a multi-line lambda function, the return type is inferred to be the dominant type from all the `Return` statements in the multi-line lambda function."},{"content":"The <bpt id=\"p1\">*</bpt>dominant type<ept id=\"p1\">*</ept> is a unique type that all other types can widen to.","pos":[3824,3895],"source":" The *dominant type* is a unique type that all other types can widen to."},{"content":"If this unique type cannot be determined, the dominant type is the unique type that all other types in the array can narrow to.","pos":[3896,4023]},{"content":"If neither of these unique types can be determined, the dominant type is <ph id=\"ph1\">`Object`</ph>.","pos":[4024,4106],"source":" If neither of these unique types can be determined, the dominant type is `Object`."},{"content":"In this case, if <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`On`</ph>, a compiler error occurs.","pos":[4107,4180],"source":" In this case, if `Option Strict` is set to `On`, a compiler error occurs."},{"content":"For example, if the expressions supplied to the <ph id=\"ph1\">`Return`</ph> statement contain values of type <ph id=\"ph2\">`Integer`</ph>, <ph id=\"ph3\">`Long`</ph>, and <ph id=\"ph4\">`Double`</ph>, the resulting array is of type <ph id=\"ph5\">`Double`</ph>.","pos":[4191,4354],"source":"For example, if the expressions supplied to the `Return` statement contain values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`."},{"content":"Both <ph id=\"ph1\">`Integer`</ph> and <ph id=\"ph2\">`Long`</ph> widen to <ph id=\"ph3\">`Double`</ph> and only <ph id=\"ph4\">`Double`</ph>.","pos":[4355,4417],"source":" Both `Integer` and `Long` widen to `Double` and only `Double`."},{"content":"Therefore, <ph id=\"ph1\">`Double`</ph> is the dominant type.","pos":[4418,4459],"source":" Therefore, `Double` is the dominant type."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>.","pos":[4460,4634],"source":" For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)."},{"content":"The body of a single-line function must be an expression that returns a value, not a statement.","pos":[4644,4739]},{"content":"There is no <ph id=\"ph1\">`Return`</ph> statement for single-line functions.","pos":[4740,4797],"source":" There is no `Return` statement for single-line functions."},{"content":"The value returned by the single-line function is the value of the expression in the body of the function.","pos":[4798,4904]},{"content":"The body of a single-line subroutine must be single-line statement.","pos":[4914,4981]},{"pos":[4991,5085],"content":"Single-line functions and subroutines do not include an <ph id=\"ph1\">`End Function`</ph> or <ph id=\"ph2\">`End Sub`</ph> statement.","source":"Single-line functions and subroutines do not include an `End Function` or `End Sub` statement."},{"content":"You can specify the data type of a lambda expression parameter by using the <ph id=\"ph1\">`As`</ph> keyword, or the data type of the parameter can be inferred.","pos":[5095,5235],"source":"You can specify the data type of a lambda expression parameter by using the `As` keyword, or the data type of the parameter can be inferred."},{"content":"Either all parameters must have specified data types or all must be inferred.","pos":[5236,5313]},{"pos":[5323,5380],"content":"<ph id=\"ph1\">`Optional`</ph> and <ph id=\"ph2\">`Paramarray`</ph> parameters are not permitted.","source":"`Optional` and `Paramarray` parameters are not permitted."},{"content":"Generic parameters are not permitted.","pos":[5390,5427]},{"pos":[5436,5449],"content":"Async Lambdas","linkify":"Async Lambdas","nodes":[{"content":"Async Lambdas","pos":[0,13]}]},{"content":"You can easily create lambda expressions and statements that incorporate asynchronous processing by using the <bpt id=\"p1\">[</bpt>Async<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/async.md)</ept> and <bpt id=\"p2\">[</bpt>Await Operator<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/await-operator.md)</ept> keywords.","pos":[5453,5738],"source":"You can easily create lambda expressions and statements that incorporate asynchronous processing by using the [Async](../../../../visual-basic/language-reference/modifiers/async.md) and [Await Operator](../../../../visual-basic/language-reference/operators/await-operator.md) keywords."},{"content":"For example, the following Windows Forms example contains an event handler that calls and awaits an async method, <ph id=\"ph1\">`ExampleMethodAsync`</ph>.","pos":[5739,5874],"source":" For example, the following Windows Forms example contains an event handler that calls and awaits an async method, `ExampleMethodAsync`."},{"content":"You can add the same event handler by using an async lambda in an <bpt id=\"p1\">[</bpt>AddHandler Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/addhandler-statement.md)</ept>.","pos":[6381,6550],"source":"You can add the same event handler by using an async lambda in an [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md)."},{"content":"To add this handler, add an <ph id=\"ph1\">`Async`</ph> modifier before the lambda parameter list, as the following example shows.","pos":[6551,6661],"source":" To add this handler, add an `Async` modifier before the lambda parameter list, as the following example shows."},{"pos":[7286,7470],"content":"For more information about how to create and use async methods, see <bpt id=\"p1\">[</bpt>Asynchronous Programming with Async and Await<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/async/index.md)</ept>.","source":"For more information about how to create and use async methods, see [Asynchronous Programming with Async and Await](../../../../visual-basic/programming-guide/concepts/async/index.md)."},{"pos":[7480,7510],"content":"<bpt id=\"p1\">&lt;a name=\"context\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Context","linkify":"<a name=\"context\"></a> Context","source":"<a name=\"context\"></a> Context"},{"content":"A lambda expression shares its context with the scope within which it is defined.","pos":[7514,7595]},{"content":"It has the same access rights as any code written in the containing scope.","pos":[7596,7670]},{"content":"This includes access to member variables, functions and subs, <ph id=\"ph1\">`Me`</ph>, and parameters and local variables in the containing scope.","pos":[7671,7798],"source":" This includes access to member variables, functions and subs, `Me`, and parameters and local variables in the containing scope."},{"content":"Access to local variables and parameters in the containing scope can extend beyond the lifetime of that scope.","pos":[7805,7915]},{"content":"As long as a delegate referring to a lambda expression is not available to garbage collection, access to the variables in the original environment is retained.","pos":[7916,8075]},{"content":"In the following example, variable <ph id=\"ph1\">`target`</ph> is local to <ph id=\"ph2\">`makeTheGame`</ph>, the method in which the lambda expression <ph id=\"ph3\">`playTheGame`</ph> is defined.","pos":[8076,8214],"source":" In the following example, variable `target` is local to `makeTheGame`, the method in which the lambda expression `playTheGame` is defined."},{"content":"Note that the returned lambda expression, assigned to <ph id=\"ph1\">`takeAGuess`</ph> in <ph id=\"ph2\">`Main`</ph>, still has access to the local variable <ph id=\"ph3\">`target`</ph>.","pos":[8215,8341],"source":" Note that the returned lambda expression, assigned to `takeAGuess` in `Main`, still has access to the local variable `target`."},{"pos":[8348,8480],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#12<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#12](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_5.vb)]"},{"content":"The following example demonstrates the wide range of access rights of the nested lambda expression.","pos":[8487,8586]},{"content":"When the returned lambda expression is executed from <ph id=\"ph1\">`Main`</ph> as <ph id=\"ph2\">`aDel`</ph>, it accesses these elements:","pos":[8587,8685],"source":" When the returned lambda expression is executed from `Main` as `aDel`, it accesses these elements:"},{"pos":[8695,8748],"content":"A field of the class in which it is defined: <ph id=\"ph1\">`aField`</ph>","source":"A field of the class in which it is defined: `aField`"},{"pos":[8758,8813],"content":"A property of the class in which it is defined: <ph id=\"ph1\">`aProp`</ph>","source":"A property of the class in which it is defined: `aProp`"},{"pos":[8823,8905],"content":"A parameter of method <ph id=\"ph1\">`functionWithNestedLambda`</ph>, in which it is defined: <ph id=\"ph2\">`level1`</ph>","source":"A parameter of method `functionWithNestedLambda`, in which it is defined: `level1`"},{"pos":[8915,8973],"content":"A local variable of <ph id=\"ph1\">`functionWithNestedLambda`</ph>: <ph id=\"ph2\">`localVar`</ph>","source":"A local variable of `functionWithNestedLambda`: `localVar`"},{"pos":[8983,9051],"content":"A parameter of the lambda expression in which it is nested: <ph id=\"ph1\">`level2`</ph>","source":"A parameter of the lambda expression in which it is nested: `level2`"},{"pos":[9058,9189],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#9<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#9](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_6.vb)]"},{"pos":[9198,9227],"content":"Converting to a Delegate Type","linkify":"Converting to a Delegate Type","nodes":[{"content":"Converting to a Delegate Type","pos":[0,29]}]},{"content":"A lambda expression can be implicitly converted to a compatible delegate type.","pos":[9231,9309]},{"content":"For information about the general requirements for compatibility, see <bpt id=\"p1\">[</bpt>Relaxed Delegate Conversion<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)</ept>.","pos":[9310,9513],"source":" For information about the general requirements for compatibility, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)."},{"content":"For example, the following code example shows a lambda expression that implicitly converts to <ph id=\"ph1\">`Func(Of Integer, Boolean)`</ph> or a matching delegate signature.","pos":[9514,9669],"source":" For example, the following code example shows a lambda expression that implicitly converts to `Func(Of Integer, Boolean)` or a matching delegate signature."},{"pos":[9676,9808],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#16<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#16](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_7.vb)]"},{"pos":[9815,9962],"content":"The following code example shows a lambda expression that implicitly converts to <ph id=\"ph1\">`Sub(Of Double, String, Double)`</ph> or a matching delegate signature.","source":"The following code example shows a lambda expression that implicitly converts to `Sub(Of Double, String, Double)` or a matching delegate signature."},{"pos":[9969,10101],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#23<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_8.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#23](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_8.vb)]"},{"content":"When you assign lambda expressions to delegates or pass them as arguments to procedures, you can specify the parameter names but omit their data types, letting the types be taken from the delegate.","pos":[10108,10305]},{"pos":[10314,10322],"content":"Examples","linkify":"Examples","nodes":[{"content":"Examples","pos":[0,8]}]},{"pos":[10332,10488],"content":"The following example defines a lambda expression that returns <ph id=\"ph1\">`True`</ph> if the nullable argument has an assigned value, and <ph id=\"ph2\">`False`</ph> if its value is <ph id=\"ph3\">`Nothing`</ph>.","source":"The following example defines a lambda expression that returns `True` if the nullable argument has an assigned value, and `False` if its value is `Nothing`."},{"pos":[10499,10630],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#4<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_9.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#4](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_9.vb)]"},{"content":"The following example defines a lambda expression that returns the index of the last element in an array.","pos":[10640,10745]},{"pos":[10756,10888],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrLambdas#5<ept id=\"p2\">](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_10.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrLambdas#5](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/lambda-expressions_10.vb)]"},{"pos":[10897,10905],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept><ph id=\"ph1\"> </ph>","pos":[10909,10934],"source":"[Procedures](./index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[10938,11068],"source":"[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>Delegates<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[11072,11165],"source":"[Delegates](../../../../visual-basic/programming-guide/language-features/delegates/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/function-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[11169,11268],"source":"[Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Sub Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/sub-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[11272,11361],"source":"[Sub Statement](../../../../visual-basic/language-reference/statements/sub-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Nullable Value Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)</ept><ph id=\"ph1\"> </ph>","pos":[11365,11485],"source":"[Nullable Value Types](../../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Pass Procedures to Another Procedure in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)</ept><ph id=\"ph1\"> </ph>","pos":[11489,11671],"source":"[How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Lambda Expression<ept id=\"p1\">](./how-to-create-a-lambda-expression.md)</ept><ph id=\"ph1\"> </ph>","pos":[11675,11752],"source":"[How to: Create a Lambda Expression](./how-to-create-a-lambda-expression.md) "},{"content":"<bpt id=\"p1\">[</bpt>Relaxed Delegate Conversion<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)</ept>","pos":[11756,11888],"source":"[Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)"}]}