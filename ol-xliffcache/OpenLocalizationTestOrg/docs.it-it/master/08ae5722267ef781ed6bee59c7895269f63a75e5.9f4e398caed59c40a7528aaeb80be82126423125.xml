{"content":"---\ntitle: \"How to: Execute a Polymorphic Query\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 2f05da1e-845b-4f14-83e4-c6353a850553\n---\n\n# How to: Execute a Polymorphic Query\n\nThis topic shows how to execute a polymorphic [!INCLUDE[esql](../../../../../includes/esql-md.md)] query using the [OFTYPE](../../../../../docs/framework/data/adonet/ef/language-reference/oftype-entity-sql.md) operator.\n\n### To run the code in this example\n\n1. Add the [School Model](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb896300(v=vs.100)) to your project and configure your project to use the Entity Framework. For more information, see [How to: Use the Entity Data Model Wizard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738677(v=vs.100)).\n\n2. In the code page for your application, add the following `using` statements (`Imports` in Visual Basic):\n\n    [!code-csharp[DP EntityServices Concepts#Namespaces](../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/source.cs#namespaces)]\n    [!code-vb[DP EntityServices Concepts#Namespaces](../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp entityservices concepts/vb/source.vb#namespaces)]\n\n3. Modify the conceptual model to have a table-per-hierarchy inheritance by following the steps in [Walkthrough: Mapping Inheritance - Table-per-Hierarchy](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/cc716683(v=vs.100)).\n\n## Example\n\nThe following example uses an OFTYPE operator to get and display a collection of only `OnsiteCourses` from a collection of `Courses`.\n\n[!code-csharp[DP EntityServices Concepts#PolymorphicQuery](../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/source.cs#polymorphicquery)]\n[!code-vb[DP EntityServices Concepts#PolymorphicQuery](../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp entityservices concepts/vb/source.vb#polymorphicquery)]\n\n## See also\n\n- [EntityClient Provider for the Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md)\n- [Entity SQL Language](../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-language.md)\n","nodes":[{"pos":[4,152],"embed":true,"restype":"x-metadata","content":"title: \"How to: Execute a Polymorphic Query\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 2f05da1e-845b-4f14-83e4-c6353a850553","nodes":[{"content":"How to: Execute a Polymorphic Query","nodes":[{"pos":[0,35],"content":"How to: Execute a Polymorphic Query","nodes":[{"content":"How to: Execute a Polymorphic Query","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[160,195],"content":"How to: Execute a Polymorphic Query","linkify":"How to: Execute a Polymorphic Query","nodes":[{"content":"How to: Execute a Polymorphic Query","pos":[0,35]}]},{"pos":[197,416],"content":"This topic shows how to execute a polymorphic <ph id=\"ph1\">[!INCLUDE[esql](../../../../../includes/esql-md.md)]</ph> query using the <bpt id=\"p1\">[</bpt>OFTYPE<ept id=\"p1\">](../../../../../docs/framework/data/adonet/ef/language-reference/oftype-entity-sql.md)</ept> operator.","source":"This topic shows how to execute a polymorphic [!INCLUDE[esql](../../../../../includes/esql-md.md)] query using the [OFTYPE](../../../../../docs/framework/data/adonet/ef/language-reference/oftype-entity-sql.md) operator."},{"pos":[422,453],"content":"To run the code in this example","linkify":"To run the code in this example","nodes":[{"content":"To run the code in this example","pos":[0,31]}]},{"content":"Add the <bpt id=\"p1\">[</bpt>School Model<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb896300(v=vs.100))</ept> to your project and configure your project to use the Entity Framework.","pos":[458,641],"source":"Add the [School Model](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb896300(v=vs.100)) to your project and configure your project to use the Entity Framework."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Use the Entity Data Model Wizard<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738677(v=vs.100))</ept>.","pos":[642,800],"source":" For more information, see [How to: Use the Entity Data Model Wizard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738677(v=vs.100))."},{"pos":[805,909],"content":"In the code page for your application, add the following <ph id=\"ph1\">`using`</ph> statements (<ph id=\"ph2\">`Imports`</ph> in Visual Basic):","source":"In the code page for your application, add the following `using` statements (`Imports` in Visual Basic):"},{"pos":[915,1243],"content":"[!code-csharp[DP EntityServices Concepts#Namespaces](../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/source.cs#namespaces)]\n [!code-vb[DP EntityServices Concepts#Namespaces](../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp entityservices concepts/vb/source.vb#namespaces)]","leadings":["","   "],"nodes":[]},{"pos":[1248,1490],"content":"Modify the conceptual model to have a table-per-hierarchy inheritance by following the steps in <bpt id=\"p1\">[</bpt>Walkthrough: Mapping Inheritance - Table-per-Hierarchy<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/cc716683(v=vs.100))</ept>.","source":"Modify the conceptual model to have a table-per-hierarchy inheritance by following the steps in [Walkthrough: Mapping Inheritance - Table-per-Hierarchy](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/cc716683(v=vs.100))."},{"pos":[1495,1502],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1504,1637],"content":"The following example uses an OFTYPE operator to get and display a collection of only <ph id=\"ph1\">`OnsiteCourses`</ph> from a collection of <ph id=\"ph2\">`Courses`</ph>.","source":"The following example uses an OFTYPE operator to get and display a collection of only `OnsiteCourses` from a collection of `Courses`."},{"pos":[1992,2000],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2004,2148],"content":"<bpt id=\"p1\">[</bpt>EntityClient Provider for the Entity Framework<ept id=\"p1\">](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md)</ept>","source":"[EntityClient Provider for the Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md)"},{"pos":[2151,2260],"content":"<bpt id=\"p1\">[</bpt>Entity SQL Language<ept id=\"p1\">](../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-language.md)</ept>","source":"[Entity SQL Language](../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-language.md)"}]}