{"content":"---\ntitle: Put function (Unmanaged API Reference)\ndescription: The Put function assigns a new value to a named property.\nms.date: \"11/06/2017\"\napi_name:\n  - \"Put\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"Put\"\nhelpviewer_keywords:\n  - \"Put function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n\n# Put function\n\nSets a named property to a new value.\n\n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n\n## Syntax\n\n```cpp\nHRESULT Put (\n   [in] int               vFunc,\n   [in] IWbemClassObject* ptr,\n   [in] LPCWSTR           wszName,\n   [in] LONG              lFlags,\n   [in] VARIANT*          pVal,\n   [in] CIMTYPE           vtType\n);\n```\n\n## Parameters\n\n`vFunc`\\\n[in] This parameter is unused.\n\n`ptr`\\\n[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance.\n\n`wszName`\\\n[in] The name of the property. This parameter cannot be `null`.\n\n`lFlags`\\\n[in] Reserved. This parameter must be 0.\n\n`pVal`\\\n[in] A pointer to a valid `VARIANT` that becomes the new property value. If `pVal` is `null` or points to a `VARIANT` of type `VT_NULL`, the property is set to `null`.\n\n`vtType`\\\n[in] The type of `VARIANT` pointed to by `pVal`. See the [Remarks](#remarks) section for more information.\n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n|`WBEM_E_FAILED` | 0x80041001 | There has been a general failure. |\n|`WBEM_E_INVALID_PARAMETER` | 0x80041008 | One or more parameters are not valid. |\n|`WBEM_E_INVALID_PROPERTY_TYPE` | 0x8004102a | The property type is not recognized. This value is returned when creating class instances if the class already exists. |\n|`WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Not enough memory is available to complete the operation. |\n| `WBEM_E_TYPE_MISMATCH` | 0x80041005 | For instances: Indicates that `pVal` points to a `VARIANT` of an incorrect type for the property. <br/> For class definitions: The property already exists in the parent class, and the new COM type is different from the old COM type. |\n|`WBEM_S_NO_ERROR` | 0 | The function call was successful. |\n\n## Remarks\n\nThis function wraps a call to the [IWbemClassObject::Put](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put) method.\n\nThis function always overwrites the current property value with a new one. If the [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) points to a class definition, `Put` creates or updates the property value. When [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) points to a CIM instance, `Put` updates the property value only; `Put` cannot create a property value.\n\nThe `__CLASS` system property is only writable during class creation, when it may not be left blank. All other system properties are read-only.\n\nA user cannot create properties with names that begin or end with an underscore (\"_\"). This is reserved for system classes and properties.\n\nIf the property set by the `Put` function exists in the parent class, the default value of the property is changed unless the property type does not match the parent class type. If the property does not exist and it is not a type mismatch, the property is created.\n\nUse the `vtType` parameter only when creating new properties in a CIM class definition and `pVal` is `null` or points to a `VARIANT` of type `VT_NULL`. In this case, the `vType` parameter specifies the CIM type of the property. In every other case, `vtType` must be 0. `vtType` must also be 0 if the underlying object is an instance (even if `Val` is `null`) because the type of the property is fixed and cannot be changed.\n\n## Example\n\nFor an example, see the [IWbemClassObject::Put](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put) method.\n\n## Requirements\n\n**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).\n\n**Header:** WMINet_Utils.idl\n\n**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]\n\n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)","nodes":[{"pos":[4,392],"embed":true,"restype":"x-metadata","content":"title: Put function (Unmanaged API Reference)\ndescription: The Put function assigns a new value to a named property.\nms.date: \"11/06/2017\"\napi_name:\n  - \"Put\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"Put\"\nhelpviewer_keywords:\n  - \"Put function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Put function (Unmanaged API Reference)","nodes":[{"pos":[0,38],"content":"Put function (Unmanaged API Reference)","nodes":[{"content":"Put function (Unmanaged API Reference)","pos":[0,38]}]}],"path":["title"],"nosxs":false},{"content":"The Put function assigns a new value to a named property.","nodes":[{"pos":[0,57],"content":"The Put function assigns a new value to a named property.","nodes":[{"content":"The Put function assigns a new value to a named property.","pos":[0,57]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[400,412],"content":"Put function","linkify":"Put function","nodes":[{"content":"Put function","pos":[0,12]}]},{"content":"Sets a named property to a new value.","pos":[414,451]},{"pos":[540,546],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[778,788],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] This parameter is unused.","pos":[799,829]},{"content":"[in] A pointer to an <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> instance.","pos":[838,945],"source":"[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance."},{"content":"[in] The name of the property.","pos":[958,988]},{"content":"This parameter cannot be <ph id=\"ph1\">`null`</ph>.","pos":[989,1021],"source":" This parameter cannot be `null`."},{"content":"[in] Reserved.","pos":[1033,1047]},{"content":"This parameter must be 0.","pos":[1048,1073]},{"content":"[in] A pointer to a valid <ph id=\"ph1\">`VARIANT`</ph> that becomes the new property value.","pos":[1083,1155],"source":"[in] A pointer to a valid `VARIANT` that becomes the new property value."},{"content":"If <ph id=\"ph1\">`pVal`</ph> is <ph id=\"ph2\">`null`</ph> or points to a <ph id=\"ph3\">`VARIANT`</ph> of type <ph id=\"ph4\">`VT_NULL`</ph>, the property is set to <ph id=\"ph5\">`null`</ph>.","pos":[1156,1250],"source":" If `pVal` is `null` or points to a `VARIANT` of type `VT_NULL`, the property is set to `null`."},{"content":"[in] The type of <ph id=\"ph1\">`VARIANT`</ph> pointed to by <ph id=\"ph2\">`pVal`</ph>.","pos":[1262,1310],"source":"[in] The type of `VARIANT` pointed to by `pVal`."},{"content":"See the <bpt id=\"p1\">[</bpt>Remarks<ept id=\"p1\">](#remarks)</ept> section for more information.","pos":[1311,1368],"source":" See the [Remarks](#remarks) section for more information."},{"pos":[1373,1385],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[1387,1527],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1530,1538]},{"content":"Value","pos":[1541,1546]},{"content":"Description","pos":[1549,1560]},{"content":"0x80041001","pos":[1615,1625]},{"content":"There has been a general failure.","pos":[1628,1661]},{"content":"0x80041008","pos":[1694,1704]},{"content":"One or more parameters are not valid.","pos":[1707,1744]},{"content":"0x8004102a","pos":[1781,1791]},{"content":"The property type is not recognized.","pos":[1794,1830]},{"content":"This value is returned when creating class instances if the class already exists.","pos":[1831,1912]},{"content":"0x80041006","pos":[1941,1951]},{"content":"Not enough memory is available to complete the operation.","pos":[1954,2011]},{"content":"0x80041005","pos":[2041,2051]},{"content":"For instances: Indicates that <ph id=\"ph1\">`pVal`</ph> points to a <ph id=\"ph2\">`VARIANT`</ph> of an incorrect type for the property.","pos":[2054,2151],"source":"For instances: Indicates that `pVal` points to a `VARIANT` of an incorrect type for the property."},{"content":"For class definitions: The property already exists in the parent class, and the new COM type is different from the old COM type.","pos":[2158,2286]},{"content":"0","pos":[2310,2311]},{"content":"The function call was successful.","pos":[2314,2347]},{"pos":[2354,2361],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2363,2490],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemClassObject::Put<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put)</ept> method.","source":"This function wraps a call to the [IWbemClassObject::Put](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put) method."},{"content":"This function always overwrites the current property value with a new one.","pos":[2492,2566]},{"content":"If the <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> points to a class definition, <ph id=\"ph1\">`Put`</ph> creates or updates the property value.","pos":[2567,2725],"source":" If the [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) points to a class definition, `Put` creates or updates the property value."},{"content":"When <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> points to a CIM instance, <ph id=\"ph1\">`Put`</ph> updates the property value only; <ph id=\"ph2\">`Put`</ph> cannot create a property value.","pos":[2726,2910],"source":" When [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) points to a CIM instance, `Put` updates the property value only; `Put` cannot create a property value."},{"content":"The <ph id=\"ph1\">`__CLASS`</ph> system property is only writable during class creation, when it may not be left blank.","pos":[2912,3012],"source":"The `__CLASS` system property is only writable during class creation, when it may not be left blank."},{"content":"All other system properties are read-only.","pos":[3013,3055]},{"content":"A user cannot create properties with names that begin or end with an underscore (\"_\").","pos":[3057,3143]},{"content":"This is reserved for system classes and properties.","pos":[3144,3195]},{"content":"If the property set by the <ph id=\"ph1\">`Put`</ph> function exists in the parent class, the default value of the property is changed unless the property type does not match the parent class type.","pos":[3197,3374],"source":"If the property set by the `Put` function exists in the parent class, the default value of the property is changed unless the property type does not match the parent class type."},{"content":"If the property does not exist and it is not a type mismatch, the property is created.","pos":[3375,3461]},{"content":"Use the <ph id=\"ph1\">`vtType`</ph> parameter only when creating new properties in a CIM class definition and <ph id=\"ph2\">`pVal`</ph> is <ph id=\"ph3\">`null`</ph> or points to a <ph id=\"ph4\">`VARIANT`</ph> of type <ph id=\"ph5\">`VT_NULL`</ph>.","pos":[3463,3614],"source":"Use the `vtType` parameter only when creating new properties in a CIM class definition and `pVal` is `null` or points to a `VARIANT` of type `VT_NULL`."},{"content":"In this case, the <ph id=\"ph1\">`vType`</ph> parameter specifies the CIM type of the property.","pos":[3615,3690],"source":" In this case, the `vType` parameter specifies the CIM type of the property."},{"content":"In every other case, <ph id=\"ph1\">`vtType`</ph> must be 0.","pos":[3691,3731],"source":" In every other case, `vtType` must be 0."},{"content":"<ph id=\"ph1\">`vtType`</ph> must also be 0 if the underlying object is an instance (even if <ph id=\"ph2\">`Val`</ph> is <ph id=\"ph3\">`null`</ph>) because the type of the property is fixed and cannot be changed.","pos":[3732,3886],"source":"`vtType` must also be 0 if the underlying object is an instance (even if `Val` is `null`) because the type of the property is fixed and cannot be changed."},{"pos":[3891,3898],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3900,4017],"content":"For an example, see the <bpt id=\"p1\">[</bpt>IWbemClassObject::Put<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put)</ept> method.","source":"For an example, see the [IWbemClassObject::Put](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-put) method."},{"pos":[4022,4034],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4036,4140],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4142,4170],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[4172,4279],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[4284,4292],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4296,4362],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}