{"content":"---\ntitle: \"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"MenuStrip control [Windows Forms], merging\"\n  - \"MenuStrip control [Windows Forms], appending\"\n  - \"MDI [Windows Forms], merging menu items\"\nms.assetid: ab70c936-b452-4653-b417-17be57bb795b\n---\n# How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)\nIn some applications, the kind of a multiple-document interface (MDI) child window can be different from the MDI parent window. For example, the MDI parent might be a spreadsheet, and the MDI child might be a chart. In that case, you want to update the contents of the MDI parent's menu with the contents of the MDI child's menu as MDI child windows of different kinds are activated.  \n  \n The following procedure uses the <xref:System.Windows.Forms.Form.IsMdiContainer%2A>, <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A>, <xref:System.Windows.Forms.MergeAction>, and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties to append the MDI child menu to the MDI parent menu. Closing the MDI child window removes the appended menu from the MDI parent.  \n  \n Also see [Multiple-Document Interface (MDI) Applications](../advanced/multiple-document-interface-mdi-applications.md).  \n  \n### To append a menu item to an MDI parent  \n  \n1.  Create a form and set its <xref:System.Windows.Forms.Form.IsMdiContainer%2A> property to `true`.  \n  \n2.  Add a <xref:System.Windows.Forms.MenuStrip> to `Form1` and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the <xref:System.Windows.Forms.MenuStrip> to `true`.  \n  \n3.  Set the <xref:System.Windows.Forms.ToolStripItem.Visible%2A> property of the `Form1`<xref:System.Windows.Forms.MenuStrip> to `false`.  \n  \n4.  Add a top-level menu item to the `Form1`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Control.Text%2A> property to `&File`.  \n  \n5.  Add a submenu item to the `&File` menu item and set its <xref:System.Windows.Forms.Form.Text%2A> property to `&Open`.  \n  \n6.  Add a form to the project, add a <xref:System.Windows.Forms.MenuStrip> to the form, and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the `Form2`<xref:System.Windows.Forms.MenuStrip> to `true`.  \n  \n7.  Add a top-level menu item to the `Form2`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Form.Text%2A> property to `&Special`.  \n  \n8.  Add two submenu items to the `&Special` menu item and set their <xref:System.Windows.Forms.Form.Text%2A> properties to `Command&1` and `Command&2`, respectively.  \n  \n9. Set the <xref:System.Windows.Forms.MergeAction> property of the `&Special`, `Command&1`, and `Command&2` menu items to <xref:System.Windows.Forms.MergeAction.Append>.  \n  \n10. Create an event handler for the <xref:System.Windows.Forms.Control.Click> event of the `&New`<xref:System.Windows.Forms.ToolStripMenuItem>.  \n  \n11. Within the event handler, insert code similar to the following code example to create and display new instances of `Form2` as MDI children of `Form1`.  \n  \n    ```vb  \n    Private Sub openToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles openToolStripMenuItem.Click  \n        Dim NewMDIChild As New Form2()  \n        'Set the parent form of the child window.  \n            NewMDIChild.MdiParent = Me  \n        'Display the new form.  \n            NewMDIChild.Show()  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void openToolStripMenuItem_Click(object sender, EventArgs e)  \n    {  \n        Form2 newMDIChild = new Form2();  \n        // Set the parent form of the child window.  \n            newMDIChild.MdiParent = this;  \n        // Display the new form.  \n            newMDIChild.Show();  \n    }  \n    ```  \n  \n12. Place code similar to the following code example in the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem> to register the event handler.  \n  \n    ```vb  \n    Private Sub openToolStripMenuItem_Click(sender As Object, e As _  \n    EventArgs) Handles openToolStripMenuItem.Click  \n    ```  \n  \n    ```csharp  \n    this.openToolStripMenuItem.Click += new System.EventHandler(this.openToolStripMenuItem_Click);  \n    ```  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   Two <xref:System.Windows.Forms.Form> controls named `Form1` and `Form2`.  \n  \n-   A <xref:System.Windows.Forms.MenuStrip> control on `Form1` named `menuStrip1`, and a <xref:System.Windows.Forms.MenuStrip> control on `Form2` named `menuStrip2`.  \n  \n-   References to the <xref:System?displayProperty=nameWithType> and <xref:System.Windows.Forms?displayProperty=nameWithType> assemblies.\n","nodes":[{"pos":[4,352],"embed":true,"restype":"x-metadata","content":"title: \"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"MenuStrip control [Windows Forms], merging\"\n  - \"MenuStrip control [Windows Forms], appending\"\n  - \"MDI [Windows Forms], merging menu items\"\nms.assetid: ab70c936-b452-4653-b417-17be57bb795b","nodes":[{"content":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","nodes":[{"pos":[0,66],"content":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","nodes":[{"content":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","pos":[0,66]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[359,425],"content":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","linkify":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","nodes":[{"content":"How to: Append a MenuStrip to an MDI Parent Window (Windows Forms)","pos":[0,66]}]},{"content":"In some applications, the kind of a multiple-document interface (MDI) child window can be different from the MDI parent window.","pos":[426,553]},{"content":"For example, the MDI parent might be a spreadsheet, and the MDI child might be a chart.","pos":[554,641]},{"content":"In that case, you want to update the contents of the MDI parent's menu with the contents of the MDI child's menu as MDI child windows of different kinds are activated.","pos":[642,809]},{"content":"The following procedure uses the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.IsMdiContainer%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.MergeAction&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A&gt;</ph> properties to append the MDI child menu to the MDI parent menu.","pos":[816,1118],"source":"The following procedure uses the <xref:System.Windows.Forms.Form.IsMdiContainer%2A>, <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A>, <xref:System.Windows.Forms.MergeAction>, and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties to append the MDI child menu to the MDI parent menu."},{"content":"Closing the MDI child window removes the appended menu from the MDI parent.","pos":[1119,1194]},{"pos":[1201,1320],"content":"Also see <bpt id=\"p1\">[</bpt>Multiple-Document Interface (MDI) Applications<ept id=\"p1\">](../advanced/multiple-document-interface-mdi-applications.md)</ept>.","source":"Also see [Multiple-Document Interface (MDI) Applications](../advanced/multiple-document-interface-mdi-applications.md)."},{"pos":[1330,1368],"content":"To append a menu item to an MDI parent","linkify":"To append a menu item to an MDI parent","nodes":[{"content":"To append a menu item to an MDI parent","pos":[0,38]}]},{"pos":[1378,1474],"content":"Create a form and set its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.IsMdiContainer%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","source":"Create a form and set its <xref:System.Windows.Forms.Form.IsMdiContainer%2A> property to `true`."},{"pos":[1484,1667],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph2\">`Form1`</ph> and set the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph> property of the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph5\">`true`</ph>.","source":"Add a <xref:System.Windows.Forms.MenuStrip> to `Form1` and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the <xref:System.Windows.Forms.MenuStrip> to `true`."},{"pos":[1677,1810],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripItem.Visible%2A&gt;</ph> property of the <ph id=\"ph2\">`Form1`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph4\">`false`</ph>.","source":"Set the <xref:System.Windows.Forms.ToolStripItem.Visible%2A> property of the `Form1`<xref:System.Windows.Forms.MenuStrip> to `false`."},{"pos":[1820,1974],"content":"Add a top-level menu item to the <ph id=\"ph1\">`Form1`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> and set its <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <ph id=\"ph4\">`&amp;File`</ph>.","source":"Add a top-level menu item to the `Form1`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Control.Text%2A> property to `&File`."},{"pos":[1984,2101],"content":"Add a submenu item to the <ph id=\"ph1\">`&amp;File`</ph> menu item and set its <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.Text%2A&gt;</ph> property to <ph id=\"ph3\">`&amp;Open`</ph>.","source":"Add a submenu item to the `&File` menu item and set its <xref:System.Windows.Forms.Form.Text%2A> property to `&Open`."},{"pos":[2111,2330],"content":"Add a form to the project, add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to the form, and set the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph> property of the <ph id=\"ph3\">`Form2`</ph><ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph5\">`true`</ph>.","source":"Add a form to the project, add a <xref:System.Windows.Forms.MenuStrip> to the form, and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the `Form2`<xref:System.Windows.Forms.MenuStrip> to `true`."},{"pos":[2340,2494],"content":"Add a top-level menu item to the <ph id=\"ph1\">`Form2`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> and set its <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Form.Text%2A&gt;</ph> property to <ph id=\"ph4\">`&amp;Special`</ph>.","source":"Add a top-level menu item to the `Form2`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Form.Text%2A> property to `&Special`."},{"pos":[2504,2665],"content":"Add two submenu items to the <ph id=\"ph1\">`&amp;Special`</ph> menu item and set their <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.Text%2A&gt;</ph> properties to <ph id=\"ph3\">`Command&amp;1`</ph> and <ph id=\"ph4\">`Command&amp;2`</ph>, respectively.","source":"Add two submenu items to the `&Special` menu item and set their <xref:System.Windows.Forms.Form.Text%2A> properties to `Command&1` and `Command&2`, respectively."},{"pos":[2674,2840],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MergeAction&gt;</ph> property of the <ph id=\"ph2\">`&amp;Special`</ph>, <ph id=\"ph3\">`Command&amp;1`</ph>, and <ph id=\"ph4\">`Command&amp;2`</ph> menu items to <ph id=\"ph5\">&lt;xref:System.Windows.Forms.MergeAction.Append&gt;</ph>.","source":"Set the <xref:System.Windows.Forms.MergeAction> property of the `&Special`, `Command&1`, and `Command&2` menu items to <xref:System.Windows.Forms.MergeAction.Append>."},{"pos":[2850,2989],"content":"Create an event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of the <ph id=\"ph2\">`&amp;New`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripMenuItem&gt;</ph>.","source":"Create an event handler for the <xref:System.Windows.Forms.Control.Click> event of the `&New`<xref:System.Windows.Forms.ToolStripMenuItem>."},{"pos":[2999,3149],"content":"Within the event handler, insert code similar to the following code example to create and display new instances of <ph id=\"ph1\">`Form2`</ph> as MDI children of <ph id=\"ph2\">`Form1`</ph>.","source":"Within the event handler, insert code similar to the following code example to create and display new instances of `Form2` as MDI children of `Form1`."},{"pos":[3870,4009],"content":"Place code similar to the following code example in the <ph id=\"ph1\">`&amp;Open`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripMenuItem&gt;</ph> to register the event handler.","source":"Place code similar to the following code example in the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem> to register the event handler."},{"pos":[4297,4315],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[4319,4341]},{"pos":[4351,4423],"content":"Two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph> controls named <ph id=\"ph2\">`Form1`</ph> and <ph id=\"ph3\">`Form2`</ph>.","source":"Two <xref:System.Windows.Forms.Form> controls named `Form1` and `Form2`."},{"pos":[4433,4594],"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> control on <ph id=\"ph2\">`Form1`</ph> named <ph id=\"ph3\">`menuStrip1`</ph>, and a <ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> control on <ph id=\"ph5\">`Form2`</ph> named <ph id=\"ph6\">`menuStrip2`</ph>.","source":"A <xref:System.Windows.Forms.MenuStrip> control on `Form1` named `menuStrip1`, and a <xref:System.Windows.Forms.MenuStrip> control on `Form2` named `menuStrip2`."},{"pos":[4604,4737],"content":"References to the <ph id=\"ph1\">&lt;xref:System?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms?displayProperty=nameWithType&gt;</ph> assemblies.","source":"References to the <xref:System?displayProperty=nameWithType> and <xref:System.Windows.Forms?displayProperty=nameWithType> assemblies."}]}