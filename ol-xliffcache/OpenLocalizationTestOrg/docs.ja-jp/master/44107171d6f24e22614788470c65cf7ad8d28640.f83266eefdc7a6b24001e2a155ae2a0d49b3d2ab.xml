{"content":"---\ntitle: \"Passing Arguments by Value and by Reference (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"ByRef keyword, passing arguments by reference\"\n  - \"Visual Basic code, procedures\"\n  - \"passing arguments, by value or by reference\"\n  - \"ByVal keyword, passing arguments by value\"\n  - \"arguments [Visual Basic], passing by value or by reference\"\n  - \"argument passing, by value or by reference\"\nms.assetid: fd8a9de6-7178-44d5-a9bf-458d4ad907c2\ncaps.latest.revision: 23\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Passing Arguments by Value and by Reference (Visual Basic)\nIn [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], you can pass an argument to a procedure *by value* or *by reference*. This is known as the *passing mechanism*, and it determines whether the procedure can modify the programming element underlying the argument in the calling code. The procedure declaration determines the passing mechanism for each parameter by specifying the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword.  \n  \n## Distinctions  \n When passing an argument to a procedure, be aware of several different distinctions that interact with each other:  \n  \n-   Whether the underlying programming element is modifiable or nonmodifiable  \n  \n-   Whether the argument itself is modifiable or nonmodifiable  \n  \n-   Whether the argument is being passed by value or by reference  \n  \n-   Whether the argument data type is a value type or a reference type  \n  \n For more information, see [Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md) and [Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md).  \n  \n## Choice of Passing Mechanism  \n You should choose the passing mechanism carefully for each argument.  \n  \n-   **Protection**. In choosing between the two passing mechanisms, the most important criterion is the exposure of calling variables to change. The advantage of passing an argument `ByRef` is that the procedure can return a value to the calling code through that argument. The advantage of passing an argument `ByVal` is that it protects a variable from being changed by the procedure.  \n  \n-   **Performance**. Although the passing mechanism can affect the performance of your code, the difference is usually insignificant. One exception to this is a value type passed `ByVal`. In this case, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] copies the entire data contents of the argument. Therefore, for a large value type such as a structure, it can be more efficient to pass it `ByRef`.  \n  \n     For reference types, only the pointer to the data is copied (four bytes on 32-bit platforms, eight bytes on 64-bit platforms). Therefore, you can pass arguments of type `String` or `Object` by value without harming performance.  \n  \n## Determination of the Passing Mechanism  \n The procedure declaration specifies the passing mechanism for each parameter. The calling code can't override a `ByVal` mechanism.  \n  \n If a parameter is declared with `ByRef`, the calling code can force the mechanism to `ByVal` by enclosing the argument name in parentheses in the call. For more information, see [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md).  \n  \n The default in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] is to pass arguments by value.  \n  \n## When to Pass an Argument by Value  \n  \n-   If the calling code element underlying the argument is a nonmodifiable element, declare the corresponding parameter [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md). No code can change the value of a nonmodifiable element.  \n  \n-   If the underlying element is modifiable, but you do not want the procedure to be able to change its value, declare the parameter `ByVal`. Only the calling code can change the value of a modifiable element passed by value.  \n  \n## When to Pass an Argument by Reference  \n  \n-   If the procedure has a genuine need to change the underlying element in the calling code, declare the corresponding parameter [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md).  \n  \n-   If the correct execution of the code depends on the procedure changing the underlying element in the calling code, declare the parameter `ByRef`. If you pass it by value, or if the calling code overrides the `ByRef` passing mechanism by enclosing the argument in parentheses, the procedure call might produce unexpected results.  \n  \n## Example  \n  \n### Description  \n The following example illustrates when to pass arguments by value and when to pass them by reference. Procedure `Calculate` has both a `ByVal` and a `ByRef` parameter. Given an interest rate, `rate`, and a sum of money, `debt`, the task of the procedure is to calculate a new value for `debt` that is the result of applying the interest rate to the original value of `debt`. Because `debt` is a `ByRef` parameter, the new total is reflected in the value of the argument in the calling code that corresponds to `debt`. Parameter `rate` is a `ByVal` parameter because `Calculate` should not change its value.  \n  \n### Code  \n [!code-vb[VbVbcnProcedures#74](./codesnippet/VisualBasic/passing-arguments-by-value-and-by-reference_1.vb)]  \n  \n## See Also  \n [Procedures](./index.md)   \n [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)   \n [How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)   \n [How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md)   \n [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)   \n [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)   \n [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)   \n [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)","nodes":[{"pos":[12,87],"content":"Passing Arguments by Value and by Reference (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Passing Arguments by Value and by Reference (Visual Basic) | Microsoft Docs","pos":[0,75]}]},{"pos":[882,940],"content":"Passing Arguments by Value and by Reference (Visual Basic)","linkify":"Passing Arguments by Value and by Reference (Visual Basic)","nodes":[{"content":"Passing Arguments by Value and by Reference (Visual Basic)","pos":[0,58]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>, you can pass an argument to a procedure <bpt id=\"p1\">*</bpt>by value<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>by reference<ept id=\"p2\">*</ept>.","pos":[941,1107],"source":"In [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], you can pass an argument to a procedure *by value* or *by reference*."},{"content":"This is known as the <bpt id=\"p1\">*</bpt>passing mechanism<ept id=\"p1\">*</ept>, and it determines whether the procedure can modify the programming element underlying the argument in the calling code.","pos":[1108,1269],"source":" This is known as the *passing mechanism*, and it determines whether the procedure can modify the programming element underlying the argument in the calling code."},{"content":"The procedure declaration determines the passing mechanism for each parameter by specifying the <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> or <bpt id=\"p2\">[</bpt>ByRef<ept id=\"p2\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept> keyword.","pos":[1270,1521],"source":" The procedure declaration determines the passing mechanism for each parameter by specifying the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword."},{"pos":[1530,1542],"content":"Distinctions","linkify":"Distinctions","nodes":[{"content":"Distinctions","pos":[0,12]}]},{"content":"When passing an argument to a procedure, be aware of several different distinctions that interact with each other:","pos":[1546,1660]},{"content":"Whether the underlying programming element is modifiable or nonmodifiable","pos":[1670,1743]},{"content":"Whether the argument itself is modifiable or nonmodifiable","pos":[1753,1811]},{"content":"Whether the argument is being passed by value or by reference","pos":[1821,1882]},{"content":"Whether the argument data type is a value type or a reference type","pos":[1892,1958]},{"pos":[1965,2261],"content":"For more information, see <bpt id=\"p1\">[</bpt>Differences Between Modifiable and Nonmodifiable Arguments<ept id=\"p1\">](./differences-between-modifiable-and-nonmodifiable-arguments.md)</ept> and <bpt id=\"p2\">[</bpt>Differences Between Passing an Argument By Value and By Reference<ept id=\"p2\">](./differences-between-passing-an-argument-by-value-and-by-reference.md)</ept>.","source":"For more information, see [Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md) and [Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)."},{"pos":[2270,2297],"content":"Choice of Passing Mechanism","linkify":"Choice of Passing Mechanism","nodes":[{"content":"Choice of Passing Mechanism","pos":[0,27]}]},{"content":"You should choose the passing mechanism carefully for each argument.","pos":[2301,2369]},{"content":"<bpt id=\"p1\">**</bpt>Protection<ept id=\"p1\">**</ept>.","pos":[2379,2394],"source":"**Protection**."},{"content":"In choosing between the two passing mechanisms, the most important criterion is the exposure of calling variables to change.","pos":[2395,2519]},{"content":"The advantage of passing an argument <ph id=\"ph1\">`ByRef`</ph> is that the procedure can return a value to the calling code through that argument.","pos":[2520,2648],"source":" The advantage of passing an argument `ByRef` is that the procedure can return a value to the calling code through that argument."},{"content":"The advantage of passing an argument <ph id=\"ph1\">`ByVal`</ph> is that it protects a variable from being changed by the procedure.","pos":[2649,2761],"source":" The advantage of passing an argument `ByVal` is that it protects a variable from being changed by the procedure."},{"content":"<bpt id=\"p1\">**</bpt>Performance<ept id=\"p1\">**</ept>.","pos":[2771,2787],"source":"**Performance**."},{"content":"Although the passing mechanism can affect the performance of your code, the difference is usually insignificant.","pos":[2788,2900]},{"content":"One exception to this is a value type passed <ph id=\"ph1\">`ByVal`</ph>.","pos":[2901,2954],"source":" One exception to this is a value type passed `ByVal`."},{"content":"In this case, <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> copies the entire data contents of the argument.","pos":[2955,3110],"source":" In this case, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] copies the entire data contents of the argument."},{"content":"Therefore, for a large value type such as a structure, it can be more efficient to pass it <ph id=\"ph1\">`ByRef`</ph>.","pos":[3111,3210],"source":" Therefore, for a large value type such as a structure, it can be more efficient to pass it `ByRef`."},{"content":"For reference types, only the pointer to the data is copied (four bytes on 32-bit platforms, eight bytes on 64-bit platforms).","pos":[3221,3347]},{"content":"Therefore, you can pass arguments of type <ph id=\"ph1\">`String`</ph> or <ph id=\"ph2\">`Object`</ph> by value without harming performance.","pos":[3348,3448],"source":" Therefore, you can pass arguments of type `String` or `Object` by value without harming performance."},{"pos":[3457,3495],"content":"Determination of the Passing Mechanism","linkify":"Determination of the Passing Mechanism","nodes":[{"content":"Determination of the Passing Mechanism","pos":[0,38]}]},{"content":"The procedure declaration specifies the passing mechanism for each parameter.","pos":[3499,3576]},{"content":"The calling code can't override a <ph id=\"ph1\">`ByVal`</ph> mechanism.","pos":[3577,3629],"source":" The calling code can't override a `ByVal` mechanism."},{"content":"If a parameter is declared with <ph id=\"ph1\">`ByRef`</ph>, the calling code can force the mechanism to <ph id=\"ph2\">`ByVal`</ph> by enclosing the argument name in parentheses in the call.","pos":[3636,3787],"source":"If a parameter is declared with `ByRef`, the calling code can force the mechanism to `ByVal` by enclosing the argument name in parentheses in the call."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Force an Argument to Be Passed by Value<ept id=\"p1\">](./how-to-force-an-argument-to-be-passed-by-value.md)</ept>.","pos":[3788,3917],"source":" For more information, see [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)."},{"pos":[3924,4062],"content":"The default in <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> is to pass arguments by value.","source":"The default in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] is to pass arguments by value."},{"pos":[4071,4104],"content":"When to Pass an Argument by Value","linkify":"When to Pass an Argument by Value","nodes":[{"content":"When to Pass an Argument by Value","pos":[0,33]}]},{"content":"If the calling code element underlying the argument is a nonmodifiable element, declare the corresponding parameter <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept>.","pos":[4114,4302],"source":"If the calling code element underlying the argument is a nonmodifiable element, declare the corresponding parameter [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md)."},{"content":"No code can change the value of a nonmodifiable element.","pos":[4303,4359]},{"content":"If the underlying element is modifiable, but you do not want the procedure to be able to change its value, declare the parameter <ph id=\"ph1\">`ByVal`</ph>.","pos":[4369,4506],"source":"If the underlying element is modifiable, but you do not want the procedure to be able to change its value, declare the parameter `ByVal`."},{"content":"Only the calling code can change the value of a modifiable element passed by value.","pos":[4507,4590]},{"pos":[4599,4636],"content":"When to Pass an Argument by Reference","linkify":"When to Pass an Argument by Reference","nodes":[{"content":"When to Pass an Argument by Reference","pos":[0,37]}]},{"pos":[4646,4844],"content":"If the procedure has a genuine need to change the underlying element in the calling code, declare the corresponding parameter <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept>.","source":"If the procedure has a genuine need to change the underlying element in the calling code, declare the corresponding parameter [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md)."},{"content":"If the correct execution of the code depends on the procedure changing the underlying element in the calling code, declare the parameter <ph id=\"ph1\">`ByRef`</ph>.","pos":[4854,4999],"source":"If the correct execution of the code depends on the procedure changing the underlying element in the calling code, declare the parameter `ByRef`."},{"content":"If you pass it by value, or if the calling code overrides the <ph id=\"ph1\">`ByRef`</ph> passing mechanism by enclosing the argument in parentheses, the procedure call might produce unexpected results.","pos":[5000,5182],"source":" If you pass it by value, or if the calling code overrides the `ByRef` passing mechanism by enclosing the argument in parentheses, the procedure call might produce unexpected results."},{"pos":[5191,5198],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5208,5219],"content":"Description","linkify":"Description","nodes":[{"content":"Description","pos":[0,11]}]},{"content":"The following example illustrates when to pass arguments by value and when to pass them by reference.","pos":[5223,5324]},{"content":"Procedure <ph id=\"ph1\">`Calculate`</ph> has both a <ph id=\"ph2\">`ByVal`</ph> and a <ph id=\"ph3\">`ByRef`</ph> parameter.","pos":[5325,5390],"source":" Procedure `Calculate` has both a `ByVal` and a `ByRef` parameter."},{"content":"Given an interest rate, <ph id=\"ph1\">`rate`</ph>, and a sum of money, <ph id=\"ph2\">`debt`</ph>, the task of the procedure is to calculate a new value for <ph id=\"ph3\">`debt`</ph> that is the result of applying the interest rate to the original value of <ph id=\"ph4\">`debt`</ph>.","pos":[5391,5597],"source":" Given an interest rate, `rate`, and a sum of money, `debt`, the task of the procedure is to calculate a new value for `debt` that is the result of applying the interest rate to the original value of `debt`."},{"content":"Because <ph id=\"ph1\">`debt`</ph> is a <ph id=\"ph2\">`ByRef`</ph> parameter, the new total is reflected in the value of the argument in the calling code that corresponds to <ph id=\"ph3\">`debt`</ph>.","pos":[5598,5740],"source":" Because `debt` is a `ByRef` parameter, the new total is reflected in the value of the argument in the calling code that corresponds to `debt`."},{"content":"Parameter <ph id=\"ph1\">`rate`</ph> is a <ph id=\"ph2\">`ByVal`</ph> parameter because <ph id=\"ph3\">`Calculate`</ph> should not change its value.","pos":[5741,5829],"source":" Parameter `rate` is a `ByVal` parameter because `Calculate` should not change its value."},{"pos":[5839,5843],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[5847,5954],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnProcedures#74<ept id=\"p2\">](./codesnippet/VisualBasic/passing-arguments-by-value-and-by-reference_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnProcedures#74](./codesnippet/VisualBasic/passing-arguments-by-value-and-by-reference_1.vb)]"},{"pos":[5963,5971],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5975,6000],"source":"[Procedures](./index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept><ph id=\"ph1\"> </ph>","pos":[6003,6082],"source":" [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Pass Arguments to a Procedure<ept id=\"p1\">](./how-to-pass-arguments-to-a-procedure.md)</ept><ph id=\"ph1\"> </ph>","pos":[6085,6169],"source":" [How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Change the Value of a Procedure Argument<ept id=\"p1\">](./how-to-change-the-value-of-a-procedure-argument.md)</ept><ph id=\"ph1\"> </ph>","pos":[6172,6278],"source":" [How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Protect a Procedure Argument Against Value Changes<ept id=\"p1\">](./how-to-protect-a-procedure-argument-against-value-changes.md)</ept><ph id=\"ph1\"> </ph>","pos":[6281,6407],"source":" [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Force an Argument to Be Passed by Value<ept id=\"p1\">](./how-to-force-an-argument-to-be-passed-by-value.md)</ept><ph id=\"ph1\"> </ph>","pos":[6410,6514],"source":" [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Passing Arguments by Position and by Name<ept id=\"p1\">](./passing-arguments-by-position-and-by-name.md)</ept><ph id=\"ph1\"> </ph>","pos":[6517,6610],"source":" [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Value Types and Reference Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)</ept>","pos":[6613,6755],"source":" [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)"}]}