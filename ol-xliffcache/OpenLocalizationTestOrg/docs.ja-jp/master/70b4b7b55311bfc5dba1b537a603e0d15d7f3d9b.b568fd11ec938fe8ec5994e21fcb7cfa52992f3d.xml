{"content":"---\ntitle: \"Enabling Cross-Database Access in SQL Server\"\nms.date: \"03/30/2017\"\nms.assetid: 10663fb6-434c-4c81-8178-ec894b9cf895\n---\n# Enabling Cross-Database Access in SQL Server\nCross-database ownership chaining occurs when a procedure in one database depends on objects in another database. A cross-database ownership chain works in the same way as ownership chaining within a single database, except that an unbroken ownership chain requires that all the object owners are mapped to the same login account. If the source object in the source database and the target objects in the target databases are owned by the same login account, SQL Server does not check permissions on the target objects.  \n  \n## Off By Default  \n Ownership chaining across databases is turned off by default. Microsoft recommends that you disable cross-database ownership chaining because it exposes you to the following security risks:  \n  \n-   Database owners and members of the `db_ddladmin` or the `db_owners` database roles can create objects that are owned by other users. These objects can potentially target objects in other databases. This means that if you enable cross-database ownership chaining, you must fully trust these users with data in all databases.  \n  \n-   Users with CREATE DATABASE permission can create new databases and attach existing databases. If cross-database ownership chaining is enabled, these users can access objects in other databases that they might not have privileges in from the newly created or attached databases that they create.  \n  \n## Enabling Cross-database Ownership Chaining  \n Cross-database ownership chaining should only be enabled in environments where you can fully trust highly-privileged users. It can be configured during setup for all databases, or selectively for specific databases using the [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] commands `sp_configure` and `ALTER DATABASE`.  \n  \n To selectively configure cross-database ownership chaining, use `sp_configure` to turn it off for the server. Then use the ALTER DATABASE command with SET DB_CHAINING ON to configure cross-database ownership chaining for only the databases that require it.  \n  \n The following sample turns on cross-database ownership chaining for all databases:  \n  \n```  \nEXECUTE sp_configure 'show advanced', 1;  \nRECONFIGURE;  \nEXECUTE sp_configure 'cross db ownership chaining', 1;  \nRECONFIGURE;  \n```  \n  \n The following sample turns on cross-database ownership chaining for specific databases:  \n  \n```  \nALTER DATABASE Database1 SET DB_CHAINING ON;  \nALTER DATABASE Database2 SET DB_CHAINING ON;  \n```  \n  \n### Dynamic SQL  \n Cross-database ownership chaining does not work in cases where dynamically created SQL statements are executed unless the same user exists in both databases. You can work around this in SQL Server by creating a stored procedure that accesses data in another database and signing the procedure with a certificate that exists in both databases. This gives users access to the database resources used by the procedure without granting them database access or permissions.  \n  \n## External Resources  \n For more information, see the following resources.  \n  \n|Resource|Description|  \n|--------------|-----------------|  \n|[Extending Database Impersonation by Using EXECUTE AS](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms188304(v=sql.105)) and [Cross DB Ownership Chaining Option](/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option).|Articles describe how to configure cross-database ownership chaining for an instance of SQL Server.|  \n  \n## See also\n\n- [Securing ADO.NET Applications](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)\n- [Overview of SQL Server Security](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)\n- [Managing Permissions with Stored Procedures in SQL Server](../../../../../docs/framework/data/adonet/sql/managing-permissions-with-stored-procedures-in-sql-server.md)\n- [Writing Secure Dynamic SQL in SQL Server](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)\n- [Signing Stored Procedures in SQL Server](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,128],"embed":true,"restype":"x-metadata","content":"title: \"Enabling Cross-Database Access in SQL Server\"\nms.date: \"03/30/2017\"\nms.assetid: 10663fb6-434c-4c81-8178-ec894b9cf895","nodes":[{"content":"Enabling Cross-Database Access in SQL Server","nodes":[{"pos":[0,44],"content":"Enabling Cross-Database Access in SQL Server","nodes":[{"content":"Enabling Cross-Database Access in SQL Server","pos":[0,44]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[135,179],"content":"Enabling Cross-Database Access in SQL Server","linkify":"Enabling Cross-Database Access in SQL Server","nodes":[{"content":"Enabling Cross-Database Access in SQL Server","pos":[0,44]}]},{"content":"Cross-database ownership chaining occurs when a procedure in one database depends on objects in another database.","pos":[180,293]},{"content":"A cross-database ownership chain works in the same way as ownership chaining within a single database, except that an unbroken ownership chain requires that all the object owners are mapped to the same login account.","pos":[294,510]},{"content":"If the source object in the source database and the target objects in the target databases are owned by the same login account, SQL Server does not check permissions on the target objects.","pos":[511,699]},{"pos":[708,722],"content":"Off By Default","linkify":"Off By Default","nodes":[{"content":"Off By Default","pos":[0,14]}]},{"content":"Ownership chaining across databases is turned off by default.","pos":[726,787]},{"content":"Microsoft recommends that you disable cross-database ownership chaining because it exposes you to the following security risks:","pos":[788,915]},{"content":"Database owners and members of the <ph id=\"ph1\">`db_ddladmin`</ph> or the <ph id=\"ph2\">`db_owners`</ph> database roles can create objects that are owned by other users.","pos":[925,1057],"source":"Database owners and members of the `db_ddladmin` or the `db_owners` database roles can create objects that are owned by other users."},{"content":"These objects can potentially target objects in other databases.","pos":[1058,1122]},{"content":"This means that if you enable cross-database ownership chaining, you must fully trust these users with data in all databases.","pos":[1123,1248]},{"content":"Users with CREATE DATABASE permission can create new databases and attach existing databases.","pos":[1258,1351]},{"content":"If cross-database ownership chaining is enabled, these users can access objects in other databases that they might not have privileges in from the newly created or attached databases that they create.","pos":[1352,1552]},{"pos":[1561,1603],"content":"Enabling Cross-database Ownership Chaining","linkify":"Enabling Cross-database Ownership Chaining","nodes":[{"content":"Enabling Cross-database Ownership Chaining","pos":[0,42]}]},{"content":"Cross-database ownership chaining should only be enabled in environments where you can fully trust highly-privileged users.","pos":[1607,1730]},{"content":"It can be configured during setup for all databases, or selectively for specific databases using the <ph id=\"ph1\">[!INCLUDE[tsql](../../../../../includes/tsql-md.md)]</ph> commands <ph id=\"ph2\">`sp_configure`</ph> and <ph id=\"ph3\">`ALTER DATABASE`</ph>.","pos":[1731,1930],"source":" It can be configured during setup for all databases, or selectively for specific databases using the [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] commands `sp_configure` and `ALTER DATABASE`."},{"content":"To selectively configure cross-database ownership chaining, use <ph id=\"ph1\">`sp_configure`</ph> to turn it off for the server.","pos":[1937,2046],"source":"To selectively configure cross-database ownership chaining, use `sp_configure` to turn it off for the server."},{"content":"Then use the ALTER DATABASE command with SET DB_CHAINING ON to configure cross-database ownership chaining for only the databases that require it.","pos":[2047,2193]},{"content":"The following sample turns on cross-database ownership chaining for all databases:","pos":[2200,2282]},{"content":"The following sample turns on cross-database ownership chaining for specific databases:","pos":[2434,2521]},{"pos":[2640,2651],"content":"Dynamic SQL","linkify":"Dynamic SQL","nodes":[{"content":"Dynamic SQL","pos":[0,11]}]},{"content":"Cross-database ownership chaining does not work in cases where dynamically created SQL statements are executed unless the same user exists in both databases.","pos":[2655,2812]},{"content":"You can work around this in SQL Server by creating a stored procedure that accesses data in another database and signing the procedure with a certificate that exists in both databases.","pos":[2813,2997]},{"content":"This gives users access to the database resources used by the procedure without granting them database access or permissions.","pos":[2998,3123]},{"pos":[3132,3150],"content":"External Resources","linkify":"External Resources","nodes":[{"content":"External Resources","pos":[0,18]}]},{"content":"For more information, see the following resources.","pos":[3154,3204]},{"content":"Resource","pos":[3211,3219]},{"content":"Description","pos":[3220,3231]},{"pos":[3273,3554],"content":"<bpt id=\"p1\">[</bpt>Extending Database Impersonation by Using EXECUTE AS<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms188304(v=sql.105))</ept> and <bpt id=\"p2\">[</bpt>Cross DB Ownership Chaining Option<ept id=\"p2\">](/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option)</ept>.","source":"[Extending Database Impersonation by Using EXECUTE AS](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms188304(v=sql.105)) and [Cross DB Ownership Chaining Option](/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option)."},{"content":"Articles describe how to configure cross-database ownership chaining for an instance of SQL Server.","pos":[3555,3654]},{"pos":[3664,3672],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3676,3783],"content":"<bpt id=\"p1\">[</bpt>Securing ADO.NET Applications<ept id=\"p1\">](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)</ept>","source":"[Securing ADO.NET Applications](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)"},{"pos":[3786,3901],"content":"<bpt id=\"p1\">[</bpt>Overview of SQL Server Security<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)</ept>","source":"[Overview of SQL Server Security](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)"},{"pos":[3904,4071],"content":"<bpt id=\"p1\">[</bpt>Managing Permissions with Stored Procedures in SQL Server<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/managing-permissions-with-stored-procedures-in-sql-server.md)</ept>","source":"[Managing Permissions with Stored Procedures in SQL Server](../../../../../docs/framework/data/adonet/sql/managing-permissions-with-stored-procedures-in-sql-server.md)"},{"pos":[4074,4207],"content":"<bpt id=\"p1\">[</bpt>Writing Secure Dynamic SQL in SQL Server<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)</ept>","source":"[Writing Secure Dynamic SQL in SQL Server](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)"},{"pos":[4210,4341],"content":"<bpt id=\"p1\">[</bpt>Signing Stored Procedures in SQL Server<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)</ept>","source":"[Signing Stored Procedures in SQL Server](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)"},{"pos":[4344,4448],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}