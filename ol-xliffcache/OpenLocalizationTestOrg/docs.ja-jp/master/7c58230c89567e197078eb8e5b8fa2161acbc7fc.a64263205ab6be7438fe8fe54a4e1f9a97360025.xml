{"content":"---\ntitle: \"How to: Compress and Extract Files | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"I/O [.NET Framework], compression\"\n  - \"compression\"\n  - \"compress files\"\nms.assetid: e9876165-3c60-4c84-a272-513e47acf579\ncaps.latest.revision: 19\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# How to: Compress and Extract Files\nThe <xref:System.IO.Compression> namespace contains the following types for compressing and decompressing files and streams. You can also use these types to read and modify the contents of a compressed file:  \n  \n-   <xref:System.IO.Compression.ZipFile>  \n  \n-   <xref:System.IO.Compression.ZipArchive>  \n  \n-   <xref:System.IO.Compression.ZipArchiveEntry>  \n  \n-   <xref:System.IO.Compression.DeflateStream>  \n  \n-   <xref:System.IO.Compression.GZipStream>  \n  \n The following examples show some of the functions you can perform when working with compressed files.  \n  \n## Example  \n This example shows how to create and extract a compressed file that has a .zip file name extension by using the <xref:System.IO.Compression.ZipFile> class. It compresses the contents of a folder into a new .zip file and then extracts that content to a new folder. To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.  \n  \n [!code-csharp[System.IO.Compression.ZipFile#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipFile#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)]  \n  \n## Example  \n The next example shows how to iterate through the contents of an existing .zip file and extract files that have a .txt extension. It uses the <xref:System.IO.Compression.ZipArchive> class to access an existing .zip file, and the <xref:System.IO.Compression.ZipArchiveEntry> class to inspect the individual entries in the compressed file. It uses an extension method (<xref:System.IO.Compression.ZipFileExtensions.ExtractToFile%2A>) for the <xref:System.IO.Compression.ZipArchiveEntry> object. The extension method is available in the <xref:System.IO.Compression.ZipFileExtensions?displayProperty=fullName> class. To use the <xref:System.IO.Compression.ZipFileExtensions> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.  \n  \n [!code-csharp[System.IO.Compression.ZipArchive#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipArchive#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program1.vb#1)]  \n  \n## Example  \n The next example uses the <xref:System.IO.Compression.ZipArchive> class to access an existing .zip file, and adds a new file to the compressed file. The new file gets compressed when you add it to the existing .zip file.  \n  \n [!code-csharp[System.IO.Compression.ZipArchiveMode#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipArchiveMode#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/vb/program1.vb#1)]  \n  \n## Example  \n You can also use the <xref:System.IO.Compression.GZipStream> and <xref:System.IO.Compression.DeflateStream> classes to compress and decompress data. They use the same compression algorithm. Compressed <xref:System.IO.Compression.GZipStream> objects that are written to a file that has an extension of .gz can be decompressed by using many common tools in addition to the methods provided by <xref:System.IO.Compression.GZipStream>. This example shows how to compress and decompress a directory of files by using the <xref:System.IO.Compression.GZipStream> class.  \n  \n [!code-csharp[IO.Compression.GZip1#1](../../../samples/snippets/csharp/VS_Snippets_CLR/IO.Compression.GZip1/CS/gziptest.cs#1)]\n [!code-vb[IO.Compression.GZip1#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/IO.Compression.GZip1/VB/gziptest.vb#1)]  \n  \n## See Also  \n <xref:System.IO.Compression.ZipArchive>   \n <xref:System.IO.Compression.ZipFile>   \n <xref:System.IO.Compression.ZipArchiveEntry>   \n <xref:System.IO.Compression.DeflateStream>   \n <xref:System.IO.Compression.GZipStream>   \n [File and Stream I-O](../../../docs/standard/io/index.md)\n","nodes":[{"pos":[12,63],"content":"How to: Compress and Extract Files | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Compress and Extract Files | Microsoft Docs","pos":[0,51]}]},{"pos":[453,487],"content":"How to: Compress and Extract Files","linkify":"How to: Compress and Extract Files","nodes":[{"content":"How to: Compress and Extract Files","pos":[0,34]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.IO.Compression&gt;</ph> namespace contains the following types for compressing and decompressing files and streams.","pos":[488,612],"source":"The <xref:System.IO.Compression> namespace contains the following types for compressing and decompressing files and streams."},{"content":"You can also use these types to read and modify the contents of a compressed file:","pos":[613,695]},{"content":"The following examples show some of the functions you can perform when working with compressed files.","pos":[952,1053]},{"pos":[1062,1069],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example shows how to create and extract a compressed file that has a .zip file name extension by using the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipFile&gt;</ph> class.","pos":[1073,1228],"source":"This example shows how to create and extract a compressed file that has a .zip file name extension by using the <xref:System.IO.Compression.ZipFile> class."},{"content":"It compresses the contents of a folder into a new .zip file and then extracts that content to a new folder.","pos":[1229,1336]},{"content":"To use the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipFile&gt;</ph> class, you must reference the <ph id=\"ph2\">`System.IO.Compression.FileSystem`</ph> assembly in your project.","pos":[1337,1475],"source":" To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project."},{"pos":[1482,1787],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.IO.Compression.ZipFile#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.IO.Compression.ZipFile#1<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.IO.Compression.ZipFile#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipFile#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)]"},{"pos":[1796,1803],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The next example shows how to iterate through the contents of an existing .zip file and extract files that have a .txt extension.","pos":[1807,1936]},{"content":"It uses the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipArchive&gt;</ph> class to access an existing .zip file, and the <ph id=\"ph2\">&lt;xref:System.IO.Compression.ZipArchiveEntry&gt;</ph> class to inspect the individual entries in the compressed file.","pos":[1937,2144],"source":" It uses the <xref:System.IO.Compression.ZipArchive> class to access an existing .zip file, and the <xref:System.IO.Compression.ZipArchiveEntry> class to inspect the individual entries in the compressed file."},{"content":"It uses an extension method (<ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipFileExtensions.ExtractToFile%2A&gt;</ph>) for the <ph id=\"ph2\">&lt;xref:System.IO.Compression.ZipArchiveEntry&gt;</ph> object.","pos":[2145,2299],"source":" It uses an extension method (<xref:System.IO.Compression.ZipFileExtensions.ExtractToFile%2A>) for the <xref:System.IO.Compression.ZipArchiveEntry> object."},{"content":"The extension method is available in the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipFileExtensions?displayProperty=fullName&gt;</ph> class.","pos":[2300,2419],"source":" The extension method is available in the <xref:System.IO.Compression.ZipFileExtensions?displayProperty=fullName> class."},{"content":"To use the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipFileExtensions&gt;</ph> class, you must reference the <ph id=\"ph2\">`System.IO.Compression.FileSystem`</ph> assembly in your project.","pos":[2420,2568],"source":" To use the <xref:System.IO.Compression.ZipFileExtensions> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project."},{"pos":[2575,2892],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.IO.Compression.ZipArchive#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program1.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.IO.Compression.ZipArchive#1<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program1.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.IO.Compression.ZipArchive#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipArchive#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program1.vb#1)]"},{"pos":[2901,2908],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The next example uses the <ph id=\"ph1\">&lt;xref:System.IO.Compression.ZipArchive&gt;</ph> class to access an existing .zip file, and adds a new file to the compressed file.","pos":[2912,3060],"source":"The next example uses the <xref:System.IO.Compression.ZipArchive> class to access an existing .zip file, and adds a new file to the compressed file."},{"content":"The new file gets compressed when you add it to the existing .zip file.","pos":[3061,3132]},{"pos":[3139,3472],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.IO.Compression.ZipArchiveMode#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/cs/program1.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.IO.Compression.ZipArchiveMode#1<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/vb/program1.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.IO.Compression.ZipArchiveMode#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/cs/program1.cs#1)]\n [!code-vb[System.IO.Compression.ZipArchiveMode#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/vb/program1.vb#1)]"},{"pos":[3481,3488],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.IO.Compression.GZipStream&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.IO.Compression.DeflateStream&gt;</ph> classes to compress and decompress data.","pos":[3492,3640],"source":"You can also use the <xref:System.IO.Compression.GZipStream> and <xref:System.IO.Compression.DeflateStream> classes to compress and decompress data."},{"content":"They use the same compression algorithm.","pos":[3641,3681]},{"content":"Compressed <ph id=\"ph1\">&lt;xref:System.IO.Compression.GZipStream&gt;</ph> objects that are written to a file that has an extension of .gz can be decompressed by using many common tools in addition to the methods provided by <ph id=\"ph2\">&lt;xref:System.IO.Compression.GZipStream&gt;</ph>.","pos":[3682,3923],"source":" Compressed <xref:System.IO.Compression.GZipStream> objects that are written to a file that has an extension of .gz can be decompressed by using many common tools in addition to the methods provided by <xref:System.IO.Compression.GZipStream>."},{"content":"This example shows how to compress and decompress a directory of files by using the <ph id=\"ph1\">&lt;xref:System.IO.Compression.GZipStream&gt;</ph> class.","pos":[3924,4054],"source":" This example shows how to compress and decompress a directory of files by using the <xref:System.IO.Compression.GZipStream> class."},{"pos":[4061,4316],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>IO.Compression.GZip1#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/IO.Compression.GZip1/CS/gziptest.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>IO.Compression.GZip1#1<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/IO.Compression.GZip1/VB/gziptest.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[IO.Compression.GZip1#1](../../../samples/snippets/csharp/VS_Snippets_CLR/IO.Compression.GZip1/CS/gziptest.cs#1)]\n [!code-vb[IO.Compression.GZip1#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/IO.Compression.GZip1/VB/gziptest.vb#1)]"},{"pos":[4325,4333],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>File and Stream I-O<ept id=\"p1\">](../../../docs/standard/io/index.md)</ept>","pos":[4561,4619],"source":" [File and Stream I-O](../../../docs/standard/io/index.md)"}]}