{"content":"---\ntitle: \"How to: Create a Windows Forms Control That Shows Progress\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"controls [Windows Forms], progress tracking\"\n  - \"controls [Windows Forms], creating\"\n  - \"progress [Windows Forms], reporting [Windows Forms]\"\n  - \"FlashTrackBar custom control\"\nms.assetid: 24c5a2e3-058c-4b8d-a217-c06e6a130c2f\n---\n# How to: Create a Windows Forms Control That Shows Progress\nThe following code example shows a custom control called `FlashTrackBar` that can be used to show the user the level or the progress of an application. It uses a gradient to visually represent progress.  \n  \n The `FlashTrackBar` control illustrates the following concepts:  \n  \n-   Defining custom properties.  \n  \n-   Defining custom events. (`FlashTrackBar` defines the `ValueChanged` event.)  \n  \n-   Overriding the <xref:System.Windows.Forms.Control.OnPaint%2A> method to provide logic to draw the control.  \n  \n-   Computing the area available for drawing the control by using its <xref:System.Windows.Forms.Control.ClientRectangle%2A> property. `FlashTrackBar` does this in its `OptimizedInvalidate` method.  \n  \n-   Implementing serialization or persistence for a property when it is changed in the Windows Forms Designer. `FlashTrackBar` defines the `ShouldSerializeStartColor` and `ShouldSerializeEndColor` methods for serializing its `StartColor` and `EndColor` properties.  \n  \n The following table shows the custom properties defined by `FlashTrackBar`.  \n  \n|Property|Description|  \n|--------------|-----------------|  \n|`AllowUserEdit`|Indicates whether the user can change the value of the flash track bar by clicking and dragging it.|  \n|`EndColor`|Specifies the ending color of the track bar.|  \n|`DarkenBy`|Specifies how much to darken the background with respect to the foreground gradient.|  \n|`Max`|Specifies the maximum value of the track bar.|  \n|`Min`|Specifies the minimum value of the track bar.|  \n|`StartColor`|Specifies the starting color of the gradient.|  \n|`ShowPercentage`|Indicates whether to display a percentage over the gradient.|  \n|`ShowValue`|Indicates whether to display the current value over the gradient.|  \n|`ShowGradient`|Indicates whether the track bar should display a color gradient showing the current value.|  \n|-   `Value`|Specifies the current value of the track bar.|  \n  \n The following table shows additional members defined by `FlashTrackBar:` the property-changed event and the method that raises the event.  \n  \n|Member|Description|  \n|------------|-----------------|  \n|`ValueChanged`|The event that is raised when the `Value` property of the track bar changes.|  \n|`OnValueChanged`|The method that raises the `ValueChanged` event.|  \n  \n> [!NOTE]\n>  `FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate.  \n  \n To handle the corresponding *EventName* events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=nameWithType>:  \n  \n-   <xref:System.Windows.Forms.Control.OnPaint%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseDown%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseMove%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseUp%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnResize%2A>  \n  \n To handle the corresponding property-changed events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=nameWithType>:  \n  \n-   <xref:System.Windows.Forms.Control.OnBackColorChanged%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnBackgroundImageChanged%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnTextChanged%2A>  \n  \n## Example  \n The `FlashTrackBar` control defines two UI type editors, `FlashTrackBarValueEditor` and `FlashTrackBarDarkenByEditor`, which are shown in the following code listings. The `HostApp` class uses the `FlashTrackBar` control on a Windows Form.  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBar.cs#1)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBar.vb#1)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarDarkenByEditor.cs#10)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarDarkenByEditor.vb#10)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarValueEditor.cs#20)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarValueEditor.vb#20)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/HostApp.cs#30)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/HostApp.vb#30)]  \n  \n## See also\n\n- [Extending Design-Time Support](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))\n- [Windows Forms Control Development Basics](windows-forms-control-development-basics.md)\n","nodes":[{"pos":[4,382],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Windows Forms Control That Shows Progress\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"controls [Windows Forms], progress tracking\"\n  - \"controls [Windows Forms], creating\"\n  - \"progress [Windows Forms], reporting [Windows Forms]\"\n  - \"FlashTrackBar custom control\"\nms.assetid: 24c5a2e3-058c-4b8d-a217-c06e6a130c2f","nodes":[{"content":"How to: Create a Windows Forms Control That Shows Progress","nodes":[{"pos":[0,58],"content":"How to: Create a Windows Forms Control That Shows Progress","nodes":[{"content":"How to: Create a Windows Forms Control That Shows Progress","pos":[0,58]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[389,447],"content":"How to: Create a Windows Forms Control That Shows Progress","linkify":"How to: Create a Windows Forms Control That Shows Progress","nodes":[{"content":"How to: Create a Windows Forms Control That Shows Progress","pos":[0,58]}]},{"content":"The following code example shows a custom control called <ph id=\"ph1\">`FlashTrackBar`</ph> that can be used to show the user the level or the progress of an application.","pos":[448,599],"source":"The following code example shows a custom control called `FlashTrackBar` that can be used to show the user the level or the progress of an application."},{"content":"It uses a gradient to visually represent progress.","pos":[600,650]},{"pos":[657,720],"content":"The <ph id=\"ph1\">`FlashTrackBar`</ph> control illustrates the following concepts:","source":"The `FlashTrackBar` control illustrates the following concepts:"},{"content":"Defining custom properties.","pos":[730,757]},{"content":"Defining custom events.","pos":[767,790]},{"content":"(<ph id=\"ph1\">`FlashTrackBar`</ph> defines the <ph id=\"ph2\">`ValueChanged`</ph> event.)","pos":[791,842],"source":" (`FlashTrackBar` defines the `ValueChanged` event.)"},{"pos":[852,958],"content":"Overriding the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method to provide logic to draw the control.","source":"Overriding the <xref:System.Windows.Forms.Control.OnPaint%2A> method to provide logic to draw the control."},{"content":"Computing the area available for drawing the control by using its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.ClientRectangle%2A&gt;</ph> property.","pos":[968,1098],"source":"Computing the area available for drawing the control by using its <xref:System.Windows.Forms.Control.ClientRectangle%2A> property."},{"content":"<ph id=\"ph1\">`FlashTrackBar`</ph> does this in its <ph id=\"ph2\">`OptimizedInvalidate`</ph> method.","pos":[1099,1161],"source":"`FlashTrackBar` does this in its `OptimizedInvalidate` method."},{"content":"Implementing serialization or persistence for a property when it is changed in the Windows Forms Designer.","pos":[1171,1277]},{"content":"<ph id=\"ph1\">`FlashTrackBar`</ph> defines the <ph id=\"ph2\">`ShouldSerializeStartColor`</ph> and <ph id=\"ph3\">`ShouldSerializeEndColor`</ph> methods for serializing its <ph id=\"ph4\">`StartColor`</ph> and <ph id=\"ph5\">`EndColor`</ph> properties.","pos":[1278,1431],"source":"`FlashTrackBar` defines the `ShouldSerializeStartColor` and `ShouldSerializeEndColor` methods for serializing its `StartColor` and `EndColor` properties."},{"pos":[1438,1513],"content":"The following table shows the custom properties defined by <ph id=\"ph1\">`FlashTrackBar`</ph>.","source":"The following table shows the custom properties defined by `FlashTrackBar`."},{"content":"Property","pos":[1520,1528]},{"content":"Description","pos":[1529,1540]},{"content":"Indicates whether the user can change the value of the flash track bar by clicking and dragging it.","pos":[1598,1697]},{"content":"Specifies the ending color of the track bar.","pos":[1713,1757]},{"content":"Specifies how much to darken the background with respect to the foreground gradient.","pos":[1773,1857]},{"content":"Specifies the maximum value of the track bar.","pos":[1868,1913]},{"content":"Specifies the minimum value of the track bar.","pos":[1924,1969]},{"content":"Specifies the starting color of the gradient.","pos":[1987,2032]},{"content":"Indicates whether to display a percentage over the gradient.","pos":[2054,2114]},{"content":"Indicates whether to display the current value over the gradient.","pos":[2131,2196]},{"content":"Indicates whether the track bar should display a color gradient showing the current value.","pos":[2216,2306]},{"content":"Specifies the current value of the track bar.","pos":[2323,2368]},{"pos":[2376,2513],"content":"The following table shows additional members defined by <ph id=\"ph1\">`FlashTrackBar:`</ph> the property-changed event and the method that raises the event.","source":"The following table shows additional members defined by `FlashTrackBar:` the property-changed event and the method that raises the event."},{"content":"Member","pos":[2520,2526]},{"content":"Description","pos":[2527,2538]},{"pos":[2593,2669],"content":"The event that is raised when the <ph id=\"ph1\">`Value`</ph> property of the track bar changes.","source":"The event that is raised when the `Value` property of the track bar changes."},{"pos":[2691,2739],"content":"The method that raises the <ph id=\"ph1\">`ValueChanged`</ph> event.","source":"The method that raises the `ValueChanged` event."},{"pos":[2748,2883],"content":"[!NOTE]\n `FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">`FlashTrackBar`</ph> uses the <ph id=\"ph2\">&lt;xref:System.EventArgs&gt;</ph> class for event data and <ph id=\"ph3\">&lt;xref:System.EventHandler&gt;</ph> for the event delegate.","pos":[9,133],"source":"`FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate."}]},{"pos":[2890,3073],"content":"To handle the corresponding <bpt id=\"p1\">*</bpt>EventName<ept id=\"p1\">*</ept> events, <ph id=\"ph1\">`FlashTrackBar`</ph> overrides the following methods that it inherits from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control?displayProperty=nameWithType&gt;</ph>:","source":"To handle the corresponding *EventName* events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=nameWithType>:"},{"pos":[3371,3559],"content":"To handle the corresponding property-changed events, <ph id=\"ph1\">`FlashTrackBar`</ph> overrides the following methods that it inherits from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control?displayProperty=nameWithType&gt;</ph>:","source":"To handle the corresponding property-changed events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=nameWithType>:"},{"pos":[3770,3777],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`FlashTrackBar`</ph> control defines two UI type editors, <ph id=\"ph2\">`FlashTrackBarValueEditor`</ph> and <ph id=\"ph3\">`FlashTrackBarDarkenByEditor`</ph>, which are shown in the following code listings.","pos":[3781,3947],"source":"The `FlashTrackBar` control defines two UI type editors, `FlashTrackBarValueEditor` and `FlashTrackBarDarkenByEditor`, which are shown in the following code listings."},{"content":"The <ph id=\"ph1\">`HostApp`</ph> class uses the <ph id=\"ph2\">`FlashTrackBar`</ph> control on a Windows Form.","pos":[3948,4019],"source":" The `HostApp` class uses the `FlashTrackBar` control on a Windows Form."},{"pos":[5374,5382],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5386,5514],"content":"<bpt id=\"p1\">[</bpt>Extending Design-Time Support<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))</ept>","source":"[Extending Design-Time Support](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))"},{"pos":[5517,5604],"content":"<bpt id=\"p1\">[</bpt>Windows Forms Control Development Basics<ept id=\"p1\">](windows-forms-control-development-basics.md)</ept>","source":"[Windows Forms Control Development Basics](windows-forms-control-development-basics.md)"}]}