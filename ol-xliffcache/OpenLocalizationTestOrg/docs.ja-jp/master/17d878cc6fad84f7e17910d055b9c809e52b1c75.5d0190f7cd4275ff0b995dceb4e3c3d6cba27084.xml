{"content":"---\ntitle: \"Attached Properties Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"attached properties [WPF Designer]\"\nms.assetid: 75928354-dc01-47e8-a018-8409aec1f32d\ncaps.latest.revision: 28\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Attached Properties Overview\nAn attached property is a concept defined by XAML. An attached property is intended to be used as a type of global property that is settable on any object. In [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], attached properties are typically defined as a specialized form of dependency property that does not have the conventional property \"wrapper\".  \n  \n   \n<a name=\"prerequisites\"></a>   \n## Prerequisites  \n This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md). To follow the examples in this topic, you should also understand XAML and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications.  \n  \n<a name=\"attached_properties_usage\"></a>   \n## Why Use Attached Properties  \n One purpose of an attached property is to allow different child elements to specify unique values for a property that is actually defined in a parent element. A specific application of this scenario is having child elements inform the parent element of how they are to be presented in the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]. One example is the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> property. The <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> property is created as an attached property because it is designed to be set on elements that are contained within a <xref:System.Windows.Controls.DockPanel>, rather than on <xref:System.Windows.Controls.DockPanel> itself. The <xref:System.Windows.Controls.DockPanel> class defines the static <xref:System.Windows.DependencyProperty> field named <xref:System.Windows.Controls.DockPanel.DockProperty>, and then provides the <xref:System.Windows.Controls.DockPanel.GetDock%2A> and <xref:System.Windows.Controls.DockPanel.SetDock%2A> methods as public accessors for the attached property.  \n  \n<a name=\"attached_properties_xaml\"></a>   \n## Attached Properties in XAML  \n In XAML, you set attached properties by using the syntax *AttachedPropertyProvider*.*PropertyName*  \n  \n The following is an example of how you can set <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> in XAML:  \n  \n [!code-xml[PropertiesOvwSupport#APBasicUsage](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml#apbasicusage)]  \n  \n Note that the usage is somewhat similar to a static property; you always reference the type <xref:System.Windows.Controls.DockPanel> that owns and registers the attached property, rather than referring to any instance specified by name.  \n  \n Also, because an attached property in XAML is an attribute that you set in markup, only the set operation has any relevance. You cannot directly get a property in XAML, although there are some indirect mechanisms for comparing values, such as triggers in styles (for details, see [Styling and Templating](../../../../docs/framework/wpf/controls/styling-and-templating.md)).  \n  \n### Attached Property Implementation in WPF  \n In [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], most of the attached properties that exist on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] types that are related to UI presentation are implemented as dependency properties. Attached properties are a XAML concept, whereas dependency properties are a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] concept. Because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] attached properties are dependency properties, they support dependency property concepts such as property metadata, and default values from that property metadata.  \n  \n<a name=\"howused\"></a>   \n## How Attached Properties Are Used by the Owning Type  \n Although attached properties are settable on any object, that does not automatically mean that setting the property will produce a tangible result, or that the value will ever be used by another object. Generally, attached properties are intended so that objects coming from a wide variety of possible class hierarchies or logical relationships can each report common information to the type that defines the attached property. The type that defines the attached property typically follows one of these models:  \n  \n-   The type that defines the attached property is designed so that it can be the parent element of the elements that will set values for the attached property. The type then iterates its child objects through internal logic against some object tree structure, obtains the values, and acts on those values in some manner.  \n  \n-   The type that defines the attached property will be used as the child element for a variety of possible parent elements and content models.  \n  \n-   The type that defines the attached property represents a service. Other types set values for the attached property. Then, when the element that set the property is evaluated in the context of the service, the attached property values are obtained through internal logic of the service class.  \n  \n### An Example of a Parent-Defined Attached Property  \n The most typical scenario where [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines an attached property is when a parent element supports a child element collection, and also implements a behavior where the specifics of the behavior are reported individually for each child element.  \n  \n <xref:System.Windows.Controls.DockPanel> defines the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> attached property, and <xref:System.Windows.Controls.DockPanel> has class-level code as part of its rendering logic (specifically, <xref:System.Windows.Controls.DockPanel.MeasureOverride%2A> and <xref:System.Windows.Controls.DockPanel.ArrangeOverride%2A>). A <xref:System.Windows.Controls.DockPanel> instance will always check to see whether any of its immediate child elements have set a value for <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName>. If so, those values become input for the rendering logic applied to that particular child element. Nested <xref:System.Windows.Controls.DockPanel> instances each treat their own immediate child element collections, but that behavior is implementation-specific to how <xref:System.Windows.Controls.DockPanel> processes <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> values. It is theoretically possible to have attached properties that influence elements beyond the immediate parent. If the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> attached property is set on an element that has no <xref:System.Windows.Controls.DockPanel> parent element to act upon it, no error or exception is raised. This simply means that a global property value was set, but it has no current <xref:System.Windows.Controls.DockPanel> parent that could consume the information.  \n  \n<a name=\"attached_properties_code\"></a>   \n## Attached Properties in Code  \n Attached properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do not have the typical [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] \"wrapper\" methods for easy get/set access. This is because the attached property is not necessarily part of the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] namespace for instances where the property is set. However, a XAML processor must be able to set those values when XAML is parsed. To support an effective attached property usage, the owner type of the attached property must implement dedicated accessor methods in the form `Get`*PropertyName* and `Set`*PropertyName*. These dedicated accessor methods are also useful to get or set the attached property in code. From a code perspective, an attached property is similar to a backing field that has method accessors instead of property accessors, and that backing field can exist on any object rather than needing to be specifically defined.  \n  \n The following example shows how you can set an attached property in code. In this example, `myCheckBox` is an instance of the <xref:System.Windows.Controls.CheckBox> class.  \n  \n [!code-csharp[PropertiesOvwSupport#APCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#apcode)]\n [!code-vb[PropertiesOvwSupport#APCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#apcode)]  \n  \n Similar to the XAML case, if `myCheckBox` had not already been added as a child element of `myDockPanel` by the third line of code, the fourth line of code would not raise an exception, but the property value would not interact with a <xref:System.Windows.Controls.DockPanel> parent and thus would do nothing. Only a <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> value set on a child element combined with the presence of a <xref:System.Windows.Controls.DockPanel> parent element will cause an effective behavior in the rendered application. (In this case, you could set the attached property, then attach to the tree. Or you could attach to the tree then set the attached property. Either action order provides the same result.)  \n  \n<a name=\"attached_properties_metadata\"></a>   \n## Attached Property Metadata  \n When registering the property, <xref:System.Windows.FrameworkPropertyMetadata> is set to specify characteristics of the property, such as whether the property affects rendering, measurement, and so on. Metadata for an attached property is generally no different than on a dependency property. If you specify a default value in an override to attached property metadata, that value becomes the default value of the implicit attached property on instances of the overriding class. Specifically, your default value is reported if some process queries for the value of an attached property through the `Get` method accessor for that property, specifying an instance of the class where you specified the metadata, and the value for that attached property was otherwise not set.  \n  \n If you want to enable property value inheritance on a property, you should use attached properties rather than non-attached dependency properties. For details, see [Property Value Inheritance](../../../../docs/framework/wpf/advanced/property-value-inheritance.md).  \n  \n<a name=\"custom\"></a>   \n## Custom Attached Properties  \n  \n<a name=\"create_attached_properties\"></a>   \n### When to Create an Attached Property  \n You might create an attached property when there is a reason to have a property setting mechanism available for classes other than the defining class. The most common scenario for this is layout. Examples of existing layout properties are <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName>, <xref:System.Windows.Controls.Panel.ZIndex%2A?displayProperty=fullName>, and <xref:System.Windows.Controls.Canvas.Top%2A?displayProperty=fullName>. The scenario enabled here is that elements that exist as child elements to layout-controlling elements are able to express layout requirements to their layout parent elements individually, each setting a property value that the parent defined as an attached property.  \n  \n Another scenario for using an attached property is when your class represents a service, and you want classes to be able to integrate the service more transparently.  \n  \n Yet another scenario is to receive [!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)] [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)] support, such as **Properties** window editing. For more information, see [Control Authoring Overview](../../../../docs/framework/wpf/controls/control-authoring-overview.md).  \n  \n As mentioned before, you should register as an attached property if you want to use property value inheritance.  \n  \n<a name=\"how_do_i_create_attached_properties\"></a>   \n### How to Create an Attached Property  \n If your class is defining the attached property strictly for use on other types, then the class does not have to derive from <xref:System.Windows.DependencyObject>. But you do need to derive from <xref:System.Windows.DependencyObject> if you follow the overall [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] model of having your attached property also be a dependency property.  \n  \n Define your attached property as a dependency property by declaring a `public` `static` `readonly` field of type <xref:System.Windows.DependencyProperty>. You define this field by using the return value of the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method. The field name must match the attached property name, appended with the string `Property`, to follow the established [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pattern of naming the identifying fields versus the properties that they represent. The attached property provider must also provide static `Get`*PropertyName* and `Set`*PropertyName* methods as accessors for the attached property; failing to do this will result in the property system being unable to use your attached property.  \n  \n> [!NOTE]\n>  If you omit the attached property's get accessor, data binding on the property will not work in design tools, such as [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] and Expression Blend.  \n  \n#### The Get Accessor  \n The signature for the `Get`*PropertyName* accessor must be:  \n  \n `public static object Get` *PropertyName* `(object`  `target` `)`  \n  \n-   The `target` object can be specified as a more specific type in your implementation. For example, the <xref:System.Windows.Controls.DockPanel.GetDock%2A?displayProperty=fullName> method types the parameter as <xref:System.Windows.UIElement>, because the attached property is only intended to be set on <xref:System.Windows.UIElement> instances.  \n  \n-   The return value can be specified as a more specific type in your implementation. For example, the <xref:System.Windows.Controls.DockPanel.GetDock%2A> method types it as <xref:System.Windows.Controls.Dock>, because the value can only be set to that enumeration.  \n  \n#### The Set Accessor  \n The signature for the `Set`*PropertyName* accessor must be:  \n  \n `public static void Set` *PropertyName* `(object`  `target` `, object`  `value` `)`  \n  \n-   The `target` object can be specified as a more specific type in your implementation. For example, the <xref:System.Windows.Controls.DockPanel.SetDock%2A> method types it as <xref:System.Windows.UIElement>, because the attached property is only intended to be set on <xref:System.Windows.UIElement> instances.  \n  \n-   The `value` object can be specified as a more specific type in your implementation. For example, the <xref:System.Windows.Controls.DockPanel.SetDock%2A> method types it as <xref:System.Windows.Controls.Dock>, because the value can only be set to that enumeration. Remember that the value for this method is the input coming from the XAML loader when it encounters your attached property in an attached property usage in markup. That input is the value specified as a XAML attribute value in markup. Therefore there must be type conversion, value serializer, or markup extension support for the type you use, such that the appropriate type can be created from the attribute value (which is ultimately just a string).  \n  \n The following example shows the dependency property registration (using the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method), as well as the `Get`*PropertyName* and `Set`*PropertyName* accessors. In the example, the attached property name is `IsBubbleSource`. Therefore, the accessors must be named `GetIsBubbleSource` and `SetIsBubbleSource`.  \n  \n [!code-csharp[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerattachedbubbler)]\n [!code-vb[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerattachedbubbler)]  \n  \n#### Attached Property Attributes  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines several [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] that are intended to provide information about attached properties to reflection processes, and to typical users of reflection and property information such as designers. Because attached properties have a type of unlimited scope, designers need a way to avoid overwhelming users with a global list of all the attached properties that are defined in a particular technology implementation that uses XAML. The [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines for attached properties can be used to scope the situations where a given attached property should be shown in a properties window. You might consider applying these attributes for your own custom attached properties also. The purpose and syntax of the [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] is described on the appropriate reference pages:  \n  \n-   <xref:System.Windows.AttachedPropertyBrowsableAttribute>  \n  \n-   <xref:System.Windows.AttachedPropertyBrowsableForChildrenAttribute>  \n  \n-   <xref:System.Windows.AttachedPropertyBrowsableForTypeAttribute>  \n  \n-   <xref:System.Windows.AttachedPropertyBrowsableWhenAttributePresentAttribute>  \n  \n<a name=\"more\"></a>   \n## Learning More About Attached Properties  \n  \n-   For more information on creating an attached property, see [Register an Attached Property](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md).  \n  \n-   For more advanced usage scenarios for dependency properties and attached properties, see [Custom Dependency Properties](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md).  \n  \n-   You can also register a property as an attached property, and as a dependency property, but then still expose \"wrapper\" implementations. In this case, the property can be set either on that element, or on any element through the XAML attached property syntax. An example of a property with an appropriate scenario for both standard and attached usages is <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=fullName>.  \n  \n## See Also  \n <xref:System.Windows.DependencyProperty>   \n [Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)   \n [Custom Dependency Properties](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md)   \n [XAML Overview (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)   \n [Register an Attached Property](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md)","nodes":[{"pos":[4,421],"embed":true,"restype":"x-metadata","content":"title: \"Attached Properties Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"attached properties [WPF Designer]\"\nms.assetid: 75928354-dc01-47e8-a018-8409aec1f32d\ncaps.latest.revision: 28\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Attached Properties Overview | Microsoft Docs","nodes":[{"pos":[0,45],"content":"Attached Properties Overview | Microsoft Docs","nodes":[{"content":"Attached Properties Overview | Microsoft Docs","pos":[0,45]}]}],"path":["title"]}],"yml":true},{"pos":[428,456],"content":"Attached Properties Overview","linkify":"Attached Properties Overview","nodes":[{"content":"Attached Properties Overview","pos":[0,28]}]},{"content":"An attached property is a concept defined by XAML.","pos":[457,507]},{"content":"An attached property is intended to be used as a type of global property that is settable on any object.","pos":[508,612]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph>, attached properties are typically defined as a specialized form of dependency property that does not have the conventional property \"wrapper\".","pos":[613,839],"source":" In [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], attached properties are typically defined as a specialized form of dependency property that does not have the conventional property \"wrapper\"."},{"pos":[884,897],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> classes, and have read the <bpt id=\"p1\">[</bpt>Dependency Properties Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)</ept>.","pos":[901,1249],"source":"This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)."},{"content":"To follow the examples in this topic, you should also understand XAML and know how to write <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> applications.","pos":[1250,1437],"source":" To follow the examples in this topic, you should also understand XAML and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications."},{"pos":[1490,1517],"content":"Why Use Attached Properties","linkify":"Why Use Attached Properties","nodes":[{"content":"Why Use Attached Properties","pos":[0,27]}]},{"content":"One purpose of an attached property is to allow different child elements to specify unique values for a property that is actually defined in a parent element.","pos":[1521,1679]},{"content":"A specific application of this scenario is having child elements inform the parent element of how they are to be presented in the <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph>.","pos":[1680,1876],"source":" A specific application of this scenario is having child elements inform the parent element of how they are to be presented in the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]."},{"content":"One example is the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> property.","pos":[1877,1979],"source":" One example is the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> property is created as an attached property because it is designed to be set on elements that are contained within a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph>, rather than on <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> itself.","pos":[1980,2280],"source":" The <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> property is created as an attached property because it is designed to be set on elements that are contained within a <xref:System.Windows.Controls.DockPanel>, rather than on <xref:System.Windows.Controls.DockPanel> itself."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> class defines the static <ph id=\"ph2\">&lt;xref:System.Windows.DependencyProperty&gt;</ph> field named <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DockPanel.DockProperty&gt;</ph>, and then provides the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.DockPanel.GetDock%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Controls.DockPanel.SetDock%2A&gt;</ph> methods as public accessors for the attached property.","pos":[2281,2643],"source":" The <xref:System.Windows.Controls.DockPanel> class defines the static <xref:System.Windows.DependencyProperty> field named <xref:System.Windows.Controls.DockPanel.DockProperty>, and then provides the <xref:System.Windows.Controls.DockPanel.GetDock%2A> and <xref:System.Windows.Controls.DockPanel.SetDock%2A> methods as public accessors for the attached property."},{"pos":[2695,2722],"content":"Attached Properties in XAML","linkify":"Attached Properties in XAML","nodes":[{"content":"Attached Properties in XAML","pos":[0,27]}]},{"pos":[2726,2824],"content":"In XAML, you set attached properties by using the syntax <bpt id=\"p1\">*</bpt>AttachedPropertyProvider<ept id=\"p1\">*</ept>.<bpt id=\"p2\">*</bpt>PropertyName<ept id=\"p2\">*</ept>","source":"In XAML, you set attached properties by using the syntax *AttachedPropertyProvider*.*PropertyName*"},{"content":"The following is an example of how you can set <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> in XAML:","pos":[2831,2960],"source":"The following is an example of how you can set <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> in XAML:"},{"pos":[2967,3118],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>PropertiesOvwSupport#APBasicUsage<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml#apbasicusage)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[PropertiesOvwSupport#APBasicUsage](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml#apbasicusage)]"},{"content":"Note that the usage is somewhat similar to a static property; you always reference the type <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> that owns and registers the attached property, rather than referring to any instance specified by name.","pos":[3125,3361],"source":"Note that the usage is somewhat similar to a static property; you always reference the type <xref:System.Windows.Controls.DockPanel> that owns and registers the attached property, rather than referring to any instance specified by name."},{"content":"Also, because an attached property in XAML is an attribute that you set in markup, only the set operation has any relevance.","pos":[3368,3492]},{"content":"You cannot directly get a property in XAML, although there are some indirect mechanisms for comparing values, such as triggers in styles (for details, see <bpt id=\"p1\">[</bpt>Styling and Templating<ept id=\"p1\">](../../../../docs/framework/wpf/controls/styling-and-templating.md)</ept>).","pos":[3493,3741],"source":" You cannot directly get a property in XAML, although there are some indirect mechanisms for comparing values, such as triggers in styles (for details, see [Styling and Templating](../../../../docs/framework/wpf/controls/styling-and-templating.md))."},{"pos":[3751,3790],"content":"Attached Property Implementation in WPF","linkify":"Attached Property Implementation in WPF","nodes":[{"content":"Attached Property Implementation in WPF","pos":[0,39]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph>, most of the attached properties that exist on <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> types that are related to UI presentation are implemented as dependency properties.","pos":[3794,4089],"source":"In [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], most of the attached properties that exist on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] types that are related to UI presentation are implemented as dependency properties."},{"content":"Attached properties are a XAML concept, whereas dependency properties are a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> concept.","pos":[4090,4256],"source":" Attached properties are a XAML concept, whereas dependency properties are a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] concept."},{"content":"Because <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> attached properties are dependency properties, they support dependency property concepts such as property metadata, and default values from that property metadata.","pos":[4257,4510],"source":" Because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] attached properties are dependency properties, they support dependency property concepts such as property metadata, and default values from that property metadata."},{"pos":[4545,4596],"content":"How Attached Properties Are Used by the Owning Type","linkify":"How Attached Properties Are Used by the Owning Type","nodes":[{"content":"How Attached Properties Are Used by the Owning Type","pos":[0,51]}]},{"content":"Although attached properties are settable on any object, that does not automatically mean that setting the property will produce a tangible result, or that the value will ever be used by another object.","pos":[4600,4802]},{"content":"Generally, attached properties are intended so that objects coming from a wide variety of possible class hierarchies or logical relationships can each report common information to the type that defines the attached property.","pos":[4803,5027]},{"content":"The type that defines the attached property typically follows one of these models:","pos":[5028,5110]},{"content":"The type that defines the attached property is designed so that it can be the parent element of the elements that will set values for the attached property.","pos":[5120,5276]},{"content":"The type then iterates its child objects through internal logic against some object tree structure, obtains the values, and acts on those values in some manner.","pos":[5277,5437]},{"content":"The type that defines the attached property will be used as the child element for a variety of possible parent elements and content models.","pos":[5447,5586]},{"content":"The type that defines the attached property represents a service.","pos":[5596,5661]},{"content":"Other types set values for the attached property.","pos":[5662,5711]},{"content":"Then, when the element that set the property is evaluated in the context of the service, the attached property values are obtained through internal logic of the service class.","pos":[5712,5887]},{"pos":[5897,5945],"content":"An Example of a Parent-Defined Attached Property","linkify":"An Example of a Parent-Defined Attached Property","nodes":[{"content":"An Example of a Parent-Defined Attached Property","pos":[0,48]}]},{"pos":[5949,6270],"content":"The most typical scenario where <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> defines an attached property is when a parent element supports a child element collection, and also implements a behavior where the specifics of the behavior are reported individually for each child element.","source":"The most typical scenario where [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines an attached property is when a parent element supports a child element collection, and also implements a behavior where the specifics of the behavior are reported individually for each child element."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> defines the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> attached property, and <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> has class-level code as part of its rendering logic (specifically, <ph id=\"ph4\">&lt;xref:System.Windows.Controls.DockPanel.MeasureOverride%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Controls.DockPanel.ArrangeOverride%2A&gt;</ph>).","pos":[6277,6660],"source":"<xref:System.Windows.Controls.DockPanel> defines the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> attached property, and <xref:System.Windows.Controls.DockPanel> has class-level code as part of its rendering logic (specifically, <xref:System.Windows.Controls.DockPanel.MeasureOverride%2A> and <xref:System.Windows.Controls.DockPanel.ArrangeOverride%2A>)."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> instance will always check to see whether any of its immediate child elements have set a value for <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph>.","pos":[6661,6877],"source":" A <xref:System.Windows.Controls.DockPanel> instance will always check to see whether any of its immediate child elements have set a value for <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName>."},{"content":"If so, those values become input for the rendering logic applied to that particular child element.","pos":[6878,6976]},{"content":"Nested <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> instances each treat their own immediate child element collections, but that behavior is implementation-specific to how <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> processes <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> values.","pos":[6977,7277],"source":" Nested <xref:System.Windows.Controls.DockPanel> instances each treat their own immediate child element collections, but that behavior is implementation-specific to how <xref:System.Windows.Controls.DockPanel> processes <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> values."},{"content":"It is theoretically possible to have attached properties that influence elements beyond the immediate parent.","pos":[7278,7387]},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> attached property is set on an element that has no <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> parent element to act upon it, no error or exception is raised.","pos":[7388,7624],"source":" If the <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> attached property is set on an element that has no <xref:System.Windows.Controls.DockPanel> parent element to act upon it, no error or exception is raised."},{"content":"This simply means that a global property value was set, but it has no current <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> parent that could consume the information.","pos":[7625,7786],"source":" This simply means that a global property value was set, but it has no current <xref:System.Windows.Controls.DockPanel> parent that could consume the information."},{"pos":[7838,7865],"content":"Attached Properties in Code","linkify":"Attached Properties in Code","nodes":[{"content":"Attached Properties in Code","pos":[0,27]}]},{"content":"Attached properties in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> do not have the typical <ph id=\"ph2\">[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]</ph> \"wrapper\" methods for easy get/set access.","pos":[7869,8110],"source":"Attached properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do not have the typical [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] \"wrapper\" methods for easy get/set access."},{"content":"This is because the attached property is not necessarily part of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]</ph> namespace for instances where the property is set.","pos":[8111,8300],"source":" This is because the attached property is not necessarily part of the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] namespace for instances where the property is set."},{"content":"However, a XAML processor must be able to set those values when XAML is parsed.","pos":[8301,8380]},{"content":"To support an effective attached property usage, the owner type of the attached property must implement dedicated accessor methods in the form <ph id=\"ph1\">`Get`</ph><bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> and <ph id=\"ph2\">`Set`</ph><bpt id=\"p2\">*</bpt>PropertyName<ept id=\"p2\">*</ept>.","pos":[8381,8568],"source":" To support an effective attached property usage, the owner type of the attached property must implement dedicated accessor methods in the form `Get`*PropertyName* and `Set`*PropertyName*."},{"content":"These dedicated accessor methods are also useful to get or set the attached property in code.","pos":[8569,8662]},{"content":"From a code perspective, an attached property is similar to a backing field that has method accessors instead of property accessors, and that backing field can exist on any object rather than needing to be specifically defined.","pos":[8663,8890]},{"content":"The following example shows how you can set an attached property in code.","pos":[8897,8970]},{"content":"In this example, <ph id=\"ph1\">`myCheckBox`</ph> is an instance of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.CheckBox&gt;</ph> class.","pos":[8971,9069],"source":" In this example, `myCheckBox` is an instance of the <xref:System.Windows.Controls.CheckBox> class."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PropertiesOvwSupport#APCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#apcode)</ept><ept id=\"p1\">]</ept>","pos":[9076,9221],"source":"[!code-csharp[PropertiesOvwSupport#APCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#apcode)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>PropertiesOvwSupport#APCode<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#apcode)</ept><ept id=\"p1\">]</ept>","pos":[9223,9374],"source":"[!code-vb[PropertiesOvwSupport#APCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#apcode)]"},{"content":"Similar to the XAML case, if <ph id=\"ph1\">`myCheckBox`</ph> had not already been added as a child element of <ph id=\"ph2\">`myDockPanel`</ph> by the third line of code, the fourth line of code would not raise an exception, but the property value would not interact with a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> parent and thus would do nothing.","pos":[9381,9690],"source":"Similar to the XAML case, if `myCheckBox` had not already been added as a child element of `myDockPanel` by the third line of code, the fourth line of code would not raise an exception, but the property value would not interact with a <xref:System.Windows.Controls.DockPanel> parent and thus would do nothing."},{"content":"Only a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph> value set on a child element combined with the presence of a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> parent element will cause an effective behavior in the rendered application.","pos":[9691,9950],"source":" Only a <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName> value set on a child element combined with the presence of a <xref:System.Windows.Controls.DockPanel> parent element will cause an effective behavior in the rendered application."},{"content":"(In this case, you could set the attached property, then attach to the tree.","pos":[9951,10027]},{"content":"Or you could attach to the tree then set the attached property.","pos":[10028,10091]},{"content":"Either action order provides the same result.)","pos":[10092,10138]},{"pos":[10194,10220],"content":"Attached Property Metadata","linkify":"Attached Property Metadata","nodes":[{"content":"Attached Property Metadata","pos":[0,26]}]},{"content":"When registering the property, <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkPropertyMetadata&gt;</ph> is set to specify characteristics of the property, such as whether the property affects rendering, measurement, and so on.","pos":[10224,10425],"source":"When registering the property, <xref:System.Windows.FrameworkPropertyMetadata> is set to specify characteristics of the property, such as whether the property affects rendering, measurement, and so on."},{"content":"Metadata for an attached property is generally no different than on a dependency property.","pos":[10426,10516]},{"content":"If you specify a default value in an override to attached property metadata, that value becomes the default value of the implicit attached property on instances of the overriding class.","pos":[10517,10702]},{"content":"Specifically, your default value is reported if some process queries for the value of an attached property through the <ph id=\"ph1\">`Get`</ph> method accessor for that property, specifying an instance of the class where you specified the metadata, and the value for that attached property was otherwise not set.","pos":[10703,10996],"source":" Specifically, your default value is reported if some process queries for the value of an attached property through the `Get` method accessor for that property, specifying an instance of the class where you specified the metadata, and the value for that attached property was otherwise not set."},{"content":"If you want to enable property value inheritance on a property, you should use attached properties rather than non-attached dependency properties.","pos":[11003,11149]},{"content":"For details, see <bpt id=\"p1\">[</bpt>Property Value Inheritance<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/property-value-inheritance.md)</ept>.","pos":[11150,11267],"source":" For details, see [Property Value Inheritance](../../../../docs/framework/wpf/advanced/property-value-inheritance.md)."},{"pos":[11301,11327],"content":"Custom Attached Properties","linkify":"Custom Attached Properties","nodes":[{"content":"Custom Attached Properties","pos":[0,26]}]},{"pos":[11382,11417],"content":"When to Create an Attached Property","linkify":"When to Create an Attached Property","nodes":[{"content":"When to Create an Attached Property","pos":[0,35]}]},{"content":"You might create an attached property when there is a reason to have a property setting mechanism available for classes other than the defining class.","pos":[11421,11571]},{"content":"The most common scenario for this is layout.","pos":[11572,11616]},{"content":"Examples of existing layout properties are <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Panel.ZIndex%2A?displayProperty=fullName&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Canvas.Top%2A?displayProperty=fullName&gt;</ph>.","pos":[11617,11882],"source":" Examples of existing layout properties are <xref:System.Windows.Controls.DockPanel.Dock%2A?displayProperty=fullName>, <xref:System.Windows.Controls.Panel.ZIndex%2A?displayProperty=fullName>, and <xref:System.Windows.Controls.Canvas.Top%2A?displayProperty=fullName>."},{"content":"The scenario enabled here is that elements that exist as child elements to layout-controlling elements are able to express layout requirements to their layout parent elements individually, each setting a property value that the parent defined as an attached property.","pos":[11883,12150]},{"content":"Another scenario for using an attached property is when your class represents a service, and you want classes to be able to integrate the service more transparently.","pos":[12157,12322]},{"content":"Yet another scenario is to receive <ph id=\"ph1\">[!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)]</ph> <ph id=\"ph2\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph> support, such as <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window editing.","pos":[12329,12571],"source":"Yet another scenario is to receive [!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)] [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)] support, such as **Properties** window editing."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Control Authoring Overview<ept id=\"p1\">](../../../../docs/framework/wpf/controls/control-authoring-overview.md)</ept>.","pos":[12572,12698],"source":" For more information, see [Control Authoring Overview](../../../../docs/framework/wpf/controls/control-authoring-overview.md)."},{"content":"As mentioned before, you should register as an attached property if you want to use property value inheritance.","pos":[12705,12816]},{"pos":[12880,12914],"content":"How to Create an Attached Property","linkify":"How to Create an Attached Property","nodes":[{"content":"How to Create an Attached Property","pos":[0,34]}]},{"content":"If your class is defining the attached property strictly for use on other types, then the class does not have to derive from <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject&gt;</ph>.","pos":[12918,13082],"source":"If your class is defining the attached property strictly for use on other types, then the class does not have to derive from <xref:System.Windows.DependencyObject>."},{"content":"But you do need to derive from <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject&gt;</ph> if you follow the overall <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> model of having your attached property also be a dependency property.","pos":[13083,13330],"source":" But you do need to derive from <xref:System.Windows.DependencyObject> if you follow the overall [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] model of having your attached property also be a dependency property."},{"content":"Define your attached property as a dependency property by declaring a <ph id=\"ph1\">`public`</ph> <ph id=\"ph2\">`static`</ph> <ph id=\"ph3\">`readonly`</ph> field of type <ph id=\"ph4\">&lt;xref:System.Windows.DependencyProperty&gt;</ph>.","pos":[13337,13491],"source":"Define your attached property as a dependency property by declaring a `public` `static` `readonly` field of type <xref:System.Windows.DependencyProperty>."},{"content":"You define this field by using the return value of the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyProperty.RegisterAttached%2A&gt;</ph> method.","pos":[13492,13615],"source":" You define this field by using the return value of the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method."},{"content":"The field name must match the attached property name, appended with the string <ph id=\"ph1\">`Property`</ph>, to follow the established <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> pattern of naming the identifying fields versus the properties that they represent.","pos":[13616,13898],"source":" The field name must match the attached property name, appended with the string `Property`, to follow the established [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pattern of naming the identifying fields versus the properties that they represent."},{"content":"The attached property provider must also provide static <ph id=\"ph1\">`Get`</ph><bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> and <ph id=\"ph2\">`Set`</ph><bpt id=\"p2\">*</bpt>PropertyName<ept id=\"p2\">*</ept> methods as accessors for the attached property; failing to do this will result in the property system being unable to use your attached property.","pos":[13899,14144],"source":" The attached property provider must also provide static `Get`*PropertyName* and `Set`*PropertyName* methods as accessors for the attached property; failing to do this will result in the property system being unable to use your attached property."},{"pos":[14152,14356],"content":"[!NOTE]\n If you omit the attached property's get accessor, data binding on the property will not work in design tools, such as [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] and Expression Blend.","leadings":["","> "],"nodes":[{"content":"If you omit the attached property's get accessor, data binding on the property will not work in design tools, such as <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> and Expression Blend.","pos":[9,202],"source":"If you omit the attached property's get accessor, data binding on the property will not work in design tools, such as [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] and Expression Blend."}]},{"pos":[14367,14383],"content":"The Get Accessor","linkify":"The Get Accessor","nodes":[{"content":"The Get Accessor","pos":[0,16]}]},{"pos":[14387,14446],"content":"The signature for the <ph id=\"ph1\">`Get`</ph><bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> accessor must be:","source":"The signature for the `Get`*PropertyName* accessor must be:"},{"pos":[14453,14518],"content":"<ph id=\"ph1\">`public static object Get`</ph> <bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> <ph id=\"ph2\">`(object`</ph>  <ph id=\"ph3\">`target`</ph> <ph id=\"ph4\">`)`</ph>","source":"`public static object Get` *PropertyName* `(object`  `target` `)`"},{"content":"The <ph id=\"ph1\">`target`</ph> object can be specified as a more specific type in your implementation.","pos":[14528,14612],"source":"The `target` object can be specified as a more specific type in your implementation."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.GetDock%2A?displayProperty=fullName&gt;</ph> method types the parameter as <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph>, because the attached property is only intended to be set on <ph id=\"ph3\">&lt;xref:System.Windows.UIElement&gt;</ph> instances.","pos":[14613,14872],"source":" For example, the <xref:System.Windows.Controls.DockPanel.GetDock%2A?displayProperty=fullName> method types the parameter as <xref:System.Windows.UIElement>, because the attached property is only intended to be set on <xref:System.Windows.UIElement> instances."},{"content":"The return value can be specified as a more specific type in your implementation.","pos":[14882,14963]},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.GetDock%2A&gt;</ph> method types it as <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Dock&gt;</ph>, because the value can only be set to that enumeration.","pos":[14964,15143],"source":" For example, the <xref:System.Windows.Controls.DockPanel.GetDock%2A> method types it as <xref:System.Windows.Controls.Dock>, because the value can only be set to that enumeration."},{"pos":[15154,15170],"content":"The Set Accessor","linkify":"The Set Accessor","nodes":[{"content":"The Set Accessor","pos":[0,16]}]},{"pos":[15174,15233],"content":"The signature for the <ph id=\"ph1\">`Set`</ph><bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> accessor must be:","source":"The signature for the `Set`*PropertyName* accessor must be:"},{"pos":[15240,15323],"content":"<ph id=\"ph1\">`public static void Set`</ph> <bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> <ph id=\"ph2\">`(object`</ph>  <ph id=\"ph3\">`target`</ph> <ph id=\"ph4\">`, object`</ph>  <ph id=\"ph5\">`value`</ph> <ph id=\"ph6\">`)`</ph>","source":"`public static void Set` *PropertyName* `(object`  `target` `, object`  `value` `)`"},{"content":"The <ph id=\"ph1\">`target`</ph> object can be specified as a more specific type in your implementation.","pos":[15333,15417],"source":"The `target` object can be specified as a more specific type in your implementation."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.SetDock%2A&gt;</ph> method types it as <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph>, because the attached property is only intended to be set on <ph id=\"ph3\">&lt;xref:System.Windows.UIElement&gt;</ph> instances.","pos":[15418,15641],"source":" For example, the <xref:System.Windows.Controls.DockPanel.SetDock%2A> method types it as <xref:System.Windows.UIElement>, because the attached property is only intended to be set on <xref:System.Windows.UIElement> instances."},{"content":"The <ph id=\"ph1\">`value`</ph> object can be specified as a more specific type in your implementation.","pos":[15651,15734],"source":"The `value` object can be specified as a more specific type in your implementation."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.SetDock%2A&gt;</ph> method types it as <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Dock&gt;</ph>, because the value can only be set to that enumeration.","pos":[15735,15914],"source":" For example, the <xref:System.Windows.Controls.DockPanel.SetDock%2A> method types it as <xref:System.Windows.Controls.Dock>, because the value can only be set to that enumeration."},{"content":"Remember that the value for this method is the input coming from the XAML loader when it encounters your attached property in an attached property usage in markup.","pos":[15915,16078]},{"content":"That input is the value specified as a XAML attribute value in markup.","pos":[16079,16149]},{"content":"Therefore there must be type conversion, value serializer, or markup extension support for the type you use, such that the appropriate type can be created from the attribute value (which is ultimately just a string).","pos":[16150,16366]},{"content":"The following example shows the dependency property registration (using the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyProperty.RegisterAttached%2A&gt;</ph> method), as well as the <ph id=\"ph2\">`Get`</ph><bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept> and <ph id=\"ph3\">`Set`</ph><bpt id=\"p2\">*</bpt>PropertyName<ept id=\"p2\">*</ept> accessors.","pos":[16373,16588],"source":"The following example shows the dependency property registration (using the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method), as well as the `Get`*PropertyName* and `Set`*PropertyName* accessors."},{"content":"In the example, the attached property name is <ph id=\"ph1\">`IsBubbleSource`</ph>.","pos":[16589,16652],"source":" In the example, the attached property name is `IsBubbleSource`."},{"content":"Therefore, the accessors must be named <ph id=\"ph1\">`GetIsBubbleSource`</ph> and <ph id=\"ph2\">`SetIsBubbleSource`</ph>.","pos":[16653,16736],"source":" Therefore, the accessors must be named `GetIsBubbleSource` and `SetIsBubbleSource`."},{"pos":[16743,17115],"content":"[!code-csharp[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerattachedbubbler)]\n[!code-vb[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerattachedbubbler)]","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>WPFAquariumSln#RegisterAttachedBubbler<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerattachedbubbler)</ept><ept id=\"p1\">]</ept>","pos":[0,182],"source":"[!code-csharp[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerattachedbubbler)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>WPFAquariumSln#RegisterAttachedBubbler<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerattachedbubbler)</ept><ept id=\"p1\">]</ept>","pos":[183,371],"source":"[!code-vb[WPFAquariumSln#RegisterAttachedBubbler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerattachedbubbler)]"}]},{"pos":[17126,17154],"content":"Attached Property Attributes","linkify":"Attached Property Attributes","nodes":[{"content":"Attached Property Attributes","pos":[0,28]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> defines several <ph id=\"ph2\">[!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)]</ph> that are intended to provide information about attached properties to reflection processes, and to typical users of reflection and property information such as designers.","pos":[17158,17536],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines several [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] that are intended to provide information about attached properties to reflection processes, and to typical users of reflection and property information such as designers."},{"content":"Because attached properties have a type of unlimited scope, designers need a way to avoid overwhelming users with a global list of all the attached properties that are defined in a particular technology implementation that uses XAML.","pos":[17537,17770]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)]</ph> that <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> defines for attached properties can be used to scope the situations where a given attached property should be shown in a properties window.","pos":[17771,18111],"source":" The [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] defines for attached properties can be used to scope the situations where a given attached property should be shown in a properties window."},{"content":"You might consider applying these attributes for your own custom attached properties also.","pos":[18112,18202]},{"content":"The purpose and syntax of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)]</ph> is described on the appropriate reference pages:","pos":[18203,18391],"source":" The purpose and syntax of the [!INCLUDE[TLA2#tla_netframewkattr#plural](../../../../includes/tla2sharptla-netframewkattrsharpplural-md.md)] is described on the appropriate reference pages:"},{"pos":[18725,18764],"content":"Learning More About Attached Properties","linkify":"Learning More About Attached Properties","nodes":[{"content":"Learning More About Attached Properties","pos":[0,39]}]},{"pos":[18774,18946],"content":"For more information on creating an attached property, see <bpt id=\"p1\">[</bpt>Register an Attached Property<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md)</ept>.","source":"For more information on creating an attached property, see [Register an Attached Property](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md)."},{"pos":[18956,19149],"content":"For more advanced usage scenarios for dependency properties and attached properties, see <bpt id=\"p1\">[</bpt>Custom Dependency Properties<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md)</ept>.","source":"For more advanced usage scenarios for dependency properties and attached properties, see [Custom Dependency Properties](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md)."},{"content":"You can also register a property as an attached property, and as a dependency property, but then still expose \"wrapper\" implementations.","pos":[19159,19295]},{"content":"In this case, the property can be set either on that element, or on any element through the XAML attached property syntax.","pos":[19296,19418]},{"content":"An example of a property with an appropriate scenario for both standard and attached usages is <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=fullName&gt;</ph>.","pos":[19419,19595],"source":" An example of a property with an appropriate scenario for both standard and attached usages is <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=fullName>."},{"pos":[19604,19612],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.DependencyProperty&gt;</ph>","pos":[19616,19656],"source":"<xref:System.Windows.DependencyProperty> "},{"content":"<bpt id=\"p1\">[</bpt>Dependency Properties Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[19661,19769],"source":"[Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Custom Dependency Properties<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md)</ept><ph id=\"ph1\"> </ph>","pos":[19773,19877],"source":"[Custom Dependency Properties](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md) "},{"content":"<bpt id=\"p1\">[</bpt>XAML Overview (WPF)<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[19881,19965],"source":"[XAML Overview (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Register an Attached Property<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md)</ept>","pos":[19969,20081],"source":"[Register an Attached Property](../../../../docs/framework/wpf/advanced/how-to-register-an-attached-property.md)"}]}