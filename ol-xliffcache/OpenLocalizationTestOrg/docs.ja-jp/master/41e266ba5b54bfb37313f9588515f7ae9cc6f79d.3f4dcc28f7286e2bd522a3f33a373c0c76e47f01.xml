{"content":"---\ntitle: \"Troubleshooting Setup Issues\"\nms.date: \"03/30/2017\"\nms.assetid: 1644f885-c408-4d5f-a5c7-a1a907bc8acd\n---\n# Troubleshooting Setup Issues\nThis topic describes how to troubleshoot Windows Communication Foundation (WCF) set up issues.  \n  \n## Some Windows Communication Foundation Registry Keys are not Repaired by Performing an MSI Repair Operation on the .NET Framework 3.0  \n If you delete any of the following registry keys:  \n  \n-   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelService 3.0.0.0  \n  \n-   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelOperation 3.0.0.0  \n  \n-   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelEndpoint 3.0.0.0  \n  \n-   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SMSvcHost 3.0.0.0  \n  \n-   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSDTC Bridge 3.0.0.0  \n  \n The keys are not re-created if you run repair by using the .NET Framework 3.0 installer launched from the **Add/Remove Programs** applet in **Control Panel**. To recreate these keys correctly, the user must uninstall and reinstall the .NET Framework 3.0.  \n  \n## WMI Service Corruption Blocks Installation of the Windows Communication Foundation WMI provider during installation of .NET Framework 3.0 package  \n WMI Service Corruption may block the installation of the Windows Communication Foundation WMI provider. During installation the Windows Communication Foundation installer is unable to register the WCF .mof file using the mofcomp.exe component. The following is a list of symptoms:  \n  \n1.  .NET Framework 3.0 installation completes successfully, but the WCF WMI provider is not registered.  \n  \n2.  An error event appears in the application event log that references problems registering the WMI provider for WCF, or running mofcomp.exe.  \n  \n3.  The setup log file named dd_wcf_retCA* in the user's %temp% directory contains references to failure to register the WCF WMI provider.  \n  \n4.  An exception such as one the following may be listed in the event log or setup trace log file:  \n  \n     ServiceModelReg [11:09:59:046]: System.ApplicationException: Unexpected result 3 executing E:\\WINDOWS\\system32\\wbem\\mofcomp.exe with \"E:\\WINDOWS\\Microsoft.NET\\Framework\\v3.0\\Windows Communication Foundation\\ServiceModel.mof\"  \n  \n     or:  \n  \n     ServiceModelReg [07:19:33:843]: System.TypeInitializationException: The type initializer for 'System.Management.ManagementPath' threw an exception. ---> System.Runtime.InteropServices.COMException (0x80040154): Retrieving the COM class factory for component with CLSID {CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA} failed due to the following error: 80040154.  \n  \n     or:  \n  \n     ServiceModelReg [07:19:32:750]: System.IO.FileNotFoundException: Could not load file or assembly 'C:\\WINDOWS\\system32\\wbem\\mofcomp.exe' or one of its dependencies. The system cannot find the file specified.  \n  \n     File name: 'C:\\WINDOWS\\system32\\wbem\\mofcomp.exe  \n  \n The following steps must be followed to resolve the problem described previously.  \n  \n1.  Run [the WMI Diagnosis Utility, version 2.0](https://go.microsoft.com/fwlink/?LinkId=94685) to repair the WMI service. For more information about using this tool, see the [WMI Diagnosis Utility](https://go.microsoft.com/fwlink/?LinkId=94686) topic.  \n  \n Repair the .NET Framework 3.0 installation by using the **Add/Remove Programs** applet located in **Control Panel**, or uninstall/reinstall the .NET Framework 3.0.  \n  \n## Repairing .NET Framework 3.0 after .NET Framework 3.5 Installation Removes Configuration Elements Introduced by .NET Framework 3.5 in machine.config  \n If you do a repair of .NET Framework 3.0 after you installed [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)], configuration elements introduced by [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] in machine.config are removed. However, the web.config remains intact. The workaround is to repair [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] after this via ARP, or use the [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) with the `/c` switch.  \n  \n [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\  \n  \n## Configure IIS Properly for WCF/WF Webhost after Installing .NET Framework 3.5  \n When [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] installation fails to configure additional WCF-related IIS configuration settings, it logs an error in the installation log and continues. Any attempt to run WorkflowServices applications will fail, since the required configuration settings are missing. For example, loading xoml or rules service can fail.  \n  \n To workaround this problem, use the [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) with the `/c` switch to properly configure IIS script maps on the machine. [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\  \n  \n## Could not load type ‘System.ServiceModel.Activation.HttpModule’ from assembly ‘System.ServiceModel, Version 3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089’  \n This error occurs if [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] is installed and then WCF HTTP Activation is enabled. To resolve the issue run the following command-line from inside the Developer Command Prompt for Visual Studio:  \n  \n```Output  \naspnet_regiis.exe -i -enable  \n```  \n  \n## See also\n\n- [Set-Up Instructions](../../../docs/framework/wcf/samples/set-up-instructions.md)\n","nodes":[{"pos":[4,112],"embed":true,"restype":"x-metadata","content":"title: \"Troubleshooting Setup Issues\"\nms.date: \"03/30/2017\"\nms.assetid: 1644f885-c408-4d5f-a5c7-a1a907bc8acd","nodes":[{"content":"Troubleshooting Setup Issues","nodes":[{"pos":[0,28],"content":"Troubleshooting Setup Issues","nodes":[{"content":"Troubleshooting Setup Issues","pos":[0,28]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[119,147],"content":"Troubleshooting Setup Issues","linkify":"Troubleshooting Setup Issues","nodes":[{"content":"Troubleshooting Setup Issues","pos":[0,28]}]},{"content":"This topic describes how to troubleshoot Windows Communication Foundation (WCF) set up issues.","pos":[148,242]},{"pos":[251,383],"content":"Some Windows Communication Foundation Registry Keys are not Repaired by Performing an MSI Repair Operation on the .NET Framework 3.0","linkify":"Some Windows Communication Foundation Registry Keys are not Repaired by Performing an MSI Repair Operation on the .NET Framework 3.0","nodes":[{"content":"Some Windows Communication Foundation Registry Keys are not Repaired by Performing an MSI Repair Operation on the .NET Framework 3.0","pos":[0,132]}]},{"content":"If you delete any of the following registry keys:","pos":[387,436]},{"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelService 3.0.0.0","pos":[446,526]},{"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelOperation 3.0.0.0","pos":[536,618]},{"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ServiceModelEndpoint 3.0.0.0","pos":[628,709]},{"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SMSvcHost 3.0.0.0","pos":[719,789]},{"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSDTC Bridge 3.0.0.0","pos":[799,872]},{"content":"The keys are not re-created if you run repair by using the .NET Framework 3.0 installer launched from the <bpt id=\"p1\">**</bpt>Add/Remove Programs<ept id=\"p1\">**</ept> applet in <bpt id=\"p2\">**</bpt>Control Panel<ept id=\"p2\">**</ept>.","pos":[879,1037],"source":"The keys are not re-created if you run repair by using the .NET Framework 3.0 installer launched from the **Add/Remove Programs** applet in **Control Panel**."},{"content":"To recreate these keys correctly, the user must uninstall and reinstall the .NET Framework 3.0.","pos":[1038,1133]},{"pos":[1142,1287],"content":"WMI Service Corruption Blocks Installation of the Windows Communication Foundation WMI provider during installation of .NET Framework 3.0 package","linkify":"WMI Service Corruption Blocks Installation of the Windows Communication Foundation WMI provider during installation of .NET Framework 3.0 package","nodes":[{"content":"WMI Service Corruption Blocks Installation of the Windows Communication Foundation WMI provider during installation of .NET Framework 3.0 package","pos":[0,145]}]},{"content":"WMI Service Corruption may block the installation of the Windows Communication Foundation WMI provider.","pos":[1291,1394]},{"content":"During installation the Windows Communication Foundation installer is unable to register the WCF .mof file using the mofcomp.exe component.","pos":[1395,1534]},{"content":"The following is a list of symptoms:","pos":[1535,1571]},{"content":".NET Framework 3.0 installation completes successfully, but the WCF WMI provider is not registered.","pos":[1581,1680]},{"content":"An error event appears in the application event log that references problems registering the WMI provider for WCF, or running mofcomp.exe.","pos":[1690,1828]},{"content":"The setup log file named dd_wcf_retCA* in the user's %temp% directory contains references to failure to register the WCF WMI provider.","pos":[1838,1972]},{"content":"An exception such as one the following may be listed in the event log or setup trace log file:","pos":[1982,2076]},{"content":"ServiceModelReg [11:09:59:046]: System.ApplicationException: Unexpected result 3 executing E:\\WINDOWS\\system32\\wbem\\mofcomp.exe with \"E:\\WINDOWS\\Microsoft.NET\\Framework\\v3.0\\Windows Communication Foundation\\ServiceModel.mof\"","pos":[2087,2311]},{"content":"or:","pos":[2322,2325]},{"content":"ServiceModelReg [07:19:33:843]: System.TypeInitializationException: The type initializer for 'System.Management.ManagementPath' threw an exception.","pos":[2336,2483]},{"content":"---&gt; System.Runtime.InteropServices.COMException (0x80040154): Retrieving the COM class factory for component with CLSID {CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA} failed due to the following error: 80040154.","pos":[2484,2688],"source":" ---> System.Runtime.InteropServices.COMException (0x80040154): Retrieving the COM class factory for component with CLSID {CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA} failed due to the following error: 80040154."},{"content":"or:","pos":[2699,2702]},{"content":"ServiceModelReg [07:19:32:750]: System.IO.FileNotFoundException: Could not load file or assembly 'C:\\WINDOWS\\system32\\wbem\\mofcomp.exe' or one of its dependencies.","pos":[2713,2876]},{"content":"The system cannot find the file specified.","pos":[2877,2919]},{"content":"File name: 'C:\\WINDOWS\\system32\\wbem\\mofcomp.exe","pos":[2930,2978]},{"content":"The following steps must be followed to resolve the problem described previously.","pos":[2985,3066]},{"content":"Run <bpt id=\"p1\">[</bpt>the WMI Diagnosis Utility, version 2.0<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=94685)</ept> to repair the WMI service.","pos":[3076,3194],"source":"Run [the WMI Diagnosis Utility, version 2.0](https://go.microsoft.com/fwlink/?LinkId=94685) to repair the WMI service."},{"content":"For more information about using this tool, see the <bpt id=\"p1\">[</bpt>WMI Diagnosis Utility<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=94686)</ept> topic.","pos":[3195,3324],"source":" For more information about using this tool, see the [WMI Diagnosis Utility](https://go.microsoft.com/fwlink/?LinkId=94686) topic."},{"pos":[3331,3494],"content":"Repair the .NET Framework 3.0 installation by using the <bpt id=\"p1\">**</bpt>Add/Remove Programs<ept id=\"p1\">**</ept> applet located in <bpt id=\"p2\">**</bpt>Control Panel<ept id=\"p2\">**</ept>, or uninstall/reinstall the .NET Framework 3.0.","source":"Repair the .NET Framework 3.0 installation by using the **Add/Remove Programs** applet located in **Control Panel**, or uninstall/reinstall the .NET Framework 3.0."},{"pos":[3503,3651],"content":"Repairing .NET Framework 3.0 after .NET Framework 3.5 Installation Removes Configuration Elements Introduced by .NET Framework 3.5 in machine.config","linkify":"Repairing .NET Framework 3.0 after .NET Framework 3.5 Installation Removes Configuration Elements Introduced by .NET Framework 3.5 in machine.config","nodes":[{"content":"Repairing .NET Framework 3.0 after .NET Framework 3.5 Installation Removes Configuration Elements Introduced by .NET Framework 3.5 in machine.config","pos":[0,148]}]},{"content":"If you do a repair of .NET Framework 3.0 after you installed <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph>, configuration elements introduced by <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> in machine.config are removed.","pos":[3655,3914],"source":"If you do a repair of .NET Framework 3.0 after you installed [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)], configuration elements introduced by [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] in machine.config are removed."},{"content":"However, the web.config remains intact.","pos":[3915,3954]},{"content":"The workaround is to repair <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> after this via ARP, or use the <bpt id=\"p1\">[</bpt>WorkFlow Service Registration Tool (WFServicesReg.exe)<ept id=\"p1\">](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md)</ept> with the <ph id=\"ph2\">`/c`</ph> switch.","pos":[3955,4242],"source":" The workaround is to repair [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] after this via ARP, or use the [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) with the `/c` switch."},{"pos":[4249,4489],"content":"<bpt id=\"p1\">[</bpt>WorkFlow Service Registration Tool (WFServicesReg.exe)<ept id=\"p1\">](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md)</ept> can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\","source":"[WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\"},{"pos":[4498,4575],"content":"Configure IIS Properly for WCF/WF Webhost after Installing .NET Framework 3.5","linkify":"Configure IIS Properly for WCF/WF Webhost after Installing .NET Framework 3.5","nodes":[{"content":"Configure IIS Properly for WCF/WF Webhost after Installing .NET Framework 3.5","pos":[0,77]}]},{"content":"When <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> installation fails to configure additional WCF-related IIS configuration settings, it logs an error in the installation log and continues.","pos":[4579,4787],"source":"When [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] installation fails to configure additional WCF-related IIS configuration settings, it logs an error in the installation log and continues."},{"content":"Any attempt to run WorkflowServices applications will fail, since the required configuration settings are missing.","pos":[4788,4902]},{"content":"For example, loading xoml or rules service can fail.","pos":[4903,4955]},{"content":"To workaround this problem, use the <bpt id=\"p1\">[</bpt>WorkFlow Service Registration Tool (WFServicesReg.exe)<ept id=\"p1\">](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md)</ept> with the <ph id=\"ph1\">`/c`</ph> switch to properly configure IIS script maps on the machine.","pos":[4962,5214],"source":"To workaround this problem, use the [WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) with the `/c` switch to properly configure IIS script maps on the machine."},{"content":"<bpt id=\"p1\">[</bpt>WorkFlow Service Registration Tool (WFServicesReg.exe)<ept id=\"p1\">](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md)</ept> can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\","pos":[5215,5455],"source":"[WorkFlow Service Registration Tool (WFServicesReg.exe)](../../../docs/framework/wcf/workflow-service-registration-tool-wfservicesreg-exe.md) can be found at %windir%\\Microsoft.NET\\framework\\v3.5\\ or %windir%\\Microsoft.NET\\framework64\\v3.5\\"},{"pos":[5464,5630],"content":"Could not load type ‘System.ServiceModel.Activation.HttpModule’ from assembly ‘System.ServiceModel, Version 3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089’","linkify":"Could not load type ‘System.ServiceModel.Activation.HttpModule’ from assembly ‘System.ServiceModel, Version 3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089’","nodes":[{"content":"Could not load type ‘System.ServiceModel.Activation.HttpModule’ from assembly ‘System.ServiceModel, Version 3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089’","pos":[0,166]}]},{"content":"This error occurs if <ph id=\"ph1\">[!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)]</ph> is installed and then WCF HTTP Activation is enabled.","pos":[5634,5773],"source":"This error occurs if [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] is installed and then WCF HTTP Activation is enabled."},{"content":"To resolve the issue run the following command-line from inside the Developer Command Prompt for Visual Studio:","pos":[5774,5885]},{"pos":[5946,5954],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5958,6039],"content":"<bpt id=\"p1\">[</bpt>Set-Up Instructions<ept id=\"p1\">](../../../docs/framework/wcf/samples/set-up-instructions.md)</ept>","source":"[Set-Up Instructions](../../../docs/framework/wcf/samples/set-up-instructions.md)"}]}