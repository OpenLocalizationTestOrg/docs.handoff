{"content":"---\ntitle: \"Windows Forms and Unmanaged Applications Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM [Windows Forms]\"\n  - \"Windows Forms, unmanaged\"\n  - \"COM interop\"\n  - \"ActiveX controls [Windows Forms], about ActiveX controls\"\n  - \"Windows Forms, interop\"\nms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Windows Forms and Unmanaged Applications Overview\nWindows Forms applications and controls can interoperate with unmanaged applications, with some caveats. The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.  \n  \n## Windows Forms Controls and ActiveX Applications  \n With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls. Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.  \n  \n These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop. The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer. For more information about COM interop, see  \n  \n [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).  \n  \n The following table shows the available ActiveX hosting support for Windows Forms controls.  \n  \n|Windows Forms version|Support|  \n|---------------------------|-------------|  \n|.NET Framework version 1.0|Internet Explorer 5.01 and later versions|  \n|.NET Framework version 1.1 and later|Internet Explorer 5.01 and later versions<br /><br /> Microsoft Foundation Classes (MFC) 7.0 and later|  \n  \n## Hosting Windows Forms components as ActiveX controls  \n In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions. This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.  \n  \n However, registration of Windows Forms controls as ActiveX controls is not supported. Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported. Only managed activation of Windows Forms controls is supported. Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.  \n  \n To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features. Using the C++ interop features is the recommended solution.  \n  \n## Windows Forms in COM client applications  \n When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly. For example, when you press the TAB key, the focus does not change from one control to another control. When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised. You may also experience unexpected behavior for keystrokes or mouse activity.  \n  \n This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly. The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.  \n  \n An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled. The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide. The window messages that are posted to the message loop may be handled differently than the Windows Form expects. Therefore, unexpected behavior may occur. Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.  \n  \n## Resolving Interoperability Issues  \n You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=fullName> method.  \n  \n To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop. To do this, use one of the following approaches:  \n  \n-   Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=fullName> method to display the Windows Form. For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).  \n  \n-   Display each Windows Form on a new thread. For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).  \n  \n## See Also  \n [Windows Forms and Unmanaged Applications](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md)   \n [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)   \n [COM Interoperability in .NET Framework Applications](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)   \n [COM Interoperability Samples](http://msdn.microsoft.com/en-us/09c38567-6380-4d70-848a-e896a4ca05f4)   \n [Aximp.exe (Windows Forms ActiveX Control Importer)](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md)   \n [Exposing .NET Framework Components to COM](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md)   \n [Packaging an Assembly for COM](../../../../docs/framework/interop/packaging-an-assembly-for-com.md)   \n [Registering Assemblies with COM](../../../../docs/framework/interop/registering-assemblies-with-com.md)   \n [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)   \n [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)","nodes":[{"pos":[4,598],"nodes":[{"content":"Windows Forms and Unmanaged Applications Overview | Microsoft Docs","nodes":[{"pos":[0,66],"content":"Windows Forms and Unmanaged Applications Overview | Microsoft Docs","nodes":[{"content":"Windows Forms and Unmanaged Applications Overview | Microsoft Docs","pos":[0,66]}]}],"pos":[6,75],"yaml":true}],"content":"title: \"Windows Forms and Unmanaged Applications Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM [Windows Forms]\"\n  - \"Windows Forms, unmanaged\"\n  - \"COM interop\"\n  - \"ActiveX controls [Windows Forms], about ActiveX controls\"\n  - \"Windows Forms, interop\"\nms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[605,654],"content":"Windows Forms and Unmanaged Applications Overview","linkify":"Windows Forms and Unmanaged Applications Overview","nodes":[{"content":"Windows Forms and Unmanaged Applications Overview","pos":[0,49]}]},{"content":"Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.","pos":[655,759]},{"content":"The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.","pos":[760,913]},{"pos":[922,969],"content":"Windows Forms Controls and ActiveX Applications","linkify":"Windows Forms Controls and ActiveX Applications","nodes":[{"content":"Windows Forms Controls and ActiveX Applications","pos":[0,47]}]},{"content":"With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.","pos":[973,1154]},{"content":"Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.","pos":[1155,1409]},{"content":"These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.","pos":[1416,1525]},{"content":"The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.","pos":[1526,1637]},{"content":"For more information about COM interop, see","pos":[1638,1681]},{"pos":[1688,1764],"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>.","source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)."},{"content":"The following table shows the available ActiveX hosting support for Windows Forms controls.","pos":[1771,1862]},{"content":"Windows Forms version","pos":[1869,1890]},{"content":"Support","pos":[1891,1898]},{"content":".NET Framework version 1.0","pos":[1949,1975]},{"content":"Internet Explorer 5.01 and later versions","pos":[1976,2017]},{"content":".NET Framework version 1.1 and later","pos":[2022,2058]},{"content":"Internet Explorer 5.01 and later versions","pos":[2059,2100]},{"content":"Microsoft Foundation Classes (MFC) 7.0 and later","pos":[2113,2161]},{"pos":[2171,2223],"content":"Hosting Windows Forms components as ActiveX controls","linkify":"Hosting Windows Forms components as ActiveX controls","nodes":[{"content":"Hosting Windows Forms components as ActiveX controls","pos":[0,52]}]},{"content":"In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.","pos":[2227,2313]},{"content":"This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.","pos":[2314,2428]},{"content":"However, registration of Windows Forms controls as ActiveX controls is not supported.","pos":[2435,2520]},{"content":"Also, calling the <ph id=\"ph1\">`com.ms.win32.Ole32.CoCreateInstance`</ph> method for Windows Forms controls is not supported.","pos":[2521,2628],"source":" Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported."},{"content":"Only managed activation of Windows Forms controls is supported.","pos":[2629,2692]},{"content":"Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.","pos":[2693,2804]},{"content":"To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.","pos":[2811,2970]},{"content":"Using the C++ interop features is the recommended solution.","pos":[2971,3030]},{"pos":[3039,3079],"content":"Windows Forms in COM client applications","linkify":"Windows Forms in COM client applications","nodes":[{"content":"Windows Forms in COM client applications","pos":[0,40]}]},{"content":"When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.","pos":[3083,3238]},{"content":"For example, when you press the TAB key, the focus does not change from one control to another control.","pos":[3239,3342]},{"content":"When you press the ENTER key while a command button has focus, the button's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event is not raised.","pos":[3343,3481],"source":" When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised."},{"content":"You may also experience unexpected behavior for keystrokes or mouse activity.","pos":[3482,3559]},{"content":"This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.","pos":[3566,3711]},{"content":"The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.","pos":[3712,3831]},{"content":"An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.","pos":[3838,4021]},{"content":"The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.","pos":[4022,4206]},{"content":"The window messages that are posted to the message loop may be handled differently than the Windows Form expects.","pos":[4207,4320]},{"content":"Therefore, unexpected behavior may occur.","pos":[4321,4362]},{"content":"Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.","pos":[4363,4484]},{"pos":[4493,4526],"content":"Resolving Interoperability Issues","linkify":"Resolving Interoperability Issues","nodes":[{"content":"Resolving Interoperability Issues","pos":[0,33]}]},{"pos":[4530,4776],"content":"You can resolve these problems by displaying the form on a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> message loop, which is created by using the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Application.Run%2A?displayProperty=fullName&gt;</ph> method.","source":"You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=fullName> method."},{"content":"To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.","pos":[4783,4900]},{"content":"To do this, use one of the following approaches:","pos":[4901,4949]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=fullName&gt;</ph> method to display the Windows Form.","pos":[4959,5074],"source":"Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=fullName> method to display the Windows Form."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)</ept>.","pos":[5075,5284],"source":" For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)."},{"content":"Display each Windows Form on a new thread.","pos":[5294,5336]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)</ept>.","pos":[5337,5569],"source":" For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)."},{"pos":[5578,5586],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Windows Forms and Unmanaged Applications<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[5590,5723],"source":"[Windows Forms and Unmanaged Applications](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5727,5803],"source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[5807,5966],"source":"[COM Interoperability in .NET Framework Applications](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>COM Interoperability Samples<ept id=\"p1\">](http://msdn.microsoft.com/en-us/09c38567-6380-4d70-848a-e896a4ca05f4)</ept><ph id=\"ph1\"> </ph>","pos":[5970,6071],"source":"[COM Interoperability Samples](http://msdn.microsoft.com/en-us/09c38567-6380-4d70-848a-e896a4ca05f4) "},{"content":"<bpt id=\"p1\">[</bpt>Aximp.exe (Windows Forms ActiveX Control Importer)<ept id=\"p1\">](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md)</ept><ph id=\"ph1\"> </ph>","pos":[6075,6214],"source":"[Aximp.exe (Windows Forms ActiveX Control Importer)](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md) "},{"content":"<bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[6218,6335],"source":"[Exposing .NET Framework Components to COM](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>Packaging an Assembly for COM<ept id=\"p1\">](../../../../docs/framework/interop/packaging-an-assembly-for-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[6339,6440],"source":"[Packaging an Assembly for COM](../../../../docs/framework/interop/packaging-an-assembly-for-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>Registering Assemblies with COM<ept id=\"p1\">](../../../../docs/framework/interop/registering-assemblies-with-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[6444,6549],"source":"[Registering Assemblies with COM](../../../../docs/framework/interop/registering-assemblies-with-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)</ept><ph id=\"ph1\"> </ph>","pos":[6553,6736],"source":"[How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)</ept>","pos":[6740,6945],"source":"[How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)"}]}