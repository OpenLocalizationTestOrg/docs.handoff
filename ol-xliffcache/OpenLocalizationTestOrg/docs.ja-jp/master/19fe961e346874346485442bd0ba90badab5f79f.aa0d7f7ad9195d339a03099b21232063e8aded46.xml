{"content":"---\ntitle: \"ReadMe for Extended Protection Authentication Sample\"\nms.date: \"03/30/2017\"\nms.assetid: 80bf2e97-398d-4db5-9040-d96478a2ccab\n---\n# ReadMe for Extended Protection Authentication Sample\nExtended Protection is a security initiative to protect against man-in-the-middle (MITM) attacks, in which an attacker (the \"man-in-the-middle\") intercepts a client’s credentials and uses them to access secure resources on the client’s intended server.  \n  \n For more information, see [Extended Protection for Authentication Overview](../../../../docs/framework/wcf/feature-details/extended-protection-for-authentication-overview.md).  \n  \n> [!NOTE]\n>  This sample only works when hosted on IIS. It does not work on Visual Studio Development Server because that does not support HTTPS.  \n  \n## To Set Up, Build, and Run the Sample  \n  \n1.  Install IIS on the machine from Add/Remove Programs -> Windows Features.  \n  \n2.  Turn on Windows Authentication in Windows features: Internet Information Services -> World Wide Web Services -> Security -> Windows Authentication.  \n  \n3.  Turn on HTTP Activation in Windows features: Microsoft .NET Framework 3.5.1 -> Windows Communication Foundation HTTP Activation.  \n  \n4.  This sample requires the client to establish a secure channel with the server and so it requires the presence of a server certificate which can be installed from Internet Information Services (IIS) Manager.  \n  \n    1.  Open the IIS manager -> Server certificates (from the feature view tab).  \n  \n    2.  For the purpose of testing this sample, you can create a self-signed certificate. (If you don’t want Internet Explorer to prompt you about the certificate not being secure, you can install it in the Trusted Certificate Root authority store).  \n  \n5.  Go to the Actions pane for the Default Web site. Click Edit Site -> Bindings. Add HTTPS as a type if it is not already present, with port number 443, and assign the SSL certificate created in the above step.  \n  \n6.  Build the service. This creates a virtual directory in IIS for you (from the post build action specified in the project properties) and copies the dll, .svc and config files as needed for a service to be Web hosted.  \n  \n7.  Open the IIS Manager. Right-click the virtual directory (ExtendedProtection) that you created in the previous step and select Convert to Application.  \n  \n8.  Open the Authentication module in IIS Manager for this virtual directory and enable Windows Authentication.  \n  \n9. Open the Advanced Settings for Windows Authentication for this virtual directory and set it to Required, since, in the sample, the corresponding ExtendedProtection setting is set to Always.  \n  \n10. You can test the service by accessing the URL from a browser window. If you want to access this URL from a cross machine, make sure that the firewall is opened for all incoming HTTP and HTTPS connections.  \n  \n11. Open the client config file and provide a full machine name for the \\<client> - \\<endpoint> - address attribute, replacing <<full_machine_name>>.  \n  \n12. Run the client. The client communicates to the service by establishing a secure channel and using extended protection under the covers.\n","nodes":[{"pos":[4,136],"embed":true,"restype":"x-metadata","content":"title: \"ReadMe for Extended Protection Authentication Sample\"\nms.date: \"03/30/2017\"\nms.assetid: 80bf2e97-398d-4db5-9040-d96478a2ccab","nodes":[{"content":"ReadMe for Extended Protection Authentication Sample","nodes":[{"pos":[0,52],"content":"ReadMe for Extended Protection Authentication Sample","nodes":[{"content":"ReadMe for Extended Protection Authentication Sample","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[143,195],"content":"ReadMe for Extended Protection Authentication Sample","linkify":"ReadMe for Extended Protection Authentication Sample","nodes":[{"content":"ReadMe for Extended Protection Authentication Sample","pos":[0,52]}]},{"content":"Extended Protection is a security initiative to protect against man-in-the-middle (MITM) attacks, in which an attacker (the \"man-in-the-middle\") intercepts a client’s credentials and uses them to access secure resources on the client’s intended server.","pos":[196,448]},{"pos":[455,630],"content":"For more information, see <bpt id=\"p1\">[</bpt>Extended Protection for Authentication Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/extended-protection-for-authentication-overview.md)</ept>.","source":"For more information, see [Extended Protection for Authentication Overview](../../../../docs/framework/wcf/feature-details/extended-protection-for-authentication-overview.md)."},{"pos":[638,781],"content":"[!NOTE]\n This sample only works when hosted on IIS. It does not work on Visual Studio Development Server because that does not support HTTPS.","leadings":["","> "],"nodes":[{"content":"This sample only works when hosted on IIS. It does not work on Visual Studio Development Server because that does not support HTTPS.","pos":[9,141],"nodes":[{"content":"This sample only works when hosted on IIS.","pos":[0,42]},{"content":"It does not work on Visual Studio Development Server because that does not support HTTPS.","pos":[43,132]}]}]},{"pos":[790,826],"content":"To Set Up, Build, and Run the Sample","linkify":"To Set Up, Build, and Run the Sample","nodes":[{"content":"To Set Up, Build, and Run the Sample","pos":[0,36]}]},{"content":"Install IIS on the machine from Add/Remove Programs -&gt; Windows Features.","pos":[836,908],"source":"Install IIS on the machine from Add/Remove Programs -> Windows Features."},{"content":"Turn on Windows Authentication in Windows features: Internet Information Services -&gt; World Wide Web Services -&gt; Security -&gt; Windows Authentication.","pos":[918,1065],"source":"Turn on Windows Authentication in Windows features: Internet Information Services -> World Wide Web Services -> Security -> Windows Authentication."},{"content":"Turn on HTTP Activation in Windows features: Microsoft .NET Framework 3.5.1 -&gt; Windows Communication Foundation HTTP Activation.","pos":[1075,1203],"source":"Turn on HTTP Activation in Windows features: Microsoft .NET Framework 3.5.1 -> Windows Communication Foundation HTTP Activation."},{"content":"This sample requires the client to establish a secure channel with the server and so it requires the presence of a server certificate which can be installed from Internet Information Services (IIS) Manager.","pos":[1213,1419]},{"content":"Open the IIS manager -&gt; Server certificates (from the feature view tab).","pos":[1433,1505],"source":"Open the IIS manager -> Server certificates (from the feature view tab)."},{"content":"For the purpose of testing this sample, you can create a self-signed certificate.","pos":[1519,1600]},{"content":"(If you don’t want Internet Explorer to prompt you about the certificate not being secure, you can install it in the Trusted Certificate Root authority store).","pos":[1601,1760]},{"content":"Go to the Actions pane for the Default Web site.","pos":[1770,1818]},{"content":"Click Edit Site -&gt; Bindings.","pos":[1819,1847],"source":" Click Edit Site -> Bindings."},{"content":"Add HTTPS as a type if it is not already present, with port number 443, and assign the SSL certificate created in the above step.","pos":[1848,1977]},{"content":"Build the service.","pos":[1987,2005]},{"content":"This creates a virtual directory in IIS for you (from the post build action specified in the project properties) and copies the dll, .svc and config files as needed for a service to be Web hosted.","pos":[2006,2202]},{"content":"Open the IIS Manager.","pos":[2212,2233]},{"content":"Right-click the virtual directory (ExtendedProtection) that you created in the previous step and select Convert to Application.","pos":[2234,2361]},{"content":"Open the Authentication module in IIS Manager for this virtual directory and enable Windows Authentication.","pos":[2371,2478]},{"content":"Open the Advanced Settings for Windows Authentication for this virtual directory and set it to Required, since, in the sample, the corresponding ExtendedProtection setting is set to Always.","pos":[2487,2676]},{"content":"You can test the service by accessing the URL from a browser window.","pos":[2686,2754]},{"content":"If you want to access this URL from a cross machine, make sure that the firewall is opened for all incoming HTTP and HTTPS connections.","pos":[2755,2890]},{"content":"Open the client config file and provide a full machine name for the <ph id=\"ph1\">\\&lt;</ph>client&gt; - <ph id=\"ph2\">\\&lt;</ph>endpoint&gt; - address attribute, replacing &lt;&lt;full_machine_name&gt;&gt;.","pos":[2900,3045],"source":"Open the client config file and provide a full machine name for the \\<client> - \\<endpoint> - address attribute, replacing <<full_machine_name>>."},{"content":"Run the client.","pos":[3055,3070]},{"content":"The client communicates to the service by establishing a secure channel and using extended protection under the covers.","pos":[3071,3190]}]}