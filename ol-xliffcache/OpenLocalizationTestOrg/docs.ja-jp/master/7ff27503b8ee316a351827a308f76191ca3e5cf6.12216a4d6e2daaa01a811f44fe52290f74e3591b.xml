{"content":"---\ntitle: \"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"Windows Forms, content copying and pasting\"\n  - \"interoperability [WPF]\"\n  - \"ElementHost control, copying and pasting at design time\"\n  - \"WPF user control, hosting in Windows Forms\"\nms.assetid: 6e81bb13-577c-46c3-a1cf-8d15969fb83e\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms\nThis walkthrough shows you how to copy a Windows Presentation Foundation (WPF) control from one Windows Form to another.  \n  \n In this walkthrough, you perform the following tasks:  \n  \n-   Create the project.  \n  \n-   Copy a WPF Control.  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev11_long](../../../../includes/vs-dev11-long-md.md)].  \n  \n## Creating the Project  \n The first step is to create the Windows Forms project.  \n  \n> [!NOTE]\n>  When hosting WPF content, only C# and Visual Basic projects are supported.  \n  \n#### To create the project  \n  \n-   Create a new Windows Forms Application project in Visual Basic or Visual C# named `CopyElementHost`.  \n  \n## Copying a WPF Control  \n After you add a WPF control to the project, you can copy it to other forms in the project.  \n  \n#### To copy a WPF control  \n  \n1.  Add a new WPF <xref:System.Windows.Controls.UserControl> project to the solution. Use the default name for the control type, `UserControl1.xaml`. For more information, see [Walkthrough: Creating New WPF Content on Windows Forms at Design Time](../../../../docs/framework/winforms/advanced/walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md).  \n  \n2.  Build the project.  \n  \n3.  Open `Form1` in the Windows Forms Designer.  \n  \n4.  From the **Toolbox**, drag an instance of `UserControl1` onto the form.  \n  \n     An instance of `UserControl1` is hosted in a new <xref:System.Windows.Forms.Integration.ElementHost> control named `elementHost1`.  \n  \n5.  With `elementHost1` selected, press CTRL+C to copy it to the clipboard.  \n  \n6.  Add a new Windows Form to the project. Use the default name for the form type, `Form2`.  \n  \n7.  With `Form2` open in the Windows Forms Designer, press CTRL+V to paste a copy of `elementHost1` onto the form.  \n  \n     The copied control is also named `elementHost1`, because it is a private field of the `Form2` class. There is no name collision with the `elementHost1` in the `Form1` class.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [Migration and Interoperability](../../../../docs/framework/wpf/advanced/migration-and-interoperability.md)   \n [Using WPF Controls](../../../../docs/framework/winforms/advanced/using-wpf-controls.md)   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)","nodes":[{"pos":[4,654],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"Windows Forms, content copying and pasting\"\n  - \"interoperability [WPF]\"\n  - \"ElementHost control, copying and pasting at design time\"\n  - \"WPF user control, hosting in Windows Forms\"\nms.assetid: 6e81bb13-577c-46c3-a1cf-8d15969fb83e\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms | Microsoft Docs","nodes":[{"pos":[0,100],"content":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms | Microsoft Docs","nodes":[{"content":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms | Microsoft Docs","pos":[0,100]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[661,744],"content":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms","linkify":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms","nodes":[{"content":"Walkthrough: Copying and Pasting an ElementHost Control into Separate Windows Forms","pos":[0,83]}]},{"content":"This walkthrough shows you how to copy a Windows Presentation Foundation (WPF) control from one Windows Form to another.","pos":[745,865]},{"content":"In this walkthrough, you perform the following tasks:","pos":[872,925]},{"content":"Create the project.","pos":[935,954]},{"content":"Copy a WPF Control.","pos":[964,983]},{"pos":[991,1367],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","pos":[9,374],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Customizing Development Settings in Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)</ept>.","pos":[217,365],"source":" For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)."}]}]},{"pos":[1376,1389],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1393,1456]},{"pos":[1466,1534],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev11_long](../../../../includes/vs-dev11-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev11_long](../../../../includes/vs-dev11-long-md.md)]."},{"pos":[1543,1563],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"The first step is to create the Windows Forms project.","pos":[1567,1621]},{"pos":[1629,1714],"content":"[!NOTE]\n When hosting WPF content, only C# and Visual Basic projects are supported.","leadings":["","> "],"nodes":[{"content":"When hosting WPF content, only C# and Visual Basic projects are supported.","pos":[9,83]}]},{"pos":[1725,1746],"content":"To create the project","linkify":"To create the project","nodes":[{"content":"To create the project","pos":[0,21]}]},{"pos":[1756,1856],"content":"Create a new Windows Forms Application project in Visual Basic or Visual C# named <ph id=\"ph1\">`CopyElementHost`</ph>.","source":"Create a new Windows Forms Application project in Visual Basic or Visual C# named `CopyElementHost`."},{"pos":[1865,1886],"content":"Copying a WPF Control","linkify":"Copying a WPF Control","nodes":[{"content":"Copying a WPF Control","pos":[0,21]}]},{"content":"After you add a WPF control to the project, you can copy it to other forms in the project.","pos":[1890,1980]},{"pos":[1991,2012],"content":"To copy a WPF control","linkify":"To copy a WPF control","nodes":[{"content":"To copy a WPF control","pos":[0,21]}]},{"content":"Add a new WPF <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> project to the solution.","pos":[2022,2103],"source":"Add a new WPF <xref:System.Windows.Controls.UserControl> project to the solution."},{"content":"Use the default name for the control type, <ph id=\"ph1\">`UserControl1.xaml`</ph>.","pos":[2104,2167],"source":" Use the default name for the control type, `UserControl1.xaml`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Creating New WPF Content on Windows Forms at Design Time<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md)</ept>.","pos":[2168,2384],"source":" For more information, see [Walkthrough: Creating New WPF Content on Windows Forms at Design Time](../../../../docs/framework/winforms/advanced/walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md)."},{"content":"Build the project.","pos":[2394,2412]},{"pos":[2422,2465],"content":"Open <ph id=\"ph1\">`Form1`</ph> in the Windows Forms Designer.","source":"Open `Form1` in the Windows Forms Designer."},{"pos":[2475,2546],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag an instance of <ph id=\"ph1\">`UserControl1`</ph> onto the form.","source":"From the **Toolbox**, drag an instance of `UserControl1` onto the form."},{"pos":[2557,2687],"content":"An instance of <ph id=\"ph1\">`UserControl1`</ph> is hosted in a new <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control named <ph id=\"ph3\">`elementHost1`</ph>.","source":"An instance of `UserControl1` is hosted in a new <xref:System.Windows.Forms.Integration.ElementHost> control named `elementHost1`."},{"pos":[2697,2768],"content":"With <ph id=\"ph1\">`elementHost1`</ph> selected, press CTRL+C to copy it to the clipboard.","source":"With `elementHost1` selected, press CTRL+C to copy it to the clipboard."},{"content":"Add a new Windows Form to the project.","pos":[2778,2816]},{"content":"Use the default name for the form type, <ph id=\"ph1\">`Form2`</ph>.","pos":[2817,2865],"source":" Use the default name for the form type, `Form2`."},{"pos":[2875,2985],"content":"With <ph id=\"ph1\">`Form2`</ph> open in the Windows Forms Designer, press CTRL+V to paste a copy of <ph id=\"ph2\">`elementHost1`</ph> onto the form.","source":"With `Form2` open in the Windows Forms Designer, press CTRL+V to paste a copy of `elementHost1` onto the form."},{"content":"The copied control is also named <ph id=\"ph1\">`elementHost1`</ph>, because it is a private field of the <ph id=\"ph2\">`Form2`</ph> class.","pos":[2996,3096],"source":"The copied control is also named `elementHost1`, because it is a private field of the `Form2` class."},{"content":"There is no name collision with the <ph id=\"ph1\">`elementHost1`</ph> in the <ph id=\"ph2\">`Form1`</ph> class.","pos":[3097,3169],"source":" There is no name collision with the `elementHost1` in the `Form1` class."},{"pos":[3178,3186],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph>","pos":[3190,3241],"source":"<xref:System.Windows.Forms.Integration.ElementHost> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph>","pos":[3246,3302],"source":"<xref:System.Windows.Forms.Integration.WindowsFormsHost> "},{"content":"<bpt id=\"p1\">[</bpt>Migration and Interoperability<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/migration-and-interoperability.md)</ept><ph id=\"ph1\"> </ph>","pos":[3307,3415],"source":"[Migration and Interoperability](../../../../docs/framework/wpf/advanced/migration-and-interoperability.md) "},{"content":"<bpt id=\"p1\">[</bpt>Using WPF Controls<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/using-wpf-controls.md)</ept><ph id=\"ph1\"> </ph>","pos":[3419,3508],"source":"[Using WPF Controls](../../../../docs/framework/winforms/advanced/using-wpf-controls.md) "},{"content":"<bpt id=\"p1\">[</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept>","pos":[3512,3596],"source":"[WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)"}]}