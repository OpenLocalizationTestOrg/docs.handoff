{"content":"---\ntitle: \"Evaluate XPath Expressions using XPathNavigator | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nms.assetid: 2913ccf3-f932-4363-8028-9e2d22ce6093\ncaps.latest.revision: 2\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# Evaluate XPath Expressions using XPathNavigator\nThe <xref:System.Xml.XPath.XPathNavigator> class provides the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method to evaluate an XPath expression. The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method takes an XPath expression, evaluates it and returns a W3C XPath type of Boolean, Number, String, or Node Set based on the result of the XPath expression.  \n  \n## The Evaluate Method  \n The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method takes an XPath expression, evaluates it, and returns a typed result of Boolean (<xref:System.Boolean>), Number (<xref:System.Double>), String (<xref:System.String>), or Node Set (<xref:System.Xml.XPath.XPathNodeIterator>). For example, the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method could be used in a mathematical method. The following example code calculates the total price of all the books in the `books.xml` file.  \n  \n```vb  \nDim document As XPathDocument = New XPathDocument(\"books.xml\")  \nDim navigator As XPathNavigator = document.CreateNavigator()  \n  \nDim query As XPathExpression = navigator.Compile(\"sum(//price/text())\")  \nDim total As Double = CType(navigator.Evaluate(query), Double)  \nConsole.WriteLine(total)  \n```  \n  \n```csharp  \nXPathDocument document = new XPathDocument(\"books.xml\");  \nXPathNavigator navigator = document.CreateNavigator();  \n  \nXPathExpression query = navigator.Compile(\"sum(//price/text())\");  \nDouble total = (Double)navigator.Evaluate(query);  \nConsole.WriteLine(total);  \n```  \n  \n The example takes the `books.xml` file as input.  \n  \n [!code-xml[XPathXMLExamples#1](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/books.xml#1)]  \n  \n### position and last Functions  \n The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method is overloaded. One of the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> methods takes an <xref:System.Xml.XPath.XPathNodeIterator> object as a parameter. This particular <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method is identical to the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method that takes only an <xref:System.Xml.XPath.XPathExpression> object as a parameter, except that it allows a node set argument to specify the current context to perform the evaluation on. This context is required for the XPath `position()` and `last()` functions as they are relative to the current context node. Unless used as a predicate in a location step, the `position()` and `last()` functions require a reference to a node set in order to be evaluated otherwise, the `position` and `last` functions return `0`.  \n  \n## See Also  \n <xref:System.Xml.XmlDocument>   \n <xref:System.Xml.XPath.XPathDocument>   \n <xref:System.Xml.XPath.XPathNavigator>   \n [Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)   \n [Select XML Data Using XPathNavigator](../../../../docs/standard/data/xml/select-xml-data-using-xpathnavigator.md)   \n [Matching Nodes using XPathNavigator](../../../../docs/standard/data/xml/matching-nodes-using-xpathnavigator.md)   \n [Node Types Recognized with XPath Queries](../../../../docs/standard/data/xml/node-types-recognized-with-xpath-queries.md)   \n [XPath Queries and Namespaces](../../../../docs/standard/data/xml/xpath-queries-and-namespaces.md)   \n [Compiled XPath Expressions](../../../../docs/standard/data/xml/compiled-xpath-expressions.md)","nodes":[{"pos":[4,414],"embed":true,"restype":"x-metadata","content":"title: \"Evaluate XPath Expressions using XPathNavigator | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nms.assetid: 2913ccf3-f932-4363-8028-9e2d22ce6093\ncaps.latest.revision: 2\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"Evaluate XPath Expressions using XPathNavigator | Microsoft Docs","nodes":[{"pos":[0,64],"content":"Evaluate XPath Expressions using XPathNavigator | Microsoft Docs","nodes":[{"content":"Evaluate XPath Expressions using XPathNavigator | Microsoft Docs","pos":[0,64]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[421,468],"content":"Evaluate XPath Expressions using XPathNavigator","linkify":"Evaluate XPath Expressions using XPathNavigator","nodes":[{"content":"Evaluate XPath Expressions using XPathNavigator","pos":[0,47]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method to evaluate an XPath expression.","pos":[469,621],"source":"The <xref:System.Xml.XPath.XPathNavigator> class provides the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method to evaluate an XPath expression."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method takes an XPath expression, evaluates it and returns a W3C XPath type of Boolean, Number, String, or Node Set based on the result of the XPath expression.","pos":[622,837],"source":" The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method takes an XPath expression, evaluates it and returns a W3C XPath type of Boolean, Number, String, or Node Set based on the result of the XPath expression."},{"pos":[846,865],"content":"The Evaluate Method","linkify":"The Evaluate Method","nodes":[{"content":"The Evaluate Method","pos":[0,19]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method takes an XPath expression, evaluates it, and returns a typed result of Boolean (<ph id=\"ph2\">&lt;xref:System.Boolean&gt;</ph>), Number (<ph id=\"ph3\">&lt;xref:System.Double&gt;</ph>), String (<ph id=\"ph4\">&lt;xref:System.String&gt;</ph>), or Node Set (<ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNodeIterator&gt;</ph>).","pos":[869,1153],"source":"The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method takes an XPath expression, evaluates it, and returns a typed result of Boolean (<xref:System.Boolean>), Number (<xref:System.Double>), String (<xref:System.String>), or Node Set (<xref:System.Xml.XPath.XPathNodeIterator>)."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method could be used in a mathematical method.","pos":[1154,1268],"source":" For example, the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method could be used in a mathematical method."},{"content":"The following example code calculates the total price of all the books in the <ph id=\"ph1\">`books.xml`</ph> file.","pos":[1269,1364],"source":" The following example code calculates the total price of all the books in the `books.xml` file."},{"pos":[1973,2021],"content":"The example takes the <ph id=\"ph1\">`books.xml`</ph> file as input.","source":"The example takes the `books.xml` file as input."},{"pos":[2153,2180],"content":"position and last Functions","linkify":"position and last Functions","nodes":[{"content":"position and last Functions","pos":[0,27]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method is overloaded.","pos":[2184,2260],"source":"The <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method is overloaded."},{"content":"One of the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> methods takes an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNodeIterator&gt;</ph> object as a parameter.","pos":[2261,2404],"source":" One of the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> methods takes an <xref:System.Xml.XPath.XPathNodeIterator> object as a parameter."},{"content":"This particular <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method is identical to the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.Evaluate%2A&gt;</ph> method that takes only an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathExpression&gt;</ph> object as a parameter, except that it allows a node set argument to specify the current context to perform the evaluation on.","pos":[2405,2741],"source":" This particular <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method is identical to the <xref:System.Xml.XPath.XPathNavigator.Evaluate%2A> method that takes only an <xref:System.Xml.XPath.XPathExpression> object as a parameter, except that it allows a node set argument to specify the current context to perform the evaluation on."},{"content":"This context is required for the XPath <ph id=\"ph1\">`position()`</ph> and <ph id=\"ph2\">`last()`</ph> functions as they are relative to the current context node.","pos":[2742,2866],"source":" This context is required for the XPath `position()` and `last()` functions as they are relative to the current context node."},{"content":"Unless used as a predicate in a location step, the <ph id=\"ph1\">`position()`</ph> and <ph id=\"ph2\">`last()`</ph> functions require a reference to a node set in order to be evaluated otherwise, the <ph id=\"ph3\">`position`</ph> and <ph id=\"ph4\">`last`</ph> functions return <ph id=\"ph5\">`0`</ph>.","pos":[2867,3071],"source":" Unless used as a predicate in a location step, the `position()` and `last()` functions require a reference to a node set in order to be evaluated otherwise, the `position` and `last` functions return `0`."},{"pos":[3080,3088],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Process XML Data Using the XPath Data Model<ept id=\"p1\">](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)</ept><ph id=\"ph1\"> </ph>","pos":[3211,3340],"source":"[Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md) "},{"content":"<bpt id=\"p1\">[</bpt>Select XML Data Using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/select-xml-data-using-xpathnavigator.md)</ept><ph id=\"ph1\"> </ph>","pos":[3344,3459],"source":"[Select XML Data Using XPathNavigator](../../../../docs/standard/data/xml/select-xml-data-using-xpathnavigator.md) "},{"content":"<bpt id=\"p1\">[</bpt>Matching Nodes using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/matching-nodes-using-xpathnavigator.md)</ept><ph id=\"ph1\"> </ph>","pos":[3463,3576],"source":"[Matching Nodes using XPathNavigator](../../../../docs/standard/data/xml/matching-nodes-using-xpathnavigator.md) "},{"content":"<bpt id=\"p1\">[</bpt>Node Types Recognized with XPath Queries<ept id=\"p1\">](../../../../docs/standard/data/xml/node-types-recognized-with-xpath-queries.md)</ept><ph id=\"ph1\"> </ph>","pos":[3580,3703],"source":"[Node Types Recognized with XPath Queries](../../../../docs/standard/data/xml/node-types-recognized-with-xpath-queries.md) "},{"content":"<bpt id=\"p1\">[</bpt>XPath Queries and Namespaces<ept id=\"p1\">](../../../../docs/standard/data/xml/xpath-queries-and-namespaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[3707,3806],"source":"[XPath Queries and Namespaces](../../../../docs/standard/data/xml/xpath-queries-and-namespaces.md) "},{"content":"<bpt id=\"p1\">[</bpt>Compiled XPath Expressions<ept id=\"p1\">](../../../../docs/standard/data/xml/compiled-xpath-expressions.md)</ept>","pos":[3810,3904],"source":"[Compiled XPath Expressions](../../../../docs/standard/data/xml/compiled-xpath-expressions.md)"}]}