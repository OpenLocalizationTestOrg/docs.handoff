{"content":"---\ntitle: \"GetSchema and Schema Collections\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 7ab93b89-1221-427c-84ad-04803b3c64b4\n---\n# GetSchema and Schema Collections\nThe **Connection** classes in each of the .NET Framework managed providers implement a **GetSchema** method which is used to retrieve schema information about the database that is currently connected, and the schema information returned from the **GetSchema** method comes in the form of a <xref:System.Data.DataTable>. The **GetSchema** method is an overloaded method that provides optional parameters for specifying the schema collection to return, and restricting the amount of information returned.  \n  \n## Specifying the Schema Collections  \n The first optional parameter of the **GetSchema** method is the collection name which is specified as a string. There are two types of schema collections: common schema collections that are common to all providers, and specific schema collections which are specific to each provider.  \n  \n You can query a .NET Framework managed provider to determine the list of supported schema collections by calling the **GetSchema** method with no arguments, or with the schema collection name \"MetaDataCollections\". This will return a <xref:System.Data.DataTable> with a list of the supported schema collections, the number of restrictions that they each support, and the number of identifier parts that they use.  \n  \n### Retrieving Schema Collections Example  \n The following examples demonstrate how to use the <xref:System.Data.SqlClient.SqlConnection.GetSchema%2A> method of the .NET Framework Data Provider for the SQL Server <xref:System.Data.SqlClient.SqlConnection> class to retrieve schema information about all of the tables contained in the **AdventureWorks** sample database:  \n  \n```vb  \nImports System.Data.SqlClient  \n  \nModule Module1  \n   Sub Main()  \n      Dim connectionString As String = GetConnectionString()  \n      Using connection As New SqlConnection(connectionString)  \n         'Connect to the database then retrieve the schema information.  \n         connection.Open()  \n         Dim table As DataTable = connection.GetSchema(\"Tables\")  \n  \n         ' Display the contents of the table.  \n         DisplayData(table)  \n         Console.WriteLine(\"Press any key to continue.\")  \n         Console.ReadKey()  \n      End Using  \n   End Sub  \n  \n   Private Function GetConnectionString() As String  \n      ' To avoid storing the connection string in your code,    \n      ' you can retrieve it from a configuration file.  \n      Return \"Data Source=(local);Database=AdventureWorks;\" _  \n         & \"Integrated Security=true;\"  \n   End Function  \n  \n   Private Sub DisplayData(ByVal table As DataTable)  \n      For Each row As DataRow In table.Rows  \n         For Each col As DataColumn In table.Columns  \n            Console.WriteLine(\"{0} = {1}\", col.ColumnName, row(col))  \n         Next  \n         Console.WriteLine(\"============================\")  \n      Next  \n   End Sub  \nEnd Module  \n```  \n  \n```csharp  \nusing System;  \nusing System.Data;  \nusing System.Data.SqlClient;  \n  \nclass Program  \n{  \n  static void Main()  \n  {  \n  string connectionString = GetConnectionString();  \n  using (SqlConnection connection = new SqlConnection(connectionString))  \n  {  \n   // Connect to the database then retrieve the schema information.  \n   connection.Open();  \n   DataTable table = connection.GetSchema(\"Tables\");  \n  \n   // Display the contents of the table.  \n   DisplayData(table);  \n   Console.WriteLine(\"Press any key to continue.\");  \n   Console.ReadKey();  \n   }  \n }  \n  \n  private static string GetConnectionString()  \n  {  \n   // To avoid storing the connection string in your code,  \n   // you can retrieve it from a configuration file.  \n   return \"Data Source=(local);Database=AdventureWorks;\" +  \n      \"Integrated Security=true;\";  \n  }  \n  \n  private static void DisplayData(System.Data.DataTable table)  \n  {  \n     foreach (System.Data.DataRow row in table.Rows)  \n     {  \n        foreach (System.Data.DataColumn col in table.Columns)  \n        {  \n           Console.WriteLine(\"{0} = {1}\", col.ColumnName, row[col]);  \n        }  \n     Console.WriteLine(\"============================\");  \n     }  \n  }  \n}  \n```  \n  \n## See also\n\n- [Retrieving Database Schema Information](../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,150],"embed":true,"restype":"x-metadata","content":"title: \"GetSchema and Schema Collections\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 7ab93b89-1221-427c-84ad-04803b3c64b4","nodes":[{"content":"GetSchema and Schema Collections","nodes":[{"pos":[0,32],"content":"GetSchema and Schema Collections","nodes":[{"content":"GetSchema and Schema Collections","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[157,189],"content":"GetSchema and Schema Collections","linkify":"GetSchema and Schema Collections","nodes":[{"content":"GetSchema and Schema Collections","pos":[0,32]}]},{"content":"The <bpt id=\"p1\">**</bpt>Connection<ept id=\"p1\">**</ept> classes in each of the .NET Framework managed providers implement a <bpt id=\"p2\">**</bpt>GetSchema<ept id=\"p2\">**</ept> method which is used to retrieve schema information about the database that is currently connected, and the schema information returned from the <bpt id=\"p3\">**</bpt>GetSchema<ept id=\"p3\">**</ept> method comes in the form of a <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph>.","pos":[190,509],"source":"The **Connection** classes in each of the .NET Framework managed providers implement a **GetSchema** method which is used to retrieve schema information about the database that is currently connected, and the schema information returned from the **GetSchema** method comes in the form of a <xref:System.Data.DataTable>."},{"content":"The <bpt id=\"p1\">**</bpt>GetSchema<ept id=\"p1\">**</ept> method is an overloaded method that provides optional parameters for specifying the schema collection to return, and restricting the amount of information returned.","pos":[510,692],"source":" The **GetSchema** method is an overloaded method that provides optional parameters for specifying the schema collection to return, and restricting the amount of information returned."},{"pos":[701,734],"content":"Specifying the Schema Collections","linkify":"Specifying the Schema Collections","nodes":[{"content":"Specifying the Schema Collections","pos":[0,33]}]},{"content":"The first optional parameter of the <bpt id=\"p1\">**</bpt>GetSchema<ept id=\"p1\">**</ept> method is the collection name which is specified as a string.","pos":[738,849],"source":"The first optional parameter of the **GetSchema** method is the collection name which is specified as a string."},{"content":"There are two types of schema collections: common schema collections that are common to all providers, and specific schema collections which are specific to each provider.","pos":[850,1021]},{"content":"You can query a .NET Framework managed provider to determine the list of supported schema collections by calling the <bpt id=\"p1\">**</bpt>GetSchema<ept id=\"p1\">**</ept> method with no arguments, or with the schema collection name \"MetaDataCollections\".","pos":[1028,1242],"source":"You can query a .NET Framework managed provider to determine the list of supported schema collections by calling the **GetSchema** method with no arguments, or with the schema collection name \"MetaDataCollections\"."},{"content":"This will return a <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> with a list of the supported schema collections, the number of restrictions that they each support, and the number of identifier parts that they use.","pos":[1243,1440],"source":" This will return a <xref:System.Data.DataTable> with a list of the supported schema collections, the number of restrictions that they each support, and the number of identifier parts that they use."},{"pos":[1450,1487],"content":"Retrieving Schema Collections Example","linkify":"Retrieving Schema Collections Example","nodes":[{"content":"Retrieving Schema Collections Example","pos":[0,37]}]},{"pos":[1491,1815],"content":"The following examples demonstrate how to use the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.GetSchema%2A&gt;</ph> method of the .NET Framework Data Provider for the SQL Server <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph> class to retrieve schema information about all of the tables contained in the <bpt id=\"p1\">**</bpt>AdventureWorks<ept id=\"p1\">**</ept> sample database:","source":"The following examples demonstrate how to use the <xref:System.Data.SqlClient.SqlConnection.GetSchema%2A> method of the .NET Framework Data Provider for the SQL Server <xref:System.Data.SqlClient.SqlConnection> class to retrieve schema information about all of the tables contained in the **AdventureWorks** sample database:"},{"pos":[4290,4298],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4302,4424],"content":"<bpt id=\"p1\">[</bpt>Retrieving Database Schema Information<ept id=\"p1\">](../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)</ept>","source":"[Retrieving Database Schema Information](../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)"},{"pos":[4427,4531],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}