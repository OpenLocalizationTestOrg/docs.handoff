{"content":"---\ntitle: \"TCP Activation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: bf8c215c-0228-4f4f-85c2-e33794ec09a7\ncaps.latest.revision: 34\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# TCP Activation\nThis sample demonstrates hosting a service that uses Windows Process Activation Services (WAS) to activate a service that communicates over the net.tcp protocol. This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md).  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your computer. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Services\\Hosting\\WASHost\\TCPActivation`  \n  \n The sample consists of a client console program (.exe) and a service library (.dll) hosted in a worker process activated by WAS. Client activity is visible in the console window.  \n  \n The service implements a contract that defines a request-reply communication pattern. The contract is defined by the `ICalculator` interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code:  \n  \n```  \n[ServiceContract(Namespace=\"http://Microsoft.ServiceModel.Samples\")]  \npublic interface ICalculator  \n{  \n    [OperationContract]  \n    double Add(double n1, double n2);  \n    [OperationContract]  \n    double Subtract(double n1, double n2);  \n    [OperationContract]  \n    double Multiply(double n1, double n2);  \n    [OperationContract]  \n    double Divide(double n1, double n2);  \n}  \n```  \n  \n The service implementation calculates and returns the appropriate result:  \n  \n```  \n// Service class that implements the service contract.  \npublic class CalculatorService : ICalculator  \n{  \n    public double Add(double n1, double n2)  \n    {  \n        return n1 + n2;  \n    }  \n    public double Subtract(double n1, double n2)  \n    {  \n        return n1 - n2;  \n    }  \n    public double Multiply(double n1, double n2)  \n    {  \n        return n1 * n2;  \n    }  \n    public double Divide(double n1, double n2)  \n    {  \n        return n1 / n2;  \n    }  \n}  \n```  \n  \n The sample uses a variant of the net.tcp binding with TCP port sharing enabled and security turned off. If you want to use a secured TCP binding, change the server's security mode to the desired setting and re-run Svcutil.exe on the client to generate an update client configuration file.  \n  \n The following sample shows the configuration for the service:  \n  \n```  \n<system.serviceModel>  \n  \n    <services>  \n      <service name=\"Microsoft.ServiceModel.Samples.CalculatorService\"  \n               behaviorConfiguration=\"CalculatorServiceBehavior\">  \n        <!-- This endpoint is exposed at the base address provided by host: net.tcp://localhost/servicemodelsamples/service.svc  -->  \n        <endpoint binding=\"netTcpBinding\" bindingConfiguration=\"PortSharingBinding\"  \n          contract=\"Microsoft.ServiceModel.Samples.ICalculator\" />  \n        <!-- the mex endpoint is explosed at net.tcp://localhost/servicemodelsamples/service.svc/mex -->  \n        <endpoint address=\"mex\"  \n                  binding=\"mexTcpBinding\"  \n                  contract=\"IMetadataExchange\" />  \n      </service>  \n    </services>  \n    <bindings>  \n      <netTcpBinding>  \n        <binding name=\"PortSharingBinding\" portSharingEnabled=\"true\">  \n          <security mode=\"None\" />  \n        </binding>  \n      </netTcpBinding>  \n    </bindings>  \n  \n    <!--For debugging purposes set the includeExceptionDetailInFaults attribute to true-->  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"CalculatorServiceBehavior\">  \n          <serviceMetadata />  \n          <serviceDebug includeExceptionDetailInFaults=\"False\" />  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n  \n  </system.serviceModel>  \n```  \n  \n The client's endpoint is configured as shown in the following sample code:  \n  \n```  \n<system.serviceModel>  \n    <bindings>  \n        <netTcpBinding>  \n          <binding name=\"NetTcpBinding_ICalculator\">  \n            <security mode=\"None\"/>  \n          </binding>  \n        </netTcpBinding>  \n    </bindings>  \n    <client>  \n        <endpoint address=\"net.tcp://localhost/servicemodelsamples/service.svc\"  \n            binding=\"netTcpBinding\" bindingConfiguration=\"NetTcpBinding_ICalculator\"  \n            contract=\"Microsoft.ServiceModel.Samples.ICalculator\" name=\"NetTcpBinding_ICalculator\" />  \n    </client>  \n</system.serviceModel>  \n```  \n  \n When you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client.  \n  \n```  \nAdd(100,15.99) = 115.99  \nSubtract(145,76.54) = 68.46  \nMultiply(9,81.25) = 731.25  \nDivide(22,7) = 3.14285714285714  \n  \nPress <ENTER> to terminate client.  \n```  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is installed. [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is required for WAS activation.  \n  \n2.  Be sure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n     In addition, you must install the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non-HTTP activation components:  \n  \n    1.  From the **Start** menu, choose **Control Panel**.  \n  \n    2.  Select **Programs and Features**.  \n  \n    3.  Click **Turn Windows Components on or Off**.  \n  \n    4.  Expand the **Microsoft .NET Framework 3.0** node and check the **Windows Communication Foundation Non-HTTP Activation** feature.  \n  \n3.  Configure WAS to support TCP activation.  \n  \n     As a convenience, the following two steps are implemented in a batch file called AddNetTcpSiteBinding.cmd located in the sample directory.  \n  \n    1.  To support net.tcp activation, the default Web site must first be bound to a net.tcp port. This can be done using Appcmd.exe, which is installed with the Internet Information Services 7.0 (IIS) management toolset. From an administrator-level command prompt, run the following command:  \n  \n        ```  \n        %windir%\\system32\\inetsrv\\appcmd.exe set site \"Default Web Site\" -+bindings.[protocol='net.tcp',bindingInformation='808:*']  \n        ```  \n  \n        > [!TIP]\n        >  This command is a single line of text. This command adds a net.tcp site binding to the default Web site listening on TCP port 808 with any hostname.  \n  \n    2.  Although all applications within a site share a common net.tcp binding, each application can enable net.tcp support individually. To enable net.tcp for the /servicemodelsamples application, run the following command from an administrator-level command prompt:  \n  \n        ```  \n        %windir%\\system32\\inetsrv\\appcmd.exe set app   \n        \"Default Web Site/servicemodelsamples\" /enabledProtocols:http,net.tcp  \n        ```  \n  \n        > [!NOTE]\n        >  This command is a single line of text. This command enables the /servicemodelsamples application to be accessed using both http://localhost/servicemodelsamples and net.tcp://localhost/servicemodelsamples.  \n  \n4.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n5.  To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n     Remove the net.tcp site binding you added for this sample.  \n  \n     As a convenience, the following two steps are implemented in a batch file called RemoveNetTcpSiteBinding.cmd located in the sample directory.  \n  \n    1.  Remove net.tcp from the list of enabled protocols by running the following command from an administrator-level command prompt:  \n  \n        ```  \n        %windir%\\system32\\inetsrv\\appcmd.exe set app   \n        \"Default Web Site/servicemodelsamples\" /enabledProtocols:http  \n        ```  \n  \n        > [!NOTE]\n        >  This command must be entered as a single line of text.  \n  \n    2.  Remove the net.tcp site binding by running the following command from an administrator-level command prompt:  \n  \n        ```  \n        %windir%\\system32\\inetsrv\\appcmd.exe set site \"Default Web Site\"   \n        --bindings.[protocol='net.tcp',bindingInformation='808:*']  \n        ```  \n  \n        > [!NOTE]\n        >  This command must be typed in as a single line of text.  \n  \n## See Also  \n [AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)","nodes":[{"pos":[12,43],"content":"TCP Activation | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TCP Activation | Microsoft Docs","pos":[0,31]}]},{"pos":[342,356],"content":"TCP Activation","linkify":"TCP Activation","nodes":[{"content":"TCP Activation","pos":[0,14]}]},{"content":"This sample demonstrates hosting a service that uses Windows Process Activation Services (WAS) to activate a service that communicates over the net.tcp protocol.","pos":[357,518]},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept>.","pos":[519,631],"source":" This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md)."},{"pos":[639,746],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"pos":[754,887],"content":"[!IMPORTANT]\n The samples may already be installed on your computer. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your computer. Check for the following (default) directory before continuing.","pos":[13,131],"nodes":[{"content":"The samples may already be installed on your computer.","pos":[1,55]},{"content":"Check for the following (default) directory before continuing.","pos":[56,118]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[941,1267],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[1268,1318]},{"content":"The sample consists of a client console program (.exe) and a service library (.dll) hosted in a worker process activated by WAS.","pos":[1417,1545]},{"content":"Client activity is visible in the console window.","pos":[1546,1595]},{"content":"The service implements a contract that defines a request-reply communication pattern.","pos":[1602,1687]},{"content":"The contract is defined by the <ph id=\"ph1\">`ICalculator`</ph> interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code:","pos":[1688,1851],"source":" The contract is defined by the `ICalculator` interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code:"},{"content":"The service implementation calculates and returns the appropriate result:","pos":[2260,2333]},{"content":"The sample uses a variant of the net.tcp binding with TCP port sharing enabled and security turned off.","pos":[2832,2935]},{"content":"If you want to use a secured TCP binding, change the server's security mode to the desired setting and re-run Svcutil.exe on the client to generate an update client configuration file.","pos":[2936,3120]},{"content":"The following sample shows the configuration for the service:","pos":[3127,3188]},{"content":"The client's endpoint is configured as shown in the following sample code:","pos":[4567,4641]},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[5220,5325]},{"content":"Press ENTER in the client window to shut down the client.","pos":[5326,5383]},{"pos":[5567,5603],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"content":"Ensure that <ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> is installed.","pos":[5613,5692],"source":"Ensure that [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is installed."},{"content":"<ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> is required for WAS activation.","pos":[5693,5778],"source":"[!INCLUDE[iisver](../../../../includes/iisver-md.md)] is required for WAS activation."},{"pos":[5788,5983],"content":"Be sure you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Be sure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[5994,6115],"content":"In addition, you must install the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> non-HTTP activation components:","source":"In addition, you must install the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non-HTTP activation components:"},{"pos":[6129,6179],"content":"From the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Control Panel<ept id=\"p2\">**</ept>.","source":"From the **Start** menu, choose **Control Panel**."},{"pos":[6193,6226],"content":"Select <bpt id=\"p1\">**</bpt>Programs and Features<ept id=\"p1\">**</ept>.","source":"Select **Programs and Features**."},{"pos":[6240,6284],"content":"Click <bpt id=\"p1\">**</bpt>Turn Windows Components on or Off<ept id=\"p1\">**</ept>.","source":"Click **Turn Windows Components on or Off**."},{"pos":[6298,6426],"content":"Expand the <bpt id=\"p1\">**</bpt>Microsoft .NET Framework 3.0<ept id=\"p1\">**</ept> node and check the <bpt id=\"p2\">**</bpt>Windows Communication Foundation Non-HTTP Activation<ept id=\"p2\">**</ept> feature.","source":"Expand the **Microsoft .NET Framework 3.0** node and check the **Windows Communication Foundation Non-HTTP Activation** feature."},{"content":"Configure WAS to support TCP activation.","pos":[6436,6476]},{"content":"As a convenience, the following two steps are implemented in a batch file called AddNetTcpSiteBinding.cmd located in the sample directory.","pos":[6487,6625]},{"content":"To support net.tcp activation, the default Web site must first be bound to a net.tcp port.","pos":[6639,6729]},{"content":"This can be done using Appcmd.exe, which is installed with the Internet Information Services 7.0 (IIS) management toolset.","pos":[6730,6852]},{"content":"From an administrator-level command prompt, run the following command:","pos":[6853,6923]},{"pos":[7104,7270],"content":"[!TIP]\nThis command is a single line of text. This command adds a net.tcp site binding to the default Web site listening on TCP port 808 with any hostname.","leadings":["","        >  "],"nodes":[{"content":"This command is a single line of text. This command adds a net.tcp site binding to the default Web site listening on TCP port 808 with any hostname.","pos":[7,155],"nodes":[{"content":"This command is a single line of text.","pos":[0,38]},{"content":"This command adds a net.tcp site binding to the default Web site listening on TCP port 808 with any hostname.","pos":[39,148]}]}]},{"content":"Although all applications within a site share a common net.tcp binding, each application can enable net.tcp support individually.","pos":[7284,7413]},{"content":"To enable net.tcp for the /servicemodelsamples application, run the following command from an administrator-level command prompt:","pos":[7414,7543]},{"pos":[7726,7949],"content":"[!NOTE]\nThis command is a single line of text. This command enables the /servicemodelsamples application to be accessed using both http://localhost/servicemodelsamples and net.tcp://localhost/servicemodelsamples.","leadings":["","        >  "],"nodes":[{"content":"This command is a single line of text. This command enables the /servicemodelsamples application to be accessed using both http://localhost/servicemodelsamples and net.tcp://localhost/servicemodelsamples.","pos":[8,212],"nodes":[{"content":"This command is a single line of text.","pos":[0,38]},{"content":"This command enables the /servicemodelsamples application to be accessed using both http://localhost/servicemodelsamples and net.tcp://localhost/servicemodelsamples.","pos":[39,204]}]}]},{"pos":[7959,8168],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[8178,8387],"content":"To run the sample in a single- or cross-computer configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"content":"Remove the net.tcp site binding you added for this sample.","pos":[8398,8456]},{"content":"As a convenience, the following two steps are implemented in a batch file called RemoveNetTcpSiteBinding.cmd located in the sample directory.","pos":[8467,8608]},{"content":"Remove net.tcp from the list of enabled protocols by running the following command from an administrator-level command prompt:","pos":[8622,8748]},{"pos":[8923,8996],"content":"[!NOTE]\nThis command must be entered as a single line of text.","leadings":["","        >  "],"nodes":[{"content":"This command must be entered as a single line of text.","pos":[8,62]}]},{"content":"Remove the net.tcp site binding by running the following command from an administrator-level command prompt:","pos":[9010,9118]},{"pos":[9310,9384],"content":"[!NOTE]\nThis command must be typed in as a single line of text.","leadings":["","        >  "],"nodes":[{"content":"This command must be typed in as a single line of text.","pos":[8,63]}]},{"pos":[9393,9401],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[9405,9495],"content":"<bpt id=\"p1\">[</bpt>AppFabric Hosting and Persistence Samples<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193961)</ept>","source":"[AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)"}]}