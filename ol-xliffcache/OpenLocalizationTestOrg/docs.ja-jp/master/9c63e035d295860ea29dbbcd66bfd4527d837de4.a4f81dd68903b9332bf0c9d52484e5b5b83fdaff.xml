{"content":"---\ntitle: \"Message Security in WCF\"\nms.date: \"03/30/2017\"\nms.assetid: a80efb59-591a-4a37-bb3c-8fffa6ca0b7d\n---\n\n# Message Security in WCF\n\nWindows Communication Foundation (WCF) has two major modes for providing security (`Transport` and `Message`) and a third mode (`TransportWithMessageCredential`) that combines the two. This topic discusses message security and the reasons to use it.\n\n## What Is Message Security?\n\nMessage security uses the WS-Security specification to secure messages. The WS-Security specification describes enhancements to SOAP messaging to ensure confidentiality, integrity, and authentication at the SOAP message level (instead of the transport level).\n\nIn brief, message security differs from transport security by encapsulating the security credentials and claims with every message along with any message protection (signing or encryption). Applying the security directly to the message by modifying its content allows the secured message to be self-containing with respect to the security aspects. This enables some scenarios that are not possible when transport security is used.\n\n## Reasons to Use Message Security\n\nIn message-level security, all of the security information is encapsulated in the message. Securing the message with message-level security instead of transport-level security has the following advantages:\n\n- End-to-end security. Transport security, such as Secure Sockets Layer (SSL) only secures messages when the communication is point-to-point. If the message is routed to one or more SOAP intermediaries (for example a router) before reaching the ultimate receiver, the message itself is not protected once an intermediary reads it from the wire. Additionally, the client authentication information is available only to the first intermediary and must be re-transmitted to the ultimate receiver in out-of-band fashion, if necessary. This applies even if the entire route uses SSL security between individual hops. Because message security works directly with the message and secures the XML in it, the security stays with the message regardless of how many intermediaries are involved before it reaches the ultimate receiver. This enables a true end-to-end security scenario.\n\n- Increased flexibility. Parts of the message, instead of the entire message, can be signed or encrypted. This means that intermediaries can view the parts of the message that are intended for them. If the sender needs to make part of the information in the message visible to the intermediaries but wants to ensure that it is not tampered with, it can just sign it but leave it unencrypted. Since the signature is part of the message, the ultimate receiver can verify that the information in the message was received intact. One scenario might have a SOAP intermediary service that routes message according the Action header value. By default, WCF does not encrypt the Action value but signs it if message security is used. Therefore, this information is available to all intermediaries, but no one can change it.\n\n- Support for multiple transports. You can send secured messages over many different transports, such as named pipes and TCP, without having to rely on the protocol for security. With transport-level security, all the security information is scoped to a single particular transport connection and is not available from the message content itself. Message security makes the message secure regardless of what transport you use to transmit the message, and the security context is directly embedded inside the message.\n\n- Support for a wide set of credentials and claims. The message security is based on the WS-Security specification, which provides an extensible framework capable of transmitting any type of claim inside the SOAP message. Unlike transport security, the set of authentication mechanisms, or claims, that you can use is not limited by the transport capabilities. WCF message security includes multiple types of authentication and claim transmission and can be extended to support additional types as necessary. For those reasons, for example, a federated credentials scenario is not possible without message security. For more information about federation scenarios WCF supports, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).\n\n## How Message and Transport Security Compare\n\n### Pros and Cons of Transport-Level Security\n\nTransport security has the following advantages:\n\n- Does not require that the communicating parties understand XML-level security concepts. This can improve the interoperability, for example, when HTTPS is used to secure the communication.\n\n- Generally improved performance.\n\n- Hardware accelerators are available.\n\n- Streaming is possible.\n\n Transport security has the following disadvantages:\n\n- Hop-to-hop only.\n\n- Limited and inextensible set of credentials.\n\n- Transport-dependent.\n\n### Disadvantages of Message-Level Security\n\nMessage security has the following disadvantages:\n\n- Performance\n\n- Cannot use message streaming.\n\n- Requires implementation of XML-level security mechanisms and support for WS-Security specification. This might affect the interoperability.\n\n## See also\n\n- [Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)\n- [Transport Security](../../../../docs/framework/wcf/feature-details/transport-security.md)\n- [How to: Use Transport Security and Message Credentials](../../../../docs/framework/wcf/feature-details/how-to-use-transport-security-and-message-credentials.md)\n- [Microsoft Patterns and Practices, Chapter 3: Implementing Transport and Message Layer Security](https://go.microsoft.com/fwlink/?LinkId=88897)\n","nodes":[{"pos":[4,107],"embed":true,"restype":"x-metadata","content":"title: \"Message Security in WCF\"\nms.date: \"03/30/2017\"\nms.assetid: a80efb59-591a-4a37-bb3c-8fffa6ca0b7d","nodes":[{"content":"Message Security in WCF","nodes":[{"pos":[0,23],"content":"Message Security in WCF","nodes":[{"content":"Message Security in WCF","pos":[0,23]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[115,138],"content":"Message Security in WCF","linkify":"Message Security in WCF","nodes":[{"content":"Message Security in WCF","pos":[0,23]}]},{"content":"Windows Communication Foundation (WCF) has two major modes for providing security (<ph id=\"ph1\">`Transport`</ph> and <ph id=\"ph2\">`Message`</ph>) and a third mode (<ph id=\"ph3\">`TransportWithMessageCredential`</ph>) that combines the two.","pos":[140,324],"source":"Windows Communication Foundation (WCF) has two major modes for providing security (`Transport` and `Message`) and a third mode (`TransportWithMessageCredential`) that combines the two."},{"content":"This topic discusses message security and the reasons to use it.","pos":[325,389]},{"pos":[394,419],"content":"What Is Message Security?","linkify":"What Is Message Security?","nodes":[{"content":"What Is Message Security?","pos":[0,25]}]},{"content":"Message security uses the WS-Security specification to secure messages.","pos":[421,492]},{"content":"The WS-Security specification describes enhancements to SOAP messaging to ensure confidentiality, integrity, and authentication at the SOAP message level (instead of the transport level).","pos":[493,680]},{"content":"In brief, message security differs from transport security by encapsulating the security credentials and claims with every message along with any message protection (signing or encryption).","pos":[682,871]},{"content":"Applying the security directly to the message by modifying its content allows the secured message to be self-containing with respect to the security aspects.","pos":[872,1029]},{"content":"This enables some scenarios that are not possible when transport security is used.","pos":[1030,1112]},{"pos":[1117,1148],"content":"Reasons to Use Message Security","linkify":"Reasons to Use Message Security","nodes":[{"content":"Reasons to Use Message Security","pos":[0,31]}]},{"content":"In message-level security, all of the security information is encapsulated in the message.","pos":[1150,1240]},{"content":"Securing the message with message-level security instead of transport-level security has the following advantages:","pos":[1241,1355]},{"content":"End-to-end security.","pos":[1359,1379]},{"content":"Transport security, such as Secure Sockets Layer (SSL) only secures messages when the communication is point-to-point.","pos":[1380,1498]},{"content":"If the message is routed to one or more SOAP intermediaries (for example a router) before reaching the ultimate receiver, the message itself is not protected once an intermediary reads it from the wire.","pos":[1499,1701]},{"content":"Additionally, the client authentication information is available only to the first intermediary and must be re-transmitted to the ultimate receiver in out-of-band fashion, if necessary.","pos":[1702,1887]},{"content":"This applies even if the entire route uses SSL security between individual hops.","pos":[1888,1968]},{"content":"Because message security works directly with the message and secures the XML in it, the security stays with the message regardless of how many intermediaries are involved before it reaches the ultimate receiver.","pos":[1969,2180]},{"content":"This enables a true end-to-end security scenario.","pos":[2181,2230]},{"content":"Increased flexibility.","pos":[2234,2256]},{"content":"Parts of the message, instead of the entire message, can be signed or encrypted.","pos":[2257,2337]},{"content":"This means that intermediaries can view the parts of the message that are intended for them.","pos":[2338,2430]},{"content":"If the sender needs to make part of the information in the message visible to the intermediaries but wants to ensure that it is not tampered with, it can just sign it but leave it unencrypted.","pos":[2431,2623]},{"content":"Since the signature is part of the message, the ultimate receiver can verify that the information in the message was received intact.","pos":[2624,2757]},{"content":"One scenario might have a SOAP intermediary service that routes message according the Action header value.","pos":[2758,2864]},{"content":"By default, WCF does not encrypt the Action value but signs it if message security is used.","pos":[2865,2956]},{"content":"Therefore, this information is available to all intermediaries, but no one can change it.","pos":[2957,3046]},{"content":"Support for multiple transports.","pos":[3050,3082]},{"content":"You can send secured messages over many different transports, such as named pipes and TCP, without having to rely on the protocol for security.","pos":[3083,3226]},{"content":"With transport-level security, all the security information is scoped to a single particular transport connection and is not available from the message content itself.","pos":[3227,3394]},{"content":"Message security makes the message secure regardless of what transport you use to transmit the message, and the security context is directly embedded inside the message.","pos":[3395,3564]},{"content":"Support for a wide set of credentials and claims.","pos":[3568,3617]},{"content":"The message security is based on the WS-Security specification, which provides an extensible framework capable of transmitting any type of claim inside the SOAP message.","pos":[3618,3787]},{"content":"Unlike transport security, the set of authentication mechanisms, or claims, that you can use is not limited by the transport capabilities.","pos":[3788,3926]},{"content":"WCF message security includes multiple types of authentication and claim transmission and can be extended to support additional types as necessary.","pos":[3927,4074]},{"content":"For those reasons, for example, a federated credentials scenario is not possible without message security.","pos":[4075,4181]},{"content":"For more information about federation scenarios WCF supports, see <bpt id=\"p1\">[</bpt>Federation and Issued Tokens<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)</ept>.","pos":[4182,4359],"source":" For more information about federation scenarios WCF supports, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)."},{"pos":[4364,4406],"content":"How Message and Transport Security Compare","linkify":"How Message and Transport Security Compare","nodes":[{"content":"How Message and Transport Security Compare","pos":[0,42]}]},{"pos":[4412,4453],"content":"Pros and Cons of Transport-Level Security","linkify":"Pros and Cons of Transport-Level Security","nodes":[{"content":"Pros and Cons of Transport-Level Security","pos":[0,41]}]},{"content":"Transport security has the following advantages:","pos":[4455,4503]},{"content":"Does not require that the communicating parties understand XML-level security concepts.","pos":[4507,4594]},{"content":"This can improve the interoperability, for example, when HTTPS is used to secure the communication.","pos":[4595,4694]},{"content":"Generally improved performance.","pos":[4698,4729]},{"content":"Hardware accelerators are available.","pos":[4733,4769]},{"content":"Streaming is possible.","pos":[4773,4795]},{"content":"Transport security has the following disadvantages:","pos":[4798,4849]},{"content":"Hop-to-hop only.","pos":[4853,4869]},{"content":"Limited and inextensible set of credentials.","pos":[4873,4917]},{"content":"Transport-dependent.","pos":[4921,4941]},{"pos":[4947,4986],"content":"Disadvantages of Message-Level Security","linkify":"Disadvantages of Message-Level Security","nodes":[{"content":"Disadvantages of Message-Level Security","pos":[0,39]}]},{"content":"Message security has the following disadvantages:","pos":[4988,5037]},{"content":"Performance","pos":[5041,5052]},{"content":"Cannot use message streaming.","pos":[5056,5085]},{"content":"Requires implementation of XML-level security mechanisms and support for WS-Security specification.","pos":[5089,5188]},{"content":"This might affect the interoperability.","pos":[5189,5228]},{"pos":[5233,5241],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5245,5357],"content":"<bpt id=\"p1\">[</bpt>Securing Services and Clients<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)</ept>","source":"[Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)"},{"pos":[5360,5450],"content":"<bpt id=\"p1\">[</bpt>Transport Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/transport-security.md)</ept>","source":"[Transport Security](../../../../docs/framework/wcf/feature-details/transport-security.md)"},{"pos":[5453,5614],"content":"<bpt id=\"p1\">[</bpt>How to: Use Transport Security and Message Credentials<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-transport-security-and-message-credentials.md)</ept>","source":"[How to: Use Transport Security and Message Credentials](../../../../docs/framework/wcf/feature-details/how-to-use-transport-security-and-message-credentials.md)"},{"pos":[5617,5760],"content":"<bpt id=\"p1\">[</bpt>Microsoft Patterns and Practices, Chapter 3: Implementing Transport and Message Layer Security<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=88897)</ept>","source":"[Microsoft Patterns and Practices, Chapter 3: Implementing Transport and Message Layer Security](https://go.microsoft.com/fwlink/?LinkId=88897)"}]}