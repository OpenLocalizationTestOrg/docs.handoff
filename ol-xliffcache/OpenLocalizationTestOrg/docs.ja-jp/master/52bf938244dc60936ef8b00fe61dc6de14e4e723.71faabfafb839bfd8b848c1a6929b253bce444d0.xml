{"content":"---\ntitle: \"Walkthrough: Creating Direct3D9 Content for Hosting in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WPF, creating Direct3D9 content\"\n  - \"Direct3D9 [WPF interoperability], creating Direct3D9 content\"\nms.assetid: 286e98bc-1eaa-4b5e-923d-3490a9cca5fc\ncaps.latest.revision: 17\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Creating Direct3D9 Content for Hosting in WPF\nThis walkthrough shows how to create Direct3D9 content that is suitable for hosting in a Windows Presentation Foundation (WPF) application. For more information on hosting Direct3D9 content in WPF applications, see [WPF and Direct3D9 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md).  \n  \n In this walkthrough, you perform the following tasks:  \n  \n-   Create a Direct3D9 project.  \n  \n-   Configure the Direct3D9 project for hosting in a WPF application.  \n  \n When you are finished, you will have a DLL that contains Direct3D9 content for use in a WPF application.  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n-   DirectX SDK 9or later.  \n  \n## Creating the Direct3D9 Project  \n The first step is to create and configure the Direct3D9 project.  \n  \n#### To create the Direct3D9 project  \n  \n1.  Create a new Win32 Project in C++ named `D3DContent`.  \n  \n     The Win32 Application Wizard opens and displays the Welcome screen.  \n  \n2.  Click **Next**.  \n  \n     The Application Settings screen appears.  \n  \n3.  In the **Application type:** section, select the **DLL** option.  \n  \n4.  Click **Finish**.  \n  \n     The D3DContent project is generated.  \n  \n5.  In Solution Explorer, right-click the D3DContent project and select **Properties**.  \n  \n     The **D3DContent Property Pages** dialog box opens.  \n  \n6.  Select the **C/C++** node.  \n  \n7.  In the **Additional Include Directories** field, specify the location of the DirectX include folder. The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Include.  \n  \n8.  Double-click the **Linker** node to expand it.  \n  \n9. In the **Additional Library Directories** field, specify the location of the DirectX libraries folder. The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Lib\\x86.  \n  \n10. Select the **Input** node.  \n  \n11. In the **Additional Dependencies** field, add the `d3d9.lib` and `d3dx9.lib` files.  \n  \n12. In Solution Explorer, add a new module definition file (.def) named `D3DContent.def` to the project.  \n  \n## Creating the Direct3D9 Content  \n To get the best performance, your Direct3D9 content must use particular settings. The following code shows how to create a Direct3D9 surface that has the best performance characteristics. For more information, see [Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md).  \n  \n#### To create the Direct3D9 content  \n  \n1.  Using Solution Explorer, add three C++ classes to the project named the following.  \n  \n     `CRenderer` (with virtual destructor)  \n  \n     `CRendererManager`  \n  \n     `CTriangleRenderer`  \n  \n2.  Open Renderer.h in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#RendererH](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderer.h#rendererh)]  \n  \n3.  Open Renderer.cpp in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#RendererCPP](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderer.cpp#renderercpp)]  \n  \n4.  Open RendererManager.h in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#RendererManagerH](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderermanager.h#renderermanagerh)]  \n  \n5.  Open RendererManager.cpp in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#RendererManagerCPP](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderermanager.cpp#renderermanagercpp)]  \n  \n6.  Open TriangleRenderer.h in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#TriangleRendererH](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/trianglerenderer.h#trianglerendererh)]  \n  \n7.  Open TriangleRenderer.cpp in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#TriangleRendererCPP](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/trianglerenderer.cpp#trianglerenderercpp)]  \n  \n8.  Open stdafx.h in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#StdafxH](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/stdafx.h#stdafxh)]  \n  \n9. Open dllmain.cpp in the Code Editor and replace the automatically generated code with the following code.  \n  \n     [!code-cpp[System.Windows.Interop.D3DImage#DllMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/dllmain.cpp#dllmain)]  \n  \n10. Open D3DContent.def in the code editor.  \n  \n11. Replace the automatically generated code with the following code.  \n  \n    ```  \n  \n    LIBRARY \"D3DContent\"  \n  \n    EXPORTS  \n  \n    SetSize  \n    SetAlpha  \n    SetNumDesiredSamples  \n    SetAdapter  \n  \n    GetBackBufferNoRef  \n    Render  \n    Destroy  \n  \n    ```  \n  \n12. Build the project.  \n  \n## Next Steps  \n  \n-   Host the Direct3D9 content in a WPF application. For more information, see [Walkthrough: Hosting Direct3D9 Content in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md).  \n  \n## See Also  \n <xref:System.Windows.Interop.D3DImage>   \n [Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)   \n [Walkthrough: Hosting Direct3D9 Content in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md)","nodes":[{"pos":[4,515],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating Direct3D9 Content for Hosting in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WPF, creating Direct3D9 content\"\n  - \"Direct3D9 [WPF interoperability], creating Direct3D9 content\"\nms.assetid: 286e98bc-1eaa-4b5e-923d-3490a9cca5fc\ncaps.latest.revision: 17\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF | Microsoft Docs","nodes":[{"pos":[0,75],"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF | Microsoft Docs","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF | Microsoft Docs","pos":[0,75]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[522,580],"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","linkify":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","pos":[0,58]}]},{"content":"This walkthrough shows how to create Direct3D9 content that is suitable for hosting in a Windows Presentation Foundation (WPF) application.","pos":[581,720]},{"content":"For more information on hosting Direct3D9 content in WPF applications, see <bpt id=\"p1\">[</bpt>WPF and Direct3D9 Interoperation<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md)</ept>.","pos":[721,908],"source":" For more information on hosting Direct3D9 content in WPF applications, see [WPF and Direct3D9 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md)."},{"content":"In this walkthrough, you perform the following tasks:","pos":[915,968]},{"content":"Create a Direct3D9 project.","pos":[978,1005]},{"content":"Configure the Direct3D9 project for hosting in a WPF application.","pos":[1015,1080]},{"content":"When you are finished, you will have a DLL that contains Direct3D9 content for use in a WPF application.","pos":[1087,1191]},{"pos":[1200,1213],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1217,1280]},{"pos":[1290,1358],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]."},{"content":"DirectX SDK 9or later.","pos":[1368,1390]},{"pos":[1399,1429],"content":"Creating the Direct3D9 Project","linkify":"Creating the Direct3D9 Project","nodes":[{"content":"Creating the Direct3D9 Project","pos":[0,30]}]},{"content":"The first step is to create and configure the Direct3D9 project.","pos":[1433,1497]},{"pos":[1508,1539],"content":"To create the Direct3D9 project","linkify":"To create the Direct3D9 project","nodes":[{"content":"To create the Direct3D9 project","pos":[0,31]}]},{"pos":[1549,1602],"content":"Create a new Win32 Project in C++ named <ph id=\"ph1\">`D3DContent`</ph>.","source":"Create a new Win32 Project in C++ named `D3DContent`."},{"content":"The Win32 Application Wizard opens and displays the Welcome screen.","pos":[1613,1680]},{"pos":[1690,1705],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","source":"Click **Next**."},{"content":"The Application Settings screen appears.","pos":[1716,1756]},{"pos":[1766,1830],"content":"In the <bpt id=\"p1\">**</bpt>Application type:<ept id=\"p1\">**</ept> section, select the <bpt id=\"p2\">**</bpt>DLL<ept id=\"p2\">**</ept> option.","source":"In the **Application type:** section, select the **DLL** option."},{"pos":[1840,1857],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"content":"The D3DContent project is generated.","pos":[1868,1904]},{"pos":[1914,1997],"content":"In Solution Explorer, right-click the D3DContent project and select <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"In Solution Explorer, right-click the D3DContent project and select **Properties**."},{"pos":[2008,2059],"content":"The <bpt id=\"p1\">**</bpt>D3DContent Property Pages<ept id=\"p1\">**</ept> dialog box opens.","source":"The **D3DContent Property Pages** dialog box opens."},{"pos":[2069,2095],"content":"Select the <bpt id=\"p1\">**</bpt>C/C++<ept id=\"p1\">**</ept> node.","source":"Select the **C/C++** node."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Include Directories<ept id=\"p1\">**</ept> field, specify the location of the DirectX include folder.","pos":[2105,2205],"source":"In the **Additional Include Directories** field, specify the location of the DirectX include folder."},{"content":"The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (<bpt id=\"p1\">*</bpt>version<ept id=\"p1\">*</ept>)\\Include.","pos":[2206,2303],"source":" The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Include."},{"pos":[2313,2359],"content":"Double-click the <bpt id=\"p1\">**</bpt>Linker<ept id=\"p1\">**</ept> node to expand it.","source":"Double-click the **Linker** node to expand it."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Library Directories<ept id=\"p1\">**</ept> field, specify the location of the DirectX libraries folder.","pos":[2368,2470],"source":"In the **Additional Library Directories** field, specify the location of the DirectX libraries folder."},{"content":"The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (<bpt id=\"p1\">*</bpt>version<ept id=\"p1\">*</ept>)\\Lib\\x86.","pos":[2471,2568],"source":" The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Lib\\x86."},{"pos":[2578,2604],"content":"Select the <bpt id=\"p1\">**</bpt>Input<ept id=\"p1\">**</ept> node.","source":"Select the **Input** node."},{"pos":[2614,2697],"content":"In the <bpt id=\"p1\">**</bpt>Additional Dependencies<ept id=\"p1\">**</ept> field, add the <ph id=\"ph1\">`d3d9.lib`</ph> and <ph id=\"ph2\">`d3dx9.lib`</ph> files.","source":"In the **Additional Dependencies** field, add the `d3d9.lib` and `d3dx9.lib` files."},{"pos":[2707,2807],"content":"In Solution Explorer, add a new module definition file (.def) named <ph id=\"ph1\">`D3DContent.def`</ph> to the project.","source":"In Solution Explorer, add a new module definition file (.def) named `D3DContent.def` to the project."},{"pos":[2816,2846],"content":"Creating the Direct3D9 Content","linkify":"Creating the Direct3D9 Content","nodes":[{"content":"Creating the Direct3D9 Content","pos":[0,30]}]},{"content":"To get the best performance, your Direct3D9 content must use particular settings.","pos":[2850,2931]},{"content":"The following code shows how to create a Direct3D9 surface that has the best performance characteristics.","pos":[2932,3037]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept>.","pos":[3038,3242],"source":" For more information, see [Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)."},{"pos":[3253,3284],"content":"To create the Direct3D9 content","linkify":"To create the Direct3D9 content","nodes":[{"content":"To create the Direct3D9 content","pos":[0,31]}]},{"content":"Using Solution Explorer, add three C++ classes to the project named the following.","pos":[3294,3376]},{"pos":[3387,3424],"content":"<ph id=\"ph1\">`CRenderer`</ph> (with virtual destructor)","source":"`CRenderer` (with virtual destructor)"},{"content":"Open Renderer.h in the Code Editor and replace the automatically generated code with the following code.","pos":[3493,3597]},{"content":"Open Renderer.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[3779,3885]},{"content":"Open RendererManager.h in the Code Editor and replace the automatically generated code with the following code.","pos":[4073,4184]},{"content":"Open RendererManager.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[4387,4500]},{"content":"Open TriangleRenderer.h in the Code Editor and replace the automatically generated code with the following code.","pos":[4709,4821]},{"content":"Open TriangleRenderer.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[5027,5141]},{"content":"Open stdafx.h in the Code Editor and replace the automatically generated code with the following code.","pos":[5353,5455]},{"content":"Open dllmain.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[5630,5735]},{"content":"Open D3DContent.def in the code editor.","pos":[5914,5953]},{"content":"Replace the automatically generated code with the following code.","pos":[5963,6028]},{"content":"Build the project.","pos":[6242,6260]},{"pos":[6269,6279],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"Host the Direct3D9 content in a WPF application.","pos":[6289,6337]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Hosting Direct3D9 Content in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md)</ept>.","pos":[6338,6501],"source":" For more information, see [Walkthrough: Hosting Direct3D9 Content in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md)."},{"pos":[6510,6518],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept><ph id=\"ph1\"> </ph>","pos":[6565,6743],"source":"[Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting Direct3D9 Content in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md)</ept>","pos":[6747,6883],"source":"[Walkthrough: Hosting Direct3D9 Content in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-direct3d9-content-in-wpf.md)"}]}