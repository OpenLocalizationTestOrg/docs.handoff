{"content":"---\ntitle: \"How to: Load Assemblies into the Reflection-Only Context\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"reflection, reflection-only loader context\"\n  - \"assemblies [.NET Framework], loading for reflection\"\n  - \"attributes [.NET Framework], retrieving\"\n  - \"assemblies [.NET Framework], reflection-only loader context\"\n  - \"reflection-only loader context\"\nms.assetid: 9818b660-52f5-423d-a9af-e75163aa7068\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Load Assemblies into the Reflection-Only Context\nThe reflection-only load context allows you to examine assemblies compiled for other platforms or for other versions of the .NET Framework. Code loaded into this context can only be examined; it cannot be executed. This means that objects cannot be created, because constructors cannot be executed. Because the code cannot be executed, dependencies are not automatically loaded. If you need to examine them, you must load them yourself.  \n  \n### To load an assembly into the reflection-only load context  \n  \n1.  Use the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.String%29> method overload to load the assembly given its display name, or the <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A> method to load the assembly given its path. If the assembly is a binary image, use the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.Byte%5B%5D%29> method overload.  \n  \n    > [!NOTE]\n    >  You cannot use the reflection-only context to load a version of mscorlib.dll from a version of the .NET Framework other than the version in the execution context.  \n  \n2.  If the assembly has dependencies, the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> method does not load them. If you need to examine them, you must load them yourself.  \n  \n3.  Determine whether an assembly is loaded into the reflection-only context by using the assembly's <xref:System.Reflection.Assembly.ReflectionOnly%2A> property.  \n  \n4.  If attributes have been applied to the assembly or to types in the assembly, examine those attributes by using the <xref:System.Reflection.CustomAttributeData> class to ensure that no attempt is made to execute code in the reflection-only context. Use the appropriate overload of the <xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType> method to obtain <xref:System.Reflection.CustomAttributeData> objects representing the attributes applied to an assembly, member, module, or parameter.  \n  \n    > [!NOTE]\n    >  Attributes applied to the assembly or to its contents might be defined in the assembly, or they might be defined in another assembly loaded into the reflection-only context. There is no way to tell in advance where the attributes are defined.  \n  \n## Example  \n The following code example shows how to examine the attributes applied to an assembly loaded into the reflection-only context.  \n  \n The code example defines a custom attribute with two constructors and one property. The attribute is applied to the assembly, to a type declared in the assembly, to a method of the type, and to a parameter of the method. When executed, the assembly loads itself into the reflection-only context and displays information about the custom attributes that were applied to it and to the types and members it contains.  \n  \n> [!NOTE]\n>  To simplify the code example, the assembly loads and examines itself. Normally, you would not expect to find the same assembly loaded into both the execution context and the reflection-only context.  \n  \n [!code-cpp[CustomAttributeData#1](../../../samples/snippets/cpp/VS_Snippets_CLR/CustomAttributeData/CPP/source.cpp#1)]\n [!code-csharp[CustomAttributeData#1](../../../samples/snippets/csharp/VS_Snippets_CLR/CustomAttributeData/CS/source.cs#1)]\n [!code-vb[CustomAttributeData#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CustomAttributeData/VB/source.vb#1)]  \n  \n## See also\n\n- <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A>\n- <xref:System.Reflection.Assembly.ReflectionOnly%2A>\n- <xref:System.Reflection.CustomAttributeData>\n","nodes":[{"pos":[4,502],"embed":true,"restype":"x-metadata","content":"title: \"How to: Load Assemblies into the Reflection-Only Context\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"reflection, reflection-only loader context\"\n  - \"assemblies [.NET Framework], loading for reflection\"\n  - \"attributes [.NET Framework], retrieving\"\n  - \"assemblies [.NET Framework], reflection-only loader context\"\n  - \"reflection-only loader context\"\nms.assetid: 9818b660-52f5-423d-a9af-e75163aa7068\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Load Assemblies into the Reflection-Only Context","nodes":[{"pos":[0,56],"content":"How to: Load Assemblies into the Reflection-Only Context","nodes":[{"content":"How to: Load Assemblies into the Reflection-Only Context","pos":[0,56]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[509,565],"content":"How to: Load Assemblies into the Reflection-Only Context","linkify":"How to: Load Assemblies into the Reflection-Only Context","nodes":[{"content":"How to: Load Assemblies into the Reflection-Only Context","pos":[0,56]}]},{"content":"The reflection-only load context allows you to examine assemblies compiled for other platforms or for other versions of the .NET Framework.","pos":[566,705]},{"content":"Code loaded into this context can only be examined; it cannot be executed.","pos":[706,780]},{"content":"This means that objects cannot be created, because constructors cannot be executed.","pos":[781,864]},{"content":"Because the code cannot be executed, dependencies are not automatically loaded.","pos":[865,944]},{"content":"If you need to examine them, you must load them yourself.","pos":[945,1002]},{"pos":[1012,1069],"content":"To load an assembly into the reflection-only load context","linkify":"To load an assembly into the reflection-only load context","nodes":[{"content":"To load an assembly into the reflection-only load context","pos":[0,57]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.String%29&gt;</ph> method overload to load the assembly given its display name, or the <ph id=\"ph2\">&lt;xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A&gt;</ph> method to load the assembly given its path.","pos":[1079,1330],"source":"Use the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.String%29> method overload to load the assembly given its display name, or the <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A> method to load the assembly given its path."},{"content":"If the assembly is a binary image, use the <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.Byte%5B%5D%29&gt;</ph> method overload.","pos":[1331,1466],"source":" If the assembly is a binary image, use the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%28System.Byte%5B%5D%29> method overload."},{"pos":[1478,1655],"content":"[!NOTE]\nYou cannot use the reflection-only context to load a version of mscorlib.dll from a version of the .NET Framework other than the version in the execution context.","leadings":["","    >  "],"nodes":[{"content":"You cannot use the reflection-only context to load a version of mscorlib.dll from a version of the .NET Framework other than the version in the execution context.","pos":[8,170]}]},{"content":"If the assembly has dependencies, the <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A&gt;</ph> method does not load them.","pos":[1665,1785],"source":"If the assembly has dependencies, the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> method does not load them."},{"content":"If you need to examine them, you must load them yourself.","pos":[1786,1843]},{"pos":[1853,2011],"content":"Determine whether an assembly is loaded into the reflection-only context by using the assembly's <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.ReflectionOnly%2A&gt;</ph> property.","source":"Determine whether an assembly is loaded into the reflection-only context by using the assembly's <xref:System.Reflection.Assembly.ReflectionOnly%2A> property."},{"content":"If attributes have been applied to the assembly or to types in the assembly, examine those attributes by using the <ph id=\"ph1\">&lt;xref:System.Reflection.CustomAttributeData&gt;</ph> class to ensure that no attempt is made to execute code in the reflection-only context.","pos":[2021,2268],"source":"If attributes have been applied to the assembly or to types in the assembly, examine those attributes by using the <xref:System.Reflection.CustomAttributeData> class to ensure that no attempt is made to execute code in the reflection-only context."},{"content":"Use the appropriate overload of the <ph id=\"ph1\">&lt;xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType&gt;</ph> method to obtain <ph id=\"ph2\">&lt;xref:System.Reflection.CustomAttributeData&gt;</ph> objects representing the attributes applied to an assembly, member, module, or parameter.","pos":[2269,2553],"source":" Use the appropriate overload of the <xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType> method to obtain <xref:System.Reflection.CustomAttributeData> objects representing the attributes applied to an assembly, member, module, or parameter."},{"pos":[2565,2822],"content":"[!NOTE]\nAttributes applied to the assembly or to its contents might be defined in the assembly, or they might be defined in another assembly loaded into the reflection-only context. There is no way to tell in advance where the attributes are defined.","leadings":["","    >  "],"nodes":[{"content":"Attributes applied to the assembly or to its contents might be defined in the assembly, or they might be defined in another assembly loaded into the reflection-only context. There is no way to tell in advance where the attributes are defined.","pos":[8,250],"nodes":[{"content":"Attributes applied to the assembly or to its contents might be defined in the assembly, or they might be defined in another assembly loaded into the reflection-only context.","pos":[0,173]},{"content":"There is no way to tell in advance where the attributes are defined.","pos":[174,242]}]}]},{"pos":[2831,2838],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows how to examine the attributes applied to an assembly loaded into the reflection-only context.","pos":[2842,2968]},{"content":"The code example defines a custom attribute with two constructors and one property.","pos":[2975,3058]},{"content":"The attribute is applied to the assembly, to a type declared in the assembly, to a method of the type, and to a parameter of the method.","pos":[3059,3195]},{"content":"When executed, the assembly loads itself into the reflection-only context and displays information about the custom attributes that were applied to it and to the types and members it contains.","pos":[3196,3388]},{"pos":[3396,3605],"content":"[!NOTE]\n To simplify the code example, the assembly loads and examines itself. Normally, you would not expect to find the same assembly loaded into both the execution context and the reflection-only context.","leadings":["","> "],"nodes":[{"content":"To simplify the code example, the assembly loads and examines itself. Normally, you would not expect to find the same assembly loaded into both the execution context and the reflection-only context.","pos":[9,207],"nodes":[{"content":"To simplify the code example, the assembly loads and examines itself.","pos":[0,69]},{"content":"Normally, you would not expect to find the same assembly loaded into both the execution context and the reflection-only context.","pos":[70,198]}]}]},{"pos":[3988,3996],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]}]}