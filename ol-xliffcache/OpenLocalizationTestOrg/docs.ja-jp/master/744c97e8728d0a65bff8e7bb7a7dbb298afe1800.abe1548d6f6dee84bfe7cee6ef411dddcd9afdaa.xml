{"content":"---\ntitle: \"Copying Existing Nodes from One Document to Another\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Copying Existing Nodes from One Document to Another\nThe **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another. The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI). The source document is not changed. After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.  \n  \n When the node is attached to its new document, the new document owns the node. The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments. This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class. For example, **CreateElement**, is the only way to create new nodes.  \n  \n Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate. This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).  \n  \n The following table describes the specific behavior for each type of node that can be imported.  \n  \n|Node Type|*deep* parameter is true|*deep* parameter is false|  \n|---------------|------------------------------|-------------------------------|  \n|XmlAttribute|The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute. The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.|The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.|  \n|XmlCDataSection|Copies the node, including its data.|Copies the node, including its data.|  \n|XmlComment|Copies the node, including its data.|Copies the node, including its data.|  \n|XmlDocumentFragment|The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.|An empty **XmlDocumentFragment** is created.|  \n|XmlDocumentType|Copies the node, including its data.*|Copies the node, including its data.*|  \n|XmlElement|The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree. **Note:**  Default attributes are not copied. If the document being imported into defines default attributes for this element name, those are assigned.|Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element. The descendant nodes are not copied. **Note:**  Default attributes are not copied. If the document being imported into defines default attributes for this element name, those are assigned.|  \n|XmlEntityReference|Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node. The replacement text is not included. If the destination document has the entity defined, its value is assigned.|Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node. The replacement text is not included. If the destination document has the entity defined, its value is assigned.|  \n|XmlProcessingInstruction|Copies the target and data value from the imported node.|Copies the target and data value from the imported node.|  \n|XmlText|Copies the node, including its data.|Copies the node, including its data.|  \n|XmlSignificantWhitespace|Copies the node, including its data.|Copies the node, including its data.|  \n|XmlWhitespace|Copies the node, including its data.|Copies the node, including its data.|  \n|XmlDeclaration|Copies the target and data value from the imported node.|Copies the target and data value from the imported node.|  \n|All other node types|These node types cannot be imported.|These node types cannot be imported.|  \n  \n> [!NOTE]\n>  Although DocumentType nodes can be imported, a document can only have one DocumentType. So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document. For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).  \n  \n## See also\n\n- [XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)\n","nodes":[{"pos":[4,203],"embed":true,"restype":"x-metadata","content":"title: \"Copying Existing Nodes from One Document to Another\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Copying Existing Nodes from One Document to Another","nodes":[{"pos":[0,51],"content":"Copying Existing Nodes from One Document to Another","nodes":[{"content":"Copying Existing Nodes from One Document to Another","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[210,261],"content":"Copying Existing Nodes from One Document to Another","linkify":"Copying Existing Nodes from One Document to Another","nodes":[{"content":"Copying Existing Nodes from One Document to Another","pos":[0,51]}]},{"content":"The <bpt id=\"p1\">**</bpt>ImportNode<ept id=\"p1\">**</ept> method is the mechanism by which a node or entire node subtree is copied from one <bpt id=\"p2\">**</bpt>XmlDocument<ept id=\"p2\">**</ept> to another.","pos":[262,390],"source":"The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another."},{"content":"The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).","pos":[391,642]},{"content":"The source document is not changed.","pos":[643,678]},{"content":"After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.","pos":[679,796]},{"content":"When the node is attached to its new document, the new document owns the node.","pos":[803,881]},{"content":"The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.","pos":[882,1011]},{"content":"This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the <bpt id=\"p1\">**</bpt>XmlDocument<ept id=\"p1\">**</ept> class.","pos":[1012,1149],"source":" This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class."},{"content":"For example, <bpt id=\"p1\">**</bpt>CreateElement<ept id=\"p1\">**</ept>, is the only way to create new nodes.","pos":[1150,1218],"source":" For example, **CreateElement**, is the only way to create new nodes."},{"content":"Depending on the node type of the imported node and the value of the <bpt id=\"p1\">*</bpt>deep<ept id=\"p1\">*</ept> parameter, additional information is copied as appropriate.","pos":[1225,1360],"source":"Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate."},{"content":"This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).","pos":[1361,1599]},{"content":"The following table describes the specific behavior for each type of node that can be imported.","pos":[1606,1701]},{"content":"Node Type","pos":[1708,1717]},{"pos":[1718,1742],"content":"<bpt id=\"p1\">*</bpt>deep<ept id=\"p1\">*</ept> parameter is true","source":"*deep* parameter is true"},{"pos":[1743,1768],"content":"<bpt id=\"p1\">*</bpt>deep<ept id=\"p1\">*</ept> parameter is false","source":"*deep* parameter is false"},{"content":"XmlAttribute","pos":[1856,1868]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlAttribute.Specified%2A&gt;</ph> is set to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> on the XmlAttribute.","pos":[1869,1956],"source":"The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute."},{"content":"The descendants of the source <bpt id=\"p1\">**</bpt>XmlAttribute<ept id=\"p1\">**</ept> are recursively imported and the resulting nodes reassembled to form the corresponding subtree.","pos":[1957,2099],"source":" The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree."},{"pos":[2100,2231],"content":"The <bpt id=\"p1\">*</bpt>deep<ept id=\"p1\">*</ept> parameter does not apply to <bpt id=\"p2\">**</bpt>XmlAttribute<ept id=\"p2\">**</ept> nodes, because they always carry their child nodes with them when imported.","source":"The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported."},{"content":"XmlCDataSection","pos":[2236,2251]},{"content":"Copies the node, including its data.","pos":[2252,2288]},{"content":"Copies the node, including its data.","pos":[2289,2325]},{"content":"XmlComment","pos":[2330,2340]},{"content":"Copies the node, including its data.","pos":[2341,2377]},{"content":"Copies the node, including its data.","pos":[2378,2414]},{"content":"XmlDocumentFragment","pos":[2419,2438]},{"content":"The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.","pos":[2439,2569]},{"pos":[2570,2614],"content":"An empty <bpt id=\"p1\">**</bpt>XmlDocumentFragment<ept id=\"p1\">**</ept> is created.","source":"An empty **XmlDocumentFragment** is created."},{"content":"XmlDocumentType","pos":[2619,2634]},{"content":"Copies the node, including its data.*","pos":[2635,2672]},{"content":"Copies the node, including its data.*","pos":[2673,2710]},{"content":"XmlElement","pos":[2715,2725]},{"content":"The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.","pos":[2726,2859]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Default attributes are not copied.","pos":[2860,2905],"source":"**Note:**  Default attributes are not copied."},{"content":"If the document being imported into defines default attributes for this element name, those are assigned.","pos":[2906,3011]},{"content":"Specified attribute nodes of the source element are imported, and the generated <bpt id=\"p1\">**</bpt>XmlAttribute<ept id=\"p1\">**</ept> nodes are attached to the new element.","pos":[3012,3147],"source":"Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element."},{"content":"The descendant nodes are not copied.","pos":[3148,3184]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Default attributes are not copied.","pos":[3185,3230],"source":"**Note:**  Default attributes are not copied."},{"content":"If the document being imported into defines default attributes for this element name, those are assigned.","pos":[3231,3336]},{"content":"XmlEntityReference","pos":[3341,3359]},{"content":"Because the source and destination documents could have the entities defined differently, this method only copies the <bpt id=\"p1\">**</bpt>XmlEntityReference<ept id=\"p1\">**</ept> node.","pos":[3360,3506],"source":"Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node."},{"content":"The replacement text is not included.","pos":[3507,3544]},{"content":"If the destination document has the entity defined, its value is assigned.","pos":[3545,3619]},{"content":"Because the source and destination documents could have the entities defined differently, this method only copies the <bpt id=\"p1\">**</bpt>XmlEntityReference<ept id=\"p1\">**</ept> node.","pos":[3620,3766],"source":"Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node."},{"content":"The replacement text is not included.","pos":[3767,3804]},{"content":"If the destination document has the entity defined, its value is assigned.","pos":[3805,3879]},{"content":"XmlProcessingInstruction","pos":[3884,3908]},{"content":"Copies the target and data value from the imported node.","pos":[3909,3965]},{"content":"Copies the target and data value from the imported node.","pos":[3966,4022]},{"content":"XmlText","pos":[4027,4034]},{"content":"Copies the node, including its data.","pos":[4035,4071]},{"content":"Copies the node, including its data.","pos":[4072,4108]},{"content":"XmlSignificantWhitespace","pos":[4113,4137]},{"content":"Copies the node, including its data.","pos":[4138,4174]},{"content":"Copies the node, including its data.","pos":[4175,4211]},{"content":"XmlWhitespace","pos":[4216,4229]},{"content":"Copies the node, including its data.","pos":[4230,4266]},{"content":"Copies the node, including its data.","pos":[4267,4303]},{"content":"XmlDeclaration","pos":[4308,4322]},{"content":"Copies the target and data value from the imported node.","pos":[4323,4379]},{"content":"Copies the target and data value from the imported node.","pos":[4380,4436]},{"content":"All other node types","pos":[4441,4461]},{"content":"These node types cannot be imported.","pos":[4462,4498]},{"content":"These node types cannot be imported.","pos":[4499,4535]},{"pos":[4544,4981],"content":"[!NOTE]\n Although DocumentType nodes can be imported, a document can only have one DocumentType. So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document. For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).","leadings":["","> "],"nodes":[{"content":"Although DocumentType nodes can be imported, a document can only have one DocumentType. So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document. For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).","pos":[9,435],"nodes":[{"content":"Although DocumentType nodes can be imported, a document can only have one DocumentType.","pos":[0,87]},{"content":"So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.","pos":[88,233]},{"content":"For information on removing nodes, see <bpt id=\"p1\">[</bpt>Removing Nodes, Content, and Values from an XML Document<ept id=\"p1\">](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md)</ept>.","pos":[234,426],"source":" For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md)."}]}]},{"pos":[4990,4998],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5002,5104],"content":"<bpt id=\"p1\">[</bpt>XML Document Object Model (DOM)<ept id=\"p1\">](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)</ept>","source":"[XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)"}]}