{"content":"---\ntitle: \"How to: Access the HTML Source in the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"managed HTML DOM\"\n  - \"HTML [Windows Forms], accessing in Windows Forms\"\nms.assetid: 53db79fa-8a5e-448e-88c2-f54ace3860b6\n---\n# How to: Access the HTML Source in the Managed HTML Document Object Model\nThe <xref:System.Windows.Forms.WebBrowser.DocumentStream%2A> and <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> properties on the <xref:System.Windows.Forms.WebBrowser> control return the HTML of the current document as it existed when it was first displayed. However, if you modify the page using method and property calls such as <xref:System.Windows.Forms.HtmlElement.AppendChild%2A> and <xref:System.Windows.Forms.HtmlElement.InnerHtml%2A>, these changes will not appear when you call <xref:System.Windows.Forms.WebBrowser.DocumentStream%2A> and <xref:System.Windows.Forms.WebBrowser.DocumentText%2A>. To obtain the most up-to-date HTML source for the DOM, you must call the <xref:System.Windows.Forms.HtmlElement.OuterHtml%2A> property on the HTML element.  \n  \n The following procedure shows how to retrieve the dynamic source and display it in a separate shortcut menu.  \n  \n### Retrieving the dynamic source with the OuterHtml property  \n  \n1.  Create a new Windows Forms application. Start with a single <xref:System.Windows.Forms.Form>, and call it `Form1`.  \n  \n2.  Host the <xref:System.Windows.Forms.WebBrowser> control in your Windows Forms application, and name it `WebBrowser1`. For more information, see [How to: Add Web Browser Capabilities to a Windows Forms Application](how-to-add-web-browser-capabilities-to-a-windows-forms-application.md).  \n  \n3.  Create a second <xref:System.Windows.Forms.Form> in your application called `CodeForm`.  \n  \n4.  Add a <xref:System.Windows.Forms.RichTextBox> control to `CodeForm` and set its <xref:System.Windows.Forms.Control.Dock%2A> property to `Fill`.  \n  \n5.  Create a public property on `CodeForm` called `Code`.  \n  \n     [!code-csharp[DisplayWebBrowserCode#1](~/samples/snippets/csharp/VS_Snippets_Winforms/DisplayWebBrowserCode/CS/CodeForm.cs#1)]\n     [!code-vb[DisplayWebBrowserCode#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/DisplayWebBrowserCode/VB/CodeForm.vb#1)]  \n  \n6.  Add a <xref:System.Windows.Forms.Button> control named `Button1` to your <xref:System.Windows.Forms.Form>, and monitor for the <xref:System.Windows.Forms.Control.Click> event. For details on monitoring events, see [Events](../../../standard/events/index.md).  \n  \n7.  Add the following code to the <xref:System.Windows.Forms.Control.Click> event handler.  \n  \n     [!code-csharp[DisplayWebBrowserCode#2](~/samples/snippets/csharp/VS_Snippets_Winforms/DisplayWebBrowserCode/CS/Form1.cs#2)]\n     [!code-vb[DisplayWebBrowserCode#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/DisplayWebBrowserCode/VB/Form1.vb#2)]  \n  \n## Robust Programming  \n Always test the value of <xref:System.Windows.Forms.WebBrowser.Document%2A> before attempting to retrieve it. If the current page is not finished loading, <xref:System.Windows.Forms.WebBrowser.Document%2A> or one or more of its child objects may not be initialized.  \n  \n## See also\n\n- [Using the Managed HTML Document Object Model](using-the-managed-html-document-object-model.md)\n- [WebBrowser Control Overview](webbrowser-control-overview.md)\n","nodes":[{"pos":[4,290],"embed":true,"restype":"x-metadata","content":"title: \"How to: Access the HTML Source in the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"managed HTML DOM\"\n  - \"HTML [Windows Forms], accessing in Windows Forms\"\nms.assetid: 53db79fa-8a5e-448e-88c2-f54ace3860b6","nodes":[{"content":"How to: Access the HTML Source in the Managed HTML Document Object Model","nodes":[{"pos":[0,72],"content":"How to: Access the HTML Source in the Managed HTML Document Object Model","nodes":[{"content":"How to: Access the HTML Source in the Managed HTML Document Object Model","pos":[0,72]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[297,369],"content":"How to: Access the HTML Source in the Managed HTML Document Object Model","linkify":"How to: Access the HTML Source in the Managed HTML Document Object Model","nodes":[{"content":"How to: Access the HTML Source in the Managed HTML Document Object Model","pos":[0,72]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentStream%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentText%2A&gt;</ph> properties on the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control return the HTML of the current document as it existed when it was first displayed.","pos":[370,637],"source":"The <xref:System.Windows.Forms.WebBrowser.DocumentStream%2A> and <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> properties on the <xref:System.Windows.Forms.WebBrowser> control return the HTML of the current document as it existed when it was first displayed."},{"content":"However, if you modify the page using method and property calls such as <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement.AppendChild%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.HtmlElement.InnerHtml%2A&gt;</ph>, these changes will not appear when you call <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentStream%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentText%2A&gt;</ph>.","pos":[638,983],"source":" However, if you modify the page using method and property calls such as <xref:System.Windows.Forms.HtmlElement.AppendChild%2A> and <xref:System.Windows.Forms.HtmlElement.InnerHtml%2A>, these changes will not appear when you call <xref:System.Windows.Forms.WebBrowser.DocumentStream%2A> and <xref:System.Windows.Forms.WebBrowser.DocumentText%2A>."},{"content":"To obtain the most up-to-date HTML source for the DOM, you must call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement.OuterHtml%2A&gt;</ph> property on the HTML element.","pos":[984,1139],"source":" To obtain the most up-to-date HTML source for the DOM, you must call the <xref:System.Windows.Forms.HtmlElement.OuterHtml%2A> property on the HTML element."},{"content":"The following procedure shows how to retrieve the dynamic source and display it in a separate shortcut menu.","pos":[1146,1254]},{"pos":[1264,1321],"content":"Retrieving the dynamic source with the OuterHtml property","linkify":"Retrieving the dynamic source with the OuterHtml property","nodes":[{"content":"Retrieving the dynamic source with the OuterHtml property","pos":[0,57]}]},{"content":"Create a new Windows Forms application.","pos":[1331,1370]},{"content":"Start with a single <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph>, and call it <ph id=\"ph2\">`Form1`</ph>.","pos":[1371,1445],"source":" Start with a single <xref:System.Windows.Forms.Form>, and call it `Form1`."},{"content":"Host the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control in your Windows Forms application, and name it <ph id=\"ph2\">`WebBrowser1`</ph>.","pos":[1455,1572],"source":"Host the <xref:System.Windows.Forms.WebBrowser> control in your Windows Forms application, and name it `WebBrowser1`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Web Browser Capabilities to a Windows Forms Application<ept id=\"p1\">](how-to-add-web-browser-capabilities-to-a-windows-forms-application.md)</ept>.","pos":[1573,1740],"source":" For more information, see [How to: Add Web Browser Capabilities to a Windows Forms Application](how-to-add-web-browser-capabilities-to-a-windows-forms-application.md)."},{"pos":[1750,1837],"content":"Create a second <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph> in your application called <ph id=\"ph2\">`CodeForm`</ph>.","source":"Create a second <xref:System.Windows.Forms.Form> in your application called `CodeForm`."},{"pos":[1847,1990],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control to <ph id=\"ph2\">`CodeForm`</ph> and set its <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Dock%2A&gt;</ph> property to <ph id=\"ph4\">`Fill`</ph>.","source":"Add a <xref:System.Windows.Forms.RichTextBox> control to `CodeForm` and set its <xref:System.Windows.Forms.Control.Dock%2A> property to `Fill`."},{"pos":[2000,2053],"content":"Create a public property on <ph id=\"ph1\">`CodeForm`</ph> called <ph id=\"ph2\">`Code`</ph>.","source":"Create a public property on `CodeForm` called `Code`."},{"pos":[2064,2323],"content":"[!code-csharp[DisplayWebBrowserCode#1](~/samples/snippets/csharp/VS_Snippets_Winforms/DisplayWebBrowserCode/CS/CodeForm.cs#1)]\n [!code-vb[DisplayWebBrowserCode#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/DisplayWebBrowserCode/VB/CodeForm.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control named <ph id=\"ph2\">`Button1`</ph> to your <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Form&gt;</ph>, and monitor for the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event.","pos":[2333,2508],"source":"Add a <xref:System.Windows.Forms.Button> control named `Button1` to your <xref:System.Windows.Forms.Form>, and monitor for the <xref:System.Windows.Forms.Control.Click> event."},{"content":"For details on monitoring events, see <bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../standard/events/index.md)</ept>.","pos":[2509,2591],"source":" For details on monitoring events, see [Events](../../../standard/events/index.md)."},{"pos":[2601,2687],"content":"Add the following code to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler.","source":"Add the following code to the <xref:System.Windows.Forms.Control.Click> event handler."},{"pos":[2698,2951],"content":"[!code-csharp[DisplayWebBrowserCode#2](~/samples/snippets/csharp/VS_Snippets_Winforms/DisplayWebBrowserCode/CS/Form1.cs#2)]\n [!code-vb[DisplayWebBrowserCode#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/DisplayWebBrowserCode/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[2960,2978],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"Always test the value of <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> before attempting to retrieve it.","pos":[2982,3091],"source":"Always test the value of <xref:System.Windows.Forms.WebBrowser.Document%2A> before attempting to retrieve it."},{"content":"If the current page is not finished loading, <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> or one or more of its child objects may not be initialized.","pos":[3092,3247],"source":" If the current page is not finished loading, <xref:System.Windows.Forms.WebBrowser.Document%2A> or one or more of its child objects may not be initialized."},{"pos":[3256,3264],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3268,3363],"content":"<bpt id=\"p1\">[</bpt>Using the Managed HTML Document Object Model<ept id=\"p1\">](using-the-managed-html-document-object-model.md)</ept>","source":"[Using the Managed HTML Document Object Model](using-the-managed-html-document-object-model.md)"},{"pos":[3366,3427],"content":"<bpt id=\"p1\">[</bpt>WebBrowser Control Overview<ept id=\"p1\">](webbrowser-control-overview.md)</ept>","source":"[WebBrowser Control Overview](webbrowser-control-overview.md)"}]}