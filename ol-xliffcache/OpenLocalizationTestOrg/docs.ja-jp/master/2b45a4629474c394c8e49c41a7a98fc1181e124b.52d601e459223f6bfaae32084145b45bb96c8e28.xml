{"content":"---\ntitle: \"Comparing DataRows (LINQ to DataSet)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 8fe0eadf-297b-487c-8d4b-7816753c2883\n---\n# Comparing DataRows (LINQ to DataSet)\n[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] defines various set operators to compare source elements to see if they are equal. [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provides the following set operators:  \n  \n-   <xref:System.Linq.Enumerable.Distinct%2A>  \n  \n-   <xref:System.Linq.Enumerable.Union%2A>  \n  \n-   <xref:System.Linq.Enumerable.Intersect%2A>  \n  \n-   <xref:System.Linq.Enumerable.Except%2A>  \n  \n These operators compare source elements by calling the <xref:System.Collections.Generic.IEqualityComparer%601.GetHashCode%2A> and <xref:System.Collections.Generic.IEqualityComparer%601.Equals%2A> methods on each collection of elements. In the case of a <xref:System.Data.DataRow>, these operators perform a reference comparison, which is generally not the ideal behavior for set operations over tabular data. For set operations, you usually want to determine whether the element values are equal and not the element references. Therefore, the <xref:System.Data.DataRowComparer> class has been added to [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]. This class can be used to compare row values.  \n  \n The <xref:System.Data.DataRowComparer> class contains a value comparison implementation for <xref:System.Data.DataRow>, so this class can be used for set operations such as <xref:System.Linq.Enumerable.Distinct%2A>. This class cannot be directly instantiated; instead, the <xref:System.Data.DataRowComparer.Default%2A> property must be used to return an instance of the <xref:System.Data.DataRowComparer%601>. The <xref:System.Data.DataRowComparer%601.Equals%2A> method is then called and the two <xref:System.Data.DataRow> objects to be compared are passed in as input parameters. The <xref:System.Data.DataRowComparer%601.Equals%2A> method returns `true` if the ordered set of column values in both <xref:System.Data.DataRow> objects are equal; otherwise, `false`.  \n  \n## Example  \n This example uses `Intersect` to return contacts that appear in both tables.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#Intersect2](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#intersect2)]\n [!code-vb[DP LINQ to DataSet Examples#Intersect2](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#intersect2)]  \n  \n### Example  \n The following example compares two rows and gets their hash codes.  \n  \n [!code-vb[DP LINQ to DataSet Examples#CompareDifferentRows](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#comparedifferentrows)]  \n  \n## See also\n\n- <xref:System.Data.DataRowComparer>\n- [Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)\n- [LINQ to DataSet Examples](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)\n","nodes":[{"pos":[4,154],"embed":true,"restype":"x-metadata","content":"title: \"Comparing DataRows (LINQ to DataSet)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 8fe0eadf-297b-487c-8d4b-7816753c2883","nodes":[{"content":"Comparing DataRows (LINQ to DataSet)","nodes":[{"pos":[0,36],"content":"Comparing DataRows (LINQ to DataSet)","nodes":[{"content":"Comparing DataRows (LINQ to DataSet)","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[161,197],"content":"Comparing DataRows (LINQ to DataSet)","linkify":"Comparing DataRows (LINQ to DataSet)","nodes":[{"content":"Comparing DataRows (LINQ to DataSet)","pos":[0,36]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]</ph> defines various set operators to compare source elements to see if they are equal.","pos":[198,346],"source":"[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] defines various set operators to compare source elements to see if they are equal."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]</ph> provides the following set operators:","pos":[347,444],"source":"[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provides the following set operators:"},{"content":"These operators compare source elements by calling the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEqualityComparer%601.GetHashCode%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEqualityComparer%601.Equals%2A&gt;</ph> methods on each collection of elements.","pos":[651,886],"source":"These operators compare source elements by calling the <xref:System.Collections.Generic.IEqualityComparer%601.GetHashCode%2A> and <xref:System.Collections.Generic.IEqualityComparer%601.Equals%2A> methods on each collection of elements."},{"content":"In the case of a <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph>, these operators perform a reference comparison, which is generally not the ideal behavior for set operations over tabular data.","pos":[887,1059],"source":" In the case of a <xref:System.Data.DataRow>, these operators perform a reference comparison, which is generally not the ideal behavior for set operations over tabular data."},{"content":"For set operations, you usually want to determine whether the element values are equal and not the element references.","pos":[1060,1178]},{"content":"Therefore, the <ph id=\"ph1\">&lt;xref:System.Data.DataRowComparer&gt;</ph> class has been added to <ph id=\"ph2\">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]</ph>.","pos":[1179,1319],"source":" Therefore, the <xref:System.Data.DataRowComparer> class has been added to [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]."},{"content":"This class can be used to compare row values.","pos":[1320,1365]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowComparer&gt;</ph> class contains a value comparison implementation for <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph>, so this class can be used for set operations such as <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Distinct%2A&gt;</ph>.","pos":[1372,1587],"source":"The <xref:System.Data.DataRowComparer> class contains a value comparison implementation for <xref:System.Data.DataRow>, so this class can be used for set operations such as <xref:System.Linq.Enumerable.Distinct%2A>."},{"content":"This class cannot be directly instantiated; instead, the <ph id=\"ph1\">&lt;xref:System.Data.DataRowComparer.Default%2A&gt;</ph> property must be used to return an instance of the <ph id=\"ph2\">&lt;xref:System.Data.DataRowComparer%601&gt;</ph>.","pos":[1588,1781],"source":" This class cannot be directly instantiated; instead, the <xref:System.Data.DataRowComparer.Default%2A> property must be used to return an instance of the <xref:System.Data.DataRowComparer%601>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowComparer%601.Equals%2A&gt;</ph> method is then called and the two <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> objects to be compared are passed in as input parameters.","pos":[1782,1953],"source":" The <xref:System.Data.DataRowComparer%601.Equals%2A> method is then called and the two <xref:System.Data.DataRow> objects to be compared are passed in as input parameters."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowComparer%601.Equals%2A&gt;</ph> method returns <ph id=\"ph2\">`true`</ph> if the ordered set of column values in both <ph id=\"ph3\">&lt;xref:System.Data.DataRow&gt;</ph> objects are equal; otherwise, <ph id=\"ph4\">`false`</ph>.","pos":[1954,2138],"source":" The <xref:System.Data.DataRowComparer%601.Equals%2A> method returns `true` if the ordered set of column values in both <xref:System.Data.DataRow> objects are equal; otherwise, `false`."},{"pos":[2147,2154],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2158,2234],"content":"This example uses <ph id=\"ph1\">`Intersect`</ph> to return contacts that appear in both tables.","source":"This example uses `Intersect` to return contacts that appear in both tables."},{"pos":[2582,2589],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example compares two rows and gets their hash codes.","pos":[2593,2659]},{"pos":[2860,2868],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2909,3009],"content":"<bpt id=\"p1\">[</bpt>Loading Data Into a DataSet<ept id=\"p1\">](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)</ept>","source":"[Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)"},{"pos":[3012,3106],"content":"<bpt id=\"p1\">[</bpt>LINQ to DataSet Examples<ept id=\"p1\">](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)</ept>","source":"[LINQ to DataSet Examples](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)"}]}