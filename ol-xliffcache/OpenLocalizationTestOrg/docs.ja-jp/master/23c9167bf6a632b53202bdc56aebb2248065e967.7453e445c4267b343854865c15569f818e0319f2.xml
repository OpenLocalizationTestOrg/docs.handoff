{"content":"---\ntitle: \"Friend Assemblies (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 9b3d5716-e6e4-47a7-a3e9-084d7fba5c28\ncaps.latest.revision: 6\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Friend Assemblies (Visual Basic)\nA *friend assembly* is an assembly that can access another assembly's [Friend](../../../../visual-basic/language-reference/modifiers/friend.md) types and members. If you identify an assembly as a friend assembly, you no longer have to mark types and members as public in order for them to be accessed by other assemblies. This is especially convenient in the following scenarios:  \n  \n-   During unit testing, when test code runs in a separate assembly but requires access to members in the assembly being tested that are marked as `Friend`.  \n  \n-   When you are developing a class library and additions to the library are contained in separate assemblies but require access to members in existing assemblies that are marked as `Friend`.  \n  \n## Remarks  \n You can use the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute to identify one or more friend assemblies for a given assembly. The following example uses the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute in assembly A and specifies assembly `AssemblyB` as a friend assembly. This gives assembly `AssemblyB` access to all types and members in assembly A that are marked as `Friend`.  \n  \n> [!NOTE]\n>  When you compile an assembly (assembly `AssemblyB`) that will access internal types or internal members of another assembly (assembly *A*), you must explicitly specify the name of the output file (.exe or .dll) by using the **/out** compiler option. This is required because the compiler has not yet generated the name for the assembly it is building at the time it is binding to external references. For more information, see [/out (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/out.md).  \n  \n```vb  \nImports System.Runtime.CompilerServices  \nImports System  \n<Assembly: InternalsVisibleTo(\"AssemblyB\")>   \n  \n' Friend class.  \nFriend Class FriendClass  \n    Public Sub Test()  \n        Console.WriteLine(\"Sample Class\")  \n    End Sub  \nEnd Class  \n  \n' Public class with a Friend method.  \nPublic Class ClassWithFriendMethod  \n    Friend Sub Test()  \n        Console.WriteLine(\"Sample Method\")  \n    End Sub  \nEnd Class  \n  \n```  \n  \n Only assemblies that you explicitly specify as friends can access `Friend` types and members. For example, if assembly B is a friend of assembly A and assembly C references assembly B, C does not have access to `Friend` types in A.  \n  \n The compiler performs some basic validation of the friend assembly name passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute. If assembly *A* declares *B* as a friend assembly, the validation rules are as follows:  \n  \n-   If assembly *A* is strong named, assembly *B* must also be strong named. The friend assembly name that is passed to the attribute must consist of the assembly name and the public key of the strong-name key that is used to sign assembly *B*.  \n  \n     The friend assembly name that is passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute cannot be the strong name of assembly *B*: do not include the assembly version, culture, architecture, or public key token.  \n  \n-   If assembly *A* is not strong named, the friend assembly name should consist of only the assembly name. For more information, see [How to: Create Unsigned Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md).  \n  \n-   If assembly *B* is strong named, you must specify the strong-name key for assembly *B* by using the project setting or the command-line `/keyfile` compiler option. For more information, see [How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md).  \n  \n The <xref:System.Security.Permissions.StrongNameIdentityPermission> class also provides the ability to share types, with the following differences:  \n  \n-   <xref:System.Security.Permissions.StrongNameIdentityPermission> applies to an individual type, while a friend assembly applies to the whole assembly.  \n  \n-   If there are hundreds of types in assembly *A* that you want to share with assembly *B*, you have to add <xref:System.Security.Permissions.StrongNameIdentityPermission> to all of them. If you use a friend assembly, you only need to declare the friend relationship once.  \n  \n-   If you use <xref:System.Security.Permissions.StrongNameIdentityPermission>, the types you want to share have to be declared as public. If you use a friend assembly, the shared types are declared as `Friend`.  \n  \n For information about how to access an assembly's `Friend` types and methods from a module file (a file with the .netmodule extension), see [/moduleassemblyname (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/moduleassemblyname.md).  \n  \n## See Also  \n <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute>   \n <xref:System.Security.Permissions.StrongNameIdentityPermission>   \n [How to: Create Unsigned Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md)   \n [How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)   \n [Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)   \n [Programming Concepts](../../../../visual-basic/programming-guide/concepts/index.md)","nodes":[{"pos":[12,61],"content":"Friend Assemblies (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Friend Assemblies (Visual Basic) | Microsoft Docs","pos":[0,49]}]},{"pos":[442,474],"content":"Friend Assemblies (Visual Basic)","linkify":"Friend Assemblies (Visual Basic)","nodes":[{"content":"Friend Assemblies (Visual Basic)","pos":[0,32]}]},{"content":"A <bpt id=\"p1\">*</bpt>friend assembly<ept id=\"p1\">*</ept> is an assembly that can access another assembly's <bpt id=\"p2\">[</bpt>Friend<ept id=\"p2\">](../../../../visual-basic/language-reference/modifiers/friend.md)</ept> types and members.","pos":[475,637],"source":"A *friend assembly* is an assembly that can access another assembly's [Friend](../../../../visual-basic/language-reference/modifiers/friend.md) types and members."},{"content":"If you identify an assembly as a friend assembly, you no longer have to mark types and members as public in order for them to be accessed by other assemblies.","pos":[638,796]},{"content":"This is especially convenient in the following scenarios:","pos":[797,854]},{"pos":[864,1016],"content":"During unit testing, when test code runs in a separate assembly but requires access to members in the assembly being tested that are marked as <ph id=\"ph1\">`Friend`</ph>.","source":"During unit testing, when test code runs in a separate assembly but requires access to members in the assembly being tested that are marked as `Friend`."},{"pos":[1026,1213],"content":"When you are developing a class library and additions to the library are contained in separate assemblies but require access to members in existing assemblies that are marked as <ph id=\"ph1\">`Friend`</ph>.","source":"When you are developing a class library and additions to the library are contained in separate assemblies but require access to members in existing assemblies that are marked as `Friend`."},{"pos":[1222,1229],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute to identify one or more friend assemblies for a given assembly.","pos":[1233,1389],"source":"You can use the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute to identify one or more friend assemblies for a given assembly."},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute in assembly A and specifies assembly <ph id=\"ph2\">`AssemblyB`</ph> as a friend assembly.","pos":[1390,1568],"source":" The following example uses the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute in assembly A and specifies assembly `AssemblyB` as a friend assembly."},{"content":"This gives assembly <ph id=\"ph1\">`AssemblyB`</ph> access to all types and members in assembly A that are marked as <ph id=\"ph2\">`Friend`</ph>.","pos":[1569,1675],"source":" This gives assembly `AssemblyB` access to all types and members in assembly A that are marked as `Friend`."},{"pos":[1683,2208],"content":"[!NOTE]\n When you compile an assembly (assembly `AssemblyB`) that will access internal types or internal members of another assembly (assembly *A*), you must explicitly specify the name of the output file (.exe or .dll) by using the **/out** compiler option. This is required because the compiler has not yet generated the name for the assembly it is building at the time it is binding to external references. For more information, see [/out (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/out.md).","leadings":["","> "],"nodes":[{"content":" When you compile an assembly (assembly `AssemblyB`) that will access internal types or internal members of another assembly (assembly *A*), you must explicitly specify the name of the output file (.exe or .dll) by using the **/out** compiler option. This is required because the compiler has not yet generated the name for the assembly it is building at the time it is binding to external references. For more information, see [/out (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/out.md).","pos":[8,523],"nodes":[{"content":"When you compile an assembly (assembly <ph id=\"ph1\">`AssemblyB`</ph>) that will access internal types or internal members of another assembly (assembly <bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept>), you must explicitly specify the name of the output file (.exe or .dll) by using the <bpt id=\"p2\">**</bpt>/out<ept id=\"p2\">**</ept> compiler option.","pos":[1,250],"source":" When you compile an assembly (assembly `AssemblyB`) that will access internal types or internal members of another assembly (assembly *A*), you must explicitly specify the name of the output file (.exe or .dll) by using the **/out** compiler option."},{"content":"This is required because the compiler has not yet generated the name for the assembly it is building at the time it is binding to external references.","pos":[251,401]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>/out (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/reference/command-line-compiler/out.md)</ept>.","pos":[402,515],"source":" For more information, see [/out (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/out.md)."}]}]},{"content":"Only assemblies that you explicitly specify as friends can access <ph id=\"ph1\">`Friend`</ph> types and members.","pos":[2657,2750],"source":"Only assemblies that you explicitly specify as friends can access `Friend` types and members."},{"content":"For example, if assembly B is a friend of assembly A and assembly C references assembly B, C does not have access to <ph id=\"ph1\">`Friend`</ph> types in A.","pos":[2751,2888],"source":" For example, if assembly B is a friend of assembly A and assembly C references assembly B, C does not have access to `Friend` types in A."},{"content":"The compiler performs some basic validation of the friend assembly name passed to the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute.","pos":[2895,3058],"source":"The compiler performs some basic validation of the friend assembly name passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute."},{"content":"If assembly <bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept> declares <bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept> as a friend assembly, the validation rules are as follows:","pos":[3059,3146],"source":" If assembly *A* declares *B* as a friend assembly, the validation rules are as follows:"},{"content":"If assembly <bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept> is strong named, assembly <bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept> must also be strong named.","pos":[3156,3228],"source":"If assembly *A* is strong named, assembly *B* must also be strong named."},{"content":"The friend assembly name that is passed to the attribute must consist of the assembly name and the public key of the strong-name key that is used to sign assembly <bpt id=\"p1\">*</bpt>B<ept id=\"p1\">*</ept>.","pos":[3229,3396],"source":" The friend assembly name that is passed to the attribute must consist of the assembly name and the public key of the strong-name key that is used to sign assembly *B*."},{"pos":[3407,3654],"content":"The friend assembly name that is passed to the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute cannot be the strong name of assembly <bpt id=\"p1\">*</bpt>B<ept id=\"p1\">*</ept>: do not include the assembly version, culture, architecture, or public key token.","source":"The friend assembly name that is passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute cannot be the strong name of assembly *B*: do not include the assembly version, culture, architecture, or public key token."},{"content":"If assembly <bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept> is not strong named, the friend assembly name should consist of only the assembly name.","pos":[3664,3767],"source":"If assembly *A* is not strong named, the friend assembly name should consist of only the assembly name."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create Unsigned Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md)</ept>.","pos":[3768,3965],"source":" For more information, see [How to: Create Unsigned Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md)."},{"content":"If assembly <bpt id=\"p1\">*</bpt>B<ept id=\"p1\">*</ept> is strong named, you must specify the strong-name key for assembly <bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept> by using the project setting or the command-line <ph id=\"ph1\">`/keyfile`</ph> compiler option.","pos":[3975,4138],"source":"If assembly *B* is strong named, you must specify the strong-name key for assembly *B* by using the project setting or the command-line `/keyfile` compiler option."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create Signed Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)</ept>.","pos":[4139,4332],"source":" For more information, see [How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph> class also provides the ability to share types, with the following differences:","pos":[4339,4486],"source":"The <xref:System.Security.Permissions.StrongNameIdentityPermission> class also provides the ability to share types, with the following differences:"},{"content":"<ph id=\"ph1\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph> applies to an individual type, while a friend assembly applies to the whole assembly.","pos":[4496,4645],"source":"<xref:System.Security.Permissions.StrongNameIdentityPermission> applies to an individual type, while a friend assembly applies to the whole assembly."},{"content":"If there are hundreds of types in assembly <bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept> that you want to share with assembly <bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept>, you have to add <ph id=\"ph1\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph> to all of them.","pos":[4655,4839],"source":"If there are hundreds of types in assembly *A* that you want to share with assembly *B*, you have to add <xref:System.Security.Permissions.StrongNameIdentityPermission> to all of them."},{"content":"If you use a friend assembly, you only need to declare the friend relationship once.","pos":[4840,4924]},{"content":"If you use <ph id=\"ph1\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph>, the types you want to share have to be declared as public.","pos":[4934,5068],"source":"If you use <xref:System.Security.Permissions.StrongNameIdentityPermission>, the types you want to share have to be declared as public."},{"content":"If you use a friend assembly, the shared types are declared as <ph id=\"ph1\">`Friend`</ph>.","pos":[5069,5141],"source":" If you use a friend assembly, the shared types are declared as `Friend`."},{"pos":[5148,5405],"content":"For information about how to access an assembly's <ph id=\"ph1\">`Friend`</ph> types and methods from a module file (a file with the .netmodule extension), see <bpt id=\"p1\">[</bpt>/moduleassemblyname (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/reference/command-line-compiler/moduleassemblyname.md)</ept>.","source":"For information about how to access an assembly's `Friend` types and methods from a module file (a file with the .netmodule extension), see [/moduleassemblyname (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/moduleassemblyname.md)."},{"pos":[5414,5422],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>How to: Create Unsigned Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[5564,5736],"source":" [How to: Create Unsigned Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-unsigned-friend-assemblies.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Create Signed Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[5739,5907],"source":" [How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Assemblies and the Global Assembly Cache (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5910,6046],"source":" [Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Programming Concepts<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/index.md)</ept>","pos":[6049,6134],"source":" [Programming Concepts](../../../../visual-basic/programming-guide/concepts/index.md)"}]}