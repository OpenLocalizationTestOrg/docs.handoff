{"content":"---\ntitle: \"WithEvents (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.WithEvents\"\n  - \"WithEvents\"\nhelpviewer_keywords: \n  - \"WithEvents keyword [Visual Basic]\"\nms.assetid: 19d461f5-d72f-4de9-8c1d-0a6650316990\n---\n# WithEvents (Visual Basic)\nSpecifies that one or more declared member variables refer to an instance of a class that can raise events.  \n  \n## Remarks  \n When a variable is defined using `WithEvents`, you can declaratively specify that a method handles the variable's events using the `Handles` keyword.  \n  \n You can use `WithEvents` only at class or module level. This means the declaration context for a `WithEvents` variable must be a class or module and cannot be a source file, namespace, structure, or procedure.  \n  \n You cannot use `WithEvents` on a structure member.  \n  \n You can declare only individual variables—not arrays—with `WithEvents`.  \n  \n## Rules  \n  \n-   **Element Types.** You must declare `WithEvents` variables to be object variables so that they can accept class instances. However, you cannot declare them as `Object`. You must declare them as the specific class that can raise the events.  \n  \n The `WithEvents` modifier can be used in this context: [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)  \n  \n## See also\n\n- [Handles](../../../visual-basic/language-reference/statements/handles-clause.md)\n- [Keywords](../../../visual-basic/language-reference/keywords/index.md)\n- [Events](../../../visual-basic/programming-guide/language-features/events/index.md)\n","nodes":[{"pos":[4,220],"embed":true,"restype":"x-metadata","content":"title: \"WithEvents (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.WithEvents\"\n  - \"WithEvents\"\nhelpviewer_keywords: \n  - \"WithEvents keyword [Visual Basic]\"\nms.assetid: 19d461f5-d72f-4de9-8c1d-0a6650316990","nodes":[{"content":"WithEvents (Visual Basic)","nodes":[{"pos":[0,25],"content":"WithEvents (Visual Basic)","nodes":[{"content":"WithEvents (Visual Basic)","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[227,252],"content":"WithEvents (Visual Basic)","linkify":"WithEvents (Visual Basic)","nodes":[{"content":"WithEvents (Visual Basic)","pos":[0,25]}]},{"content":"Specifies that one or more declared member variables refer to an instance of a class that can raise events.","pos":[253,360]},{"pos":[369,376],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[380,529],"content":"When a variable is defined using <ph id=\"ph1\">`WithEvents`</ph>, you can declaratively specify that a method handles the variable's events using the <ph id=\"ph2\">`Handles`</ph> keyword.","source":"When a variable is defined using `WithEvents`, you can declaratively specify that a method handles the variable's events using the `Handles` keyword."},{"content":"You can use <ph id=\"ph1\">`WithEvents`</ph> only at class or module level.","pos":[536,591],"source":"You can use `WithEvents` only at class or module level."},{"content":"This means the declaration context for a <ph id=\"ph1\">`WithEvents`</ph> variable must be a class or module and cannot be a source file, namespace, structure, or procedure.","pos":[592,745],"source":" This means the declaration context for a `WithEvents` variable must be a class or module and cannot be a source file, namespace, structure, or procedure."},{"pos":[752,802],"content":"You cannot use <ph id=\"ph1\">`WithEvents`</ph> on a structure member.","source":"You cannot use `WithEvents` on a structure member."},{"pos":[809,880],"content":"You can declare only individual variables—not arrays—with <ph id=\"ph1\">`WithEvents`</ph>.","source":"You can declare only individual variables—not arrays—with `WithEvents`."},{"pos":[889,894],"content":"Rules","linkify":"Rules","nodes":[{"content":"Rules","pos":[0,5]}]},{"content":"<bpt id=\"p1\">**</bpt>Element Types.<ept id=\"p1\">**</ept>","pos":[904,922],"source":"**Element Types.**"},{"content":"You must declare <ph id=\"ph1\">`WithEvents`</ph> variables to be object variables so that they can accept class instances.","pos":[923,1026],"source":" You must declare `WithEvents` variables to be object variables so that they can accept class instances."},{"content":"However, you cannot declare them as <ph id=\"ph1\">`Object`</ph>.","pos":[1027,1072],"source":" However, you cannot declare them as `Object`."},{"content":"You must declare them as the specific class that can raise the events.","pos":[1073,1143]},{"pos":[1150,1290],"content":"The <ph id=\"ph1\">`WithEvents`</ph> modifier can be used in this context: <bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/dim-statement.md)</ept>","source":"The `WithEvents` modifier can be used in this context: [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)"},{"pos":[1299,1307],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1311,1391],"content":"<bpt id=\"p1\">[</bpt>Handles<ept id=\"p1\">](../../../visual-basic/language-reference/statements/handles-clause.md)</ept>","source":"[Handles](../../../visual-basic/language-reference/statements/handles-clause.md)"},{"pos":[1394,1464],"content":"<bpt id=\"p1\">[</bpt>Keywords<ept id=\"p1\">](../../../visual-basic/language-reference/keywords/index.md)</ept>","source":"[Keywords](../../../visual-basic/language-reference/keywords/index.md)"},{"pos":[1467,1550],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../visual-basic/programming-guide/language-features/events/index.md)"}]}