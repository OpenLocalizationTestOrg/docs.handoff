{"content":"---\ntitle: \"Security Behaviors in WCF\"\nms.date: \"03/30/2017\"\nms.assetid: 513232c0-39fd-4409-bda6-5ebd5e0ea7b0\n---\n# Security Behaviors in WCF\nIn Windows Communication Foundation (WCF), behaviors modify run-time behavior at the service level or at the endpoint level. (For more information about behaviors in general, see [Specifying Service Run-Time Behavior](../../../../docs/framework/wcf/specifying-service-run-time-behavior.md).) *Security behaviors* allow control over credentials, authentication, authorization, and auditing logs. You can use behaviors either by programming or through configuration. This topic focuses on configuring the following behaviors related to security functions:  \n  \n-   [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md).  \n  \n-   [\\<clientCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md).  \n  \n-   [\\<serviceAuthorization>](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md).  \n  \n-   [\\<serviceSecurityAudit>](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md).  \n  \n-   [\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md), which also enables you to specify a secure endpoint that clients can access for metadata.  \n  \n## Setting Credentials with Behaviors  \n Use the [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) and [\\<clientCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md) to set credential values for a service or client. The underlying binding configuration determines whether a credential has to be set. For example, if the security mode is set to `None`, both clients and services do not authenticate each other and require no credentials of any type.  \n  \n On the other hand, the service binding can require a client credential type. In that case, you may have to set a credential value using a behavior. (For more information about the possible types of credentials, see [Selecting a Credential Type](../../../../docs/framework/wcf/feature-details/selecting-a-credential-type.md).) In some cases, such as when Windows credentials are used to authenticate, the environment automatically establishes the actual credential value and you do not need to explicitly set the credential value (unless you want to specify a different set of credentials).  \n  \n All service credentials are found as child elements of the [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md). The following example shows a certificate used as a service credential.  \n  \n```xml  \n<configuration>  \n <system.serviceModel>  \n  <behaviors>  \n   <serviceBehaviors>  \n    <behavior name=\"ServiceBehavior1\">  \n     <serviceCredentials>  \n      <serviceCertificate findValue=\"000000000000000000000000000\"   \n                          storeLocation=\"CurrentUser\"  \n      storeName=\"Root\" x509FindType=\"FindByThumbprint\" />  \n     </serviceCredentials>  \n    </behavior>  \n   </serviceBehaviors>  \n  </behaviors>  \n </system.serviceModel>  \n</configuration>  \n```  \n  \n## Service Credentials  \n The [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) contains four child elements. The elements and their usages are discussed in the following sections.  \n  \n### \\<serviceCertificate> Element  \n Use this element to specify an X.509 certificate that is used to authenticate the service to clients using Message security mode. If you are using a certificate that is periodically renewed, then its thumbprint changes. In that case, use the subject name as the `X509FindType` because the certificate can be reissued with the same subject name.  \n  \n For more information about using the element, see [How to: Specify Client Credential Values](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md).  \n  \n### \\<certificate> of \\<clientCertificate> Element  \n Use the [\\<certificate>](../../../../docs/framework/configure-apps/file-schema/wcf/certificate-of-clientcertificate-element.md) element when the service must have the client's certificate in advance to communicate securely with the client. This occurs when using the duplex communication pattern. In the more typical request-reply pattern, the client includes its certificate in the request, which the service uses to secure its response back to the client. The duplex communication pattern, however, has no requests and replies. The service cannot infer the client's certificate from the communication and therefore the service requires the client's certificate in advance to secure the messages to the client. You must obtain the client's certificate in an out-of-band manner and specify the certificate using this element. For more information about duplex services, see [How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md).  \n  \n### \\<authentication> of \\<clientCertificate> Element  \n The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) element enables you to customize how clients are authenticated. You can set the `CertificateValidationMode` attribute to `None`, `ChainTrust`, `PeerOrChainTrust`, `PeerTrust`, or `Custom`. By default, the level is set to `ChainTrust`, which specifies that each certificate must be found in a hierarchy of certificates ending in a *root authority* at the top of the chain. This is the most secure mode. You can also set the value to `PeerOrChainTrust`, which specifies that self-issued certificates (peer trust) are accepted as well as certificates that are in a trusted chain. This value is used when developing and debugging clients and services because self-issued certificates need not be purchased from a trusted authority. When deploying a client, use the `ChainTrust` value instead. You can also set the value to `Custom`. When set to the `Custom` value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate. To create your own custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class.  \n  \n### \\<issuedTokenAuthentication> Element  \n The issued token scenario has three stages. In the first stage, a client trying to access a service is referred to a *secure token service* (STS). The STS then authenticates the client and subsequently issues the client a token, typically a Security Assertions Markup Language (SAML) token. The client then returns to the service with the token. The service examines the token for data that allows the service to authenticate the token and therefore the client. To authenticate the token, the certificate that the secure token service uses must be known to the service. The [\\<issuedTokenAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md) element is the repository for any such secure token service certificates. To add certificates, use the [\\<knownCertificates>](../../../../docs/framework/configure-apps/file-schema/wcf/knowncertificates.md). Insert an [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-knowncertificates.md) for each certificate, as shown in the following example.  \n  \n```xml  \n<issuedTokenAuthentication>  \n   <knownCertificates>  \n      <add findValue=\"www.contoso.com\"   \n           storeLocation=\"LocalMachine\" storeName=\"My\"   \n           X509FindType=\"FindBySubjectName\" />  \n    </knownCertificates>  \n</issuedTokenAuthentication>  \n```  \n  \n By default, the certificates must be obtained from a secure token service. These \"known\" certificates ensure that only legitimate clients can access a service.  \n  \n You should use the [\\<allowedAudienceUris>](../../../../docs/framework/configure-apps/file-schema/wcf/allowedaudienceuris.md) collection in a federated application that utilizes a *secure token service* (STS) that issues `SamlSecurityToken` security tokens. When the STS issues the security token, it can specify the URI of the Web services for which the security token is intended by adding a `SamlAudienceRestrictionCondition` to the security token. That allows the `SamlSecurityTokenAuthenticator` for the recipient Web service to verify that the issued security token is intended for this Web service by specifying that this check should happen by doing the following:  \n  \n-   Set the `audienceUriMode` attribute of [\\<issuedTokenAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md) to `Always` or `BearerKeyOnly`.  \n  \n-   Specify the set of valid URIs, by adding the URIs to this collection. To do this, insert an [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-allowedaudienceuris.md) for each URI  \n  \n For more information, see <xref:System.IdentityModel.Selectors.SamlSecurityTokenAuthenticator>.  \n  \n For more information about using this configuration element, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).  \n  \n#### Allowing Anonymous CardSpace Users  \n Setting the `AllowUntrustedRsaIssuers` attribute of the `<IssuedTokenAuthentication>` element to `true` explicitly allows any client to present a self-issued token signed with an arbitrary RSA key pair. The issuer is *untrusted* because the key has no issuer data associated with it. A [!INCLUDE[infocard](../../../../includes/infocard-md.md)] user can create a self-issued card that includes self-provided claims of identity. Use this capability with caution. To use this feature, think of the RSA public key as a more secure password that should be stored in a database along with a user name. Before allowing a client access to the service, verify the client-presented RSA public key by comparing it with the stored public key for the presented user name. This presumes that you have established a registration process whereby users can register their user names and associate them with the self-issued RSA public keys.  \n  \n## Client Credentials  \n Client credentials are used to authenticate the client to services in cases where mutual authentication is required. You can use the section to specify service certificates for scenarios where the client must secure messages to a service with the service's certificate.  \n  \n You can also configure a client as part of a federation scenario to use issued tokens from a secure token service or a local issuer of tokens. For more information about federated scenarios, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md). All client credentials are found under the [\\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md), as shown in the following code.  \n  \n```xml  \n<behaviors>  \n <endpointBehaviors>  \n  <behavior name=\"EndpointBehavior1\">  \n   <clientCredentials>  \n    <clientCertificate findValue=\"cn=www.contoso.com\"     \n        storeLocation=\"LocalMachine\"  \n        storeName=\"AuthRoot\" x509FindType=\"FindBySubjectName\" />  \n    <serviceCertificate>  \n     <defaultCertificate findValue=\"www.cohowinery.com\"   \n                    storeLocation=\"LocalMachine\"  \n                    storeName=\"Root\" x509FindType=\"FindByIssuerName\" />  \n    <authentication revocationMode=\"Online\"  \n                    trustedStoreLocation=\"LocalMachine\" />  \n    </serviceCertificate>  \n   </clientCredentials>  \n  </behavior>  \n </endpointBehaviors>  \n```  \n  \n#### \\<clientCertifictate> Element  \n Set the certificate used to authenticate the client with this element. For more information, see [How to: Specify Client Credential Values](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md).  \n  \n#### \\<httpDigest>  \n This feature must be enabled with Active Directory on Windows and Internet Information Services (IIS). For more information, see [Digest Authentication in IIS 6.0](https://go.microsoft.com/fwlink/?LinkId=88443).  \n  \n#### \\<issuedToken> Element  \n The [\\<issuedToken>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtoken.md) contains the elements used to configure a local issuer of tokens, or behaviors used with an security token service. For instructions on configuring a client to use a local issuer, see [How to: Configure a Local Issuer](../../../../docs/framework/wcf/feature-details/how-to-configure-a-local-issuer.md).  \n  \n#### \\<localIssuerAddress>  \n Specifies a default security token service address. This is used when the <xref:System.ServiceModel.WSFederationHttpBinding> does not supply a URL for the security token service, or when the issuer address of a federated binding is `http://schemas.microsoft.com/2005/12/ServiceModel/Addressing/Anonymous` or `null`. In such cases, the <xref:System.ServiceModel.Description.ClientCredentials> must be configured with the address of the local issuer and the binding to use to communicate with that issuer.  \n  \n#### \\<issuerChannelBehaviors>  \n Use the [\\<issuerChannelBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/issuerchannelbehaviors-element.md) to add WCF client behaviors used when communicating with a security token service. Define client behaviors in the [\\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md) section. To use a defined behavior, add an <`add`> element to the `<issuerChannelBehaviors>` element with two attributes. Set the `issuerAddress` to the URL of the security token service and set the `behaviorConfiguration` attribute to the name of the defined endpoint behavior, as shown in the following example.  \n  \n```xml  \n<clientCredentials>  \n   <issuedToken>  \n      <issuerChannelBehaviors>  \n         <add issuerAddress=\"http://www.contoso.com\"  \n               behaviorConfiguration=\"clientBehavior1\" />     \n```  \n  \n#### \\<serviceCertificate> Element  \n Use this element to control authentication of service certificates.  \n  \n The [\\<defaultCertificate>](../../../../docs/framework/configure-apps/file-schema/wcf/defaultcertificate-element.md) element can store a single certificate used when the service specifies no certificate.  \n  \n Use the [\\<scopedCertificates>](../../../../docs/framework/configure-apps/file-schema/wcf/scopedcertificates-element.md) and [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-scopedcertificates-element.md) to set service certificates that are associated with specific services. The `<add>` element includes a `targetUri` attribute that is used to associate the certificate with the service.  \n  \n The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element specifies the level of trust used to authenticate certificates. By default, the level is set to \"ChainTrust,\" which specifies that each certificate must be found in a hierarchy of certificates ending in a trusted certification authority at the top of the chain. This is the most secure mode. You can also set the value to \"PeerOrChainTrust\", which specifies that self-issued certificates (peer trust) are accepted, as well as certificates that are in a trusted chain. This value is used when developing and debugging clients and services because self-issued certificates need not be purchased from a trusted authority. When deploying a client, use the \"ChainTrust\" value instead. You can also set the value to \"Custom\" or \"None.\" To use the \"Custom\" value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate. To create your own custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class. For more information, see [How to: Create a Service that Employs a Custom Certificate Validator](../../../../docs/framework/wcf/extending/how-to-create-a-service-that-employs-a-custom-certificate-validator.md).  \n  \n The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element includes a `RevocationMode` attribute that specifies how certificates are checked for revocation. The default is \"online\", which indicates that certificates are automatically checked for revocation. For more information, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).  \n  \n## ServiceAuthorization  \n The [\\<serviceAuthorization>](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md) element contains elements that affect authorization, custom role providers, and impersonation.  \n  \n The <xref:System.Security.Permissions.PrincipalPermissionAttribute> class is applied to a service method. The attribute specifies the groups of users to use when authorizing use of a protected method. The default value is \"UseWindowsGroups\" and specifies that Windows groups, such as \"Administrators\" or \"Users,\" are searched for an identity trying to access a resource. You can also specify \"UseAspNetRoles\" to use a custom role provider that is configured under the <`system.web` > element, as shown in the following code.  \n  \n```xml  \n<system.web>  \n  <membership defaultProvider=\"SqlProvider\"   \n   userIsOnlineTimeWindow=\"15\">  \n     <providers>  \n       <clear />  \n       <add   \n          name=\"SqlProvider\"   \n          type=\"System.Web.Security.SqlMembershipProvider\"   \n          connectionStringName=\"SqlConn\"  \n          applicationName=\"MembershipProvider\"  \n          enablePasswordRetrieval=\"false\"  \n          enablePasswordReset=\"false\"  \n          requiresQuestionAndAnswer=\"false\"  \n          requiresUniqueEmail=\"true\"  \n          passwordFormat=\"Hashed\" />  \n     </providers>  \n   </membership>  \n  <!-- Other configuration code not shown.-->  \n</system.web>  \n```  \n  \n The following code shows the `roleProviderName` used with the `principalPermissionMode` attribute.  \n  \n```xml  \n<behaviors>  \n <behavior name=\"ServiceBehaviour\">          \n  <serviceAuthorization principalPermissionMode =\"UseAspNetRoles\"   \n                        roleProviderName =\"SqlProvider\" />  \n</behavior>   \n   <!-- Other configuration code not shown. -->  \n</behaviors>  \n```  \n  \n## Configuring Security Audits  \n Use the [\\<serviceSecurityAudit>](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md) to specify the log written to, and what types of events to log. For more information, see [Auditing](../../../../docs/framework/wcf/feature-details/auditing-security-events.md).  \n  \n```xml  \n<system.serviceModel>  \n<serviceBehaviors>  \n  <behavior name=\"NewBehavior\">  \n    <serviceSecurityAudit auditLogLocation=\"Application\"   \n             suppressAuditFailure=\"true\"  \n             serviceAuthorizationAuditLevel=\"Success\"   \n             messageAuthenticationAuditLevel=\"Success\" />  \n    </behavior>  \n  </serviceBehaviors>  \n</behaviors>  \n```  \n  \n## Secure Metadata Exchange  \n Exporting metadata to clients is convenient for service and client developers, as it enables downloads of configuration and client code. To reduce the exposure of a service to malicious users, it is possible to secure the transfer using the SSL over HTTP (HTTPS) mechanism. To do so, you must first bind a suitable X.509 certificate to a specific port on the computer that is hosting the service. (For more information, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).) Second, add a [\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md) to the service configuration and set the `HttpsGetEnabled` attribute to `true`. Finally, set the `HttpsGetUrl` attribute to the URL of the service metadata endpoint, as shown in the following example.  \n  \n```xml  \n<behaviors>  \n <serviceBehaviors>  \n  <behavior name=\"NewBehavior\">  \n    <serviceMetadata httpsGetEnabled=\"true\"   \n     httpsGetUrl=\"https://myComputerName/myEndpoint\" />  \n  </behavior>  \n </serviceBehaviors>  \n</behaviors>  \n```  \n  \n## See also\n\n- [Auditing](../../../../docs/framework/wcf/feature-details/auditing-security-events.md)\n- [Security Model for Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)\n","nodes":[{"pos":[4,109],"embed":true,"restype":"x-metadata","content":"title: \"Security Behaviors in WCF\"\nms.date: \"03/30/2017\"\nms.assetid: 513232c0-39fd-4409-bda6-5ebd5e0ea7b0","nodes":[{"content":"Security Behaviors in WCF","nodes":[{"pos":[0,25],"content":"Security Behaviors in WCF","nodes":[{"content":"Security Behaviors in WCF","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[116,141],"content":"Security Behaviors in WCF","linkify":"Security Behaviors in WCF","nodes":[{"content":"Security Behaviors in WCF","pos":[0,25]}]},{"content":"In Windows Communication Foundation (WCF), behaviors modify run-time behavior at the service level or at the endpoint level.","pos":[142,266]},{"content":"(For more information about behaviors in general, see <bpt id=\"p1\">[</bpt>Specifying Service Run-Time Behavior<ept id=\"p1\">](../../../../docs/framework/wcf/specifying-service-run-time-behavior.md)</ept>.) <bpt id=\"p2\">*</bpt>Security behaviors<ept id=\"p2\">*</ept> allow control over credentials, authentication, authorization, and auditing logs.","pos":[267,536],"source":" (For more information about behaviors in general, see [Specifying Service Run-Time Behavior](../../../../docs/framework/wcf/specifying-service-run-time-behavior.md).) *Security behaviors* allow control over credentials, authentication, authorization, and auditing logs."},{"content":"You can use behaviors either by programming or through configuration.","pos":[537,606]},{"content":"This topic focuses on configuring the following behaviors related to security functions:","pos":[607,695]},{"pos":[705,810],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept>.","source":"[\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)."},{"pos":[820,923],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>clientCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md)</ept>.","source":"[\\<clientCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md)."},{"pos":[933,1050],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceAuthorization&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md)</ept>.","source":"[\\<serviceAuthorization>](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md)."},{"pos":[1060,1169],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceSecurityAudit&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md)</ept>.","source":"[\\<serviceSecurityAudit>](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md)."},{"pos":[1179,1368],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceMetadata&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md)</ept>, which also enables you to specify a secure endpoint that clients can access for metadata.","source":"[\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md), which also enables you to specify a secure endpoint that clients can access for metadata."},{"pos":[1377,1411],"content":"Setting Credentials with Behaviors","linkify":"Setting Credentials with Behaviors","nodes":[{"content":"Setting Credentials with Behaviors","pos":[0,34]}]},{"content":"Use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept> and <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>clientCredentials&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md)</ept> to set credential values for a service or client.","pos":[1415,1684],"source":"Use the [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) and [\\<clientCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/clientcredentials.md) to set credential values for a service or client."},{"content":"The underlying binding configuration determines whether a credential has to be set.","pos":[1685,1768]},{"content":"For example, if the security mode is set to <ph id=\"ph1\">`None`</ph>, both clients and services do not authenticate each other and require no credentials of any type.","pos":[1769,1917],"source":" For example, if the security mode is set to `None`, both clients and services do not authenticate each other and require no credentials of any type."},{"content":"On the other hand, the service binding can require a client credential type.","pos":[1924,2000]},{"content":"In that case, you may have to set a credential value using a behavior.","pos":[2001,2071]},{"content":"(For more information about the possible types of credentials, see <bpt id=\"p1\">[</bpt>Selecting a Credential Type<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/selecting-a-credential-type.md)</ept>.) In some cases, such as when Windows credentials are used to authenticate, the environment automatically establishes the actual credential value and you do not need to explicitly set the credential value (unless you want to specify a different set of credentials).","pos":[2072,2513],"source":" (For more information about the possible types of credentials, see [Selecting a Credential Type](../../../../docs/framework/wcf/feature-details/selecting-a-credential-type.md).) In some cases, such as when Windows credentials are used to authenticate, the environment automatically establishes the actual credential value and you do not need to explicitly set the credential value (unless you want to specify a different set of credentials)."},{"content":"All service credentials are found as child elements of the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)</ept>.","pos":[2520,2680],"source":"All service credentials are found as child elements of the [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)."},{"content":"The following example shows a certificate used as a service credential.","pos":[2681,2752]},{"pos":[3250,3269],"content":"Service Credentials","linkify":"Service Credentials","nodes":[{"content":"Service Credentials","pos":[0,19]}]},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept> contains four child elements.","pos":[3273,3411],"source":"The [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) contains four child elements."},{"content":"The elements and their usages are discussed in the following sections.","pos":[3412,3482]},{"pos":[3492,3521],"content":"\\<serviceCertificate> Element","linkify":"\\<serviceCertificate> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>serviceCertificate&gt; Element","pos":[0,29],"source":"\\<serviceCertificate> Element"}]},{"content":"Use this element to specify an X.509 certificate that is used to authenticate the service to clients using Message security mode.","pos":[3525,3654]},{"content":"If you are using a certificate that is periodically renewed, then its thumbprint changes.","pos":[3655,3744]},{"content":"In that case, use the subject name as the <ph id=\"ph1\">`X509FindType`</ph> because the certificate can be reissued with the same subject name.","pos":[3745,3869],"source":" In that case, use the subject name as the `X509FindType` because the certificate can be reissued with the same subject name."},{"pos":[3876,4044],"content":"For more information about using the element, see <bpt id=\"p1\">[</bpt>How to: Specify Client Credential Values<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md)</ept>.","source":"For more information about using the element, see [How to: Specify Client Credential Values](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md)."},{"pos":[4054,4100],"content":"\\<certificate> of \\<clientCertificate> Element","linkify":"\\<certificate> of \\<clientCertificate> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>certificate&gt; of <ph id=\"ph2\">\\&lt;</ph>clientCertificate&gt; Element","pos":[0,46],"source":"\\<certificate> of \\<clientCertificate> Element"}]},{"content":"Use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>certificate&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/certificate-of-clientcertificate-element.md)</ept> element when the service must have the client's certificate in advance to communicate securely with the client.","pos":[4104,4343],"source":"Use the [\\<certificate>](../../../../docs/framework/configure-apps/file-schema/wcf/certificate-of-clientcertificate-element.md) element when the service must have the client's certificate in advance to communicate securely with the client."},{"content":"This occurs when using the duplex communication pattern.","pos":[4344,4400]},{"content":"In the more typical request-reply pattern, the client includes its certificate in the request, which the service uses to secure its response back to the client.","pos":[4401,4561]},{"content":"The duplex communication pattern, however, has no requests and replies.","pos":[4562,4633]},{"content":"The service cannot infer the client's certificate from the communication and therefore the service requires the client's certificate in advance to secure the messages to the client.","pos":[4634,4815]},{"content":"You must obtain the client's certificate in an out-of-band manner and specify the certificate using this element.","pos":[4816,4929]},{"content":"For more information about duplex services, see <bpt id=\"p1\">[</bpt>How to: Create a Duplex Contract<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)</ept>.","pos":[4930,5096],"source":" For more information about duplex services, see [How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)."},{"pos":[5106,5155],"content":"\\<authentication> of \\<clientCertificate> Element","linkify":"\\<authentication> of \\<clientCertificate> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>authentication&gt; of <ph id=\"ph2\">\\&lt;</ph>clientCertificate&gt; Element","pos":[0,49],"source":"\\<authentication> of \\<clientCertificate> Element"}]},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>authentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md)</ept> element enables you to customize how clients are authenticated.","pos":[5159,5352],"source":"The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) element enables you to customize how clients are authenticated."},{"content":"You can set the <ph id=\"ph1\">`CertificateValidationMode`</ph> attribute to <ph id=\"ph2\">`None`</ph>, <ph id=\"ph3\">`ChainTrust`</ph>, <ph id=\"ph4\">`PeerOrChainTrust`</ph>, <ph id=\"ph5\">`PeerTrust`</ph>, or <ph id=\"ph6\">`Custom`</ph>.","pos":[5353,5477],"source":" You can set the `CertificateValidationMode` attribute to `None`, `ChainTrust`, `PeerOrChainTrust`, `PeerTrust`, or `Custom`."},{"content":"By default, the level is set to <ph id=\"ph1\">`ChainTrust`</ph>, which specifies that each certificate must be found in a hierarchy of certificates ending in a <bpt id=\"p1\">*</bpt>root authority<ept id=\"p1\">*</ept> at the top of the chain.","pos":[5478,5660],"source":" By default, the level is set to `ChainTrust`, which specifies that each certificate must be found in a hierarchy of certificates ending in a *root authority* at the top of the chain."},{"content":"This is the most secure mode.","pos":[5661,5690]},{"content":"You can also set the value to <ph id=\"ph1\">`PeerOrChainTrust`</ph>, which specifies that self-issued certificates (peer trust) are accepted as well as certificates that are in a trusted chain.","pos":[5691,5865],"source":" You can also set the value to `PeerOrChainTrust`, which specifies that self-issued certificates (peer trust) are accepted as well as certificates that are in a trusted chain."},{"content":"This value is used when developing and debugging clients and services because self-issued certificates need not be purchased from a trusted authority.","pos":[5866,6016]},{"content":"When deploying a client, use the <ph id=\"ph1\">`ChainTrust`</ph> value instead.","pos":[6017,6077],"source":" When deploying a client, use the `ChainTrust` value instead."},{"content":"You can also set the value to <ph id=\"ph1\">`Custom`</ph>.","pos":[6078,6117],"source":" You can also set the value to `Custom`."},{"content":"When set to the <ph id=\"ph1\">`Custom`</ph> value, you must also set the <ph id=\"ph2\">`CustomCertificateValidatorType`</ph> attribute to an assembly and type used to validate the certificate.","pos":[6118,6272],"source":" When set to the `Custom` value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate."},{"content":"To create your own custom validator, you must inherit from the abstract <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.X509CertificateValidator&gt;</ph> class.","pos":[6273,6414],"source":" To create your own custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class."},{"pos":[6424,6460],"content":"\\<issuedTokenAuthentication> Element","linkify":"\\<issuedTokenAuthentication> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>issuedTokenAuthentication&gt; Element","pos":[0,36],"source":"\\<issuedTokenAuthentication> Element"}]},{"content":"The issued token scenario has three stages.","pos":[6464,6507]},{"content":"In the first stage, a client trying to access a service is referred to a <bpt id=\"p1\">*</bpt>secure token service<ept id=\"p1\">*</ept> (STS).","pos":[6508,6610],"source":" In the first stage, a client trying to access a service is referred to a *secure token service* (STS)."},{"content":"The STS then authenticates the client and subsequently issues the client a token, typically a Security Assertions Markup Language (SAML) token.","pos":[6611,6754]},{"content":"The client then returns to the service with the token.","pos":[6755,6809]},{"content":"The service examines the token for data that allows the service to authenticate the token and therefore the client.","pos":[6810,6925]},{"content":"To authenticate the token, the certificate that the secure token service uses must be known to the service.","pos":[6926,7033]},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>issuedTokenAuthentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md)</ept> element is the repository for any such secure token service certificates.","pos":[7034,7252],"source":" The [\\<issuedTokenAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md) element is the repository for any such secure token service certificates."},{"content":"To add certificates, use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>knownCertificates&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/knowncertificates.md)</ept>.","pos":[7253,7385],"source":" To add certificates, use the [\\<knownCertificates>](../../../../docs/framework/configure-apps/file-schema/wcf/knowncertificates.md)."},{"content":"Insert an <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>add&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-knowncertificates.md)</ept> for each certificate, as shown in the following example.","pos":[7386,7548],"source":" Insert an [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-knowncertificates.md) for each certificate, as shown in the following example."},{"content":"By default, the certificates must be obtained from a secure token service.","pos":[7835,7909]},{"content":"These \"known\" certificates ensure that only legitimate clients can access a service.","pos":[7910,7994]},{"content":"You should use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>allowedAudienceUris&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/allowedaudienceuris.md)</ept> collection in a federated application that utilizes a <bpt id=\"p2\">*</bpt>secure token service<ept id=\"p2\">*</ept> (STS) that issues <ph id=\"ph2\">`SamlSecurityToken`</ph> security tokens.","pos":[8001,8258],"source":"You should use the [\\<allowedAudienceUris>](../../../../docs/framework/configure-apps/file-schema/wcf/allowedaudienceuris.md) collection in a federated application that utilizes a *secure token service* (STS) that issues `SamlSecurityToken` security tokens."},{"content":"When the STS issues the security token, it can specify the URI of the Web services for which the security token is intended by adding a <ph id=\"ph1\">`SamlAudienceRestrictionCondition`</ph> to the security token.","pos":[8259,8452],"source":" When the STS issues the security token, it can specify the URI of the Web services for which the security token is intended by adding a `SamlAudienceRestrictionCondition` to the security token."},{"content":"That allows the <ph id=\"ph1\">`SamlSecurityTokenAuthenticator`</ph> for the recipient Web service to verify that the issued security token is intended for this Web service by specifying that this check should happen by doing the following:","pos":[8453,8673],"source":" That allows the `SamlSecurityTokenAuthenticator` for the recipient Web service to verify that the issued security token is intended for this Web service by specifying that this check should happen by doing the following:"},{"pos":[8683,8894],"content":"Set the <ph id=\"ph1\">`audienceUriMode`</ph> attribute of <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>issuedTokenAuthentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md)</ept> to <ph id=\"ph3\">`Always`</ph> or <ph id=\"ph4\">`BearerKeyOnly`</ph>.","source":"Set the `audienceUriMode` attribute of [\\<issuedTokenAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtokenauthentication-of-servicecredentials.md) to `Always` or `BearerKeyOnly`."},{"content":"Specify the set of valid URIs, by adding the URIs to this collection.","pos":[8904,8973]},{"content":"To do this, insert an <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>add&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-allowedaudienceuris.md)</ept> for each URI","pos":[8974,9106],"source":" To do this, insert an [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-allowedaudienceuris.md) for each URI"},{"pos":[9113,9208],"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.SamlSecurityTokenAuthenticator&gt;</ph>.","source":"For more information, see <xref:System.IdentityModel.Selectors.SamlSecurityTokenAuthenticator>."},{"pos":[9215,9440],"content":"For more information about using this configuration element, see <bpt id=\"p1\">[</bpt>How to: Configure Credentials on a Federation Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)</ept>.","source":"For more information about using this configuration element, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)."},{"pos":[9451,9485],"content":"Allowing Anonymous CardSpace Users","linkify":"Allowing Anonymous CardSpace Users","nodes":[{"content":"Allowing Anonymous CardSpace Users","pos":[0,34]}]},{"content":"Setting the <ph id=\"ph1\">`AllowUntrustedRsaIssuers`</ph> attribute of the <ph id=\"ph2\">`&lt;IssuedTokenAuthentication&gt;`</ph> element to <ph id=\"ph3\">`true`</ph> explicitly allows any client to present a self-issued token signed with an arbitrary RSA key pair.","pos":[9489,9691],"source":"Setting the `AllowUntrustedRsaIssuers` attribute of the `<IssuedTokenAuthentication>` element to `true` explicitly allows any client to present a self-issued token signed with an arbitrary RSA key pair."},{"content":"The issuer is <bpt id=\"p1\">*</bpt>untrusted<ept id=\"p1\">*</ept> because the key has no issuer data associated with it.","pos":[9692,9772],"source":" The issuer is *untrusted* because the key has no issuer data associated with it."},{"content":"A <ph id=\"ph1\">[!INCLUDE[infocard](../../../../includes/infocard-md.md)]</ph> user can create a self-issued card that includes self-provided claims of identity.","pos":[9773,9915],"source":" A [!INCLUDE[infocard](../../../../includes/infocard-md.md)] user can create a self-issued card that includes self-provided claims of identity."},{"content":"Use this capability with caution.","pos":[9916,9949]},{"content":"To use this feature, think of the RSA public key as a more secure password that should be stored in a database along with a user name.","pos":[9950,10084]},{"content":"Before allowing a client access to the service, verify the client-presented RSA public key by comparing it with the stored public key for the presented user name.","pos":[10085,10247]},{"content":"This presumes that you have established a registration process whereby users can register their user names and associate them with the self-issued RSA public keys.","pos":[10248,10411]},{"pos":[10420,10438],"content":"Client Credentials","linkify":"Client Credentials","nodes":[{"content":"Client Credentials","pos":[0,18]}]},{"content":"Client credentials are used to authenticate the client to services in cases where mutual authentication is required.","pos":[10442,10558]},{"content":"You can use the section to specify service certificates for scenarios where the client must secure messages to a service with the service's certificate.","pos":[10559,10711]},{"content":"You can also configure a client as part of a federation scenario to use issued tokens from a secure token service or a local issuer of tokens.","pos":[10718,10860]},{"content":"For more information about federated scenarios, see <bpt id=\"p1\">[</bpt>Federation and Issued Tokens<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)</ept>.","pos":[10861,11024],"source":" For more information about federated scenarios, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)."},{"content":"All client credentials are found under the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>endpointBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)</ept>, as shown in the following code.","pos":[11025,11203],"source":" All client credentials are found under the [\\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md), as shown in the following code."},{"pos":[11911,11940],"content":"\\<clientCertifictate> Element","linkify":"\\<clientCertifictate> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>clientCertifictate&gt; Element","pos":[0,29],"source":"\\<clientCertifictate> Element"}]},{"content":"Set the certificate used to authenticate the client with this element.","pos":[11944,12014]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Specify Client Credential Values<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md)</ept>.","pos":[12015,12159],"source":" For more information, see [How to: Specify Client Credential Values](../../../../docs/framework/wcf/how-to-specify-client-credential-values.md)."},{"pos":[12170,12183],"content":"\\<httpDigest>","linkify":"\\<httpDigest>","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>httpDigest&gt;","pos":[0,13],"source":"\\<httpDigest>"}]},{"content":"This feature must be enabled with Active Directory on Windows and Internet Information Services (IIS).","pos":[12187,12289]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Digest Authentication in IIS 6.0<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=88443)</ept>.","pos":[12290,12398],"source":" For more information, see [Digest Authentication in IIS 6.0](https://go.microsoft.com/fwlink/?LinkId=88443)."},{"pos":[12409,12431],"content":"\\<issuedToken> Element","linkify":"\\<issuedToken> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>issuedToken&gt; Element","pos":[0,22],"source":"\\<issuedToken> Element"}]},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>issuedToken&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtoken.md)</ept> contains the elements used to configure a local issuer of tokens, or behaviors used with an security token service.","pos":[12435,12645],"source":"The [\\<issuedToken>](../../../../docs/framework/configure-apps/file-schema/wcf/issuedtoken.md) contains the elements used to configure a local issuer of tokens, or behaviors used with an security token service."},{"content":"For instructions on configuring a client to use a local issuer, see <bpt id=\"p1\">[</bpt>How to: Configure a Local Issuer<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-a-local-issuer.md)</ept>.","pos":[12646,12832],"source":" For instructions on configuring a client to use a local issuer, see [How to: Configure a Local Issuer](../../../../docs/framework/wcf/feature-details/how-to-configure-a-local-issuer.md)."},{"pos":[12843,12864],"content":"\\<localIssuerAddress>","linkify":"\\<localIssuerAddress>","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>localIssuerAddress&gt;","pos":[0,21],"source":"\\<localIssuerAddress>"}]},{"content":"Specifies a default security token service address.","pos":[12868,12919]},{"content":"This is used when the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSFederationHttpBinding&gt;</ph> does not supply a URL for the security token service, or when the issuer address of a federated binding is <ph id=\"ph2\">`http://schemas.microsoft.com/2005/12/ServiceModel/Addressing/Anonymous`</ph> or <ph id=\"ph3\">`null`</ph>.","pos":[12920,13183],"source":" This is used when the <xref:System.ServiceModel.WSFederationHttpBinding> does not supply a URL for the security token service, or when the issuer address of a federated binding is `http://schemas.microsoft.com/2005/12/ServiceModel/Addressing/Anonymous` or `null`."},{"content":"In such cases, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ClientCredentials&gt;</ph> must be configured with the address of the local issuer and the binding to use to communicate with that issuer.","pos":[13184,13371],"source":" In such cases, the <xref:System.ServiceModel.Description.ClientCredentials> must be configured with the address of the local issuer and the binding to use to communicate with that issuer."},{"pos":[13382,13407],"content":"\\<issuerChannelBehaviors>","linkify":"\\<issuerChannelBehaviors>","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>issuerChannelBehaviors&gt;","pos":[0,25],"source":"\\<issuerChannelBehaviors>"}]},{"content":"Use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>issuerChannelBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/issuerchannelbehaviors-element.md)</ept> to add WCF client behaviors used when communicating with a security token service.","pos":[13411,13622],"source":"Use the [\\<issuerChannelBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/issuerchannelbehaviors-element.md) to add WCF client behaviors used when communicating with a security token service."},{"content":"Define client behaviors in the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>endpointBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)</ept> section.","pos":[13623,13765],"source":" Define client behaviors in the [\\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md) section."},{"content":"To use a defined behavior, add an &lt;<ph id=\"ph1\">`add`</ph>&gt; element to the <ph id=\"ph2\">`&lt;issuerChannelBehaviors&gt;`</ph> element with two attributes.","pos":[13766,13878],"source":" To use a defined behavior, add an <`add`> element to the `<issuerChannelBehaviors>` element with two attributes."},{"content":"Set the <ph id=\"ph1\">`issuerAddress`</ph> to the URL of the security token service and set the <ph id=\"ph2\">`behaviorConfiguration`</ph> attribute to the name of the defined endpoint behavior, as shown in the following example.","pos":[13879,14070],"source":" Set the `issuerAddress` to the URL of the security token service and set the `behaviorConfiguration` attribute to the name of the defined endpoint behavior, as shown in the following example."},{"pos":[14291,14320],"content":"\\<serviceCertificate> Element","linkify":"\\<serviceCertificate> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>serviceCertificate&gt; Element","pos":[0,29],"source":"\\<serviceCertificate> Element"}]},{"content":"Use this element to control authentication of service certificates.","pos":[14324,14391]},{"pos":[14398,14601],"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>defaultCertificate&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/defaultcertificate-element.md)</ept> element can store a single certificate used when the service specifies no certificate.","source":"The [\\<defaultCertificate>](../../../../docs/framework/configure-apps/file-schema/wcf/defaultcertificate-element.md) element can store a single certificate used when the service specifies no certificate."},{"content":"Use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>scopedCertificates&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/scopedcertificates-element.md)</ept> and <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>add&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-scopedcertificates-element.md)</ept> to set service certificates that are associated with specific services.","pos":[14608,14909],"source":"Use the [\\<scopedCertificates>](../../../../docs/framework/configure-apps/file-schema/wcf/scopedcertificates-element.md) and [\\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-scopedcertificates-element.md) to set service certificates that are associated with specific services."},{"content":"The <ph id=\"ph1\">`&lt;add&gt;`</ph> element includes a <ph id=\"ph2\">`targetUri`</ph> attribute that is used to associate the certificate with the service.","pos":[14910,15022],"source":" The `<add>` element includes a `targetUri` attribute that is used to associate the certificate with the service."},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>authentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)</ept> element specifies the level of trust used to authenticate certificates.","pos":[15029,15231],"source":"The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element specifies the level of trust used to authenticate certificates."},{"content":"By default, the level is set to \"ChainTrust,\" which specifies that each certificate must be found in a hierarchy of certificates ending in a trusted certification authority at the top of the chain.","pos":[15232,15429]},{"content":"This is the most secure mode.","pos":[15430,15459]},{"content":"You can also set the value to \"PeerOrChainTrust\", which specifies that self-issued certificates (peer trust) are accepted, as well as certificates that are in a trusted chain.","pos":[15460,15635]},{"content":"This value is used when developing and debugging clients and services because self-issued certificates need not be purchased from a trusted authority.","pos":[15636,15786]},{"content":"When deploying a client, use the \"ChainTrust\" value instead.","pos":[15787,15847]},{"content":"You can also set the value to \"Custom\" or \"None.\"","pos":[15848,15897]},{"content":"To use the \"Custom\" value, you must also set the <ph id=\"ph1\">`CustomCertificateValidatorType`</ph> attribute to an assembly and type used to validate the certificate.","pos":[15898,16047],"source":" To use the \"Custom\" value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate."},{"content":"To create your own custom validator, you must inherit from the abstract <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.X509CertificateValidator&gt;</ph> class.","pos":[16048,16189],"source":" To create your own custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a Service that Employs a Custom Certificate Validator<ept id=\"p1\">](../../../../docs/framework/wcf/extending/how-to-create-a-service-that-employs-a-custom-certificate-validator.md)</ept>.","pos":[16190,16400],"source":" For more information, see [How to: Create a Service that Employs a Custom Certificate Validator](../../../../docs/framework/wcf/extending/how-to-create-a-service-that-employs-a-custom-certificate-validator.md)."},{"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>authentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)</ept> element includes a <ph id=\"ph2\">`RevocationMode`</ph> attribute that specifies how certificates are checked for revocation.","pos":[16407,16643],"source":"The [\\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element includes a `RevocationMode` attribute that specifies how certificates are checked for revocation."},{"content":"The default is \"online\", which indicates that certificates are automatically checked for revocation.","pos":[16644,16744]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)</ept>.","pos":[16745,16876],"source":" For more information, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)."},{"pos":[16885,16905],"content":"ServiceAuthorization","linkify":"ServiceAuthorization","nodes":[{"content":"ServiceAuthorization","pos":[0,20]}]},{"pos":[16909,17124],"content":"The <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceAuthorization&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md)</ept> element contains elements that affect authorization, custom role providers, and impersonation.","source":"The [\\<serviceAuthorization>](../../../../docs/framework/configure-apps/file-schema/wcf/serviceauthorization-element.md) element contains elements that affect authorization, custom role providers, and impersonation."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Permissions.PrincipalPermissionAttribute&gt;</ph> class is applied to a service method.","pos":[17131,17236],"source":"The <xref:System.Security.Permissions.PrincipalPermissionAttribute> class is applied to a service method."},{"content":"The attribute specifies the groups of users to use when authorizing use of a protected method.","pos":[17237,17331]},{"content":"The default value is \"UseWindowsGroups\" and specifies that Windows groups, such as \"Administrators\" or \"Users,\" are searched for an identity trying to access a resource.","pos":[17332,17501]},{"content":"You can also specify \"UseAspNetRoles\" to use a custom role provider that is configured under the &lt;<ph id=\"ph1\">`system.web`</ph> &gt; element, as shown in the following code.","pos":[17502,17655],"source":" You can also specify \"UseAspNetRoles\" to use a custom role provider that is configured under the <`system.web` > element, as shown in the following code."},{"pos":[18326,18424],"content":"The following code shows the <ph id=\"ph1\">`roleProviderName`</ph> used with the <ph id=\"ph2\">`principalPermissionMode`</ph> attribute.","source":"The following code shows the `roleProviderName` used with the `principalPermissionMode` attribute."},{"pos":[18721,18748],"content":"Configuring Security Audits","linkify":"Configuring Security Audits","nodes":[{"content":"Configuring Security Audits","pos":[0,27]}]},{"content":"Use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceSecurityAudit&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md)</ept> to specify the log written to, and what types of events to log.","pos":[18752,18932],"source":"Use the [\\<serviceSecurityAudit>](../../../../docs/framework/configure-apps/file-schema/wcf/servicesecurityaudit.md) to specify the log written to, and what types of events to log."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Auditing<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/auditing-security-events.md)</ept>.","pos":[18933,19046],"source":" For more information, see [Auditing](../../../../docs/framework/wcf/feature-details/auditing-security-events.md)."},{"pos":[19429,19453],"content":"Secure Metadata Exchange","linkify":"Secure Metadata Exchange","nodes":[{"content":"Secure Metadata Exchange","pos":[0,24]}]},{"content":"Exporting metadata to clients is convenient for service and client developers, as it enables downloads of configuration and client code.","pos":[19457,19593]},{"content":"To reduce the exposure of a service to malicious users, it is possible to secure the transfer using the SSL over HTTP (HTTPS) mechanism.","pos":[19594,19730]},{"content":"To do so, you must first bind a suitable X.509 certificate to a specific port on the computer that is hosting the service.","pos":[19731,19853]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)</ept>.) Second, add a <bpt id=\"p2\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceMetadata&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md)</ept> to the service configuration and set the <ph id=\"ph2\">`HttpsGetEnabled`</ph> attribute to <ph id=\"ph3\">`true`</ph>.","pos":[19854,20180],"source":" (For more information, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).) Second, add a [\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md) to the service configuration and set the `HttpsGetEnabled` attribute to `true`."},{"content":"Finally, set the <ph id=\"ph1\">`HttpsGetUrl`</ph> attribute to the URL of the service metadata endpoint, as shown in the following example.","pos":[20181,20301],"source":" Finally, set the `HttpsGetUrl` attribute to the URL of the service metadata endpoint, as shown in the following example."},{"pos":[20557,20565],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[20569,20655],"content":"<bpt id=\"p1\">[</bpt>Auditing<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/auditing-security-events.md)</ept>","source":"[Auditing](../../../../docs/framework/wcf/feature-details/auditing-security-events.md)"},{"pos":[20658,20764],"content":"<bpt id=\"p1\">[</bpt>Security Model for Windows Server App Fabric<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=201279&amp;clcid=0x409)</ept>","source":"[Security Model for Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)"}]}