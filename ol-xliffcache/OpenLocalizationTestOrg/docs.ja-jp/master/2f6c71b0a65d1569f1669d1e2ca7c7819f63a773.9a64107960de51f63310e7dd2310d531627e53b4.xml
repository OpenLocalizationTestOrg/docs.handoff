{"content":"---\ntitle: \"IHostTaskManager Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostTaskManager\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostTaskManager\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostTaskManager interface [.NET Framework hosting]\"\nms.assetid: 4a0b05b9-3ef1-4607-b7c8-bd4dd43647a0\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 18\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostTaskManager Interface\nProvides methods that allow the common language runtime (CLR) to work with tasks through the host instead of using the standard operating system threading or fiber functions.  \n  \n## Methods  \n  \n|Method|Description|  \n|------------|-----------------|  \n|[BeginDelayAbort Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-begindelayabort-method.md)|Notifies the host that managed code is entering a period in which the current task must not be aborted.|  \n|[BeginThreadAffinity Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-beginthreadaffinity-method.md)|Notifies the host that managed code is entering a period in which the current task must not be moved to another operating system thread.|  \n|[CallNeedsHostHook Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-callneedshosthook-method.md)|Enables the host to specify whether the common language runtime can inline the specified call to an unmanaged function.|  \n|[CreateTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-createtask-method.md)|Requests that the host create a new task.|  \n|[EndDelayAbort Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enddelayabort-method.md)|Notifies the host that managed code is exiting the period in which the current task must not be aborted, following an earlier call to `BeginDelayAbort`.|  \n|[EndThreadAffinity Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md)|Notifies the host that managed code is exiting the period in which the current task must not be moved to another operating system thread, following an earlier call to `BeginThreadAffinity`.|  \n|[EnterRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md)|Notifies the host that a call to an unmanaged method, such as a platform invoke method, is returning execution control to the CLR.|  \n|[GetCurrentTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getcurrenttask-method.md)|Gets an interface pointer to the task that is currently executing on the operating system thread from which this call is made.|  \n|[GetStackGuarantee Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getstackguarantee-method.md)|Gets the amount of stack space that is guaranteed to be available after a stack operation completes, but before the closing of a process.|  \n|[LeaveRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md)|Notifies the host that managed code is about to make a call to an unmanaged function.|  \n|[ReverseEnterRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md)|Notifies the host that a call is being made into the common language runtime (CLR) from unmanaged code.|  \n|[ReverseLeaveRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md)|Notifies the host that control is leaving the CLR and entering an unmanaged function that was, in turn, called from managed code.|  \n|[SetCLRTaskManager Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setclrtaskmanager-method.md)|Provides the host with an interface pointer to an [ICLRTaskManager](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md) instance implemented by the CLR.|  \n|[SetLocale Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setlocale-method.md)|Notifies the host that the CLR has changed the locale on the current task.|  \n|[SetStackGuarantee Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setstackguarantee-method.md)|Reserved for internal use only.|  \n|[SetUILocale Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setuilocale-method.md)|Notifies the host that the user interface locale has been changed on the current task.|  \n|[Sleep Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-sleep-method.md)|Notifies the host that the current task is going to sleep.|  \n|[SwitchToTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-switchtotask-method.md)|Notifies the host that it should switch out the current task.|  \n  \n## Remarks  \n `IHostTaskManager` allows the CLR to create and manage tasks, to provide hooks for the host to take action when control transfers from managed to unmanaged code and vice versa, and to specify certain actions the host can and cannot take during code execution.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)   \n [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)   \n [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)   \n [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)","nodes":[{"pos":[4,607],"embed":true,"restype":"x-metadata","content":"title: \"IHostTaskManager Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostTaskManager\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostTaskManager\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostTaskManager interface [.NET Framework hosting]\"\nms.assetid: 4a0b05b9-3ef1-4607-b7c8-bd4dd43647a0\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 18\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"IHostTaskManager Interface | Microsoft Docs","nodes":[{"pos":[0,43],"content":"IHostTaskManager Interface | Microsoft Docs","nodes":[{"content":"IHostTaskManager Interface | Microsoft Docs","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[614,640],"content":"IHostTaskManager Interface","linkify":"IHostTaskManager Interface","nodes":[{"content":"IHostTaskManager Interface","pos":[0,26]}]},{"content":"Provides methods that allow the common language runtime (CLR) to work with tasks through the host instead of using the standard operating system threading or fiber functions.","pos":[641,815]},{"pos":[824,831],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"content":"Method","pos":[838,844]},{"content":"Description","pos":[845,856]},{"pos":[896,1013],"content":"<bpt id=\"p1\">[</bpt>BeginDelayAbort Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-begindelayabort-method.md)</ept>","source":"[BeginDelayAbort Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-begindelayabort-method.md)"},{"content":"Notifies the host that managed code is entering a period in which the current task must not be aborted.","pos":[1014,1117]},{"pos":[1122,1247],"content":"<bpt id=\"p1\">[</bpt>BeginThreadAffinity Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-beginthreadaffinity-method.md)</ept>","source":"[BeginThreadAffinity Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-beginthreadaffinity-method.md)"},{"content":"Notifies the host that managed code is entering a period in which the current task must not be moved to another operating system thread.","pos":[1248,1384]},{"pos":[1389,1510],"content":"<bpt id=\"p1\">[</bpt>CallNeedsHostHook Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-callneedshosthook-method.md)</ept>","source":"[CallNeedsHostHook Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-callneedshosthook-method.md)"},{"content":"Enables the host to specify whether the common language runtime can inline the specified call to an unmanaged function.","pos":[1511,1630]},{"pos":[1635,1742],"content":"<bpt id=\"p1\">[</bpt>CreateTask Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-createtask-method.md)</ept>","source":"[CreateTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-createtask-method.md)"},{"content":"Requests that the host create a new task.","pos":[1743,1784]},{"pos":[1789,1902],"content":"<bpt id=\"p1\">[</bpt>EndDelayAbort Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enddelayabort-method.md)</ept>","source":"[EndDelayAbort Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enddelayabort-method.md)"},{"pos":[1903,2055],"content":"Notifies the host that managed code is exiting the period in which the current task must not be aborted, following an earlier call to <ph id=\"ph1\">`BeginDelayAbort`</ph>.","source":"Notifies the host that managed code is exiting the period in which the current task must not be aborted, following an earlier call to `BeginDelayAbort`."},{"pos":[2060,2181],"content":"<bpt id=\"p1\">[</bpt>EndThreadAffinity Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md)</ept>","source":"[EndThreadAffinity Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md)"},{"pos":[2182,2371],"content":"Notifies the host that managed code is exiting the period in which the current task must not be moved to another operating system thread, following an earlier call to <ph id=\"ph1\">`BeginThreadAffinity`</ph>.","source":"Notifies the host that managed code is exiting the period in which the current task must not be moved to another operating system thread, following an earlier call to `BeginThreadAffinity`."},{"pos":[2376,2487],"content":"<bpt id=\"p1\">[</bpt>EnterRuntime Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md)</ept>","source":"[EnterRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md)"},{"content":"Notifies the host that a call to an unmanaged method, such as a platform invoke method, is returning execution control to the CLR.","pos":[2488,2618]},{"pos":[2623,2738],"content":"<bpt id=\"p1\">[</bpt>GetCurrentTask Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getcurrenttask-method.md)</ept>","source":"[GetCurrentTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getcurrenttask-method.md)"},{"content":"Gets an interface pointer to the task that is currently executing on the operating system thread from which this call is made.","pos":[2739,2865]},{"pos":[2870,2991],"content":"<bpt id=\"p1\">[</bpt>GetStackGuarantee Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getstackguarantee-method.md)</ept>","source":"[GetStackGuarantee Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-getstackguarantee-method.md)"},{"content":"Gets the amount of stack space that is guaranteed to be available after a stack operation completes, but before the closing of a process.","pos":[2992,3129]},{"pos":[3134,3245],"content":"<bpt id=\"p1\">[</bpt>LeaveRuntime Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md)</ept>","source":"[LeaveRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md)"},{"content":"Notifies the host that managed code is about to make a call to an unmanaged function.","pos":[3246,3331]},{"pos":[3336,3461],"content":"<bpt id=\"p1\">[</bpt>ReverseEnterRuntime Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md)</ept>","source":"[ReverseEnterRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md)"},{"content":"Notifies the host that a call is being made into the common language runtime (CLR) from unmanaged code.","pos":[3462,3565]},{"pos":[3570,3695],"content":"<bpt id=\"p1\">[</bpt>ReverseLeaveRuntime Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md)</ept>","source":"[ReverseLeaveRuntime Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md)"},{"content":"Notifies the host that control is leaving the CLR and entering an unmanaged function that was, in turn, called from managed code.","pos":[3696,3825]},{"pos":[3830,3951],"content":"<bpt id=\"p1\">[</bpt>SetCLRTaskManager Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setclrtaskmanager-method.md)</ept>","source":"[SetCLRTaskManager Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setclrtaskmanager-method.md)"},{"pos":[3952,4131],"content":"Provides the host with an interface pointer to an <bpt id=\"p1\">[</bpt>ICLRTaskManager<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept> instance implemented by the CLR.","source":"Provides the host with an interface pointer to an [ICLRTaskManager](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md) instance implemented by the CLR."},{"pos":[4136,4241],"content":"<bpt id=\"p1\">[</bpt>SetLocale Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setlocale-method.md)</ept>","source":"[SetLocale Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setlocale-method.md)"},{"content":"Notifies the host that the CLR has changed the locale on the current task.","pos":[4242,4316]},{"pos":[4321,4442],"content":"<bpt id=\"p1\">[</bpt>SetStackGuarantee Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setstackguarantee-method.md)</ept>","source":"[SetStackGuarantee Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setstackguarantee-method.md)"},{"content":"Reserved for internal use only.","pos":[4443,4474]},{"pos":[4479,4588],"content":"<bpt id=\"p1\">[</bpt>SetUILocale Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setuilocale-method.md)</ept>","source":"[SetUILocale Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-setuilocale-method.md)"},{"content":"Notifies the host that the user interface locale has been changed on the current task.","pos":[4589,4675]},{"pos":[4680,4777],"content":"<bpt id=\"p1\">[</bpt>Sleep Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-sleep-method.md)</ept>","source":"[Sleep Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-sleep-method.md)"},{"content":"Notifies the host that the current task is going to sleep.","pos":[4778,4836]},{"pos":[4841,4952],"content":"<bpt id=\"p1\">[</bpt>SwitchToTask Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-switchtotask-method.md)</ept>","source":"[SwitchToTask Method](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-switchtotask-method.md)"},{"content":"Notifies the host that it should switch out the current task.","pos":[4953,5014]},{"pos":[5024,5031],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5035,5294],"content":"<ph id=\"ph1\">`IHostTaskManager`</ph> allows the CLR to create and manage tasks, to provide hooks for the host to take action when control transfers from managed to unmanaged code and vice versa, and to specify certain actions the host can and cannot take during code execution.","source":"`IHostTaskManager` allows the CLR to create and manage tasks, to provide hooks for the host to take action when control transfers from managed to unmanaged code and vice versa, and to specify certain actions the host can and cannot take during code execution."},{"pos":[5303,5315],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5319,5423],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[5430,5451],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[5458,5508],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[5515,5623],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[5632,5640],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICLRTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[5644,5737],"source":"[ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>ICLRTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[5741,5848],"source":"[ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IHostTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[5852,5947],"source":"[IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept>","pos":[5951,6043],"source":"[Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)"}]}