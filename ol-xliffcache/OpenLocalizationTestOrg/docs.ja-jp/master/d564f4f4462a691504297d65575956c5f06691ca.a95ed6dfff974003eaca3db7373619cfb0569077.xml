{"content":"---\ntitle: \"Unable to emit assembly: <error message>\"\nms.date: 08/14/2018\nf1_keywords:\n  - \"vbc30145\"\n  - \"bc30145\"\nhelpviewer_keywords:\n  - \"BC30145\"\nms.assetid: 2e7eb2b9-eda6-4bdb-95cc-72c7f0be7528\n---\n# Unable to emit assembly: \\<error message>\n\nThe Visual Basic compiler calls the Assembly Linker (*Al.exe*, also known as Alink) to generate an assembly with a manifest, and the linker reports an error in the emission stage of creating the assembly.\n\n**Error ID:** BC30145\n\n## To correct this error\n\n1. Examine the quoted error message and consult the topic [Al.exe](../../../framework/tools/al-exe-assembly-linker.md) for further explanation and advice.\n\n2. Try signing the assembly manually, using either the [Al.exe](../../../framework/tools/al-exe-assembly-linker.md) or the [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md).\n\n3. If the error persists, gather information about the circumstances and notify Microsoft Product Support Services.\n\n### To sign the assembly manually\n\n1. Use the [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)) to create a public/private key pair file.\n\n   This file has an *.snk* extension.\n\n2. Delete the COM reference that is generating the error from your project.\n\n3. Open the [Developer Command Prompt for Visual Studio](../../../framework/tools/developer-command-prompt-for-vs.md).\n\n   In Windows 10, enter **Developer command prompt** into the search box on the task bar. Then, select **Developer Command Prompt for VS 2017** from the results list.\n\n4. Change the directory to the directory where you want to place your assembly wrapper.\n\n5. Enter the following command:\n\n    ```cmd\n    tlbimp <path to COM reference file> /out:<output assembly name> /keyfile:<path to .snk file>\n    ```\n\n   An example of the actual command you might enter is:\n\n    ```cmd\n    tlbimp c:\\windows\\system32\\msi.dll /out:Interop.WindowsInstaller.dll /keyfile:\"c:\\documents and settings\\mykey.snk\"\n    ```\n\n   > [!TIP]\n   > Use double quotation marks if a path or file contains spaces.\n\n6. In Visual Studio, add a .NET Assembly reference to the file you just created.\n\n## See also\n\n- [Al.exe](../../../framework/tools/al-exe-assembly-linker.md)\n- [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)\n- [How to: Create a Public-Private Key Pair](../../../framework/app-domains/how-to-create-a-public-private-key-pair.md)\n- [Talk to Us](/visualstudio/ide/talk-to-us)","nodes":[{"pos":[4,199],"embed":true,"restype":"x-metadata","content":"title: \"Unable to emit assembly: <error message>\"\nms.date: 08/14/2018\nf1_keywords:\n  - \"vbc30145\"\n  - \"bc30145\"\nhelpviewer_keywords:\n  - \"BC30145\"\nms.assetid: 2e7eb2b9-eda6-4bdb-95cc-72c7f0be7528","nodes":[{"content":"Unable to emit assembly: <error message>","nodes":[{"pos":[0,40],"content":"Unable to emit assembly: <ph id=\"ph1\">&lt;error message&gt;</ph>","source":"Unable to emit assembly: <error message>"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[206,247],"content":"Unable to emit assembly: \\<error message>","linkify":"Unable to emit assembly: \\<error message>","nodes":[{"content":"Unable to emit assembly: <ph id=\"ph1\">\\&lt;</ph>error message&gt;","pos":[0,41],"source":"Unable to emit assembly: \\<error message>"}]},{"pos":[249,453],"content":"The Visual Basic compiler calls the Assembly Linker (<bpt id=\"p1\">*</bpt>Al.exe<ept id=\"p1\">*</ept>, also known as Alink) to generate an assembly with a manifest, and the linker reports an error in the emission stage of creating the assembly.","source":"The Visual Basic compiler calls the Assembly Linker (*Al.exe*, also known as Alink) to generate an assembly with a manifest, and the linker reports an error in the emission stage of creating the assembly."},{"pos":[455,476],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC30145","source":"**Error ID:** BC30145"},{"pos":[481,502],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"pos":[507,658],"content":"Examine the quoted error message and consult the topic <bpt id=\"p1\">[</bpt>Al.exe<ept id=\"p1\">](../../../framework/tools/al-exe-assembly-linker.md)</ept> for further explanation and advice.","source":"Examine the quoted error message and consult the topic [Al.exe](../../../framework/tools/al-exe-assembly-linker.md) for further explanation and advice."},{"pos":[663,864],"content":"Try signing the assembly manually, using either the <bpt id=\"p1\">[</bpt>Al.exe<ept id=\"p1\">](../../../framework/tools/al-exe-assembly-linker.md)</ept> or the <bpt id=\"p2\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p2\">](../../../framework/tools/sn-exe-strong-name-tool.md)</ept>.","source":"Try signing the assembly manually, using either the [Al.exe](../../../framework/tools/al-exe-assembly-linker.md) or the [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)."},{"content":"If the error persists, gather information about the circumstances and notify Microsoft Product Support Services.","pos":[869,981]},{"pos":[987,1016],"content":"To sign the assembly manually","linkify":"To sign the assembly manually","nodes":[{"content":"To sign the assembly manually","pos":[0,29]}]},{"pos":[1021,1152],"content":"Use the <bpt id=\"p1\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p1\">](../../../framework/tools/sn-exe-strong-name-tool.md)</ept>) to create a public/private key pair file.","source":"Use the [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)) to create a public/private key pair file."},{"pos":[1157,1191],"content":"This file has an <bpt id=\"p1\">*</bpt>.snk<ept id=\"p1\">*</ept> extension.","source":"This file has an *.snk* extension."},{"content":"Delete the COM reference that is generating the error from your project.","pos":[1196,1268]},{"pos":[1273,1388],"content":"Open the <bpt id=\"p1\">[</bpt>Developer Command Prompt for Visual Studio<ept id=\"p1\">](../../../framework/tools/developer-command-prompt-for-vs.md)</ept>.","source":"Open the [Developer Command Prompt for Visual Studio](../../../framework/tools/developer-command-prompt-for-vs.md)."},{"content":"In Windows 10, enter <bpt id=\"p1\">**</bpt>Developer command prompt<ept id=\"p1\">**</ept> into the search box on the task bar.","pos":[1393,1479],"source":"In Windows 10, enter **Developer command prompt** into the search box on the task bar."},{"content":"Then, select <bpt id=\"p1\">**</bpt>Developer Command Prompt for VS 2017<ept id=\"p1\">**</ept> from the results list.","pos":[1480,1556],"source":" Then, select **Developer Command Prompt for VS 2017** from the results list."},{"content":"Change the directory to the directory where you want to place your assembly wrapper.","pos":[1561,1645]},{"content":"Enter the following command:","pos":[1650,1678]},{"content":"An example of the actual command you might enter is:","pos":[1800,1852]},{"pos":[1999,2072],"content":"[!TIP]\nUse double quotation marks if a path or file contains spaces.","leadings":["","   > "],"nodes":[{"content":"Use double quotation marks if a path or file contains spaces.","pos":[7,68]}]},{"content":"In Visual Studio, add a .NET Assembly reference to the file you just created.","pos":[2077,2154]},{"pos":[2159,2167],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2171,2231],"content":"<bpt id=\"p1\">[</bpt>Al.exe<ept id=\"p1\">](../../../framework/tools/al-exe-assembly-linker.md)</ept>","source":"[Al.exe](../../../framework/tools/al-exe-assembly-linker.md)"},{"pos":[2234,2314],"content":"<bpt id=\"p1\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p1\">](../../../framework/tools/sn-exe-strong-name-tool.md)</ept>","source":"[Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)"},{"pos":[2317,2434],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Public-Private Key Pair<ept id=\"p1\">](../../../framework/app-domains/how-to-create-a-public-private-key-pair.md)</ept>","source":"[How to: Create a Public-Private Key Pair](../../../framework/app-domains/how-to-create-a-public-private-key-pair.md)"},{"pos":[2437,2479],"content":"<bpt id=\"p1\">[</bpt>Talk to Us<ept id=\"p1\">](/visualstudio/ide/talk-to-us)</ept>","source":"[Talk to Us](/visualstudio/ide/talk-to-us)"}]}