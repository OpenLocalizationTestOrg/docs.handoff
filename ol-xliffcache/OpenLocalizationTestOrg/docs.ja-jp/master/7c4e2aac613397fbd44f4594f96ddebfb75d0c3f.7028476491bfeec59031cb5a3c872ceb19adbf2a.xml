{"content":"---\ntitle: \"Using type dynamic - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"dynamic [C#], about dynamic type\"\n  - \"dynamic type [C#]\"\nms.assetid: 3828989d-c967-4a51-b948-857ebc8fdf26\n---\n# Using type dynamic (C# Programming Guide)\n\n[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] introduces a new type, `dynamic`. The type is a static type, but an object of type `dynamic` bypasses static type checking. In most cases, it functions like it has type `object`. At compile time, an element that is typed as `dynamic` is assumed to support any operation. Therefore, you do not have to be concerned about whether the object gets its value from a COM API, from a dynamic language such as IronPython, from the HTML Document Object Model (DOM), from reflection, or from somewhere else in the program. However, if the code is not valid, errors are caught at run time.\n\nFor example, if instance method `exampleMethod1` in the following code has only one parameter, the compiler recognizes that the first call to the method, `ec.exampleMethod1(10, 4)`, is not valid because it contains two arguments. The call causes a compiler error. The second call to the method, `dynamic_ec.exampleMethod1(10, 4)`, is not checked by the compiler because the type of `dynamic_ec` is `dynamic`. Therefore, no compiler error is reported. However, the error does not escape notice indefinitely. It is caught at run time and causes a run-time exception.\n\n[!code-csharp[CsProgGuideTypes#50](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#50)]\n\n[!code-csharp[CsProgGuideTypes#56](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#56)]\n\nThe role of the compiler in these examples is to package together information about what each statement is proposing to do to the object or expression that is typed as `dynamic`. At run time, the stored information is examined, and any statement that is not valid causes a run-time exception.\n\nThe result of most dynamic operations is itself `dynamic`. For example, if you rest the mouse pointer over the use of `testSum` in the following example, IntelliSense displays the type **(local variable) dynamic testSum**.\n\n[!code-csharp[CsProgGuideTypes#51](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#51)]\n\nOperations in which the result is not `dynamic` include:\n\n* Conversions from `dynamic` to another type.\n* Constructor calls that include arguments of type `dynamic`.\n\nFor example, the type of `testInstance` in the following declaration is `ExampleClass`, not `dynamic`:\n\n[!code-csharp[CsProgGuideTypes#52](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#52)]\n\nConversion examples are shown in the following section, \"Conversions.\"\n\n## Conversions\n\nConversions between dynamic objects and other types are easy. This enables the developer to switch between dynamic and non-dynamic behavior.\n\nAny object can be converted to dynamic type implicitly, as shown in the following examples.\n\n[!code-csharp[CsProgGuideTypes#53](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#53)]\n\nConversely, an implicit conversion can be dynamically applied to any expression of type `dynamic`.\n\n[!code-csharp[CsProgGuideTypes#54](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#54)]\n\n## Overload resolution with arguments of type dynamic\n\nOverload resolution occurs at run time instead of at compile time if one or more of the arguments in a method call have the type `dynamic`, or if the receiver of the method call is of type `dynamic`. In the following example, if the only accessible `exampleMethod2` method is defined to take a string argument, sending `d1` as the argument does not cause a compiler error, but it does cause a run-time exception. Overload resolution fails at run time because the run-time type of `d1` is `int`, and `exampleMethod2` requires a string.\n\n[!code-csharp[CsProgGuideTypes#55](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#55)]\n\n## Dynamic language runtime\n\nThe dynamic language runtime (DLR) is a new API in [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]. It provides the infrastructure that supports the `dynamic` type in C#, and also the implementation of dynamic programming languages such as IronPython and IronRuby. For more information about the DLR, see [Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md).\n\n## COM interop\n\n[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] includes several features that improve the experience of interoperating with COM APIs such as the Office Automation APIs. Among the improvements are the use of the `dynamic` type, and of [named and optional arguments](../classes-and-structs/named-and-optional-arguments.md).\n\nMany COM methods allow for variation in argument types and return type by designating the types as `object`. This has necessitated explicit casting of the values to coordinate with strongly typed variables in C#. If you compile by using the [/link (C# Compiler Options)](../../../csharp/language-reference/compiler-options/link-compiler-option.md) option, the introduction of the `dynamic` type enables you to treat the occurrences of `object` in COM signatures as if they were of type `dynamic`, and thereby to avoid much of the casting. For example, the following statements contrast how you access a cell in a Microsoft Office Excel spreadsheet with the `dynamic` type and without the `dynamic` type.\n\n[!code-csharp[csOfficeWalkthrough#12](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#12)]\n\n[!code-csharp[csOfficeWalkthrough#13](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#13)]\n\n## Related topics\n\n|Title|Description|\n|-----------|-----------------|\n|[dynamic](../../language-reference/keywords/dynamic.md)|Describes the usage of the `dynamic` keyword.|\n|[Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)|Provides an overview of the DLR, which is a runtime environment that adds a set of services for dynamic languages to the common language runtime (CLR).|\n|[Walkthrough: Creating and Using Dynamic Objects](walkthrough-creating-and-using-dynamic-objects.md)|Provides step-by-step instructions for creating a custom dynamic object and for creating a project that accesses an `IronPython` library.|\n|[How to: Access Office Interop Objects by Using Visual C# Features](../interop/how-to-access-office-onterop-objects.md)|Demonstrates how to create a project that uses named and optional arguments, the `dynamic` type, and other enhancements that simplify access to Office API objects.|","nodes":[{"pos":[4,228],"embed":true,"restype":"x-metadata","content":"title: \"Using type dynamic - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"dynamic [C#], about dynamic type\"\n  - \"dynamic type [C#]\"\nms.assetid: 3828989d-c967-4a51-b948-857ebc8fdf26","nodes":[{"content":"Using type dynamic - C# Programming Guide","nodes":[{"pos":[0,41],"content":"Using type dynamic - C# Programming Guide","nodes":[{"content":"Using type dynamic - C# Programming Guide","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[235,276],"content":"Using type dynamic (C# Programming Guide)","linkify":"Using type dynamic (C# Programming Guide)","nodes":[{"content":"Using type dynamic (C# Programming Guide)","pos":[0,41]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph> introduces a new type, <ph id=\"ph2\">`dynamic`</ph>.","pos":[278,377],"source":"[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] introduces a new type, `dynamic`."},{"content":"The type is a static type, but an object of type <ph id=\"ph1\">`dynamic`</ph> bypasses static type checking.","pos":[378,467],"source":" The type is a static type, but an object of type `dynamic` bypasses static type checking."},{"content":"In most cases, it functions like it has type <ph id=\"ph1\">`object`</ph>.","pos":[468,522],"source":" In most cases, it functions like it has type `object`."},{"content":"At compile time, an element that is typed as <ph id=\"ph1\">`dynamic`</ph> is assumed to support any operation.","pos":[523,614],"source":" At compile time, an element that is typed as `dynamic` is assumed to support any operation."},{"content":"Therefore, you do not have to be concerned about whether the object gets its value from a COM API, from a dynamic language such as IronPython, from the HTML Document Object Model (DOM), from reflection, or from somewhere else in the program.","pos":[615,856]},{"content":"However, if the code is not valid, errors are caught at run time.","pos":[857,922]},{"content":"For example, if instance method <ph id=\"ph1\">`exampleMethod1`</ph> in the following code has only one parameter, the compiler recognizes that the first call to the method, <ph id=\"ph2\">`ec.exampleMethod1(10, 4)`</ph>, is not valid because it contains two arguments.","pos":[924,1153],"source":"For example, if instance method `exampleMethod1` in the following code has only one parameter, the compiler recognizes that the first call to the method, `ec.exampleMethod1(10, 4)`, is not valid because it contains two arguments."},{"content":"The call causes a compiler error.","pos":[1154,1187]},{"content":"The second call to the method, <ph id=\"ph1\">`dynamic_ec.exampleMethod1(10, 4)`</ph>, is not checked by the compiler because the type of <ph id=\"ph2\">`dynamic_ec`</ph> is <ph id=\"ph3\">`dynamic`</ph>.","pos":[1188,1332],"source":" The second call to the method, `dynamic_ec.exampleMethod1(10, 4)`, is not checked by the compiler because the type of `dynamic_ec` is `dynamic`."},{"content":"Therefore, no compiler error is reported.","pos":[1333,1374]},{"content":"However, the error does not escape notice indefinitely.","pos":[1375,1430]},{"content":"It is caught at run time and causes a run-time exception.","pos":[1431,1488]},{"content":"The role of the compiler in these examples is to package together information about what each statement is proposing to do to the object or expression that is typed as <ph id=\"ph1\">`dynamic`</ph>.","pos":[1738,1916],"source":"The role of the compiler in these examples is to package together information about what each statement is proposing to do to the object or expression that is typed as `dynamic`."},{"content":"At run time, the stored information is examined, and any statement that is not valid causes a run-time exception.","pos":[1917,2030]},{"content":"The result of most dynamic operations is itself <ph id=\"ph1\">`dynamic`</ph>.","pos":[2032,2090],"source":"The result of most dynamic operations is itself `dynamic`."},{"content":"For example, if you rest the mouse pointer over the use of <ph id=\"ph1\">`testSum`</ph> in the following example, IntelliSense displays the type <bpt id=\"p1\">**</bpt>(local variable) dynamic testSum<ept id=\"p1\">**</ept>.","pos":[2091,2254],"source":" For example, if you rest the mouse pointer over the use of `testSum` in the following example, IntelliSense displays the type **(local variable) dynamic testSum**."},{"pos":[2380,2436],"content":"Operations in which the result is not <ph id=\"ph1\">`dynamic`</ph> include:","source":"Operations in which the result is not `dynamic` include:"},{"pos":[2440,2483],"content":"Conversions from <ph id=\"ph1\">`dynamic`</ph> to another type.","source":"Conversions from `dynamic` to another type."},{"pos":[2486,2545],"content":"Constructor calls that include arguments of type <ph id=\"ph1\">`dynamic`</ph>.","source":"Constructor calls that include arguments of type `dynamic`."},{"pos":[2547,2649],"content":"For example, the type of <ph id=\"ph1\">`testInstance`</ph> in the following declaration is <ph id=\"ph2\">`ExampleClass`</ph>, not <ph id=\"ph3\">`dynamic`</ph>:","source":"For example, the type of `testInstance` in the following declaration is `ExampleClass`, not `dynamic`:"},{"content":"Conversion examples are shown in the following section, \"Conversions.\"","pos":[2775,2845]},{"pos":[2850,2861],"content":"Conversions","linkify":"Conversions","nodes":[{"content":"Conversions","pos":[0,11]}]},{"content":"Conversions between dynamic objects and other types are easy.","pos":[2863,2924]},{"content":"This enables the developer to switch between dynamic and non-dynamic behavior.","pos":[2925,3003]},{"content":"Any object can be converted to dynamic type implicitly, as shown in the following examples.","pos":[3005,3096]},{"pos":[3222,3320],"content":"Conversely, an implicit conversion can be dynamically applied to any expression of type <ph id=\"ph1\">`dynamic`</ph>.","source":"Conversely, an implicit conversion can be dynamically applied to any expression of type `dynamic`."},{"pos":[3449,3499],"content":"Overload resolution with arguments of type dynamic","linkify":"Overload resolution with arguments of type dynamic","nodes":[{"content":"Overload resolution with arguments of type dynamic","pos":[0,50]}]},{"content":"Overload resolution occurs at run time instead of at compile time if one or more of the arguments in a method call have the type <ph id=\"ph1\">`dynamic`</ph>, or if the receiver of the method call is of type <ph id=\"ph2\">`dynamic`</ph>.","pos":[3501,3700],"source":"Overload resolution occurs at run time instead of at compile time if one or more of the arguments in a method call have the type `dynamic`, or if the receiver of the method call is of type `dynamic`."},{"content":"In the following example, if the only accessible <ph id=\"ph1\">`exampleMethod2`</ph> method is defined to take a string argument, sending <ph id=\"ph2\">`d1`</ph> as the argument does not cause a compiler error, but it does cause a run-time exception.","pos":[3701,3913],"source":" In the following example, if the only accessible `exampleMethod2` method is defined to take a string argument, sending `d1` as the argument does not cause a compiler error, but it does cause a run-time exception."},{"content":"Overload resolution fails at run time because the run-time type of <ph id=\"ph1\">`d1`</ph> is <ph id=\"ph2\">`int`</ph>, and <ph id=\"ph3\">`exampleMethod2`</ph> requires a string.","pos":[3914,4035],"source":" Overload resolution fails at run time because the run-time type of `d1` is `int`, and `exampleMethod2` requires a string."},{"pos":[4164,4188],"content":"Dynamic language runtime","linkify":"Dynamic language runtime","nodes":[{"content":"Dynamic language runtime","pos":[0,24]}]},{"content":"The dynamic language runtime (DLR) is a new API in <ph id=\"ph1\">[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]</ph>.","pos":[4190,4299],"source":"The dynamic language runtime (DLR) is a new API in [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]."},{"content":"It provides the infrastructure that supports the <ph id=\"ph1\">`dynamic`</ph> type in C#, and also the implementation of dynamic programming languages such as IronPython and IronRuby.","pos":[4300,4464],"source":" It provides the infrastructure that supports the `dynamic` type in C#, and also the implementation of dynamic programming languages such as IronPython and IronRuby."},{"content":"For more information about the DLR, see <bpt id=\"p1\">[</bpt>Dynamic Language Runtime Overview<ept id=\"p1\">](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)</ept>.","pos":[4465,4621],"source":" For more information about the DLR, see [Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)."},{"pos":[4626,4637],"content":"COM interop","linkify":"COM interop","nodes":[{"content":"COM interop","pos":[0,11]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)]</ph> includes several features that improve the experience of interoperating with COM APIs such as the Office Automation APIs.","pos":[4639,4826],"source":"[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] includes several features that improve the experience of interoperating with COM APIs such as the Office Automation APIs."},{"content":"Among the improvements are the use of the <ph id=\"ph1\">`dynamic`</ph> type, and of <bpt id=\"p1\">[</bpt>named and optional arguments<ept id=\"p1\">](../classes-and-structs/named-and-optional-arguments.md)</ept>.","pos":[4827,4979],"source":" Among the improvements are the use of the `dynamic` type, and of [named and optional arguments](../classes-and-structs/named-and-optional-arguments.md)."},{"content":"Many COM methods allow for variation in argument types and return type by designating the types as <ph id=\"ph1\">`object`</ph>.","pos":[4981,5089],"source":"Many COM methods allow for variation in argument types and return type by designating the types as `object`."},{"content":"This has necessitated explicit casting of the values to coordinate with strongly typed variables in C#.","pos":[5090,5193]},{"content":"If you compile by using the <bpt id=\"p1\">[</bpt>/link (C# Compiler Options)<ept id=\"p1\">](../../../csharp/language-reference/compiler-options/link-compiler-option.md)</ept> option, the introduction of the <ph id=\"ph1\">`dynamic`</ph> type enables you to treat the occurrences of <ph id=\"ph2\">`object`</ph> in COM signatures as if they were of type <ph id=\"ph3\">`dynamic`</ph>, and thereby to avoid much of the casting.","pos":[5194,5519],"source":" If you compile by using the [/link (C# Compiler Options)](../../../csharp/language-reference/compiler-options/link-compiler-option.md) option, the introduction of the `dynamic` type enables you to treat the occurrences of `object` in COM signatures as if they were of type `dynamic`, and thereby to avoid much of the casting."},{"content":"For example, the following statements contrast how you access a cell in a Microsoft Office Excel spreadsheet with the <ph id=\"ph1\">`dynamic`</ph> type and without the <ph id=\"ph2\">`dynamic`</ph> type.","pos":[5520,5684],"source":" For example, the following statements contrast how you access a cell in a Microsoft Office Excel spreadsheet with the `dynamic` type and without the `dynamic` type."},{"pos":[5943,5957],"content":"Related topics","linkify":"Related topics","nodes":[{"content":"Related topics","pos":[0,14]}]},{"content":"Title","pos":[5960,5965]},{"content":"Description","pos":[5966,5977]},{"pos":[6012,6067],"content":"<bpt id=\"p1\">[</bpt>dynamic<ept id=\"p1\">](../../language-reference/keywords/dynamic.md)</ept>","source":"[dynamic](../../language-reference/keywords/dynamic.md)"},{"pos":[6068,6113],"content":"Describes the usage of the <ph id=\"ph1\">`dynamic`</ph> keyword.","source":"Describes the usage of the `dynamic` keyword."},{"pos":[6116,6231],"content":"<bpt id=\"p1\">[</bpt>Dynamic Language Runtime Overview<ept id=\"p1\">](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)</ept>","source":"[Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)"},{"content":"Provides an overview of the DLR, which is a runtime environment that adds a set of services for dynamic languages to the common language runtime (CLR).","pos":[6232,6383]},{"pos":[6386,6486],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Creating and Using Dynamic Objects<ept id=\"p1\">](walkthrough-creating-and-using-dynamic-objects.md)</ept>","source":"[Walkthrough: Creating and Using Dynamic Objects](walkthrough-creating-and-using-dynamic-objects.md)"},{"pos":[6487,6624],"content":"Provides step-by-step instructions for creating a custom dynamic object and for creating a project that accesses an <ph id=\"ph1\">`IronPython`</ph> library.","source":"Provides step-by-step instructions for creating a custom dynamic object and for creating a project that accesses an `IronPython` library."},{"pos":[6627,6746],"content":"<bpt id=\"p1\">[</bpt>How to: Access Office Interop Objects by Using Visual C# Features<ept id=\"p1\">](../interop/how-to-access-office-onterop-objects.md)</ept>","source":"[How to: Access Office Interop Objects by Using Visual C# Features](../interop/how-to-access-office-onterop-objects.md)"},{"pos":[6747,6910],"content":"Demonstrates how to create a project that uses named and optional arguments, the <ph id=\"ph1\">`dynamic`</ph> type, and other enhancements that simplify access to Office API objects.","source":"Demonstrates how to create a project that uses named and optional arguments, the `dynamic` type, and other enhancements that simplify access to Office API objects."}]}