{"content":"---\ntitle: \"Managing Connections\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Internet, connections\"\n  - \"HTTP, classes for connecting\"\n  - \"requesting data from Internet, connections\"\n  - \"sending data, connections\"\n  - \"receiving data, connections\"\n  - \"ServicePoint class, about ServicePoint class\"\n  - \"response to Internet request, connections\"\n  - \"connections [.NET Framework], classes\"\n  - \"network resources, connections\"\n  - \"downloading Internet resources, connections\"\n  - \"ServicePointManager class, about ServicePointManager class\"\nms.assetid: 9b3d3de7-189f-4f7d-81ae-9c29c441aaaa\n---\n# Managing Connections\nApplications that use HTTP to connect to data resources can use the .NET Framework's <xref:System.Net.ServicePoint> and <xref:System.Net.ServicePointManager> classes to manage connections to the Internet and to help them achieve optimum scale and performance.  \n  \n The **ServicePoint** class provides an application with an endpoint to which the application can connect to access Internet resources. Each **ServicePoint** contains information that helps optimize connections with an Internet server by sharing optimization information between connections to improve performance.  \n  \n Each **ServicePoint** is identified by a Uniform Resource Identifier (URI) and is categorized according to the scheme identifier and host fragments of the URI. For example, the same **ServicePoint** instance would provide requests to the URIs `http://www.contoso.com/index.htm` and `http://www.contoso.com/news.htm?date=today` since they have the same scheme identifier (http) and host fragments (`www.contoso.com`). If the application already has a persistent connection to the server `www.contoso.com`, it uses that connection to retrieve both requests, avoiding the need to create two connections.  \n  \n **ServicePointManager** is a static class that manages the creation and destruction of **ServicePoint** instances. The **ServicePointManager** creates a **ServicePoint** when the application requests an Internet resource that is not in the collection of existing **ServicePoint** instances. **ServicePoint** instances are destroyed when they have exceeded their maximum idle time or when the number of existing **ServicePoint** instances exceeds the maximum number of **ServicePoint** instances for the application. You can control both the default maximum idle time and the maximum number of **ServicePoint** instances by setting the <xref:System.Net.ServicePointManager.MaxServicePointIdleTime%2A> and <xref:System.Net.ServicePointManager.MaxServicePoints%2A> properties on the **ServicePointManager**.  \n  \n The number of connections between a client and server can have a dramatic impact on application throughput. By default, an application using the <xref:System.Net.HttpWebRequest> class uses a maximum of two persistent connections to a given server, but you can set the maximum number of connections on a per-application basis.  \n  \n> [!NOTE]\n>  The HTTP/1.1 specification limits the number of connections from an application to two connections per server.  \n  \n The optimum number of connections depends on the actual conditions in which the application runs. Increasing the number of connections available to the application may not affect application performance. To determine the impact of more connections, run performance tests while varying the number of connections. You can change the number of connections that an application uses by changing the static <xref:System.Net.ServicePointManager.DefaultConnectionLimit%2A> property on the **ServicePointManager** class at application initialization, as shown in the following code sample.  \n  \n```csharp  \n// Set the maximum number of connections per server to 4.  \nServicePointManager.DefaultConnectionLimit = 4;  \n```  \n  \n```vb  \n' Set the maximum number of connections per server to 4.  \nServicePointManager.DefaultConnectionLimit = 4  \n```  \n  \n Changing the **ServicePointManager.DefaultConnectionLimit** property does not affect previously initialized **ServicePoint** instances. The following code demonstrates changing the connection limit on an existing **ServicePoint** for the server `http://www.contoso.com` to the value stored in `newLimit`.  \n  \n```csharp  \nUri uri = new Uri(\"http://www.contoso.com/\");  \nServicePoint sp = ServicePointManager.FindServicePoint(uri);  \nsp.ConnectionLimit = newLimit;  \n```  \n  \n```vb  \nDim uri As New Uri(\"http://www.contoso.com/\")  \nDim sp As ServicePoint = ServicePointManager.FindServicePoint(uri)  \nsp.ConnectionLimit = newLimit  \n```  \n  \n## See also\n\n- [Connection Grouping](../../../docs/framework/network-programming/connection-grouping.md)\n- [Using Application Protocols](../../../docs/framework/network-programming/using-application-protocols.md)\n","nodes":[{"pos":[4,633],"embed":true,"restype":"x-metadata","content":"title: \"Managing Connections\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Internet, connections\"\n  - \"HTTP, classes for connecting\"\n  - \"requesting data from Internet, connections\"\n  - \"sending data, connections\"\n  - \"receiving data, connections\"\n  - \"ServicePoint class, about ServicePoint class\"\n  - \"response to Internet request, connections\"\n  - \"connections [.NET Framework], classes\"\n  - \"network resources, connections\"\n  - \"downloading Internet resources, connections\"\n  - \"ServicePointManager class, about ServicePointManager class\"\nms.assetid: 9b3d3de7-189f-4f7d-81ae-9c29c441aaaa","nodes":[{"content":"Managing Connections","nodes":[{"pos":[0,20],"content":"Managing Connections","nodes":[{"content":"Managing Connections","pos":[0,20]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[640,660],"content":"Managing Connections","linkify":"Managing Connections","nodes":[{"content":"Managing Connections","pos":[0,20]}]},{"pos":[661,920],"content":"Applications that use HTTP to connect to data resources can use the .NET Framework's <ph id=\"ph1\">&lt;xref:System.Net.ServicePoint&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Net.ServicePointManager&gt;</ph> classes to manage connections to the Internet and to help them achieve optimum scale and performance.","source":"Applications that use HTTP to connect to data resources can use the .NET Framework's <xref:System.Net.ServicePoint> and <xref:System.Net.ServicePointManager> classes to manage connections to the Internet and to help them achieve optimum scale and performance."},{"content":"The <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> class provides an application with an endpoint to which the application can connect to access Internet resources.","pos":[927,1061],"source":"The **ServicePoint** class provides an application with an endpoint to which the application can connect to access Internet resources."},{"content":"Each <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> contains information that helps optimize connections with an Internet server by sharing optimization information between connections to improve performance.","pos":[1062,1240],"source":" Each **ServicePoint** contains information that helps optimize connections with an Internet server by sharing optimization information between connections to improve performance."},{"content":"Each <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> is identified by a Uniform Resource Identifier (URI) and is categorized according to the scheme identifier and host fragments of the URI.","pos":[1247,1406],"source":"Each **ServicePoint** is identified by a Uniform Resource Identifier (URI) and is categorized according to the scheme identifier and host fragments of the URI."},{"content":"For example, the same <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> instance would provide requests to the URIs <ph id=\"ph1\">`http://www.contoso.com/index.htm`</ph> and <ph id=\"ph2\">`http://www.contoso.com/news.htm?date=today`</ph> since they have the same scheme identifier (http) and host fragments (<ph id=\"ph3\">`www.contoso.com`</ph>).","pos":[1407,1663],"source":" For example, the same **ServicePoint** instance would provide requests to the URIs `http://www.contoso.com/index.htm` and `http://www.contoso.com/news.htm?date=today` since they have the same scheme identifier (http) and host fragments (`www.contoso.com`)."},{"content":"If the application already has a persistent connection to the server <ph id=\"ph1\">`www.contoso.com`</ph>, it uses that connection to retrieve both requests, avoiding the need to create two connections.","pos":[1664,1847],"source":" If the application already has a persistent connection to the server `www.contoso.com`, it uses that connection to retrieve both requests, avoiding the need to create two connections."},{"content":"<bpt id=\"p1\">**</bpt>ServicePointManager<ept id=\"p1\">**</ept> is a static class that manages the creation and destruction of <bpt id=\"p2\">**</bpt>ServicePoint<ept id=\"p2\">**</ept> instances.","pos":[1854,1968],"source":"**ServicePointManager** is a static class that manages the creation and destruction of **ServicePoint** instances."},{"content":"The <bpt id=\"p1\">**</bpt>ServicePointManager<ept id=\"p1\">**</ept> creates a <bpt id=\"p2\">**</bpt>ServicePoint<ept id=\"p2\">**</ept> when the application requests an Internet resource that is not in the collection of existing <bpt id=\"p3\">**</bpt>ServicePoint<ept id=\"p3\">**</ept> instances.","pos":[1969,2144],"source":" The **ServicePointManager** creates a **ServicePoint** when the application requests an Internet resource that is not in the collection of existing **ServicePoint** instances."},{"content":"<bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> instances are destroyed when they have exceeded their maximum idle time or when the number of existing <bpt id=\"p2\">**</bpt>ServicePoint<ept id=\"p2\">**</ept> instances exceeds the maximum number of <bpt id=\"p3\">**</bpt>ServicePoint<ept id=\"p3\">**</ept> instances for the application.","pos":[2145,2369],"source":"**ServicePoint** instances are destroyed when they have exceeded their maximum idle time or when the number of existing **ServicePoint** instances exceeds the maximum number of **ServicePoint** instances for the application."},{"content":"You can control both the default maximum idle time and the maximum number of <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> instances by setting the <ph id=\"ph1\">&lt;xref:System.Net.ServicePointManager.MaxServicePointIdleTime%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Net.ServicePointManager.MaxServicePoints%2A&gt;</ph> properties on the <bpt id=\"p2\">**</bpt>ServicePointManager<ept id=\"p2\">**</ept>.","pos":[2370,2658],"source":" You can control both the default maximum idle time and the maximum number of **ServicePoint** instances by setting the <xref:System.Net.ServicePointManager.MaxServicePointIdleTime%2A> and <xref:System.Net.ServicePointManager.MaxServicePoints%2A> properties on the **ServicePointManager**."},{"content":"The number of connections between a client and server can have a dramatic impact on application throughput.","pos":[2665,2772]},{"content":"By default, an application using the <ph id=\"ph1\">&lt;xref:System.Net.HttpWebRequest&gt;</ph> class uses a maximum of two persistent connections to a given server, but you can set the maximum number of connections on a per-application basis.","pos":[2773,2990],"source":" By default, an application using the <xref:System.Net.HttpWebRequest> class uses a maximum of two persistent connections to a given server, but you can set the maximum number of connections on a per-application basis."},{"pos":[2998,3119],"content":"[!NOTE]\n The HTTP/1.1 specification limits the number of connections from an application to two connections per server.","leadings":["","> "],"nodes":[{"content":"The HTTP/1.1 specification limits the number of connections from an application to two connections per server.","pos":[9,119]}]},{"content":"The optimum number of connections depends on the actual conditions in which the application runs.","pos":[3126,3223]},{"content":"Increasing the number of connections available to the application may not affect application performance.","pos":[3224,3329]},{"content":"To determine the impact of more connections, run performance tests while varying the number of connections.","pos":[3330,3437]},{"content":"You can change the number of connections that an application uses by changing the static <ph id=\"ph1\">&lt;xref:System.Net.ServicePointManager.DefaultConnectionLimit%2A&gt;</ph> property on the <bpt id=\"p1\">**</bpt>ServicePointManager<ept id=\"p1\">**</ept> class at application initialization, as shown in the following code sample.","pos":[3438,3706],"source":" You can change the number of connections that an application uses by changing the static <xref:System.Net.ServicePointManager.DefaultConnectionLimit%2A> property on the **ServicePointManager** class at application initialization, as shown in the following code sample."},{"content":"Changing the <bpt id=\"p1\">**</bpt>ServicePointManager.DefaultConnectionLimit<ept id=\"p1\">**</ept> property does not affect previously initialized <bpt id=\"p2\">**</bpt>ServicePoint<ept id=\"p2\">**</ept> instances.","pos":[3969,4104],"source":"Changing the **ServicePointManager.DefaultConnectionLimit** property does not affect previously initialized **ServicePoint** instances."},{"content":"The following code demonstrates changing the connection limit on an existing <bpt id=\"p1\">**</bpt>ServicePoint<ept id=\"p1\">**</ept> for the server <ph id=\"ph1\">`http://www.contoso.com`</ph> to the value stored in <ph id=\"ph2\">`newLimit`</ph>.","pos":[4105,4273],"source":" The following code demonstrates changing the connection limit on an existing **ServicePoint** for the server `http://www.contoso.com` to the value stored in `newLimit`."},{"pos":[4613,4621],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4625,4714],"content":"<bpt id=\"p1\">[</bpt>Connection Grouping<ept id=\"p1\">](../../../docs/framework/network-programming/connection-grouping.md)</ept>","source":"[Connection Grouping](../../../docs/framework/network-programming/connection-grouping.md)"},{"pos":[4717,4822],"content":"<bpt id=\"p1\">[</bpt>Using Application Protocols<ept id=\"p1\">](../../../docs/framework/network-programming/using-application-protocols.md)</ept>","source":"[Using Application Protocols](../../../docs/framework/network-programming/using-application-protocols.md)"}]}