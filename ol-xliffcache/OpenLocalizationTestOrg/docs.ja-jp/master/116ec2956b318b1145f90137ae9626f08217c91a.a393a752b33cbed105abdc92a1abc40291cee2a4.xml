{"content":"---\ntitle: \"ICLRTask2::EndPreventAsyncAbort Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRTask2.EndPreventAsyncAbort\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRTask2::EndPreventAsyncAbort\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"EndPreventAsyncAbort method [.NET Framework hosting]\"\n  - \"ICLRTask2::EndPreventAsyncAbort method [.NET Framework hosting]\"\nms.assetid: d8013659-e3df-44b3-814f-a6b534ce62f8\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 6\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRTask2::EndPreventAsyncAbort Method\nAllows new or pending thread abort requests to result in thread aborts on the current thread.  \n  \n## Syntax  \n  \n```  \nHRESULT EndPreventAsyncAbort();  \n```  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|HOST_E_INVALIDOPERATION|The method was called on a thread which is not the current thread.|  \n  \n## Remarks  \n Calling this method decrements the delay-thread-abort counter for the current thread by one.  \n  \n Calls to [ICLRTask2::BeginPreventAsyncAbort](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md) and `EndPreventAsyncAbort` can be nested. As long as the counter is greater than zero, thread aborts for the current thread are delayed.  \n  \n The functionality that is exposed by this feature is used internally by the virtual machine (VM). Misuse of these methods may cause unspecified behavior in the VM. For example, calling `EndPreventAsyncAbort` without first calling `BeginPreventAsyncAbort` could set the counter to zero when the VM has previously incremented it. Similarly, the internal counter is not checked for overflow. If it exceeds its integral limit because it is incremented by both the host and the VM, the resulting behavior is unspecified.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [BeginPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)   \n [ICLRTask2 Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-interface.md)   \n [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)   \n [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)   \n [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)   \n [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)","nodes":[{"pos":[12,67],"content":"ICLRTask2::EndPreventAsyncAbort Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ICLRTask2::EndPreventAsyncAbort Method | Microsoft Docs","pos":[0,55]}]},{"pos":[725,763],"content":"ICLRTask2::EndPreventAsyncAbort Method","linkify":"ICLRTask2::EndPreventAsyncAbort Method","nodes":[{"content":"ICLRTask2::EndPreventAsyncAbort Method","pos":[0,38]}]},{"content":"Allows new or pending thread abort requests to result in thread aborts on the current thread.","pos":[764,857]},{"pos":[866,872],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[930,942],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[946,1053]},{"content":"HRESULT","pos":[1060,1067]},{"content":"Description","pos":[1068,1079]},{"content":"S_OK","pos":[1120,1124]},{"content":"The method completed successfully.","pos":[1125,1159]},{"content":"HOST_E_INVALIDOPERATION","pos":[1164,1187]},{"content":"The method was called on a thread which is not the current thread.","pos":[1188,1254]},{"pos":[1264,1271],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Calling this method decrements the delay-thread-abort counter for the current thread by one.","pos":[1275,1367]},{"content":"Calls to <bpt id=\"p1\">[</bpt>ICLRTask2::BeginPreventAsyncAbort<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)</ept> and <ph id=\"ph1\">`EndPreventAsyncAbort`</ph> can be nested.","pos":[1374,1553],"source":"Calls to [ICLRTask2::BeginPreventAsyncAbort](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md) and `EndPreventAsyncAbort` can be nested."},{"content":"As long as the counter is greater than zero, thread aborts for the current thread are delayed.","pos":[1554,1648]},{"content":"The functionality that is exposed by this feature is used internally by the virtual machine (VM).","pos":[1655,1752]},{"content":"Misuse of these methods may cause unspecified behavior in the VM.","pos":[1753,1818]},{"content":"For example, calling <ph id=\"ph1\">`EndPreventAsyncAbort`</ph> without first calling <ph id=\"ph2\">`BeginPreventAsyncAbort`</ph> could set the counter to zero when the VM has previously incremented it.","pos":[1819,1982],"source":" For example, calling `EndPreventAsyncAbort` without first calling `BeginPreventAsyncAbort` could set the counter to zero when the VM has previously incremented it."},{"content":"Similarly, the internal counter is not checked for overflow.","pos":[1983,2043]},{"content":"If it exceeds its integral limit because it is incremented by both the host and the VM, the resulting behavior is unspecified.","pos":[2044,2170]},{"pos":[2179,2191],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2195,2299],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2306,2327],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2334,2384],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2391,2499],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[2508,2516],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>BeginPreventAsyncAbort Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)</ept><ph id=\"ph1\"> </ph>","pos":[2520,2645],"source":"[BeginPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ICLRTask2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2648,2744],"source":" [ICLRTask2 Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ICLRTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2747,2855],"source":" [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IHostTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2858,2954],"source":" [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IHostTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2957,3067],"source":" [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept>","pos":[3070,3163],"source":" [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)"}]}