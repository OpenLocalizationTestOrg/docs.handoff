{"content":"---\ntitle: \"Specifying an Entry Point | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"EntryPoint field\"\n  - \"platform invoke, attribute fields\"\n  - \"attribute fields in platform invoke, EntryPoint\"\nms.assetid: d1247f08-0965-416a-b978-e0b50652dfe3\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Specifying an Entry Point\nAn entry point identifies the location of a function in a DLL. Within a managed project, the original name or ordinal entry point of a target function identifies that function across the interoperation boundary. Further, you can map the entry point to a different name, effectively renaming the function.  \n  \n Following is a list of possible reasons to rename a DLL function:  \n  \n-   To avoid using case-sensitive API function names  \n  \n-   To comply with existing naming standards  \n  \n-   To accommodate functions that take different data types (by declaring multiple versions of the same DLL function)  \n  \n-   To simplify using APIs that contain ANSI and Unicode versions  \n  \n This topic demonstrates how to rename a DLL function in managed code.  \n  \n## Renaming a Function in Visual Basic  \n Visual Basic uses the **Function** keyword in the **Declare** statement to set the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName> field. The following example shows a basic declaration.  \n  \n```vb  \nImports System.Runtime.InteropServices  \n  \nPublic Class Win32  \n    Declare Auto Function MessageBox Lib \"user32.dll\" _  \n       (ByVal hWnd As Integer, ByVal txt As String,_  \n       ByVal caption As String, ByVal Typ As Integer) As Integer  \nEnd Class  \n```  \n  \n You can replace the **MessageBox** entry point with **MsgBox** by including the **Alias** keyword in your definition, as shown in the following example. In both examples the **Auto** keyword eliminates the need to specify the character-set version of the entry point. For more information about selecting a character set, see [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md).  \n  \n```vb  \nImports System.Runtime.InteropServices  \n  \nPublic Class Win32  \n    Declare Auto Function MsgBox Lib \"user32.dll\" _  \n       Alias \"MessageBox\" (ByVal hWnd As Integer, ByVal txt As String,_  \n       ByVal caption As String, ByVal Typ As Integer) As Integer  \nEnd Class  \n```  \n  \n## Renaming a Function in C# and C++  \n You can use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName> field to specify a DLL function by name or ordinal. If the name of the function in your method definition is the same as the entry point in the DLL, you do not have to explicitly identify the function with the **EntryPoint** field. Otherwise, use one of the following attribute forms to indicate a name or ordinal:  \n  \n```  \n[DllImport(\"dllname\", EntryPoint=\"Functionname\")]  \n[DllImport(\"dllname\", EntryPoint=\"#123\")]  \n```  \n  \n Notice that you must prefix an ordinal with the pound sign (#).  \n  \n The following example demonstrates how to replace **MessageBoxA** with **MsgBox** in your code by using the **EntryPoint** field.  \n  \n```csharp  \nusing System.Runtime.InteropServices;  \n  \npublic class Win32 {  \n    [DllImport(\"user32.dll\", EntryPoint=\"MessageBoxA\")]  \n    public static extern int MsgBox(int hWnd, String text, String caption,  \n                                    uint type);  \n}  \n  \n```  \n  \n```cpp  \nusing namespace System::Runtime::InteropServices;  \n  \ntypedef void* HWND;  \n[DllImport(\"user32\", EntryPoint=\"MessageBoxA\")]  \nextern \"C\" int MsgBox(HWND hWnd,  \n                      String*  pText,  \n                      String*  pCaption,  \n                      unsigned int uType);  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.DllImportAttribute>   \n [Creating Prototypes in Managed Code](../../../docs/framework/interop/creating-prototypes-in-managed-code.md)   \n [Platform Invoke Examples](../../../docs/framework/interop/platform-invoke-examples.md)   \n [Marshaling Data with Platform Invoke](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)","nodes":[{"pos":[4,546],"embed":true,"restype":"x-metadata","content":"title: \"Specifying an Entry Point | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"EntryPoint field\"\n  - \"platform invoke, attribute fields\"\n  - \"attribute fields in platform invoke, EntryPoint\"\nms.assetid: d1247f08-0965-416a-b978-e0b50652dfe3\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"Specifying an Entry Point | Microsoft Docs","nodes":[{"pos":[0,42],"content":"Specifying an Entry Point | Microsoft Docs","nodes":[{"content":"Specifying an Entry Point | Microsoft Docs","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[553,578],"content":"Specifying an Entry Point","linkify":"Specifying an Entry Point","nodes":[{"content":"Specifying an Entry Point","pos":[0,25]}]},{"content":"An entry point identifies the location of a function in a DLL.","pos":[579,641]},{"content":"Within a managed project, the original name or ordinal entry point of a target function identifies that function across the interoperation boundary.","pos":[642,790]},{"content":"Further, you can map the entry point to a different name, effectively renaming the function.","pos":[791,883]},{"content":"Following is a list of possible reasons to rename a DLL function:","pos":[890,955]},{"content":"To avoid using case-sensitive API function names","pos":[965,1013]},{"content":"To comply with existing naming standards","pos":[1023,1063]},{"content":"To accommodate functions that take different data types (by declaring multiple versions of the same DLL function)","pos":[1073,1186]},{"content":"To simplify using APIs that contain ANSI and Unicode versions","pos":[1196,1257]},{"content":"This topic demonstrates how to rename a DLL function in managed code.","pos":[1264,1333]},{"pos":[1342,1377],"content":"Renaming a Function in Visual Basic","linkify":"Renaming a Function in Visual Basic","nodes":[{"content":"Renaming a Function in Visual Basic","pos":[0,35]}]},{"content":"Visual Basic uses the <bpt id=\"p1\">**</bpt>Function<ept id=\"p1\">**</ept> keyword in the <bpt id=\"p2\">**</bpt>Declare<ept id=\"p2\">**</ept> statement to set the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName&gt;</ph> field.","pos":[1381,1563],"source":"Visual Basic uses the **Function** keyword in the **Declare** statement to set the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName> field."},{"content":"The following example shows a basic declaration.","pos":[1564,1612]},{"content":"You can replace the <bpt id=\"p1\">**</bpt>MessageBox<ept id=\"p1\">**</ept> entry point with <bpt id=\"p2\">**</bpt>MsgBox<ept id=\"p2\">**</ept> by including the <bpt id=\"p3\">**</bpt>Alias<ept id=\"p3\">**</ept> keyword in your definition, as shown in the following example.","pos":[1893,2045],"source":"You can replace the **MessageBox** entry point with **MsgBox** by including the **Alias** keyword in your definition, as shown in the following example."},{"content":"In both examples the <bpt id=\"p1\">**</bpt>Auto<ept id=\"p1\">**</ept> keyword eliminates the need to specify the character-set version of the entry point.","pos":[2046,2160],"source":" In both examples the **Auto** keyword eliminates the need to specify the character-set version of the entry point."},{"content":"For more information about selecting a character set, see <bpt id=\"p1\">[</bpt>Specifying a Character Set<ept id=\"p1\">](../../../docs/framework/interop/specifying-a-character-set.md)</ept>.","pos":[2161,2311],"source":" For more information about selecting a character set, see [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md)."},{"pos":[2609,2642],"content":"Renaming a Function in C# and C++","linkify":"Renaming a Function in C# and C++","nodes":[{"content":"Renaming a Function in C# and C++","pos":[0,33]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName&gt;</ph> field to specify a DLL function by name or ordinal.","pos":[2646,2806],"source":"You can use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint?displayProperty=fullName> field to specify a DLL function by name or ordinal."},{"content":"If the name of the function in your method definition is the same as the entry point in the DLL, you do not have to explicitly identify the function with the <bpt id=\"p1\">**</bpt>EntryPoint<ept id=\"p1\">**</ept> field.","pos":[2807,2986],"source":" If the name of the function in your method definition is the same as the entry point in the DLL, you do not have to explicitly identify the function with the **EntryPoint** field."},{"content":"Otherwise, use one of the following attribute forms to indicate a name or ordinal:","pos":[2987,3069]},{"content":"Notice that you must prefix an ordinal with the pound sign (#).","pos":[3187,3250]},{"pos":[3257,3386],"content":"The following example demonstrates how to replace <bpt id=\"p1\">**</bpt>MessageBoxA<ept id=\"p1\">**</ept> with <bpt id=\"p2\">**</bpt>MsgBox<ept id=\"p2\">**</ept> in your code by using the <bpt id=\"p3\">**</bpt>EntryPoint<ept id=\"p3\">**</ept> field.","source":"The following example demonstrates how to replace **MessageBoxA** with **MsgBox** in your code by using the **EntryPoint** field."},{"pos":[3982,3990],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Creating Prototypes in Managed Code<ept id=\"p1\">](../../../docs/framework/interop/creating-prototypes-in-managed-code.md)</ept><ph id=\"ph1\"> </ph>","pos":[4055,4165],"source":"[Creating Prototypes in Managed Code](../../../docs/framework/interop/creating-prototypes-in-managed-code.md) "},{"content":"<bpt id=\"p1\">[</bpt>Platform Invoke Examples<ept id=\"p1\">](../../../docs/framework/interop/platform-invoke-examples.md)</ept><ph id=\"ph1\"> </ph>","pos":[4169,4257],"source":"[Platform Invoke Examples](../../../docs/framework/interop/platform-invoke-examples.md) "},{"content":"<bpt id=\"p1\">[</bpt>Marshaling Data with Platform Invoke<ept id=\"p1\">](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)</ept>","pos":[4261,4372],"source":"[Marshaling Data with Platform Invoke](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)"}]}