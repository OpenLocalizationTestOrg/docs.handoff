{"content":"---\ntitle: \"How to: Specify the Execution Mode in PLINQ\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"PLINQ queries, how to use execution mode\"\nms.assetid: e52ff26c-c5d3-4fab-9fec-c937fb387963\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Specify the Execution Mode in PLINQ\nThis example shows how to force PLINQ to bypass its default heuristics and parallelize a query regardless of the query's shape.  \n  \n> [!WARNING]\n>  This example is intended to demonstrate usage, and might not run faster than the equivalent sequential LINQ to Objects query. For more information about speedup, see [Understanding Speedup in PLINQ](../../../docs/standard/parallel-programming/understanding-speedup-in-plinq.md).  \n  \n## Example  \n [!code-csharp[PLINQ#22](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#22)]\n [!code-vb[PLINQ#22](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#22)]  \n  \n PLINQ is designed to exploit opportunities for parallelization. However, not all queries benefit from parallel execution. For example, when a query contains a single user delegate that does very little work, the query will usually run faster sequentially. This is because the overhead involved in enabling parallelizing execution is more expensive than the speedup that is obtained. Therefore, PLINQ does not automatically parallelize every query. It first examines the shape of the query and the various operators that comprise it. Based on this analysis, PLINQ in the default execution mode may decide to execute some or all of the query sequentially. However, in some cases you may know more about your query than PLINQ is able to determine from its analysis. For example, you may know that a delegate is very expensive, and that the query will definitely benefit from parallelization. In such cases, you can use the <xref:System.Linq.ParallelEnumerable.WithExecutionMode%2A> method and specify the <xref:System.Linq.ParallelExecutionMode.ForceParallelism> value to instruct PLINQ to always run the query as parallel.  \n  \n## Compiling the Code  \n Cut and paste this code into the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) and call the method from `Main`.  \n  \n## See also\n\n- <xref:System.Linq.ParallelEnumerable.AsSequential%2A>\n- [Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)\n","nodes":[{"pos":[4,301],"embed":true,"restype":"x-metadata","content":"title: \"How to: Specify the Execution Mode in PLINQ\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"PLINQ queries, how to use execution mode\"\nms.assetid: e52ff26c-c5d3-4fab-9fec-c937fb387963\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Specify the Execution Mode in PLINQ","nodes":[{"pos":[0,43],"content":"How to: Specify the Execution Mode in PLINQ","nodes":[{"content":"How to: Specify the Execution Mode in PLINQ","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[308,351],"content":"How to: Specify the Execution Mode in PLINQ","linkify":"How to: Specify the Execution Mode in PLINQ","nodes":[{"content":"How to: Specify the Execution Mode in PLINQ","pos":[0,43]}]},{"content":"This example shows how to force PLINQ to bypass its default heuristics and parallelize a query regardless of the query's shape.","pos":[352,479]},{"pos":[487,779],"content":"[!WARNING]\n This example is intended to demonstrate usage, and might not run faster than the equivalent sequential LINQ to Objects query. For more information about speedup, see [Understanding Speedup in PLINQ](../../../docs/standard/parallel-programming/understanding-speedup-in-plinq.md).","leadings":["","> "],"nodes":[{"content":"This example is intended to demonstrate usage, and might not run faster than the equivalent sequential LINQ to Objects query. For more information about speedup, see [Understanding Speedup in PLINQ](../../../docs/standard/parallel-programming/understanding-speedup-in-plinq.md).","pos":[12,290],"nodes":[{"content":"This example is intended to demonstrate usage, and might not run faster than the equivalent sequential LINQ to Objects query.","pos":[0,125]},{"content":"For more information about speedup, see <bpt id=\"p1\">[</bpt>Understanding Speedup in PLINQ<ept id=\"p1\">](../../../docs/standard/parallel-programming/understanding-speedup-in-plinq.md)</ept>.","pos":[126,278],"source":" For more information about speedup, see [Understanding Speedup in PLINQ](../../../docs/standard/parallel-programming/understanding-speedup-in-plinq.md)."}]}]},{"pos":[788,795],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"PLINQ is designed to exploit opportunities for parallelization.","pos":[1017,1080]},{"content":"However, not all queries benefit from parallel execution.","pos":[1081,1138]},{"content":"For example, when a query contains a single user delegate that does very little work, the query will usually run faster sequentially.","pos":[1139,1272]},{"content":"This is because the overhead involved in enabling parallelizing execution is more expensive than the speedup that is obtained.","pos":[1273,1399]},{"content":"Therefore, PLINQ does not automatically parallelize every query.","pos":[1400,1464]},{"content":"It first examines the shape of the query and the various operators that comprise it.","pos":[1465,1549]},{"content":"Based on this analysis, PLINQ in the default execution mode may decide to execute some or all of the query sequentially.","pos":[1550,1670]},{"content":"However, in some cases you may know more about your query than PLINQ is able to determine from its analysis.","pos":[1671,1779]},{"content":"For example, you may know that a delegate is very expensive, and that the query will definitely benefit from parallelization.","pos":[1780,1905]},{"content":"In such cases, you can use the <ph id=\"ph1\">&lt;xref:System.Linq.ParallelEnumerable.WithExecutionMode%2A&gt;</ph> method and specify the <ph id=\"ph2\">&lt;xref:System.Linq.ParallelExecutionMode.ForceParallelism&gt;</ph> value to instruct PLINQ to always run the query as parallel.","pos":[1906,2137],"source":" In such cases, you can use the <xref:System.Linq.ParallelEnumerable.WithExecutionMode%2A> method and specify the <xref:System.Linq.ParallelExecutionMode.ForceParallelism> value to instruct PLINQ to always run the query as parallel."},{"pos":[2146,2164],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2168,2319],"content":"Cut and paste this code into the <bpt id=\"p1\">[</bpt>PLINQ Data Sample<ept id=\"p1\">](../../../docs/standard/parallel-programming/plinq-data-sample.md)</ept> and call the method from <ph id=\"ph1\">`Main`</ph>.","source":"Cut and paste this code into the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) and call the method from `Main`."},{"pos":[2328,2336],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2396,2487],"content":"<bpt id=\"p1\">[</bpt>Parallel LINQ (PLINQ)<ept id=\"p1\">](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)</ept>","source":"[Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)"}]}