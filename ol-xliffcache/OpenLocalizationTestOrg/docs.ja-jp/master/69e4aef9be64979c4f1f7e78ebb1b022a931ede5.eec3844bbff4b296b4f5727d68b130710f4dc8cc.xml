{"content":"---\ntitle: \"Best Practices: Data Contract Versioning | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"data contracts\"\n  - \"service contracts\"\n  - \"best practices [WCF], data contract versioning\"\n  - \"Windows Communication Foundation, data contracts\"\nms.assetid: bf0ab338-4d36-4e12-8002-8ebfdeb346cb\ncaps.latest.revision: 24\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Best Practices: Data Contract Versioning\nThis topic lists the best practices for creating data contracts that can evolve easily over time. [!INCLUDE[crabout](../../../includes/crabout-md.md)] data contracts, see the topics in [Using Data Contracts](../../../docs/framework/wcf/feature-details/using-data-contracts.md).  \n  \n## Note on Schema Validation  \n In discussing data contract versioning, it is important to note that the data contract schema exported by [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] does not have any versioning support, other than the fact that elements are marked as optional by default.  \n  \n This means that even the most common versioning scenario, such as adding a new data member, cannot be implemented in a way that is seamless with regard to a given schema. The newer versions of a data contract (with a new data member, for example) do not validate using the old schema.  \n  \n However, there are many scenarios in which strict schema compliance is not required. Many Web services platforms, including [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and XML Web services created using ASP.NET, do not perform schema validation by default and therefore tolerate extra elements that are not described by the schema. When working with such platforms, many versioning scenarios are easier to implement.  \n  \n Thus, there are two sets of data contract versioning guidelines: one set for scenarios where strict schema validity is important, and another set for scenarios when it is not.  \n  \n## Versioning When Schema Validation Is Required  \n If strict schema validity is required in all directions (new-to-old and old-to-new), data contracts should be considered immutable. If versioning is required, a new data contract should be created, with a different name or namespace, and the service contract using the data type should be versioned accordingly.  \n  \n For example, a purchase order processing service contract named `PoProcessing` with a `PostPurchaseOrder` operation takes a parameter that conforms to a `PurchaseOrder` data contract. If the `PurchaseOrder` contract has to change, you must create a new data contract, that is, `PurchaseOrder2`, which includes the changes. You must then handle the versioning at the service contract level. For example, by creating a `PostPurchaseOrder2` operation that takes the `PurchaseOrder2` parameter, or by creating a `PoProcessing2` service contract where the `PostPurchaseOrder` operation takes a `PurchaseOrder2` data contract.  \n  \n Note that changes in data contracts that are referenced by other data contracts also extend to the service model layer. For example, in the previous scenario the `PurchaseOrder` data contract does not need to change. However, it contains a data member of a `Customer` data contract, which in turn contained a data member of the `Address` data contract, which does need to be changed. In that case, you would need to create an `Address2` data contract with the required changes, a `Customer2` data contract that contains the `Address2` data member, and a `PurchaseOrder2` data contract that contains a `Customer2` data member. As in the previous case, the service contract would have to be versioned as well.  \n  \n Although in these examples names are changed (by appending a \"2\"), the recommendation is to change namespaces instead of names by appending new namespaces with a version number or a date. For example, the `http://schemas.contoso.com/2005/05/21/PurchaseOrder` data contract would change to the `http://schemas.contoso.com/2005/10/14/PurchaseOrder` data contract.  \n  \n [!INCLUDE[crdefault](../../../includes/crdefault-md.md)] Best Practices: [Service Versioning](../../../docs/framework/wcf/service-versioning.md).  \n  \n Occasionally, you must guarantee strict schema compliance for messages sent by your application, but cannot rely on the incoming messages to be strictly schema-compliant. In this case, there is a danger that an incoming message might contain extraneous data. The extraneous values are stored and returned by [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and thus results in schema-invalid messages being sent. To avoid this problem, the round-tripping feature should be turned off. There are two ways to do this.  \n  \n-   Do not implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface on any of your types.  \n  \n-   Apply a <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute to your service contract with the <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> property set to `true`.  \n  \n [!INCLUDE[crabout](../../../includes/crabout-md.md)] round-tripping, see [Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md).  \n  \n## Versioning When Schema Validation Is Not Required  \n Strict schema compliance is rarely required. Many platforms tolerate extra elements not described by a schema. As long as this is tolerated, the full set of features described in [Data Contract Versioning](../../../docs/framework/wcf/feature-details/data-contract-versioning.md) and [Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md) can be used. The following guidelines are recommended.  \n  \n Some of the guidelines must be followed exactly in order to send new versions of a type where an older one is expected or send an old one where the new one is expected. Other guidelines are not strictly required, but are listed here because they may be affected by the future of schema versioning.  \n  \n1.  Do not attempt to version data contracts by type inheritance. To create later versions, either change the data contract on an existing type or create a new unrelated type.  \n  \n2.  The use of inheritance together with data contracts is allowed, provided that inheritance is not used as a versioning mechanism and that certain rules are followed. If a type derives from a certain base type, do not make it derive from a different base type in a future version (unless it has the same data contract). There is one exception to this: you can insert a type into the hierarchy between a data contract type and its base type, but only if it does not contain data members with the same names as other members in any possible versions of the other types in the hierarchy. In general, using data members with the same names at different levels of the same inheritance hierarchy can lead to serious versioning problems and should be avoided.  \n  \n3.  Starting with the first version of a data contract, always implement <xref:System.Runtime.Serialization.IExtensibleDataObject> to enable round-tripping. [!INCLUDE[crdefault](../../../includes/crdefault-md.md)][Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md). If you have released one or more versions of a type without implementing this interface, implement it in the next version of the type.  \n  \n4.  In later versions, do not change the data contract name or namespace. If changing the name or namespace of the type underlying the data contract, be sure to preserve the data contract name and namespace by using the appropriate mechanisms, such as the <xref:System.Runtime.Serialization.DataContractAttribute.Name%2A> property of the <xref:System.Runtime.Serialization.DataContractAttribute>. [!INCLUDE[crabout](../../../includes/crabout-md.md)] naming, see [Data Contract Names](../../../docs/framework/wcf/feature-details/data-contract-names.md).  \n  \n5.  In later versions, do not change the names of any data members. If changing the name of the field, property, or event underlying the data member, use the `Name` property of the <xref:System.Runtime.Serialization.DataMemberAttribute> to preserve the existing data member name.  \n  \n6.  In later versions, do not change the type of any field, property, or event underlying a data member such that the resulting data contract for that data member changes. Keep in mind that interface types are equivalent to <xref:System.Object> for the purposes of determining the expected data contract.  \n  \n7.  In later versions, do not change the order of the existing data members by adjusting the <xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A> property of the <xref:System.Runtime.Serialization.DataMemberAttribute> attribute.  \n  \n8.  In later versions, new data members can be added. They should always follow these rules:  \n  \n    1.  The <xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A> property should always be left at its default value of `false`.  \n  \n    2.  If a default value of `null` or zero for the member is unacceptable, a callback method should be provided using the <xref:System.Runtime.Serialization.OnDeserializingAttribute> to provide a reasonable default in case the member is not present in the incoming stream. [!INCLUDE[crabout](../../../includes/crabout-md.md)] the callback, see [Version-Tolerant Serialization Callbacks](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md).  \n  \n    3.  The `Order` property on the `DataMemberAttribute` should be used to make sure that all of the newly added data members appear after the existing data members. The recommended way of doing this is as follows: None of the data members in the first version of the data contract should have their `Order` property set. All of the data members added in version 2 of the data contract should have their `Order` property set to 2. All of the data members added in version 3 of the data contract should have their `Order` set to 3, and so on. It is permissible to have more than one data member set to the same `Order` number.  \n  \n9. Do not remove data members in later versions, even if the <xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A> property was left at its default property of `false` in prior versions.  \n  \n10. Do not change the `IsRequired` property on any existing data members from version to version.  \n  \n11. For required data members (where `IsRequired` is `true`), do not change the `EmitDefaultValue` property from version to version.  \n  \n12. Do not attempt to create branched versioning hierarchies. That is, there should always be a path in at least one direction from any version to any other version using only the changes permitted by these guidelines.  \n  \n     For example, if version 1 of a Person data contract contains only the Name data member, you should not create version 2a of the contract adding only the Age member and version 2b adding only the Address member. Going from 2a to 2b would involve removing Age and adding Address; going in the other direction would entail removing Address and adding Age. Removing members is not permitted by these guidelines.  \n  \n13. You should generally not create new subtypes of existing data contract types in a new version of your application. Likewise, you should not create new data contracts that are used in place of data members declared as Object or as interface types. Creating these new classes is allowed only when you know that you can add the new types to the known types list of all instances of your old application. For example, in version 1 of your application, you may have the LibraryItem data contract type with the Book and Newspaper data contract subtypes. LibraryItem would then have a known types list that contains Book and Newspaper. Suppose you now add a Magazine type in version 2 which is a subtype of LibraryItem. If you send a Magazine instance from version 2 to version 1, the Magazine data contract is not found in the list of known types and an exception is thrown.  \n  \n14. You should not add or remove enumeration members between versions. You should also not rename enumeration members, unless you use the Name property on the `EnumMemberAttribute` attribute to keep their names in the data contract model the same.  \n  \n15. Collections are interchangeable in the data contract model as described in [Collection Types in Data Contracts](../../../docs/framework/wcf/feature-details/collection-types-in-data-contracts.md). This allows for a great degree of flexibility. However, make sure that you do not inadvertently change a collection type in a non-interchangeable way from version to version. For example, do not change from a non-customized collection (that is, without the `CollectionDataContractAttribute` attribute) to a customized one or a customized collection to a non-customized one. Also, do not change the properties on the `CollectionDataContractAttribute` from version to version. The only allowed change is adding a Name or Namespace property if the underlying collection type's name or namespace has changed and you need to make its data contract name and namespace the same as in a previous version.  \n  \n Some of the guidelines listed here can be safely ignored when special circumstances apply. Make sure you fully understand the serialization, deserialization, and schema mechanisms involved before deviating from the guidelines.  \n  \n## See Also  \n <xref:System.Runtime.Serialization.DataContractAttribute.Name%2A>   \n <xref:System.Runtime.Serialization.DataContractAttribute>   \n <xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A>   \n <xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A>   \n <xref:System.Runtime.Serialization.IExtensibleDataObject>   \n <xref:System.ServiceModel.ServiceBehaviorAttribute>   \n <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A>   \n <xref:System.Runtime.Serialization.ExtensionDataObject>   \n <xref:System.Runtime.Serialization.OnDeserializingAttribute>   \n [Using Data Contracts](../../../docs/framework/wcf/feature-details/using-data-contracts.md)   \n [Data Contract Versioning](../../../docs/framework/wcf/feature-details/data-contract-versioning.md)   \n [Data Contract Names](../../../docs/framework/wcf/feature-details/data-contract-names.md)   \n [Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)   \n [Version-Tolerant Serialization Callbacks](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md)","nodes":[{"pos":[4,570],"embed":true,"restype":"x-metadata","content":"title: \"Best Practices: Data Contract Versioning | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"data contracts\"\n  - \"service contracts\"\n  - \"best practices [WCF], data contract versioning\"\n  - \"Windows Communication Foundation, data contracts\"\nms.assetid: bf0ab338-4d36-4e12-8002-8ebfdeb346cb\ncaps.latest.revision: 24\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"Best Practices: Data Contract Versioning | Microsoft Docs","nodes":[{"pos":[0,57],"content":"Best Practices: Data Contract Versioning | Microsoft Docs","nodes":[{"content":"Best Practices: Data Contract Versioning | Microsoft Docs","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[577,617],"content":"Best Practices: Data Contract Versioning","linkify":"Best Practices: Data Contract Versioning","nodes":[{"content":"Best Practices: Data Contract Versioning","pos":[0,40]}]},{"content":"This topic lists the best practices for creating data contracts that can evolve easily over time.","pos":[618,715]},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> data contracts, see the topics in <bpt id=\"p1\">[</bpt>Using Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/using-data-contracts.md)</ept>.","pos":[716,895],"source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] data contracts, see the topics in [Using Data Contracts](../../../docs/framework/wcf/feature-details/using-data-contracts.md)."},{"pos":[904,929],"content":"Note on Schema Validation","linkify":"Note on Schema Validation","nodes":[{"content":"Note on Schema Validation","pos":[0,25]}]},{"pos":[933,1198],"content":"In discussing data contract versioning, it is important to note that the data contract schema exported by <ph id=\"ph1\">[!INCLUDE[indigo1](../../../includes/indigo1-md.md)]</ph> does not have any versioning support, other than the fact that elements are marked as optional by default.","source":"In discussing data contract versioning, it is important to note that the data contract schema exported by [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] does not have any versioning support, other than the fact that elements are marked as optional by default."},{"content":"This means that even the most common versioning scenario, such as adding a new data member, cannot be implemented in a way that is seamless with regard to a given schema.","pos":[1205,1375]},{"content":"The newer versions of a data contract (with a new data member, for example) do not validate using the old schema.","pos":[1376,1489]},{"content":"However, there are many scenarios in which strict schema compliance is not required.","pos":[1496,1580]},{"content":"Many Web services platforms, including <ph id=\"ph1\">[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]</ph> and XML Web services created using ASP.NET, do not perform schema validation by default and therefore tolerate extra elements that are not described by the schema.","pos":[1581,1836],"source":" Many Web services platforms, including [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and XML Web services created using ASP.NET, do not perform schema validation by default and therefore tolerate extra elements that are not described by the schema."},{"content":"When working with such platforms, many versioning scenarios are easier to implement.","pos":[1837,1921]},{"content":"Thus, there are two sets of data contract versioning guidelines: one set for scenarios where strict schema validity is important, and another set for scenarios when it is not.","pos":[1928,2103]},{"pos":[2112,2157],"content":"Versioning When Schema Validation Is Required","linkify":"Versioning When Schema Validation Is Required","nodes":[{"content":"Versioning When Schema Validation Is Required","pos":[0,45]}]},{"content":"If strict schema validity is required in all directions (new-to-old and old-to-new), data contracts should be considered immutable.","pos":[2161,2292]},{"content":"If versioning is required, a new data contract should be created, with a different name or namespace, and the service contract using the data type should be versioned accordingly.","pos":[2293,2472]},{"content":"For example, a purchase order processing service contract named <ph id=\"ph1\">`PoProcessing`</ph> with a <ph id=\"ph2\">`PostPurchaseOrder`</ph> operation takes a parameter that conforms to a <ph id=\"ph3\">`PurchaseOrder`</ph> data contract.","pos":[2479,2662],"source":"For example, a purchase order processing service contract named `PoProcessing` with a `PostPurchaseOrder` operation takes a parameter that conforms to a `PurchaseOrder` data contract."},{"content":"If the <ph id=\"ph1\">`PurchaseOrder`</ph> contract has to change, you must create a new data contract, that is, <ph id=\"ph2\">`PurchaseOrder2`</ph>, which includes the changes.","pos":[2663,2801],"source":" If the `PurchaseOrder` contract has to change, you must create a new data contract, that is, `PurchaseOrder2`, which includes the changes."},{"content":"You must then handle the versioning at the service contract level.","pos":[2802,2868]},{"content":"For example, by creating a <ph id=\"ph1\">`PostPurchaseOrder2`</ph> operation that takes the <ph id=\"ph2\">`PurchaseOrder2`</ph> parameter, or by creating a <ph id=\"ph3\">`PoProcessing2`</ph> service contract where the <ph id=\"ph4\">`PostPurchaseOrder`</ph> operation takes a <ph id=\"ph5\">`PurchaseOrder2`</ph> data contract.","pos":[2869,3099],"source":" For example, by creating a `PostPurchaseOrder2` operation that takes the `PurchaseOrder2` parameter, or by creating a `PoProcessing2` service contract where the `PostPurchaseOrder` operation takes a `PurchaseOrder2` data contract."},{"content":"Note that changes in data contracts that are referenced by other data contracts also extend to the service model layer.","pos":[3106,3225]},{"content":"For example, in the previous scenario the <ph id=\"ph1\">`PurchaseOrder`</ph> data contract does not need to change.","pos":[3226,3322],"source":" For example, in the previous scenario the `PurchaseOrder` data contract does not need to change."},{"content":"However, it contains a data member of a <ph id=\"ph1\">`Customer`</ph> data contract, which in turn contained a data member of the <ph id=\"ph2\">`Address`</ph> data contract, which does need to be changed.","pos":[3323,3489],"source":" However, it contains a data member of a `Customer` data contract, which in turn contained a data member of the `Address` data contract, which does need to be changed."},{"content":"In that case, you would need to create an <ph id=\"ph1\">`Address2`</ph> data contract with the required changes, a <ph id=\"ph2\">`Customer2`</ph> data contract that contains the <ph id=\"ph3\">`Address2`</ph> data member, and a <ph id=\"ph4\">`PurchaseOrder2`</ph> data contract that contains a <ph id=\"ph5\">`Customer2`</ph> data member.","pos":[3490,3731],"source":" In that case, you would need to create an `Address2` data contract with the required changes, a `Customer2` data contract that contains the `Address2` data member, and a `PurchaseOrder2` data contract that contains a `Customer2` data member."},{"content":"As in the previous case, the service contract would have to be versioned as well.","pos":[3732,3813]},{"content":"Although in these examples names are changed (by appending a \"2\"), the recommendation is to change namespaces instead of names by appending new namespaces with a version number or a date.","pos":[3820,4007]},{"content":"For example, the <ph id=\"ph1\">`http://schemas.contoso.com/2005/05/21/PurchaseOrder`</ph> data contract would change to the <ph id=\"ph2\">`http://schemas.contoso.com/2005/10/14/PurchaseOrder`</ph> data contract.","pos":[4008,4181],"source":" For example, the `http://schemas.contoso.com/2005/05/21/PurchaseOrder` data contract would change to the `http://schemas.contoso.com/2005/10/14/PurchaseOrder` data contract."},{"pos":[4245,4333],"content":"Best Practices: <bpt id=\"p1\">[</bpt>Service Versioning<ept id=\"p1\">](../../../docs/framework/wcf/service-versioning.md)</ept>.","source":" Best Practices: [Service Versioning](../../../docs/framework/wcf/service-versioning.md)."},{"content":"Occasionally, you must guarantee strict schema compliance for messages sent by your application, but cannot rely on the incoming messages to be strictly schema-compliant.","pos":[4340,4510]},{"content":"In this case, there is a danger that an incoming message might contain extraneous data.","pos":[4511,4598]},{"content":"The extraneous values are stored and returned by <ph id=\"ph1\">[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]</ph> and thus results in schema-invalid messages being sent.","pos":[4599,4756],"source":" The extraneous values are stored and returned by [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and thus results in schema-invalid messages being sent."},{"content":"To avoid this problem, the round-tripping feature should be turned off.","pos":[4757,4828]},{"content":"There are two ways to do this.","pos":[4829,4859]},{"content":"Do not implement the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.IExtensibleDataObject&gt;</ph> interface on any of your types.","pos":[4869,4979],"source":"Do not implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface on any of your types."},{"pos":[4989,5197],"content":"Apply a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute&gt;</ph> attribute to your service contract with the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A&gt;</ph> property set to <ph id=\"ph3\">`true`</ph>.","source":"Apply a <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute to your service contract with the <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> property set to `true`."},{"pos":[5257,5395],"content":"round-tripping, see <bpt id=\"p1\">[</bpt>Forward-Compatible Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)</ept>.","source":" round-tripping, see [Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)."},{"pos":[5404,5453],"content":"Versioning When Schema Validation Is Not Required","linkify":"Versioning When Schema Validation Is Not Required","nodes":[{"content":"Versioning When Schema Validation Is Not Required","pos":[0,49]}]},{"content":"Strict schema compliance is rarely required.","pos":[5457,5501]},{"content":"Many platforms tolerate extra elements not described by a schema.","pos":[5502,5567]},{"content":"As long as this is tolerated, the full set of features described in <bpt id=\"p1\">[</bpt>Data Contract Versioning<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/data-contract-versioning.md)</ept> and <bpt id=\"p2\">[</bpt>Forward-Compatible Data Contracts<ept id=\"p2\">](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)</ept> can be used.","pos":[5568,5870],"source":" As long as this is tolerated, the full set of features described in [Data Contract Versioning](../../../docs/framework/wcf/feature-details/data-contract-versioning.md) and [Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md) can be used."},{"content":"The following guidelines are recommended.","pos":[5871,5912]},{"content":"Some of the guidelines must be followed exactly in order to send new versions of a type where an older one is expected or send an old one where the new one is expected.","pos":[5919,6087]},{"content":"Other guidelines are not strictly required, but are listed here because they may be affected by the future of schema versioning.","pos":[6088,6216]},{"content":"Do not attempt to version data contracts by type inheritance.","pos":[6226,6287]},{"content":"To create later versions, either change the data contract on an existing type or create a new unrelated type.","pos":[6288,6397]},{"content":"The use of inheritance together with data contracts is allowed, provided that inheritance is not used as a versioning mechanism and that certain rules are followed.","pos":[6407,6571]},{"content":"If a type derives from a certain base type, do not make it derive from a different base type in a future version (unless it has the same data contract).","pos":[6572,6724]},{"content":"There is one exception to this: you can insert a type into the hierarchy between a data contract type and its base type, but only if it does not contain data members with the same names as other members in any possible versions of the other types in the hierarchy.","pos":[6725,6989]},{"content":"In general, using data members with the same names at different levels of the same inheritance hierarchy can lead to serious versioning problems and should be avoided.","pos":[6990,7157]},{"content":"Starting with the first version of a data contract, always implement <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.IExtensibleDataObject&gt;</ph> to enable round-tripping.","pos":[7167,7319],"source":"Starting with the first version of a data contract, always implement <xref:System.Runtime.Serialization.IExtensibleDataObject> to enable round-tripping."},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Forward-Compatible Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)</ept>.","pos":[7320,7494],"source":"[!INCLUDE[crdefault](../../../includes/crdefault-md.md)][Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)."},{"content":"If you have released one or more versions of a type without implementing this interface, implement it in the next version of the type.","pos":[7495,7629]},{"content":"In later versions, do not change the data contract name or namespace.","pos":[7639,7708]},{"content":"If changing the name or namespace of the type underlying the data contract, be sure to preserve the data contract name and namespace by using the appropriate mechanisms, such as the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractAttribute.Name%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.DataContractAttribute&gt;</ph>.","pos":[7709,8031],"source":" If changing the name or namespace of the type underlying the data contract, be sure to preserve the data contract name and namespace by using the appropriate mechanisms, such as the <xref:System.Runtime.Serialization.DataContractAttribute.Name%2A> property of the <xref:System.Runtime.Serialization.DataContractAttribute>."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> naming, see <bpt id=\"p1\">[</bpt>Data Contract Names<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/data-contract-names.md)</ept>.","pos":[8032,8187],"source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] naming, see [Data Contract Names](../../../docs/framework/wcf/feature-details/data-contract-names.md)."},{"content":"In later versions, do not change the names of any data members.","pos":[8197,8260]},{"content":"If changing the name of the field, property, or event underlying the data member, use the <ph id=\"ph1\">`Name`</ph> property of the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute&gt;</ph> to preserve the existing data member name.","pos":[8261,8472],"source":" If changing the name of the field, property, or event underlying the data member, use the `Name` property of the <xref:System.Runtime.Serialization.DataMemberAttribute> to preserve the existing data member name."},{"content":"In later versions, do not change the type of any field, property, or event underlying a data member such that the resulting data contract for that data member changes.","pos":[8482,8649]},{"content":"Keep in mind that interface types are equivalent to <ph id=\"ph1\">&lt;xref:System.Object&gt;</ph> for the purposes of determining the expected data contract.","pos":[8650,8782],"source":" Keep in mind that interface types are equivalent to <xref:System.Object> for the purposes of determining the expected data contract."},{"content":"In later versions, do not change the order of the existing data members by adjusting the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute&gt;</ph> attribute.","pos":[8792,9028],"source":"In later versions, do not change the order of the existing data members by adjusting the <xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A> property of the <xref:System.Runtime.Serialization.DataMemberAttribute> attribute."},{"content":"In later versions, new data members can be added.","pos":[9038,9087]},{"content":"They should always follow these rules:","pos":[9088,9126]},{"pos":[9140,9277],"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A&gt;</ph> property should always be left at its default value of <ph id=\"ph2\">`false`</ph>.","source":"The <xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A> property should always be left at its default value of `false`."},{"content":"If a default value of <ph id=\"ph1\">`null`</ph> or zero for the member is unacceptable, a callback method should be provided using the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.OnDeserializingAttribute&gt;</ph> to provide a reasonable default in case the member is not present in the incoming stream.","pos":[9291,9557],"source":"If a default value of `null` or zero for the member is unacceptable, a callback method should be provided using the <xref:System.Runtime.Serialization.OnDeserializingAttribute> to provide a reasonable default in case the member is not present in the incoming stream."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> the callback, see <bpt id=\"p1\">[</bpt>Version-Tolerant Serialization Callbacks<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md)</ept>.","pos":[9558,9761],"source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] the callback, see [Version-Tolerant Serialization Callbacks](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md)."},{"content":"The <ph id=\"ph1\">`Order`</ph> property on the <ph id=\"ph2\">`DataMemberAttribute`</ph> should be used to make sure that all of the newly added data members appear after the existing data members.","pos":[9775,9933],"source":"The `Order` property on the `DataMemberAttribute` should be used to make sure that all of the newly added data members appear after the existing data members."},{"content":"The recommended way of doing this is as follows: None of the data members in the first version of the data contract should have their <ph id=\"ph1\">`Order`</ph> property set.","pos":[9934,10089],"source":" The recommended way of doing this is as follows: None of the data members in the first version of the data contract should have their `Order` property set."},{"content":"All of the data members added in version 2 of the data contract should have their <ph id=\"ph1\">`Order`</ph> property set to 2.","pos":[10090,10198],"source":" All of the data members added in version 2 of the data contract should have their `Order` property set to 2."},{"content":"All of the data members added in version 3 of the data contract should have their <ph id=\"ph1\">`Order`</ph> set to 3, and so on.","pos":[10199,10309],"source":" All of the data members added in version 3 of the data contract should have their `Order` set to 3, and so on."},{"content":"It is permissible to have more than one data member set to the same <ph id=\"ph1\">`Order`</ph> number.","pos":[10310,10393],"source":" It is permissible to have more than one data member set to the same `Order` number."},{"pos":[10402,10601],"content":"Do not remove data members in later versions, even if the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A&gt;</ph> property was left at its default property of <ph id=\"ph2\">`false`</ph> in prior versions.","source":"Do not remove data members in later versions, even if the <xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A> property was left at its default property of `false` in prior versions."},{"pos":[10611,10704],"content":"Do not change the <ph id=\"ph1\">`IsRequired`</ph> property on any existing data members from version to version.","source":"Do not change the `IsRequired` property on any existing data members from version to version."},{"pos":[10714,10842],"content":"For required data members (where <ph id=\"ph1\">`IsRequired`</ph> is <ph id=\"ph2\">`true`</ph>), do not change the <ph id=\"ph3\">`EmitDefaultValue`</ph> property from version to version.","source":"For required data members (where `IsRequired` is `true`), do not change the `EmitDefaultValue` property from version to version."},{"content":"Do not attempt to create branched versioning hierarchies.","pos":[10852,10909]},{"content":"That is, there should always be a path in at least one direction from any version to any other version using only the changes permitted by these guidelines.","pos":[10910,11066]},{"content":"For example, if version 1 of a Person data contract contains only the Name data member, you should not create version 2a of the contract adding only the Age member and version 2b adding only the Address member.","pos":[11077,11287]},{"content":"Going from 2a to 2b would involve removing Age and adding Address; going in the other direction would entail removing Address and adding Age.","pos":[11288,11429]},{"content":"Removing members is not permitted by these guidelines.","pos":[11430,11484]},{"content":"You should generally not create new subtypes of existing data contract types in a new version of your application.","pos":[11494,11608]},{"content":"Likewise, you should not create new data contracts that are used in place of data members declared as Object or as interface types.","pos":[11609,11740]},{"content":"Creating these new classes is allowed only when you know that you can add the new types to the known types list of all instances of your old application.","pos":[11741,11894]},{"content":"For example, in version 1 of your application, you may have the LibraryItem data contract type with the Book and Newspaper data contract subtypes.","pos":[11895,12041]},{"content":"LibraryItem would then have a known types list that contains Book and Newspaper.","pos":[12042,12122]},{"content":"Suppose you now add a Magazine type in version 2 which is a subtype of LibraryItem.","pos":[12123,12206]},{"content":"If you send a Magazine instance from version 2 to version 1, the Magazine data contract is not found in the list of known types and an exception is thrown.","pos":[12207,12362]},{"content":"You should not add or remove enumeration members between versions.","pos":[12372,12438]},{"content":"You should also not rename enumeration members, unless you use the Name property on the <ph id=\"ph1\">`EnumMemberAttribute`</ph> attribute to keep their names in the data contract model the same.","pos":[12439,12615],"source":" You should also not rename enumeration members, unless you use the Name property on the `EnumMemberAttribute` attribute to keep their names in the data contract model the same."},{"content":"Collections are interchangeable in the data contract model as described in <bpt id=\"p1\">[</bpt>Collection Types in Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/collection-types-in-data-contracts.md)</ept>.","pos":[12625,12820],"source":"Collections are interchangeable in the data contract model as described in [Collection Types in Data Contracts](../../../docs/framework/wcf/feature-details/collection-types-in-data-contracts.md)."},{"content":"This allows for a great degree of flexibility.","pos":[12821,12867]},{"content":"However, make sure that you do not inadvertently change a collection type in a non-interchangeable way from version to version.","pos":[12868,12995]},{"content":"For example, do not change from a non-customized collection (that is, without the <ph id=\"ph1\">`CollectionDataContractAttribute`</ph> attribute) to a customized one or a customized collection to a non-customized one.","pos":[12996,13194],"source":" For example, do not change from a non-customized collection (that is, without the `CollectionDataContractAttribute` attribute) to a customized one or a customized collection to a non-customized one."},{"content":"Also, do not change the properties on the <ph id=\"ph1\">`CollectionDataContractAttribute`</ph> from version to version.","pos":[13195,13295],"source":" Also, do not change the properties on the `CollectionDataContractAttribute` from version to version."},{"content":"The only allowed change is adding a Name or Namespace property if the underlying collection type's name or namespace has changed and you need to make its data contract name and namespace the same as in a previous version.","pos":[13296,13517]},{"content":"Some of the guidelines listed here can be safely ignored when special circumstances apply.","pos":[13524,13614]},{"content":"Make sure you fully understand the serialization, deserialization, and schema mechanisms involved before deviating from the guidelines.","pos":[13615,13750]},{"pos":[13759,13767],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractAttribute.Name%2A&gt;</ph>","pos":[13771,13836],"source":"<xref:System.Runtime.Serialization.DataContractAttribute.Name%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractAttribute&gt;</ph>","pos":[13841,13898],"source":"<xref:System.Runtime.Serialization.DataContractAttribute> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A&gt;</ph>","pos":[13903,13967],"source":"<xref:System.Runtime.Serialization.DataMemberAttribute.Order%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A&gt;</ph>","pos":[13972,14041],"source":"<xref:System.Runtime.Serialization.DataMemberAttribute.IsRequired%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.IExtensibleDataObject&gt;</ph>","pos":[14046,14103],"source":"<xref:System.Runtime.Serialization.IExtensibleDataObject> "},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute&gt;</ph>","pos":[14108,14159],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A&gt;</ph>","pos":[14164,14238],"source":"<xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.ExtensionDataObject&gt;</ph>","pos":[14243,14298],"source":"<xref:System.Runtime.Serialization.ExtensionDataObject> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.OnDeserializingAttribute&gt;</ph>","pos":[14303,14363],"source":"<xref:System.Runtime.Serialization.OnDeserializingAttribute> "},{"content":"<bpt id=\"p1\">[</bpt>Using Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/using-data-contracts.md)</ept><ph id=\"ph1\"> </ph>","pos":[14368,14460],"source":"[Using Data Contracts](../../../docs/framework/wcf/feature-details/using-data-contracts.md) "},{"content":"<bpt id=\"p1\">[</bpt>Data Contract Versioning<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/data-contract-versioning.md)</ept><ph id=\"ph1\"> </ph>","pos":[14464,14564],"source":"[Data Contract Versioning](../../../docs/framework/wcf/feature-details/data-contract-versioning.md) "},{"content":"<bpt id=\"p1\">[</bpt>Data Contract Names<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/data-contract-names.md)</ept><ph id=\"ph1\"> </ph>","pos":[14568,14658],"source":"[Data Contract Names](../../../docs/framework/wcf/feature-details/data-contract-names.md) "},{"content":"<bpt id=\"p1\">[</bpt>Forward-Compatible Data Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md)</ept><ph id=\"ph1\"> </ph>","pos":[14662,14780],"source":"[Forward-Compatible Data Contracts](../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md) "},{"content":"<bpt id=\"p1\">[</bpt>Version-Tolerant Serialization Callbacks<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md)</ept>","pos":[14784,14915],"source":"[Version-Tolerant Serialization Callbacks](../../../docs/framework/wcf/feature-details/version-tolerant-serialization-callbacks.md)"}]}