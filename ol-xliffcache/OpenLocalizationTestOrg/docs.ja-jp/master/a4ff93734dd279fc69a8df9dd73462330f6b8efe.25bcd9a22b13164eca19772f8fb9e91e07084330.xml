{"content":"---\ntitle: \"GROUP BY (Entity SQL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\nms.assetid: cf4f4972-4724-4945-ba44-943a08549139\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# GROUP BY (Entity SQL)\nSpecifies groups into which objects returned by a query ([SELECT](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md)) expression are to be placed.  \n  \n## Syntax  \n  \n```  \n  \n[ GROUP BY aliasedExpression [ ,...n ] ]  \n```  \n  \n## Arguments  \n `aliasedExpression`  \n Any valid query expression on which grouping is performed. `expression` can be a property or a non-aggregate expression that references a property returned by the FROM clause. Each expression in a GROUP BY clause must evaluate to a type that can be compared for equality. These types are generally scalar primitives such as numbers, strings, and dates. You cannot group by a collection.  \n  \n## Remarks  \n If aggregate functions are included in the SELECT clause \\<select list>, GROUP BY calculates a summary value for each group. When GROUP BY is specified, either each property name in any nonaggregate expression in the select list should be included in the GROUP BY list, or the GROUP BY expression must exactly match the select list expression.  \n  \n> [!NOTE]\n>  If the ORDER BY clause is not specified, groups returned by the GROUP BY clause are not in any particular order. To specify a particular ordering of the data, we recommend that you always use the ORDER BY clause.  \n  \n When a GROUP BY clause is specified, either explicitly or implicitly (for example, by a HAVING clause in the query), the current scope is hidden, and a new scope is introduced.  \n  \n The SELECT clause, the HAVING clause, and the ORDER BY clause will no longer be able to refer to element names specified in the FROM clause. You can only refer to the grouping expressions themselves. To do this, you can assign new names (aliases) to each grouping expression. If no alias is specified for a grouping expression, [!INCLUDE[esql](../../../../../../includes/esql-md.md)] tries to generate one by using the alias generation rules, as illustrated in the following example.  \n  \n `SELECT g1, g2, ...gn FROM c as c1`  \n  \n `GROUP BY e1 as g1, e2 as g2, ...en as gn`  \n  \n Expressions in the GROUP BY clause cannot refer to names defined earlier in the same GROUP BY clause.  \n  \n In addition to grouping names, you can also specify aggregates in the SELECT clause, HAVING clause, and the ORDER BY clause. An aggregate contains an expression that is evaluated for each element of the group. The aggregate operator reduces the values of all these expressions (usually, but not always, into a single value). The aggregate expression can make references to the original element names visible in the parent scope, or to any of the new names introduced by the GROUP BY clause itself. Although the aggregates appear in the SELECT clause, HAVING clause, and ORDER BY clause, they are actually evaluated under the same scope as the grouping expressions, as illustrated in the following example.  \n  \n `SELECT name, sum(o.Price * o.Quantity) as total`  \n  \n `FROM orderLines as o`  \n  \n `GROUP BY o.Product as name`  \n  \n This query uses the GROUP BY clause to produce a report of the cost of all products ordered, broken down by product. It gives the name `name` to the product as part of the grouping expression, and then references that name in the SELECT list. It also specifies the aggregate `sum` in the SELECT list that internally references the price and quantity of the order line.  \n  \n Each GROUP By key expression must have at least one reference to the input scope:  \n  \n```  \nSELECT FROM Persons as P  \nGROUP BY Q + P   -- GOOD  \nGROUP BY Q   -- BAD  \nGROUP BY 1   -- BAD, a constant is not allowed  \n```  \n  \n For an example of using GROUP BY, see [HAVING](../../../../../../docs/framework/data/adonet/ef/language-reference/having-entity-sql.md).  \n  \n## Example  \n The following Entity SQL query uses the GROUP BY operator to specify groups into which objects are returned by a query. The query is based on the AdventureWorks Sales Model. To compile and run this query, follow these steps:  \n  \n1.  Follow the procedure in [How to: Execute a Query that Returns PrimitiveType Results](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md).  \n  \n2.  Pass the following query as an argument to the `ExecutePrimitiveTypeQuery` method:  \n  \n [!code-csharp[DP EntityServices Concepts 2#GROUPBY](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts 2/cs/entitysql.cs#groupby)]  \n  \n## See Also  \n [Entity SQL Reference](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md)   \n [Query Expressions](../../../../../../docs/framework/data/adonet/ef/language-reference/query-expressions-entity-sql.md)","nodes":[{"pos":[4,396],"embed":true,"restype":"x-metadata","content":"title: \"GROUP BY (Entity SQL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\nms.assetid: cf4f4972-4724-4945-ba44-943a08549139\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"GROUP BY (Entity SQL) | Microsoft Docs","nodes":[{"pos":[0,38],"content":"GROUP BY (Entity SQL) | Microsoft Docs","nodes":[{"content":"GROUP BY (Entity SQL) | Microsoft Docs","pos":[0,38]}]}],"path":["title"]}],"yml":true},{"pos":[403,424],"content":"GROUP BY (Entity SQL)","linkify":"GROUP BY (Entity SQL)","nodes":[{"content":"GROUP BY (Entity SQL)","pos":[0,21]}]},{"pos":[425,609],"content":"Specifies groups into which objects returned by a query (<bpt id=\"p1\">[</bpt>SELECT<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md)</ept>) expression are to be placed.","source":"Specifies groups into which objects returned by a query ([SELECT](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md)) expression are to be placed."},{"pos":[618,624],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[694,703],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"Any valid query expression on which grouping is performed.","pos":[730,788]},{"content":"<ph id=\"ph1\">`expression`</ph> can be a property or a non-aggregate expression that references a property returned by the FROM clause.","pos":[789,905],"source":"`expression` can be a property or a non-aggregate expression that references a property returned by the FROM clause."},{"content":"Each expression in a GROUP BY clause must evaluate to a type that can be compared for equality.","pos":[906,1001]},{"content":"These types are generally scalar primitives such as numbers, strings, and dates.","pos":[1002,1082]},{"content":"You cannot group by a collection.","pos":[1083,1116]},{"pos":[1125,1132],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If aggregate functions are included in the SELECT clause <ph id=\"ph1\">\\&lt;</ph>select list&gt;, GROUP BY calculates a summary value for each group.","pos":[1136,1260],"source":"If aggregate functions are included in the SELECT clause \\<select list>, GROUP BY calculates a summary value for each group."},{"content":"When GROUP BY is specified, either each property name in any nonaggregate expression in the select list should be included in the GROUP BY list, or the GROUP BY expression must exactly match the select list expression.","pos":[1261,1479]},{"pos":[1487,1710],"content":"[!NOTE]\n If the ORDER BY clause is not specified, groups returned by the GROUP BY clause are not in any particular order. To specify a particular ordering of the data, we recommend that you always use the ORDER BY clause.","leadings":["","> "],"nodes":[{"content":"If the ORDER BY clause is not specified, groups returned by the GROUP BY clause are not in any particular order. To specify a particular ordering of the data, we recommend that you always use the ORDER BY clause.","pos":[9,221],"nodes":[{"content":"If the ORDER BY clause is not specified, groups returned by the GROUP BY clause are not in any particular order.","pos":[0,112]},{"content":"To specify a particular ordering of the data, we recommend that you always use the ORDER BY clause.","pos":[113,212]}]}]},{"content":"When a GROUP BY clause is specified, either explicitly or implicitly (for example, by a HAVING clause in the query), the current scope is hidden, and a new scope is introduced.","pos":[1717,1893]},{"content":"The SELECT clause, the HAVING clause, and the ORDER BY clause will no longer be able to refer to element names specified in the FROM clause.","pos":[1900,2040]},{"content":"You can only refer to the grouping expressions themselves.","pos":[2041,2099]},{"content":"To do this, you can assign new names (aliases) to each grouping expression.","pos":[2100,2175]},{"content":"If no alias is specified for a grouping expression, <ph id=\"ph1\">[!INCLUDE[esql](../../../../../../includes/esql-md.md)]</ph> tries to generate one by using the alias generation rules, as illustrated in the following example.","pos":[2176,2383],"source":" If no alias is specified for a grouping expression, [!INCLUDE[esql](../../../../../../includes/esql-md.md)] tries to generate one by using the alias generation rules, as illustrated in the following example."},{"content":"Expressions in the GROUP BY clause cannot refer to names defined earlier in the same GROUP BY clause.","pos":[2481,2582]},{"content":"In addition to grouping names, you can also specify aggregates in the SELECT clause, HAVING clause, and the ORDER BY clause.","pos":[2589,2713]},{"content":"An aggregate contains an expression that is evaluated for each element of the group.","pos":[2714,2798]},{"content":"The aggregate operator reduces the values of all these expressions (usually, but not always, into a single value).","pos":[2799,2913]},{"content":"The aggregate expression can make references to the original element names visible in the parent scope, or to any of the new names introduced by the GROUP BY clause itself.","pos":[2914,3086]},{"content":"Although the aggregates appear in the SELECT clause, HAVING clause, and ORDER BY clause, they are actually evaluated under the same scope as the grouping expressions, as illustrated in the following example.","pos":[3087,3294]},{"content":"This query uses the GROUP BY clause to produce a report of the cost of all products ordered, broken down by product.","pos":[3421,3537]},{"content":"It gives the name <ph id=\"ph1\">`name`</ph> to the product as part of the grouping expression, and then references that name in the SELECT list.","pos":[3538,3663],"source":" It gives the name `name` to the product as part of the grouping expression, and then references that name in the SELECT list."},{"content":"It also specifies the aggregate <ph id=\"ph1\">`sum`</ph> in the SELECT list that internally references the price and quantity of the order line.","pos":[3664,3789],"source":" It also specifies the aggregate `sum` in the SELECT list that internally references the price and quantity of the order line."},{"content":"Each GROUP By key expression must have at least one reference to the input scope:","pos":[3796,3877]},{"pos":[4024,4160],"content":"For an example of using GROUP BY, see <bpt id=\"p1\">[</bpt>HAVING<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/having-entity-sql.md)</ept>.","source":"For an example of using GROUP BY, see [HAVING](../../../../../../docs/framework/data/adonet/ef/language-reference/having-entity-sql.md)."},{"pos":[4169,4176],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following Entity SQL query uses the GROUP BY operator to specify groups into which objects are returned by a query.","pos":[4180,4299]},{"content":"The query is based on the AdventureWorks Sales Model.","pos":[4300,4353]},{"content":"To compile and run this query, follow these steps:","pos":[4354,4404]},{"pos":[4414,4609],"content":"Follow the procedure in <bpt id=\"p1\">[</bpt>How to: Execute a Query that Returns PrimitiveType Results<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md)</ept>.","source":"Follow the procedure in [How to: Execute a Query that Returns PrimitiveType Results](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md)."},{"pos":[4619,4701],"content":"Pass the following query as an argument to the <ph id=\"ph1\">`ExecutePrimitiveTypeQuery`</ph> method:","source":"Pass the following query as an argument to the `ExecutePrimitiveTypeQuery` method:"},{"pos":[4882,4890],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Entity SQL Reference<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md)</ept><ph id=\"ph1\"> </ph>","pos":[4894,5009],"source":"[Entity SQL Reference](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md) "},{"content":"<bpt id=\"p1\">[</bpt>Query Expressions<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/query-expressions-entity-sql.md)</ept>","pos":[5013,5132],"source":"[Query Expressions](../../../../../../docs/framework/data/adonet/ef/language-reference/query-expressions-entity-sql.md)"}]}