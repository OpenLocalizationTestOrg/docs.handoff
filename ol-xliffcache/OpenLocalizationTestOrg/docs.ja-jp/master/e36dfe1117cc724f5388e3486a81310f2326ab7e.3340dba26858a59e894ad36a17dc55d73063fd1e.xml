{"content":"---\ntitle: \"Example COM Class - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"examples [C#], COM classes\"\n  - \"COM, exposing Visual C# objects to\"\nms.assetid: 6504dea9-ad1c-4993-a794-830fec5270af\n---\n# Example COM Class (C# Programming Guide)\nThe following is an example of a class that you would expose as a COM object. After this code has been placed in a .cs file and added to your project, set the **Register for COM Interop** property to **True**. For more information, see [How to: Register a Component for COM Interop](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w29wacsy(v=vs.100)).\n  \n Exposing Visual C# objects to COM requires declaring a class interface, an events interface if it is required, and the class itself. Class members must follow these rules to be visible to COM:  \n  \n-   The class must be public.  \n  \n-   Properties, methods, and events must be public.  \n  \n-   Properties and methods must be declared on the class interface.  \n  \n-   Events must be declared in the event interface.  \n  \n Other public members in the class that are not declared in these interfaces will not be visible to COM, but they will be visible to other .NET Framework objects.  \n  \n To expose properties and methods to COM, you must declare them on the class interface and mark them with a `DispId` attribute, and implement them in the class. The order in which the members are declared in the interface is the order used for the COM vtable.  \n  \n To expose events from your class, you must declare them on the events interface and mark them with a `DispId` attribute. The class should not implement this interface.  \n  \n The class implements the class interface; it can implement more than one interface, but the first implementation will be the default class interface. Implement the methods and properties exposed to COM here. They must be marked public and must match the declarations in the class interface. Also, declare the events raised by the class here. They must be marked public and must match the declarations in the events interface.  \n  \n## Example  \n [!code-csharp[csProgGuideInterop#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideInterop/CS/ExampleCOM.cs#8)]  \n  \n## See also\n\n- [C# Programming Guide](../../../csharp/programming-guide/index.md)\n- [Interoperability](../../../csharp/programming-guide/interop/index.md)\n- [Build Page, Project Designer (C#)](/visualstudio/ide/reference/build-page-project-designer-csharp)\n","nodes":[{"pos":[4,238],"embed":true,"restype":"x-metadata","content":"title: \"Example COM Class - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"examples [C#], COM classes\"\n  - \"COM, exposing Visual C# objects to\"\nms.assetid: 6504dea9-ad1c-4993-a794-830fec5270af","nodes":[{"content":"Example COM Class - C# Programming Guide","nodes":[{"pos":[0,40],"content":"Example COM Class - C# Programming Guide","nodes":[{"content":"Example COM Class - C# Programming Guide","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[245,285],"content":"Example COM Class (C# Programming Guide)","linkify":"Example COM Class (C# Programming Guide)","nodes":[{"content":"Example COM Class (C# Programming Guide)","pos":[0,40]}]},{"content":"The following is an example of a class that you would expose as a COM object.","pos":[286,363]},{"content":"After this code has been placed in a .cs file and added to your project, set the <bpt id=\"p1\">**</bpt>Register for COM Interop<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>True<ept id=\"p2\">**</ept>.","pos":[364,495],"source":" After this code has been placed in a .cs file and added to your project, set the **Register for COM Interop** property to **True**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Register a Component for COM Interop<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w29wacsy(v=vs.100))</ept>.","pos":[496,666],"source":" For more information, see [How to: Register a Component for COM Interop](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w29wacsy(v=vs.100))."},{"content":"Exposing Visual C# objects to COM requires declaring a class interface, an events interface if it is required, and the class itself.","pos":[671,803]},{"content":"Class members must follow these rules to be visible to COM:","pos":[804,863]},{"content":"The class must be public.","pos":[873,898]},{"content":"Properties, methods, and events must be public.","pos":[908,955]},{"content":"Properties and methods must be declared on the class interface.","pos":[965,1028]},{"content":"Events must be declared in the event interface.","pos":[1038,1085]},{"content":"Other public members in the class that are not declared in these interfaces will not be visible to COM, but they will be visible to other .NET Framework objects.","pos":[1092,1253]},{"content":"To expose properties and methods to COM, you must declare them on the class interface and mark them with a <ph id=\"ph1\">`DispId`</ph> attribute, and implement them in the class.","pos":[1260,1419],"source":"To expose properties and methods to COM, you must declare them on the class interface and mark them with a `DispId` attribute, and implement them in the class."},{"content":"The order in which the members are declared in the interface is the order used for the COM vtable.","pos":[1420,1518]},{"content":"To expose events from your class, you must declare them on the events interface and mark them with a <ph id=\"ph1\">`DispId`</ph> attribute.","pos":[1525,1645],"source":"To expose events from your class, you must declare them on the events interface and mark them with a `DispId` attribute."},{"content":"The class should not implement this interface.","pos":[1646,1692]},{"content":"The class implements the class interface; it can implement more than one interface, but the first implementation will be the default class interface.","pos":[1699,1848]},{"content":"Implement the methods and properties exposed to COM here.","pos":[1849,1906]},{"content":"They must be marked public and must match the declarations in the class interface.","pos":[1907,1989]},{"content":"Also, declare the events raised by the class here.","pos":[1990,2040]},{"content":"They must be marked public and must match the declarations in the events interface.","pos":[2041,2124]},{"pos":[2133,2140],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2275,2283],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2287,2353],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"},{"pos":[2356,2426],"content":"<bpt id=\"p1\">[</bpt>Interoperability<ept id=\"p1\">](../../../csharp/programming-guide/interop/index.md)</ept>","source":"[Interoperability](../../../csharp/programming-guide/interop/index.md)"},{"pos":[2429,2528],"content":"<bpt id=\"p1\">[</bpt>Build Page, Project Designer (C#)<ept id=\"p1\">](/visualstudio/ide/reference/build-page-project-designer-csharp)</ept>","source":"[Build Page, Project Designer (C#)](/visualstudio/ide/reference/build-page-project-designer-csharp)"}]}