{"content":"---\ntitle: \"How to: Convert Numeric User Input in Web Controls to Numbers\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"numeric format strings [.NET Framework]\"\n  - \"formatting [.NET Framework], numbers\"\n  - \"number formatting [.NET Framework]\"\n  - \"parsing strings [.NET Framework], numeric strings\"\n  - \"converting numeric user input to number\"\n  - \"numbers [.NET Framework], converting numeric user input to number\"\nms.assetid: f27ddfb8-7479-4b79-8879-02a3bd8402d4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Convert Numeric User Input in Web Controls to Numbers\nBecause a Web page can be displayed anywhere in the world, users can input numeric data into a <xref:System.Web.UI.WebControls.TextBox> control in an almost unlimited number of formats. As a result, it is very important to determine the locale and culture of the Web page's user. When you parse user input, you can then apply the formatting conventions defined by the user's locale and culture.  \n  \n### To convert numeric input from a Web TextBox control to a number  \n  \n1.  Determine whether the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> property is populated. If it is not, continue to step 6.  \n  \n2.  If the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property is populated, retrieve its first element. The first element indicates the user's default or preferred language and region.  \n  \n3.  Instantiate a <xref:System.Globalization.CultureInfo> object that represents the user's preferred culture by calling the <xref:System.Globalization.CultureInfo.%23ctor%28System.String%2CSystem.Boolean%29?displayProperty=nameWithType> constructor.  \n  \n4.  Call either the `TryParse` or the `Parse` method of the numeric type that you want to convert the user's input to. Use an overload of the `TryParse` or the `Parse` method with a `provider` parameter, and pass it either of the following:  \n  \n    -   The <xref:System.Globalization.CultureInfo> object created in step 3.  \n  \n    -   The <xref:System.Globalization.NumberFormatInfo> object that is returned by the <xref:System.Globalization.CultureInfo.NumberFormat%2A> property of the <xref:System.Globalization.CultureInfo> object created in step 3.  \n  \n5.  If the conversion fails, repeat steps 2 through 4 for each remaining element in the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property.  \n  \n6.  If the conversion still fails or if the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property is empty, parse the string by using the invariant culture, which is returned by the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.  \n  \n## Example  \n The following example is the complete code-behind page for a Web form that asks the user to enter a numeric value in a <xref:System.Web.UI.WebControls.TextBox> control and converts it to a number. That number is then doubled and displayed by using the same formatting rules as the original input.  \n  \n [!code-csharp[Formatting.HowTo.ParseNumericInput#1](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.HowTo.ParseNumericInput/cs/NumericUserInput1.aspx.cs#1)]\n [!code-vb[Formatting.HowTo.ParseNumericInput#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.HowTo.ParseNumericInput/vb/NumericUserInput1.aspx.vb#1)]  \n  \n The <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> property is populated from the culture names that are contained in `Accept-Language` headers included in an HTTP request. However, not all browsers include `Accept-Language` headers in their requests, and users can also suppress the headers completely. This makes it important to have a fallback culture when parsing user input. Typically, the fallback culture is the invariant culture returned by <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>. Users can also provide Internet Explorer with culture names that they input in a text box, which creates the possibility that the culture names may not be valid. This makes it important to use exception handling when instantiating a <xref:System.Globalization.CultureInfo> object.  \n  \n When retrieved from an HTTP request submitted by Internet Explorer, the <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> array is populated in order of user preference. The first element in the array contains the name of the user's primary culture/region. If the array contains any additional items, Internet Explorer arbitrarily assigns them a quality specifier, which is delimited from the culture name by a semicolon. For example, an entry for the fr-FR culture might take the form `fr-FR;q=0.7`.  \n  \n The example calls the <xref:System.Globalization.CultureInfo.%23ctor%2A> constructor with its `useUserOverride` parameter set to `false` to create a new <xref:System.Globalization.CultureInfo> object. This ensures that, if the culture name is the default culture name on the server, the new <xref:System.Globalization.CultureInfo> object created by the class constructor contains a culture's default settings and does not reflect any settings overridden by using the server's **Regional and Language Options** application. The values from any overridden settings on the server are unlikely to exist on the user's system or to be reflected in the user's input.  \n  \n Your code can call either the `Parse` or the `TryParse` method of the numeric type that the user's input will be converted to. Repeated calls to a parse method may be required for a single parsing operation. As a result, the `TryParse` method is better, because it returns `false` if a parse operation fails. In contrast, handling the repeated exceptions that may be thrown by the `Parse` method can be a very expensive proposition in a Web application.  \n  \n## Compiling the Code  \n To compile the code, copy it into an [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] code-behind page so that it replaces all the existing code. The [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] Web page should contain the following controls:  \n  \n-   A <xref:System.Web.UI.WebControls.Label> control, which is not referenced in code. Set its <xref:System.Web.UI.WebControls.TextBox.Text%2A> property to \"Enter a Number:\".  \n  \n-   A <xref:System.Web.UI.WebControls.TextBox> control named `NumericString`.  \n  \n-   A <xref:System.Web.UI.WebControls.Button> control named `OKButton`. Set its <xref:System.Web.UI.WebControls.Button.Text%2A> property to \"OK\".  \n  \n Change the name of the class from `NumericUserInput` to the name of the class that is defined by the `Inherits` attribute of the [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] page's `Page` directive. Change the name of the `NumericInput` object reference to the name defined by the `id` attribute of the [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] page's `form` tag.  \n  \n## .NET Framework Security  \n To prevent a user from injecting script into the HTML stream, user input should never be directly echoed back in the server response. Instead, it should be encoded by using the <xref:System.Web.HttpServerUtility.HtmlEncode%2A?displayProperty=nameWithType> method.  \n  \n## See also\n\n- [Performing Formatting Operations](../../../docs/standard/base-types/performing-formatting-operations.md)\n- [Parsing Numeric Strings](../../../docs/standard/base-types/parsing-numeric.md)\n","nodes":[{"pos":[4,576],"embed":true,"restype":"x-metadata","content":"title: \"How to: Convert Numeric User Input in Web Controls to Numbers\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"numeric format strings [.NET Framework]\"\n  - \"formatting [.NET Framework], numbers\"\n  - \"number formatting [.NET Framework]\"\n  - \"parsing strings [.NET Framework], numeric strings\"\n  - \"converting numeric user input to number\"\n  - \"numbers [.NET Framework], converting numeric user input to number\"\nms.assetid: f27ddfb8-7479-4b79-8879-02a3bd8402d4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Convert Numeric User Input in Web Controls to Numbers","nodes":[{"pos":[0,61],"content":"How to: Convert Numeric User Input in Web Controls to Numbers","nodes":[{"content":"How to: Convert Numeric User Input in Web Controls to Numbers","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[583,644],"content":"How to: Convert Numeric User Input in Web Controls to Numbers","linkify":"How to: Convert Numeric User Input in Web Controls to Numbers","nodes":[{"content":"How to: Convert Numeric User Input in Web Controls to Numbers","pos":[0,61]}]},{"content":"Because a Web page can be displayed anywhere in the world, users can input numeric data into a <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.TextBox&gt;</ph> control in an almost unlimited number of formats.","pos":[645,830],"source":"Because a Web page can be displayed anywhere in the world, users can input numeric data into a <xref:System.Web.UI.WebControls.TextBox> control in an almost unlimited number of formats."},{"content":"As a result, it is very important to determine the locale and culture of the Web page's user.","pos":[831,924]},{"content":"When you parse user input, you can then apply the formatting conventions defined by the user's locale and culture.","pos":[925,1039]},{"pos":[1049,1112],"content":"To convert numeric input from a Web TextBox control to a number","linkify":"To convert numeric input from a Web TextBox control to a number","nodes":[{"content":"To convert numeric input from a Web TextBox control to a number","pos":[0,63]}]},{"content":"Determine whether the string array returned by the <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType&gt;</ph> property is populated.","pos":[1122,1271],"source":"Determine whether the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> property is populated."},{"content":"If it is not, continue to step 6.","pos":[1272,1305]},{"content":"If the string array returned by the <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A&gt;</ph> property is populated, retrieve its first element.","pos":[1315,1448],"source":"If the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property is populated, retrieve its first element."},{"content":"The first element indicates the user's default or preferred language and region.","pos":[1449,1529]},{"pos":[1539,1785],"content":"Instantiate a <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object that represents the user's preferred culture by calling the <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.%23ctor%28System.String%2CSystem.Boolean%29?displayProperty=nameWithType&gt;</ph> constructor.","source":"Instantiate a <xref:System.Globalization.CultureInfo> object that represents the user's preferred culture by calling the <xref:System.Globalization.CultureInfo.%23ctor%28System.String%2CSystem.Boolean%29?displayProperty=nameWithType> constructor."},{"content":"Call either the <ph id=\"ph1\">`TryParse`</ph> or the <ph id=\"ph2\">`Parse`</ph> method of the numeric type that you want to convert the user's input to.","pos":[1795,1909],"source":"Call either the `TryParse` or the `Parse` method of the numeric type that you want to convert the user's input to."},{"content":"Use an overload of the <ph id=\"ph1\">`TryParse`</ph> or the <ph id=\"ph2\">`Parse`</ph> method with a <ph id=\"ph3\">`provider`</ph> parameter, and pass it either of the following:","pos":[1910,2031],"source":" Use an overload of the `TryParse` or the `Parse` method with a `provider` parameter, and pass it either of the following:"},{"pos":[2045,2114],"content":"The <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object created in step 3.","source":"The <xref:System.Globalization.CultureInfo> object created in step 3."},{"pos":[2128,2345],"content":"The <ph id=\"ph1\">&lt;xref:System.Globalization.NumberFormatInfo&gt;</ph> object that is returned by the <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.NumberFormat%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object created in step 3.","source":"The <xref:System.Globalization.NumberFormatInfo> object that is returned by the <xref:System.Globalization.CultureInfo.NumberFormat%2A> property of the <xref:System.Globalization.CultureInfo> object created in step 3."},{"pos":[2355,2524],"content":"If the conversion fails, repeat steps 2 through 4 for each remaining element in the string array returned by the <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A&gt;</ph> property.","source":"If the conversion fails, repeat steps 2 through 4 for each remaining element in the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property."},{"pos":[2534,2841],"content":"If the conversion still fails or if the string array returned by the <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A&gt;</ph> property is empty, parse the string by using the invariant culture, which is returned by the <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType&gt;</ph> property.","source":"If the conversion still fails or if the string array returned by the <xref:System.Web.HttpRequest.UserLanguages%2A> property is empty, parse the string by using the invariant culture, which is returned by the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property."},{"pos":[2850,2857],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example is the complete code-behind page for a Web form that asks the user to enter a numeric value in a <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.TextBox&gt;</ph> control and converts it to a number.","pos":[2861,3057],"source":"The following example is the complete code-behind page for a Web form that asks the user to enter a numeric value in a <xref:System.Web.UI.WebControls.TextBox> control and converts it to a number."},{"content":"That number is then doubled and displayed by using the same formatting rules as the original input.","pos":[3058,3157]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType&gt;</ph> property is populated from the culture names that are contained in <ph id=\"ph2\">`Accept-Language`</ph> headers included in an HTTP request.","pos":[3510,3711],"source":"The <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> property is populated from the culture names that are contained in `Accept-Language` headers included in an HTTP request."},{"content":"However, not all browsers include <ph id=\"ph1\">`Accept-Language`</ph> headers in their requests, and users can also suppress the headers completely.","pos":[3712,3842],"source":" However, not all browsers include `Accept-Language` headers in their requests, and users can also suppress the headers completely."},{"content":"This makes it important to have a fallback culture when parsing user input.","pos":[3843,3918]},{"content":"Typically, the fallback culture is the invariant culture returned by <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType&gt;</ph>.","pos":[3919,4077],"source":" Typically, the fallback culture is the invariant culture returned by <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>."},{"content":"Users can also provide Internet Explorer with culture names that they input in a text box, which creates the possibility that the culture names may not be valid.","pos":[4078,4239]},{"content":"This makes it important to use exception handling when instantiating a <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object.","pos":[4240,4358],"source":" This makes it important to use exception handling when instantiating a <xref:System.Globalization.CultureInfo> object."},{"content":"When retrieved from an HTTP request submitted by Internet Explorer, the <ph id=\"ph1\">&lt;xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType&gt;</ph> array is populated in order of user preference.","pos":[4365,4560],"source":"When retrieved from an HTTP request submitted by Internet Explorer, the <xref:System.Web.HttpRequest.UserLanguages%2A?displayProperty=nameWithType> array is populated in order of user preference."},{"content":"The first element in the array contains the name of the user's primary culture/region.","pos":[4561,4647]},{"content":"If the array contains any additional items, Internet Explorer arbitrarily assigns them a quality specifier, which is delimited from the culture name by a semicolon.","pos":[4648,4812]},{"content":"For example, an entry for the fr-FR culture might take the form <ph id=\"ph1\">`fr-FR;q=0.7`</ph>.","pos":[4813,4891],"source":" For example, an entry for the fr-FR culture might take the form `fr-FR;q=0.7`."},{"content":"The example calls the <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.%23ctor%2A&gt;</ph> constructor with its <ph id=\"ph2\">`useUserOverride`</ph> parameter set to <ph id=\"ph3\">`false`</ph> to create a new <ph id=\"ph4\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object.","pos":[4898,5098],"source":"The example calls the <xref:System.Globalization.CultureInfo.%23ctor%2A> constructor with its `useUserOverride` parameter set to `false` to create a new <xref:System.Globalization.CultureInfo> object."},{"content":"This ensures that, if the culture name is the default culture name on the server, the new <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object created by the class constructor contains a culture's default settings and does not reflect any settings overridden by using the server's <bpt id=\"p1\">**</bpt>Regional and Language Options<ept id=\"p1\">**</ept> application.","pos":[5099,5420],"source":" This ensures that, if the culture name is the default culture name on the server, the new <xref:System.Globalization.CultureInfo> object created by the class constructor contains a culture's default settings and does not reflect any settings overridden by using the server's **Regional and Language Options** application."},{"content":"The values from any overridden settings on the server are unlikely to exist on the user's system or to be reflected in the user's input.","pos":[5421,5557]},{"content":"Your code can call either the <ph id=\"ph1\">`Parse`</ph> or the <ph id=\"ph2\">`TryParse`</ph> method of the numeric type that the user's input will be converted to.","pos":[5564,5690],"source":"Your code can call either the `Parse` or the `TryParse` method of the numeric type that the user's input will be converted to."},{"content":"Repeated calls to a parse method may be required for a single parsing operation.","pos":[5691,5771]},{"content":"As a result, the <ph id=\"ph1\">`TryParse`</ph> method is better, because it returns <ph id=\"ph2\">`false`</ph> if a parse operation fails.","pos":[5772,5872],"source":" As a result, the `TryParse` method is better, because it returns `false` if a parse operation fails."},{"content":"In contrast, handling the repeated exceptions that may be thrown by the <ph id=\"ph1\">`Parse`</ph> method can be a very expensive proposition in a Web application.","pos":[5873,6017],"source":" In contrast, handling the repeated exceptions that may be thrown by the `Parse` method can be a very expensive proposition in a Web application."},{"pos":[6026,6044],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"To compile the code, copy it into an <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]</ph> code-behind page so that it replaces all the existing code.","pos":[6048,6199],"source":"To compile the code, copy it into an [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] code-behind page so that it replaces all the existing code."},{"content":"The <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]</ph> Web page should contain the following controls:","pos":[6200,6306],"source":" The [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] Web page should contain the following controls:"},{"content":"A <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.Label&gt;</ph> control, which is not referenced in code.","pos":[6316,6398],"source":"A <xref:System.Web.UI.WebControls.Label> control, which is not referenced in code."},{"content":"Set its <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.TextBox.Text%2A&gt;</ph> property to \"Enter a Number:\".","pos":[6399,6486],"source":" Set its <xref:System.Web.UI.WebControls.TextBox.Text%2A> property to \"Enter a Number:\"."},{"pos":[6496,6569],"content":"A <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.TextBox&gt;</ph> control named <ph id=\"ph2\">`NumericString`</ph>.","source":"A <xref:System.Web.UI.WebControls.TextBox> control named `NumericString`."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.Button&gt;</ph> control named <ph id=\"ph2\">`OKButton`</ph>.","pos":[6579,6646],"source":"A <xref:System.Web.UI.WebControls.Button> control named `OKButton`."},{"content":"Set its <ph id=\"ph1\">&lt;xref:System.Web.UI.WebControls.Button.Text%2A&gt;</ph> property to \"OK\".","pos":[6647,6720],"source":" Set its <xref:System.Web.UI.WebControls.Button.Text%2A> property to \"OK\"."},{"content":"Change the name of the class from <ph id=\"ph1\">`NumericUserInput`</ph> to the name of the class that is defined by the <ph id=\"ph2\">`Inherits`</ph> attribute of the <ph id=\"ph3\">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]</ph> page's <ph id=\"ph4\">`Page`</ph> directive.","pos":[6727,6935],"source":"Change the name of the class from `NumericUserInput` to the name of the class that is defined by the `Inherits` attribute of the [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] page's `Page` directive."},{"content":"Change the name of the <ph id=\"ph1\">`NumericInput`</ph> object reference to the name defined by the <ph id=\"ph2\">`id`</ph> attribute of the <ph id=\"ph3\">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]</ph> page's <ph id=\"ph4\">`form`</ph> tag.","pos":[6936,7113],"source":" Change the name of the `NumericInput` object reference to the name defined by the `id` attribute of the [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] page's `form` tag."},{"pos":[7122,7145],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"To prevent a user from injecting script into the HTML stream, user input should never be directly echoed back in the server response.","pos":[7149,7282]},{"content":"Instead, it should be encoded by using the <ph id=\"ph1\">&lt;xref:System.Web.HttpServerUtility.HtmlEncode%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[7283,7412],"source":" Instead, it should be encoded by using the <xref:System.Web.HttpServerUtility.HtmlEncode%2A?displayProperty=nameWithType> method."},{"pos":[7421,7429],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7433,7538],"content":"<bpt id=\"p1\">[</bpt>Performing Formatting Operations<ept id=\"p1\">](../../../docs/standard/base-types/performing-formatting-operations.md)</ept>","source":"[Performing Formatting Operations](../../../docs/standard/base-types/performing-formatting-operations.md)"},{"pos":[7541,7620],"content":"<bpt id=\"p1\">[</bpt>Parsing Numeric Strings<ept id=\"p1\">](../../../docs/standard/base-types/parsing-numeric.md)</ept>","source":"[Parsing Numeric Strings](../../../docs/standard/base-types/parsing-numeric.md)"}]}