{"content":"---\ntitle: \"Delegates (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"delegates [Visual Basic]\"\n  - \"Visual Basic code, delegates\"\nms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28\n---\n\n# Delegates (Visual Basic)\n\nDelegates are objects that refer to methods. They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages. But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>. Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.\n\n## Delegates and Events\n\nDelegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called. For example, you might want an object that raises events to be able to call different event handlers under different circumstances. Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event. Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement. At run time, the delegate forwards calls to the appropriate event handler.\n\nAlthough you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you. For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event. The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure. The following two lines of code are equivalent. In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument. The second line is a more convenient way to do the same thing.\n\n[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]\n\nYou can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.\n\n## Declaring Events that Use an Existing Delegate Type\n\nIn some situations, you may want to declare an event to use an existing delegate type as its underlying delegate. The following syntax demonstrates how:\n\n[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]\n\nThis is useful when you want to route multiple events to the same handler.\n\n## Delegate Variables and Parameters\n\nYou can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.\n\nFor example, suppose you have a classified-ad application that includes a list box with the names of cars. The ads are sorted by title, which is normally the make of the car. A problem you may face occurs when some cars include the year of the car before the make. The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.\n\nTo fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads. To do this, you pass the custom sort procedure to the sort class at run time, using delegates.\n\n## AddressOf and Lambda Expressions\n\nEach delegate class defines a constructor that is passed the specification of an object method. An argument to a delegate constructor must be a reference to a method, or a lambda expression.\n\nTo specify a reference to a method, use the following syntax:\n\n`AddressOf` [`expression`.]`methodName`\n\nThe compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class. The `methodName` can be either a shared method or an instance method. The `methodName` is not optional, even if you create a delegate for the default method of the class.\n\nTo specify a lambda expression, use the following syntax:\n\n`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`\n\nThe following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.\n\n[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]\n\nThe signature of the function must match that of the delegate type. For more information about lambda expressions, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md). For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).\n\n## Related Topics\n\n|Title|Description|\n|-----------|-----------------|\n|[How to: Invoke a Delegate Method](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)|Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.|\n|[How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)|Demonstrates how to use delegates to pass one procedure to another procedure.|\n|[Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)|Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical|\n|[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)|Provides an overview of events in Visual Basic.|\n","nodes":[{"pos":[4,193],"embed":true,"restype":"x-metadata","content":"title: \"Delegates (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"delegates [Visual Basic]\"\n  - \"Visual Basic code, delegates\"\nms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28","nodes":[{"content":"Delegates (Visual Basic)","nodes":[{"pos":[0,24],"content":"Delegates (Visual Basic)","nodes":[{"content":"Delegates (Visual Basic)","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[201,225],"content":"Delegates (Visual Basic)","linkify":"Delegates (Visual Basic)","nodes":[{"content":"Delegates (Visual Basic)","pos":[0,24]}]},{"content":"Delegates are objects that refer to methods.","pos":[227,271]},{"content":"They are sometimes described as <bpt id=\"p1\">*</bpt>type-safe function pointers<ept id=\"p1\">*</ept> because they are similar to function pointers used in other programming languages.","pos":[272,416],"source":" They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages."},{"content":"But unlike function pointers, Visual Basic delegates are a reference type based on the class <ph id=\"ph1\">&lt;xref:System.Delegate?displayProperty=nameWithType&gt;</ph>.","pos":[417,562],"source":" But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>."},{"content":"Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.","pos":[563,698]},{"pos":[703,723],"content":"Delegates and Events","linkify":"Delegates and Events","nodes":[{"content":"Delegates and Events","pos":[0,20]}]},{"content":"Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.","pos":[725,850]},{"content":"For example, you might want an object that raises events to be able to call different event handlers under different circumstances.","pos":[851,982]},{"content":"Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.","pos":[983,1103]},{"content":"Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the <ph id=\"ph1\">`AddHandler`</ph> statement.","pos":[1104,1246],"source":" Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement."},{"content":"At run time, the delegate forwards calls to the appropriate event handler.","pos":[1247,1321]},{"content":"Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.","pos":[1323,1453]},{"content":"For example, an <ph id=\"ph1\">`Event`</ph> statement implicitly defines a delegate class named <ph id=\"ph2\">`&lt;EventName&gt;EventHandler`</ph> as a nested class of the class containing the <ph id=\"ph3\">`Event`</ph> statement, and with the same signature as the event.","pos":[1454,1662],"source":" For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event."},{"content":"The <ph id=\"ph1\">`AddressOf`</ph> statement implicitly creates an instance of a delegate that refers to a specific procedure.","pos":[1663,1770],"source":" The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure."},{"content":"The following two lines of code are equivalent.","pos":[1771,1818]},{"content":"In the first line, you see the explicit creation of an instance of <ph id=\"ph1\">`EventHandler`</ph>, with a reference to method <ph id=\"ph2\">`Button1_Click`</ph> sent as the argument.","pos":[1819,1966],"source":" In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument."},{"content":"The second line is a more convenient way to do the same thing.","pos":[1967,2029]},{"content":"You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.","pos":[2148,2271]},{"pos":[2276,2327],"content":"Declaring Events that Use an Existing Delegate Type","linkify":"Declaring Events that Use an Existing Delegate Type","nodes":[{"content":"Declaring Events that Use an Existing Delegate Type","pos":[0,51]}]},{"content":"In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.","pos":[2329,2442]},{"content":"The following syntax demonstrates how:","pos":[2443,2481]},{"content":"This is useful when you want to route multiple events to the same handler.","pos":[2600,2674]},{"pos":[2679,2712],"content":"Delegate Variables and Parameters","linkify":"Delegate Variables and Parameters","nodes":[{"content":"Delegate Variables and Parameters","pos":[0,33]}]},{"content":"You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.","pos":[2714,2876]},{"content":"For example, suppose you have a classified-ad application that includes a list box with the names of cars.","pos":[2878,2984]},{"content":"The ads are sorted by title, which is normally the make of the car.","pos":[2985,3052]},{"content":"A problem you may face occurs when some cars include the year of the car before the make.","pos":[3053,3142]},{"content":"The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.","pos":[3143,3334]},{"content":"To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.","pos":[3336,3526]},{"content":"To do this, you pass the custom sort procedure to the sort class at run time, using delegates.","pos":[3527,3621]},{"pos":[3626,3658],"content":"AddressOf and Lambda Expressions","linkify":"AddressOf and Lambda Expressions","nodes":[{"content":"AddressOf and Lambda Expressions","pos":[0,32]}]},{"content":"Each delegate class defines a constructor that is passed the specification of an object method.","pos":[3660,3755]},{"content":"An argument to a delegate constructor must be a reference to a method, or a lambda expression.","pos":[3756,3850]},{"content":"To specify a reference to a method, use the following syntax:","pos":[3852,3913]},{"pos":[3915,3954],"content":"<ph id=\"ph1\">`AddressOf`</ph> [<ph id=\"ph2\">`expression`</ph>.]<ph id=\"ph3\">`methodName`</ph>","source":"`AddressOf` [`expression`.]`methodName`"},{"content":"The compile-time type of the <ph id=\"ph1\">`expression`</ph> must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.","pos":[3956,4147],"source":"The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class."},{"content":"The <ph id=\"ph1\">`methodName`</ph> can be either a shared method or an instance method.","pos":[4148,4217],"source":" The `methodName` can be either a shared method or an instance method."},{"content":"The <ph id=\"ph1\">`methodName`</ph> is not optional, even if you create a delegate for the default method of the class.","pos":[4218,4318],"source":" The `methodName` is not optional, even if you create a delegate for the default method of the class."},{"content":"To specify a lambda expression, use the following syntax:","pos":[4320,4377]},{"pos":[4379,4448],"content":"<ph id=\"ph1\">`Function`</ph> ([<ph id=\"ph2\">`parm`</ph> As <ph id=\"ph3\">`type`</ph>, <ph id=\"ph4\">`parm2`</ph> As <ph id=\"ph5\">`type2`</ph>, ...]) <ph id=\"ph6\">`expression`</ph>","source":"`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`"},{"pos":[4450,4563],"content":"The following example shows both <ph id=\"ph1\">`AddressOf`</ph> and lambda expressions used to specify the reference for a delegate.","source":"The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate."},{"content":"The signature of the function must match that of the delegate type.","pos":[4684,4751]},{"content":"For more information about lambda expressions, see <bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</ept>.","pos":[4752,4919],"source":" For more information about lambda expressions, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)."},{"content":"For more examples of lambda expression and <ph id=\"ph1\">`AddressOf`</ph> assignments to delegates, see <bpt id=\"p1\">[</bpt>Relaxed Delegate Conversion<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)</ept>.","pos":[4920,5138],"source":" For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)."},{"pos":[5143,5157],"content":"Related Topics","linkify":"Related Topics","nodes":[{"content":"Related Topics","pos":[0,14]}]},{"content":"Title","pos":[5160,5165]},{"content":"Description","pos":[5166,5177]},{"pos":[5212,5353],"content":"<bpt id=\"p1\">[</bpt>How to: Invoke a Delegate Method<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)</ept>","source":"[How to: Invoke a Delegate Method](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)"},{"content":"Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.","pos":[5354,5476]},{"pos":[5479,5660],"content":"<bpt id=\"p1\">[</bpt>How to: Pass Procedures to Another Procedure in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)</ept>","source":"[How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)"},{"content":"Demonstrates how to use delegates to pass one procedure to another procedure.","pos":[5661,5738]},{"pos":[5741,5873],"content":"<bpt id=\"p1\">[</bpt>Relaxed Delegate Conversion<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)</ept>","source":"[Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)"},{"content":"Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical","pos":[5874,5991]},{"pos":[5994,6080],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)"},{"content":"Provides an overview of events in Visual Basic.","pos":[6081,6128]}]}