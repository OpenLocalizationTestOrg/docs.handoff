{"content":"---\ntitle: \"How to: Copy a Directory to Another Directory in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"I/O [Visual Basic], copying directories\"\n  - \"I/O [Visual Basic], copying folders\"\n  - \"folders [Visual Basic], copying\"\n  - \"directories [Visual Basic], copying\"\nms.assetid: 2a370bd7-10ba-4219-afc4-4519d031eb6c\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Copy a Directory to Another Directory in Visual Basic\nUse the <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A> method to copy a directory to another directory. This method copies the contents of the directory as well as the directory itself. If the target directory does not exist, it will be created. If a directory with the same name exists in the target location and `overwrite` is set to `False`, the contents of the two directories will be merged. You can specify a new name for the directory during the operation.  \n  \n When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while `overwrite` is set to `False`. When such exceptions are thrown, they are consolidated into a single exception, whose `Data` property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value.  \n  \n### To copy a directory to another directory  \n  \n-   Use the `CopyDirectory` method, specifying source and destination directory names. The following example copies the directory named `TestDirectory1` into `TestDirectory2`, overwriting existing files.  \n  \n     [!code-vb[VbVbcnMyFileSystem#16](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-copy-a-directory-to-another-directory_1.vb)]  \n  \n     This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **File system - Processing Drives, Folders, and Files**. For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets).  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The new name specified for the directory contains a colon (:) or slash (\\ or /) (<xref:System.ArgumentException>).  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   `destinationDirectoryName` is `Nothing` or an empty string (<xref:System.ArgumentNullException>)  \n  \n-   The source directory does not exist (<xref:System.IO.DirectoryNotFoundException>).  \n  \n-   The source directory is a root directory (<xref:System.IO.IOException>).  \n  \n-   The combined path points to an existing file (<xref:System.IO.IOException>).  \n  \n-   The source path and target path are the same (<xref:System.IO.IOException>).  \n  \n-   `ShowUI` is set to `UIOption.AllDialogs` and the user cancels the operation, or one or more files in the directory cannot be copied (<xref:System.OperationCanceledException>).  \n  \n-   The operation is cyclic (<xref:System.InvalidOperationException>).  \n  \n-   The path contains a colon (:) (<xref:System.NotSupportedException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n-   A destination file exists but cannot be accessed (<xref:System.UnauthorizedAccessException>).  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A>   \n [How to: Find Subdirectories with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)   \n [How to: Get the Collection of Files in a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)","nodes":[{"pos":[4,746],"embed":true,"restype":"x-metadata","content":"title: \"How to: Copy a Directory to Another Directory in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"I/O [Visual Basic], copying directories\"\n  - \"I/O [Visual Basic], copying folders\"\n  - \"folders [Visual Basic], copying\"\n  - \"directories [Visual Basic], copying\"\nms.assetid: 2a370bd7-10ba-4219-afc4-4519d031eb6c\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic | Microsoft Docs","nodes":[{"pos":[0,78],"content":"How to: Copy a Directory to Another Directory in Visual Basic | Microsoft Docs","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic | Microsoft Docs","pos":[0,78]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[753,814],"content":"How to: Copy a Directory to Another Directory in Visual Basic","linkify":"How to: Copy a Directory to Another Directory in Visual Basic","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic","pos":[0,61]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A&gt;</ph> method to copy a directory to another directory.","pos":[815,935],"source":"Use the <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A> method to copy a directory to another directory."},{"content":"This method copies the contents of the directory as well as the directory itself.","pos":[936,1017]},{"content":"If the target directory does not exist, it will be created.","pos":[1018,1077]},{"content":"If a directory with the same name exists in the target location and <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph>, the contents of the two directories will be merged.","pos":[1078,1228],"source":" If a directory with the same name exists in the target location and `overwrite` is set to `False`, the contents of the two directories will be merged."},{"content":"You can specify a new name for the directory during the operation.","pos":[1229,1295]},{"content":"When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph>.","pos":[1302,1475],"source":"When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while `overwrite` is set to `False`."},{"content":"When such exceptions are thrown, they are consolidated into a single exception, whose <ph id=\"ph1\">`Data`</ph> property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value.","pos":[1476,1714],"source":" When such exceptions are thrown, they are consolidated into a single exception, whose `Data` property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value."},{"pos":[1724,1764],"content":"To copy a directory to another directory","linkify":"To copy a directory to another directory","nodes":[{"content":"To copy a directory to another directory","pos":[0,40]}]},{"content":"Use the <ph id=\"ph1\">`CopyDirectory`</ph> method, specifying source and destination directory names.","pos":[1774,1856],"source":"Use the `CopyDirectory` method, specifying source and destination directory names."},{"content":"The following example copies the directory named <ph id=\"ph1\">`TestDirectory1`</ph> into <ph id=\"ph2\">`TestDirectory2`</ph>, overwriting existing files.","pos":[1857,1973],"source":" The following example copies the directory named `TestDirectory1` into `TestDirectory2`, overwriting existing files."},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[2181,2249]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>File system - Processing Drives, Folders, and Files<ept id=\"p1\">**</ept>.","pos":[2250,2351],"source":" In the code snippet picker, it is located in **File system - Processing Drives, Folders, and Files**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/code-snippets)</ept>.","pos":[2352,2453],"source":" For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets)."},{"pos":[2462,2480],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[2484,2532]},{"pos":[2542,2656],"content":"The new name specified for the directory contains a colon (:) or slash (\\ or /) (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The new name specified for the directory contains a colon (:) or slash (\\ or /) (<xref:System.ArgumentException>)."},{"pos":[2666,2891],"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>.<ph id=\"ph3\">\\\\</ph>) (<ph id=\"ph4\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>)."},{"pos":[2901,2985],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[2995,3091],"content":"<ph id=\"ph1\">`destinationDirectoryName`</ph> is <ph id=\"ph2\">`Nothing`</ph> or an empty string (<ph id=\"ph3\">&lt;xref:System.ArgumentNullException&gt;</ph>)","source":"`destinationDirectoryName` is `Nothing` or an empty string (<xref:System.ArgumentNullException>)"},{"pos":[3101,3183],"content":"The source directory does not exist (<ph id=\"ph1\">&lt;xref:System.IO.DirectoryNotFoundException&gt;</ph>).","source":"The source directory does not exist (<xref:System.IO.DirectoryNotFoundException>)."},{"pos":[3193,3265],"content":"The source directory is a root directory (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The source directory is a root directory (<xref:System.IO.IOException>)."},{"pos":[3275,3351],"content":"The combined path points to an existing file (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The combined path points to an existing file (<xref:System.IO.IOException>)."},{"pos":[3361,3437],"content":"The source path and target path are the same (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The source path and target path are the same (<xref:System.IO.IOException>)."},{"pos":[3447,3622],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`UIOption.AllDialogs`</ph> and the user cancels the operation, or one or more files in the directory cannot be copied (<ph id=\"ph3\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `UIOption.AllDialogs` and the user cancels the operation, or one or more files in the directory cannot be copied (<xref:System.OperationCanceledException>)."},{"pos":[3632,3698],"content":"The operation is cyclic (<ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph>).","source":"The operation is cyclic (<xref:System.InvalidOperationException>)."},{"pos":[3708,3776],"content":"The path contains a colon (:) (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"The path contains a colon (:) (<xref:System.NotSupportedException>)."},{"pos":[3786,3877],"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"pos":[3887,4007],"content":"A file or folder name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"pos":[4017,4114],"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"pos":[4124,4217],"content":"A destination file exists but cannot be accessed (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"A destination file exists but cannot be accessed (<xref:System.UnauthorizedAccessException>)."},{"pos":[4226,4234],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>How to: Find Subdirectories with a Specific Pattern<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)</ept><ph id=\"ph1\"> </ph>","pos":[4306,4493],"source":"[How to: Find Subdirectories with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Get the Collection of Files in a Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)</ept>","pos":[4497,4681],"source":"[How to: Get the Collection of Files in a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)"}]}