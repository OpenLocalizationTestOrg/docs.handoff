{"content":"---\ntitle: \"How to: Prevent a Child Task from Attaching to its Parent\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"tasks, preventing attachments\"\nms.assetid: c0fb85d4-9e80-4905-9f65-29acc54201c4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Prevent a Child Task from Attaching to its Parent\nThis document demonstrates how to prevent a child task from attaching to the parent task. Preventing a child task from attaching to its parent is useful when you call a component that is written by a third party and that also uses tasks. For example, a third-party component that uses the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option to create a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> object can cause problems in your code if it is long-running or throws an unhandled exception.  \n  \n## Example  \n The following example compares the effects of using the default options to the effects of preventing a child task from attaching to the parent. The example creates a <xref:System.Threading.Tasks.Task> object that calls into a third-party library that also uses a <xref:System.Threading.Tasks.Task> object. The third-party library uses the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent> option to create the <xref:System.Threading.Tasks.Task> object. The application uses the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option to create the parent task. This option instructs the runtime to remove the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent> specification in child tasks.  \n  \n [!code-csharp[TPL_DenyChildAttach#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_denychildattach/cs/denychildattach.cs#1)]\n [!code-vb[TPL_DenyChildAttach#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_denychildattach/vb/denychildattach.vb#1)]  \n  \n Because a parent task does not finish until all child tasks finish, a long-running child task can cause the overall application to perform poorly. In this example, when the application uses the default options to create the parent task, the child task must finish before the parent task finishes. When the application uses the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option, the child is not attached to the parent. Therefore, the application can perform additional work after the parent task finishes and before it must wait for the child task to finish.  \n  \n## Compiling the Code  \n Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `DenyChildAttach.cs` (`DenyChildAttach.vb` for Visual Basic), and then run the following command in a Developer Command Prompt for Visual Studio window.  \n  \n Visual C#  \n  \n **csc.exe DenyChildAttach.cs**  \n  \n Visual Basic  \n  \n **vbc.exe DenyChildAttach.vb**  \n  \n## Robust Programming  \n  \n## See also\n\n- [Task-based Asynchronous Programming](../../../docs/standard/parallel-programming/task-based-asynchronous-programming.md)\n","nodes":[{"pos":[4,304],"embed":true,"restype":"x-metadata","content":"title: \"How to: Prevent a Child Task from Attaching to its Parent\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"tasks, preventing attachments\"\nms.assetid: c0fb85d4-9e80-4905-9f65-29acc54201c4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Prevent a Child Task from Attaching to its Parent","nodes":[{"pos":[0,57],"content":"How to: Prevent a Child Task from Attaching to its Parent","nodes":[{"content":"How to: Prevent a Child Task from Attaching to its Parent","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[311,368],"content":"How to: Prevent a Child Task from Attaching to its Parent","linkify":"How to: Prevent a Child Task from Attaching to its Parent","nodes":[{"content":"How to: Prevent a Child Task from Attaching to its Parent","pos":[0,57]}]},{"content":"This document demonstrates how to prevent a child task from attaching to the parent task.","pos":[369,458]},{"content":"Preventing a child task from attaching to its parent is useful when you call a component that is written by a third party and that also uses tasks.","pos":[459,606]},{"content":"For example, a third-party component that uses the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType&gt;</ph> option to create a <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph> object can cause problems in your code if it is long-running or throws an unhandled exception.","pos":[607,944],"source":" For example, a third-party component that uses the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option to create a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> object can cause problems in your code if it is long-running or throws an unhandled exception."},{"pos":[953,960],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example compares the effects of using the default options to the effects of preventing a child task from attaching to the parent.","pos":[964,1107]},{"content":"The example creates a <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> object that calls into a third-party library that also uses a <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> object.","pos":[1108,1269],"source":" The example creates a <xref:System.Threading.Tasks.Task> object that calls into a third-party library that also uses a <xref:System.Threading.Tasks.Task> object."},{"content":"The third-party library uses the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent&gt;</ph> option to create the <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> object.","pos":[1270,1433],"source":" The third-party library uses the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent> option to create the <xref:System.Threading.Tasks.Task> object."},{"content":"The application uses the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType&gt;</ph> option to create the parent task.","pos":[1434,1587],"source":" The application uses the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option to create the parent task."},{"content":"This option instructs the runtime to remove the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent&gt;</ph> specification in child tasks.","pos":[1588,1732],"source":" This option instructs the runtime to remove the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent> specification in child tasks."},{"content":"Because a parent task does not finish until all child tasks finish, a long-running child task can cause the overall application to perform poorly.","pos":[2013,2159]},{"content":"In this example, when the application uses the default options to create the parent task, the child task must finish before the parent task finishes.","pos":[2160,2309]},{"content":"When the application uses the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType&gt;</ph> option, the child is not attached to the parent.","pos":[2310,2483],"source":" When the application uses the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option, the child is not attached to the parent."},{"content":"Therefore, the application can perform additional work after the parent task finishes and before it must wait for the child task to finish.","pos":[2484,2623]},{"pos":[2632,2650],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2654,2905],"content":"Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named <ph id=\"ph1\">`DenyChildAttach.cs`</ph> (<ph id=\"ph2\">`DenyChildAttach.vb`</ph> for Visual Basic), and then run the following command in a Developer Command Prompt for Visual Studio window.","source":"Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `DenyChildAttach.cs` (`DenyChildAttach.vb` for Visual Basic), and then run the following command in a Developer Command Prompt for Visual Studio window."},{"content":"Visual C#","pos":[2912,2921]},{"pos":[2928,2958],"content":"<bpt id=\"p1\">**</bpt>csc.exe DenyChildAttach.cs<ept id=\"p1\">**</ept>","source":"**csc.exe DenyChildAttach.cs**"},{"content":"Visual Basic","pos":[2965,2977]},{"pos":[2984,3014],"content":"<bpt id=\"p1\">**</bpt>vbc.exe DenyChildAttach.vb<ept id=\"p1\">**</ept>","source":"**vbc.exe DenyChildAttach.vb**"},{"pos":[3023,3041],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"pos":[3050,3058],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3062,3183],"content":"<bpt id=\"p1\">[</bpt>Task-based Asynchronous Programming<ept id=\"p1\">](../../../docs/standard/parallel-programming/task-based-asynchronous-programming.md)</ept>","source":"[Task-based Asynchronous Programming](../../../docs/standard/parallel-programming/task-based-asynchronous-programming.md)"}]}