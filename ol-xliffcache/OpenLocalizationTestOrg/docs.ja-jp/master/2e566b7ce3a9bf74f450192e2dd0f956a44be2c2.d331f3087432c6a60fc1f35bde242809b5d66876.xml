{"content":"---\ntitle: \"Walkthrough: Running an Operation in the Background | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"background tasks\"\n  - \"forms, multithreading\"\n  - \"forms, background operations\"\n  - \"background threads\"\n  - \"BackgroundWorker class, examples\"\n  - \"threading [Windows Forms], background operations\"\n  - \"background operations\"\nms.assetid: 1b9a4e0a-f134-48ff-a1be-c461446a31ba\ncaps.latest.revision: 11\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Running an Operation in the Background\nIf you have an operation that will take a long time to complete, and you do not want to cause delays in your user interface, you can use the <xref:System.ComponentModel.BackgroundWorker> class to run the operation on another thread.  \n  \n For a complete listing of the code used in this example, see [How to: Run an Operation in the Background](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md).  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  \n  \n### To run an operation in the background  \n  \n1.  With your form active in the Windows Forms Designer, drag two <xref:System.Windows.Forms.Button> controls from the **Toolbox** to the form, and then set the `Name` and <xref:System.Windows.Forms.Control.Text%2A> properties of the buttons according to the following table.  \n  \n    |Button|Name|Text|  \n    |------------|----------|----------|  \n    |`button1`|`startBtn`|**Start**|  \n    |`button2`|`cancelBtn`|**Cancel**|  \n  \n2.  Open the **Toolbox**, click the **Components** tab, and then drag the <xref:System.ComponentModel.BackgroundWorker> component onto your form.  \n  \n     The `backgroundWorker1` component appears in the **Component Tray**.  \n  \n3.  In the **Properties** window, set the <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> property to `true`.  \n  \n4.  In the **Properties** window, click on the **Events** button, and then double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers.  \n  \n5.  Insert your time-consuming code into the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler.  \n  \n6.  Extract any parameters required by the operation from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs> parameter.  \n  \n7.  Assign the result of the computation to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.  \n  \n     This is will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#2)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#2)]  \n  \n8.  Insert code for retrieving the result of your operation in the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#3)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#3)]  \n  \n9. Implement the `TimeConsumingOperation` method.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#4)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#4)]  \n  \n10. In the Windows Forms Designer, double-click `startButton` to create the <xref:System.Windows.Forms.Control.Click> event handler.  \n  \n11. Call the <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> method in the <xref:System.Windows.Forms.Control.Click> event handler for `startButton`.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#5)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#5)]  \n  \n12. In the Windows Forms Designer, double-click `cancelButton` to create the <xref:System.Windows.Forms.Control.Click> event handler.  \n  \n13. Call the <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> method in the <xref:System.Windows.Forms.Control.Click> event handler for `cancelButton`.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#6](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#6)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#6](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#6)]  \n  \n14. At the top of the file, import the System.ComponentModel and System.Threading namespaces.  \n  \n     [!code-csharp[System.ComponentModel.BackgroundWorker.Example#7](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#7)]\n     [!code-vb[System.ComponentModel.BackgroundWorker.Example#7](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#7)]  \n  \n15. Press F6 to build the solution, and then press CTRL-F5 to run the application outside the debugger.  \n  \n> [!NOTE]\n>  If you press F5 to run the application under the debugger, the exception raised in the `TimeConsumingOperation` method is caught and displayed by the debugger. When you run the application outside the debugger, the <xref:System.ComponentModel.BackgroundWorker> handles the exception and caches it in the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.RunWorkerCompletedEventArgs>.  \n  \n1.  Click the **Start** button to run an asynchronous operation, and then click the **Cancel** button to stop a running asynchronous operation.  \n  \n     The outcome of each operation is displayed in a <xref:System.Windows.Forms.MessageBox>.  \n  \n## Next Steps  \n  \n-   Implement a form that reports progress as an asynchronous operation proceeds. For more information, see [How to: Implement a Form That Uses a Background Operation](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md).  \n  \n-   Implement a class that supports the Asynchronous Pattern for Components. For more information, see [Implementing the Event-based Asynchronous Pattern](../../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).  \n  \n## See Also  \n <xref:System.ComponentModel.BackgroundWorker>   \n <xref:System.ComponentModel.DoWorkEventArgs>   \n [How to: Implement a Form That Uses a Background Operation](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)   \n [How to: Run an Operation in the Background](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md)   \n [BackgroundWorker Component](../../../../docs/framework/winforms/controls/backgroundworker-component.md)","nodes":[{"pos":[12,80],"content":"Walkthrough: Running an Operation in the Background | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Running an Operation in the Background | Microsoft Docs","pos":[0,68]}]},{"pos":[673,724],"content":"Walkthrough: Running an Operation in the Background","linkify":"Walkthrough: Running an Operation in the Background","nodes":[{"content":"Walkthrough: Running an Operation in the Background","pos":[0,51]}]},{"content":"If you have an operation that will take a long time to complete, and you do not want to cause delays in your user interface, you can use the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> class to run the operation on another thread.","pos":[725,957],"source":"If you have an operation that will take a long time to complete, and you do not want to cause delays in your user interface, you can use the <xref:System.ComponentModel.BackgroundWorker> class to run the operation on another thread."},{"pos":[964,1161],"content":"For a complete listing of the code used in this example, see <bpt id=\"p1\">[</bpt>How to: Run an Operation in the Background<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md)</ept>.","source":"For a complete listing of the code used in this example, see [How to: Run an Operation in the Background](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md)."},{"pos":[1169,1545],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","leadings":["","> "],"nodes":[{"content":" The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","pos":[8,374],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[1,131]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[132,217],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Customizing Development Settings in Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)</ept>.","pos":[218,366],"source":" For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)."}]}]},{"pos":[1555,1592],"content":"To run an operation in the background","linkify":"To run an operation in the background","nodes":[{"content":"To run an operation in the background","pos":[0,37]}]},{"pos":[1602,1873],"content":"With your form active in the Windows Forms Designer, drag two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> to the form, and then set the <ph id=\"ph2\">`Name`</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> properties of the buttons according to the following table.","source":"With your form active in the Windows Forms Designer, drag two <xref:System.Windows.Forms.Button> controls from the **Toolbox** to the form, and then set the `Name` and <xref:System.Windows.Forms.Control.Text%2A> properties of the buttons according to the following table."},{"content":"Button","pos":[1884,1890]},{"content":"Name","pos":[1891,1895]},{"content":"Text","pos":[1896,1900]},{"pos":[1973,1982],"content":"<bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>","source":"**Start**"},{"pos":[2013,2023],"content":"<bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept>","source":"**Cancel**"},{"pos":[2034,2175],"content":"Open the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, click the <bpt id=\"p2\">**</bpt>Components<ept id=\"p2\">**</ept> tab, and then drag the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component onto your form.","source":"Open the **Toolbox**, click the **Components** tab, and then drag the <xref:System.ComponentModel.BackgroundWorker> component onto your form."},{"pos":[2186,2254],"content":"The <ph id=\"ph1\">`backgroundWorker1`</ph> component appears in the <bpt id=\"p1\">**</bpt>Component Tray<ept id=\"p1\">**</ept>.","source":"The `backgroundWorker1` component appears in the **Component Tray**."},{"pos":[2264,2397],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","source":"In the **Properties** window, set the <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> property to `true`."},{"pos":[2407,2649],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click on the <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept> button, and then double-click the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> events to create event handlers.","source":"In the **Properties** window, click on the **Events** button, and then double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers."},{"content":"Insert your time-consuming code into the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler.","pos":[2659,2767],"source":"Insert your time-consuming code into the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler."},{"content":"Extract any parameters required by the operation from the <ph id=\"ph1\">&lt;xref:System.ComponentModel.DoWorkEventArgs.Argument%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph> parameter.","pos":[2777,2963],"source":"Extract any parameters required by the operation from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs> parameter."},{"content":"Assign the result of the computation to the <ph id=\"ph1\">&lt;xref:System.ComponentModel.DoWorkEventArgs.Result%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph>.","pos":[2973,3133],"source":"Assign the result of the computation to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>."},{"content":"This is will be available to the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> event handler.","pos":[3144,3256],"source":"This is will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler."},{"pos":[3267,3640],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#2)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#2<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#2)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#2)]\n [!code-vb[System.ComponentModel.BackgroundWorker.Example#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#2)]"},{"content":"Insert code for retrieving the result of your operation in the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> event handler.","pos":[3650,3792],"source":"Insert code for retrieving the result of your operation in the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler."},{"pos":[3803,4176],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#3<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#3)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#3<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#3)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#3)]\n [!code-vb[System.ComponentModel.BackgroundWorker.Example#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#3)]"},{"pos":[4185,4231],"content":"Implement the <ph id=\"ph1\">`TimeConsumingOperation`</ph> method.","source":"Implement the `TimeConsumingOperation` method."},{"pos":[4242,4615],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#4<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#4)</ept><ept id=\"p1\">]</ept>   <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#4<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#4)</ept><ept id=\"p3\">]</ept>","leadings":["","   "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#4)]\n  [!code-vb[System.ComponentModel.BackgroundWorker.Example#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#4)]"},{"pos":[4625,4753],"content":"In the Windows Forms Designer, double-click <ph id=\"ph1\">`startButton`</ph> to create the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler.","source":"In the Windows Forms Designer, double-click `startButton` to create the <xref:System.Windows.Forms.Control.Click> event handler."},{"pos":[4763,4924],"content":"Call the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A&gt;</ph> method in the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for <ph id=\"ph3\">`startButton`</ph>.","source":"Call the <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> method in the <xref:System.Windows.Forms.Control.Click> event handler for `startButton`."},{"pos":[4935,5308],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#5<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#5)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#5<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#5)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#5)]\n [!code-vb[System.ComponentModel.BackgroundWorker.Example#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#5)]"},{"pos":[5318,5447],"content":"In the Windows Forms Designer, double-click <ph id=\"ph1\">`cancelButton`</ph> to create the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler.","source":"In the Windows Forms Designer, double-click `cancelButton` to create the <xref:System.Windows.Forms.Control.Click> event handler."},{"pos":[5457,5616],"content":"Call the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph> method in the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for <ph id=\"ph3\">`cancelButton`</ph>.","source":"Call the <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> method in the <xref:System.Windows.Forms.Control.Click> event handler for `cancelButton`."},{"pos":[5627,6000],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#6<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#6)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#6<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#6)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#6](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#6)]\n [!code-vb[System.ComponentModel.BackgroundWorker.Example#6](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#6)]"},{"content":"At the top of the file, import the System.ComponentModel and System.Threading namespaces.","pos":[6010,6099]},{"pos":[6110,6483],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.ComponentModel.BackgroundWorker.Example#7<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#7)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.ComponentModel.BackgroundWorker.Example#7<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#7)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[System.ComponentModel.BackgroundWorker.Example#7](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/CS/Form1.cs#7)]\n [!code-vb[System.ComponentModel.BackgroundWorker.Example#7](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker.Example/VB/Form1.vb#7)]"},{"content":"Press F6 to build the solution, and then press CTRL-F5 to run the application outside the debugger.","pos":[6493,6592]},{"pos":[6600,7050],"content":"[!NOTE]\n If you press F5 to run the application under the debugger, the exception raised in the `TimeConsumingOperation` method is caught and displayed by the debugger. When you run the application outside the debugger, the <xref:System.ComponentModel.BackgroundWorker> handles the exception and caches it in the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.RunWorkerCompletedEventArgs>.","leadings":["","> "],"nodes":[{"content":" If you press F5 to run the application under the debugger, the exception raised in the `TimeConsumingOperation` method is caught and displayed by the debugger. When you run the application outside the debugger, the <xref:System.ComponentModel.BackgroundWorker> handles the exception and caches it in the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.RunWorkerCompletedEventArgs>.","pos":[8,448],"nodes":[{"content":"If you press F5 to run the application under the debugger, the exception raised in the <ph id=\"ph1\">`TimeConsumingOperation`</ph> method is caught and displayed by the debugger.","pos":[1,160],"source":" If you press F5 to run the application under the debugger, the exception raised in the `TimeConsumingOperation` method is caught and displayed by the debugger."},{"content":"When you run the application outside the debugger, the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> handles the exception and caches it in the <ph id=\"ph2\">&lt;xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.ComponentModel.RunWorkerCompletedEventArgs&gt;</ph>.","pos":[161,440],"source":" When you run the application outside the debugger, the <xref:System.ComponentModel.BackgroundWorker> handles the exception and caches it in the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.RunWorkerCompletedEventArgs>."}]}]},{"pos":[7060,7199],"content":"Click the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> button to run an asynchronous operation, and then click the <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button to stop a running asynchronous operation.","source":"Click the **Start** button to run an asynchronous operation, and then click the **Cancel** button to stop a running asynchronous operation."},{"content":"The outcome of each operation is displayed in a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MessageBox&gt;</ph>.","pos":[7210,7297],"source":"The outcome of each operation is displayed in a <xref:System.Windows.Forms.MessageBox>."},{"pos":[7306,7316],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"Implement a form that reports progress as an asynchronous operation proceeds.","pos":[7326,7403]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Implement a Form That Uses a Background Operation<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)</ept>.","pos":[7404,7596],"source":" For more information, see [How to: Implement a Form That Uses a Background Operation](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)."},{"content":"Implement a class that supports the Asynchronous Pattern for Components.","pos":[7606,7678]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Implementing the Event-based Asynchronous Pattern<ept id=\"p1\">](../../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)</ept>.","pos":[7679,7871],"source":" For more information, see [Implementing the Event-based Asynchronous Pattern](../../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)."},{"pos":[7880,7888],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph>","pos":[7892,7937],"source":"<xref:System.ComponentModel.BackgroundWorker> "},{"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph>","pos":[7942,7986],"source":" <xref:System.ComponentModel.DoWorkEventArgs> "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Implement a Form That Uses a Background Operation<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)</ept><ph id=\"ph1\"> </ph>","pos":[7990,8157],"source":" [How to: Implement a Form That Uses a Background Operation](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Run an Operation in the Background<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md)</ept><ph id=\"ph1\"> </ph>","pos":[8160,8297],"source":" [How to: Run an Operation in the Background](../../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md) "},{"content":"<bpt id=\"p1\"> [</bpt>BackgroundWorker Component<ept id=\"p1\">](../../../../docs/framework/winforms/controls/backgroundworker-component.md)</ept>","pos":[8300,8405],"source":" [BackgroundWorker Component](../../../../docs/framework/winforms/controls/backgroundworker-component.md)"}]}