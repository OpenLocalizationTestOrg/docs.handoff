{"content":"---\ntitle: \"Walkthrough: Simple Object Model and Query (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: c878e457-f715-46e4-a136-ff14d6c86018\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Walkthrough: Simple Object Model and Query (Visual Basic)\nThis walkthrough provides a fundamental end-to-end [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] scenario with minimal complexities. You will create an entity class that models the Customers table in the sample Northwind database. You will then create a simple query to list customers who are located in London.  \n  \n This walkthrough is code-oriented by design to help show [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] concepts. Normally speaking, you would use the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] to create your object model.  \n  \n [!INCLUDE[note_settings_general](../../../../../../includes/note-settings-general-md.md)]  \n  \n This walkthrough was written by using Visual Basic Development Settings.  \n  \n## Prerequisites  \n  \n-   This walkthrough uses a dedicated folder (\"c:\\linqtest\") to hold files. Create this folder before you begin the walkthrough.  \n  \n-   This walkthrough requires the Northwind sample database. If you do not have this database on your development computer, you can download it from the Microsoft download site. For instructions, see [Downloading Sample Databases](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md). After you have downloaded the database, copy the file to the c:\\linqtest folder.  \n  \n## Overview  \n This walkthrough consists of six main tasks:  \n  \n-   Creating a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] solution in [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)].  \n  \n-   Mapping a class to a database table.  \n  \n-   Designating properties on the class to represent database columns.  \n  \n-   Specifying the connection to the Northwind database.  \n  \n-   Creating a simple query to run against the database.  \n  \n-   Executing the query and observing the results.  \n  \n## Creating a LINQ to SQL Solution  \n In this first task, you create a [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] solution that contains the necessary references to build and run a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] project.  \n  \n#### To create a LINQ to SQL solution  \n  \n1.  On the **File** menu, click **New Project**.  \n  \n2.  In the **Project types** pane of the **New Project** dialog box, click **Visual Basic**.  \n  \n3.  In the **Templates** pane, click **Console Application**.  \n  \n4.  In the **Name** box, type **LinqConsoleApp**.  \n  \n5.  Click **OK**.  \n  \n## Adding LINQ References and Directives  \n This walkthrough uses assemblies that might not be installed by default in your project. If `System.Data.Linq` is not listed as a reference in your project (click **Show All Files** in **Solution Explorer** and expand the **References** node), add it, as explained in the following steps.  \n  \n#### To add System.Data.Linq  \n  \n1.  In **Solution Explorer**, right-click **References**, and then click **Add Reference**.  \n  \n2.  In the **Add Reference** dialog box, click **.NET**, click the System.Data.Linq assembly, and then click **OK**.  \n  \n     The assembly is added to the project.  \n  \n3.  Also in the **Add Reference** dialog box, click **.NET**, scroll to and click System.Windows.Forms, and then click **OK**.  \n  \n     This assembly, which supports the message box in the walkthrough, is added to the project.  \n  \n4.  Add the following directives above `Module1`:  \n  \n     [!code-vb[DLinqWalk1VB#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#1)]  \n  \n## Mapping a Class to a Database Table  \n In this step, you create a class and map it to a database table. Such a class is termed an *entity class*. Note that the mapping is accomplished by just adding the <xref:System.Data.Linq.Mapping.TableAttribute> attribute. The <xref:System.Data.Linq.Mapping.TableAttribute.Name%2A> property specifies the name of the table in the database.  \n  \n#### To create an entity class and map it to a database table  \n  \n-   Type or paste the following code into Module1.vb immediately above `Sub Main`:  \n  \n     [!code-vb[DLinqWalk1VB#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#2)]  \n  \n## Designating Properties on the Class to Represent Database Columns  \n In this step, you accomplish several tasks.  \n  \n-   You use the <xref:System.Data.Linq.Mapping.ColumnAttribute> attribute to designate `CustomerID` and `City` properties on the entity class as representing columns in the database table.  \n  \n-   You designate the `CustomerID` property as representing a primary key column in the database.  \n  \n-   You designate `_CustomerID` and `_City` fields for private storage. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can then store and retrieve values directly, instead of using public accessors that might include business logic.  \n  \n#### To represent characteristics of two database columns  \n  \n-   Type or paste the following code into Module1.vb just before `End Class`:  \n  \n     [!code-vb[DLinqWalk1VB#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#3)]  \n  \n## Specifying the Connection to the Northwind Database  \n In this step you use a <xref:System.Data.Linq.DataContext> object to establish a connection between your code-based data structures and the database itself. The <xref:System.Data.Linq.DataContext> is the main channel through which you retrieve objects from the database and submit changes.  \n  \n You also declare a `Table(Of Customer)` to act as the logical, typed table for your queries against the Customers table in the database. You will create and execute these queries in later steps.  \n  \n#### To specify the database connection  \n  \n-   Type or paste the following code into the `Sub Main` method.  \n  \n     Note that the `northwnd.mdf` file is assumed to be in the linqtest folder. For more information, see the Prerequisites section earlier in this walkthrough.  \n  \n     [!code-vb[DLinqWalk1VB#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#4)]  \n  \n## Creating a Simple Query  \n In this step, you create a query to find which customers in the database Customers table are located in London. The query code in this step just describes the query. It does not execute it. This approach is known as *deferred execution*. For more information, see [Introduction to LINQ Queries (C#)](~/docs/csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md).  \n  \n You will also produce a log output to show the SQL commands that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] generates. This logging feature (which uses <xref:System.Data.Linq.DataContext.Log%2A>) is helpful in debugging, and in determining that the commands being sent to the database accurately represent your query.  \n  \n#### To create a simple query  \n  \n-   Type or paste the following code into the `Sub Main` method after the `Table(Of Customer)` declaration:  \n  \n     [!code-vb[DLinqWalk1AVB#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#5)]  \n  \n## Executing the Query  \n In this step, you actually execute the query. The query expressions you created in the previous steps are not evaluated until the results are needed. When you begin the `For Each` iteration, a SQL command is executed against the database and objects are materialized.  \n  \n#### To execute the query  \n  \n1.  Type or paste the following code at the end of the `Sub Main` method (after the query description):  \n  \n     [!code-vb[DLinqWalk1AVB#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#6)]  \n  \n2.  Press F5 to debug the application.  \n  \n    > [!NOTE]\n    >  If your application generates a run-time error, see the Troubleshooting section of [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md).  \n  \n     The message box displays a list of six customers. The Console window displays the generated SQL code.  \n  \n3.  Click **OK** to dismiss the message box.  \n  \n     The application closes.  \n  \n4.  On the **File** menu, click **Save All**.  \n  \n     You will need this application if you continue with the next walkthrough.  \n  \n## Next Steps  \n The [Walkthrough: Querying Across Relationships (Visual Basic)](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-querying-across-relationships-visual-basic.md) topic continues where this walkthrough ends. The Querying Across Relationships walkthrough demonstrates how [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can query across tables, similar to *joins* in a relational database.  \n  \n If you want to do the Querying Across Relationships walkthrough, make sure to save the solution for the walkthrough you have just completed, which is a prerequisite.  \n  \n## See Also  \n [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)","nodes":[{"pos":[12,86],"content":"Walkthrough: Simple Object Model and Query (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Simple Object Model and Query (Visual Basic) | Microsoft Docs","pos":[0,74]}]},{"pos":[395,452],"content":"Walkthrough: Simple Object Model and Query (Visual Basic)","linkify":"Walkthrough: Simple Object Model and Query (Visual Basic)","nodes":[{"content":"Walkthrough: Simple Object Model and Query (Visual Basic)","pos":[0,57]}]},{"content":"This walkthrough provides a fundamental end-to-end <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> scenario with minimal complexities.","pos":[453,607],"source":"This walkthrough provides a fundamental end-to-end [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] scenario with minimal complexities."},{"content":"You will create an entity class that models the Customers table in the sample Northwind database.","pos":[608,705]},{"content":"You will then create a simple query to list customers who are located in London.","pos":[706,786]},{"content":"This walkthrough is code-oriented by design to help show <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> concepts.","pos":[793,927],"source":"This walkthrough is code-oriented by design to help show [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] concepts."},{"content":"Normally speaking, you would use the <ph id=\"ph1\">[!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)]</ph> to create your object model.","pos":[928,1077],"source":" Normally speaking, you would use the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] to create your object model."},{"content":"This walkthrough was written by using Visual Basic Development Settings.","pos":[1180,1252]},{"pos":[1261,1274],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"This walkthrough uses a dedicated folder (\"c:\\linqtest\") to hold files.","pos":[1284,1355]},{"content":"Create this folder before you begin the walkthrough.","pos":[1356,1408]},{"content":"This walkthrough requires the Northwind sample database.","pos":[1418,1474]},{"content":"If you do not have this database on your development computer, you can download it from the Microsoft download site.","pos":[1475,1591]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>Downloading Sample Databases<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md)</ept>.","pos":[1592,1732],"source":" For instructions, see [Downloading Sample Databases](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md)."},{"content":"After you have downloaded the database, copy the file to the c:\\linqtest folder.","pos":[1733,1813]},{"pos":[1822,1830],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"This walkthrough consists of six main tasks:","pos":[1834,1878]},{"pos":[1888,2059],"content":"Creating a <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> solution in <ph id=\"ph2\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph>.","source":"Creating a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] solution in [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]."},{"content":"Mapping a class to a database table.","pos":[2069,2105]},{"content":"Designating properties on the class to represent database columns.","pos":[2115,2181]},{"content":"Specifying the connection to the Northwind database.","pos":[2191,2243]},{"content":"Creating a simple query to run against the database.","pos":[2253,2305]},{"content":"Executing the query and observing the results.","pos":[2315,2361]},{"pos":[2370,2401],"content":"Creating a LINQ to SQL Solution","linkify":"Creating a LINQ to SQL Solution","nodes":[{"content":"Creating a LINQ to SQL Solution","pos":[0,31]}]},{"pos":[2405,2661],"content":"In this first task, you create a <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph> solution that contains the necessary references to build and run a <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> project.","source":"In this first task, you create a [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] solution that contains the necessary references to build and run a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] project."},{"pos":[2672,2704],"content":"To create a LINQ to SQL solution","linkify":"To create a LINQ to SQL solution","nodes":[{"content":"To create a LINQ to SQL solution","pos":[0,32]}]},{"pos":[2714,2758],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept>.","source":"On the **File** menu, click **New Project**."},{"pos":[2768,2856],"content":"In the <bpt id=\"p1\">**</bpt>Project types<ept id=\"p1\">**</ept> pane of the <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept> dialog box, click <bpt id=\"p3\">**</bpt>Visual Basic<ept id=\"p3\">**</ept>.","source":"In the **Project types** pane of the **New Project** dialog box, click **Visual Basic**."},{"pos":[2866,2923],"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Console Application<ept id=\"p2\">**</ept>.","source":"In the **Templates** pane, click **Console Application**."},{"pos":[2933,2978],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>LinqConsoleApp<ept id=\"p2\">**</ept>.","source":"In the **Name** box, type **LinqConsoleApp**."},{"pos":[2988,3001],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"pos":[3010,3047],"content":"Adding LINQ References and Directives","linkify":"Adding LINQ References and Directives","nodes":[{"content":"Adding LINQ References and Directives","pos":[0,37]}]},{"content":"This walkthrough uses assemblies that might not be installed by default in your project.","pos":[3051,3139]},{"content":"If <ph id=\"ph1\">`System.Data.Linq`</ph> is not listed as a reference in your project (click <bpt id=\"p1\">**</bpt>Show All Files<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and expand the <bpt id=\"p3\">**</bpt>References<ept id=\"p3\">**</ept> node), add it, as explained in the following steps.","pos":[3140,3339],"source":" If `System.Data.Linq` is not listed as a reference in your project (click **Show All Files** in **Solution Explorer** and expand the **References** node), add it, as explained in the following steps."},{"pos":[3350,3373],"content":"To add System.Data.Linq","linkify":"To add System.Data.Linq","nodes":[{"content":"To add System.Data.Linq","pos":[0,23]}]},{"pos":[3383,3470],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click **References**, and then click **Add Reference**."},{"pos":[3480,3592],"content":"In the <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>.NET<ept id=\"p2\">**</ept>, click the System.Data.Linq assembly, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"In the **Add Reference** dialog box, click **.NET**, click the System.Data.Linq assembly, and then click **OK**."},{"content":"The assembly is added to the project.","pos":[3603,3640]},{"pos":[3650,3772],"content":"Also in the <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>.NET<ept id=\"p2\">**</ept>, scroll to and click System.Windows.Forms, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Also in the **Add Reference** dialog box, click **.NET**, scroll to and click System.Windows.Forms, and then click **OK**."},{"content":"This assembly, which supports the message box in the walkthrough, is added to the project.","pos":[3783,3873]},{"pos":[3883,3928],"content":"Add the following directives above <ph id=\"ph1\">`Module1`</ph>:","source":"Add the following directives above `Module1`:"},{"pos":[3939,4059],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1VB#1<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1VB#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#1)]"},{"pos":[4068,4103],"content":"Mapping a Class to a Database Table","linkify":"Mapping a Class to a Database Table","nodes":[{"content":"Mapping a Class to a Database Table","pos":[0,35]}]},{"content":"In this step, you create a class and map it to a database table.","pos":[4107,4171]},{"content":"Such a class is termed an <bpt id=\"p1\">*</bpt>entity class<ept id=\"p1\">*</ept>.","pos":[4172,4213],"source":" Such a class is termed an *entity class*."},{"content":"Note that the mapping is accomplished by just adding the <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.TableAttribute&gt;</ph> attribute.","pos":[4214,4328],"source":" Note that the mapping is accomplished by just adding the <xref:System.Data.Linq.Mapping.TableAttribute> attribute."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.TableAttribute.Name%2A&gt;</ph> property specifies the name of the table in the database.","pos":[4329,4445],"source":" The <xref:System.Data.Linq.Mapping.TableAttribute.Name%2A> property specifies the name of the table in the database."},{"pos":[4456,4512],"content":"To create an entity class and map it to a database table","linkify":"To create an entity class and map it to a database table","nodes":[{"content":"To create an entity class and map it to a database table","pos":[0,56]}]},{"pos":[4522,4600],"content":"Type or paste the following code into Module1.vb immediately above <ph id=\"ph1\">`Sub Main`</ph>:","source":"Type or paste the following code into Module1.vb immediately above `Sub Main`:"},{"pos":[4611,4731],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1VB#2<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#2)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1VB#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#2)]"},{"pos":[4740,4805],"content":"Designating Properties on the Class to Represent Database Columns","linkify":"Designating Properties on the Class to Represent Database Columns","nodes":[{"content":"Designating Properties on the Class to Represent Database Columns","pos":[0,65]}]},{"content":"In this step, you accomplish several tasks.","pos":[4809,4852]},{"pos":[4862,5046],"content":"You use the <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.ColumnAttribute&gt;</ph> attribute to designate <ph id=\"ph2\">`CustomerID`</ph> and <ph id=\"ph3\">`City`</ph> properties on the entity class as representing columns in the database table.","source":"You use the <xref:System.Data.Linq.Mapping.ColumnAttribute> attribute to designate `CustomerID` and `City` properties on the entity class as representing columns in the database table."},{"pos":[5056,5149],"content":"You designate the <ph id=\"ph1\">`CustomerID`</ph> property as representing a primary key column in the database.","source":"You designate the `CustomerID` property as representing a primary key column in the database."},{"content":"You designate <ph id=\"ph1\">`_CustomerID`</ph> and <ph id=\"ph2\">`_City`</ph> fields for private storage.","pos":[5159,5226],"source":"You designate `_CustomerID` and `_City` fields for private storage."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> can then store and retrieve values directly, instead of using public accessors that might include business logic.","pos":[5227,5408],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can then store and retrieve values directly, instead of using public accessors that might include business logic."},{"pos":[5419,5471],"content":"To represent characteristics of two database columns","linkify":"To represent characteristics of two database columns","nodes":[{"content":"To represent characteristics of two database columns","pos":[0,52]}]},{"pos":[5481,5554],"content":"Type or paste the following code into Module1.vb just before <ph id=\"ph1\">`End Class`</ph>:","source":"Type or paste the following code into Module1.vb just before `End Class`:"},{"pos":[5565,5685],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1VB#3<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#3)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1VB#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#3)]"},{"pos":[5694,5745],"content":"Specifying the Connection to the Northwind Database","linkify":"Specifying the Connection to the Northwind Database","nodes":[{"content":"Specifying the Connection to the Northwind Database","pos":[0,51]}]},{"content":"In this step you use a <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object to establish a connection between your code-based data structures and the database itself.","pos":[5749,5905],"source":"In this step you use a <xref:System.Data.Linq.DataContext> object to establish a connection between your code-based data structures and the database itself."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> is the main channel through which you retrieve objects from the database and submit changes.","pos":[5906,6038],"source":" The <xref:System.Data.Linq.DataContext> is the main channel through which you retrieve objects from the database and submit changes."},{"content":"You also declare a <ph id=\"ph1\">`Table(Of Customer)`</ph> to act as the logical, typed table for your queries against the Customers table in the database.","pos":[6045,6181],"source":"You also declare a `Table(Of Customer)` to act as the logical, typed table for your queries against the Customers table in the database."},{"content":"You will create and execute these queries in later steps.","pos":[6182,6239]},{"pos":[6250,6284],"content":"To specify the database connection","linkify":"To specify the database connection","nodes":[{"content":"To specify the database connection","pos":[0,34]}]},{"pos":[6294,6354],"content":"Type or paste the following code into the <ph id=\"ph1\">`Sub Main`</ph> method.","source":"Type or paste the following code into the `Sub Main` method."},{"content":"Note that the <ph id=\"ph1\">`northwnd.mdf`</ph> file is assumed to be in the linqtest folder.","pos":[6365,6439],"source":"Note that the `northwnd.mdf` file is assumed to be in the linqtest folder."},{"content":"For more information, see the Prerequisites section earlier in this walkthrough.","pos":[6440,6520]},{"pos":[6531,6651],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1VB#4<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#4)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1VB#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#4)]"},{"pos":[6660,6683],"content":"Creating a Simple Query","linkify":"Creating a Simple Query","nodes":[{"content":"Creating a Simple Query","pos":[0,23]}]},{"content":"In this step, you create a query to find which customers in the database Customers table are located in London.","pos":[6687,6798]},{"content":"The query code in this step just describes the query.","pos":[6799,6852]},{"content":"It does not execute it.","pos":[6853,6876]},{"content":"This approach is known as <bpt id=\"p1\">*</bpt>deferred execution<ept id=\"p1\">*</ept>.","pos":[6877,6924],"source":" This approach is known as *deferred execution*."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Introduction to LINQ Queries (C#)<ept id=\"p1\">](~/docs/csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md)</ept>.","pos":[6925,7066],"source":" For more information, see [Introduction to LINQ Queries (C#)](~/docs/csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md)."},{"content":"You will also produce a log output to show the SQL commands that <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> generates.","pos":[7073,7216],"source":"You will also produce a log output to show the SQL commands that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] generates."},{"content":"This logging feature (which uses <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.Log%2A&gt;</ph>) is helpful in debugging, and in determining that the commands being sent to the database accurately represent your query.","pos":[7217,7415],"source":" This logging feature (which uses <xref:System.Data.Linq.DataContext.Log%2A>) is helpful in debugging, and in determining that the commands being sent to the database accurately represent your query."},{"pos":[7426,7450],"content":"To create a simple query","linkify":"To create a simple query","nodes":[{"content":"To create a simple query","pos":[0,24]}]},{"pos":[7460,7563],"content":"Type or paste the following code into the <ph id=\"ph1\">`Sub Main`</ph> method after the <ph id=\"ph2\">`Table(Of Customer)`</ph> declaration:","source":"Type or paste the following code into the `Sub Main` method after the `Table(Of Customer)` declaration:"},{"pos":[7574,7696],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1AVB#5<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#5)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1AVB#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#5)]"},{"pos":[7705,7724],"content":"Executing the Query","linkify":"Executing the Query","nodes":[{"content":"Executing the Query","pos":[0,19]}]},{"content":"In this step, you actually execute the query.","pos":[7728,7773]},{"content":"The query expressions you created in the previous steps are not evaluated until the results are needed.","pos":[7774,7877]},{"content":"When you begin the <ph id=\"ph1\">`For Each`</ph> iteration, a SQL command is executed against the database and objects are materialized.","pos":[7878,7995],"source":" When you begin the `For Each` iteration, a SQL command is executed against the database and objects are materialized."},{"pos":[8006,8026],"content":"To execute the query","linkify":"To execute the query","nodes":[{"content":"To execute the query","pos":[0,20]}]},{"pos":[8036,8135],"content":"Type or paste the following code at the end of the <ph id=\"ph1\">`Sub Main`</ph> method (after the query description):","source":"Type or paste the following code at the end of the `Sub Main` method (after the query description):"},{"pos":[8146,8268],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DLinqWalk1AVB#6<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#6)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[DLinqWalk1AVB#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#6)]"},{"content":"Press F5 to debug the application.","pos":[8278,8312]},{"pos":[8324,8532],"content":"[!NOTE]\nIf your application generates a run-time error, see the Troubleshooting section of [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md).","leadings":["","    >  "],"nodes":[{"content":"If your application generates a run-time error, see the Troubleshooting section of <bpt id=\"p1\">[</bpt>Learning by Walkthroughs<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)</ept>.","pos":[8,201],"source":"If your application generates a run-time error, see the Troubleshooting section of [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)."}]},{"content":"The message box displays a list of six customers.","pos":[8543,8592]},{"content":"The Console window displays the generated SQL code.","pos":[8593,8644]},{"pos":[8654,8694],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to dismiss the message box.","source":"Click **OK** to dismiss the message box."},{"content":"The application closes.","pos":[8705,8728]},{"pos":[8738,8779],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Save All<ept id=\"p2\">**</ept>.","source":"On the **File** menu, click **Save All**."},{"content":"You will need this application if you continue with the next walkthrough.","pos":[8790,8863]},{"pos":[8872,8882],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"The <bpt id=\"p1\">[</bpt>Walkthrough: Querying Across Relationships (Visual Basic)<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-querying-across-relationships-visual-basic.md)</ept> topic continues where this walkthrough ends.","pos":[8886,9107],"source":"The [Walkthrough: Querying Across Relationships (Visual Basic)](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-querying-across-relationships-visual-basic.md) topic continues where this walkthrough ends."},{"content":"The Querying Across Relationships walkthrough demonstrates how <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> can query across tables, similar to <bpt id=\"p1\">*</bpt>joins<ept id=\"p1\">*</ept> in a relational database.","pos":[9108,9308],"source":" The Querying Across Relationships walkthrough demonstrates how [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can query across tables, similar to *joins* in a relational database."},{"content":"If you want to do the Querying Across Relationships walkthrough, make sure to save the solution for the walkthrough you have just completed, which is a prerequisite.","pos":[9315,9480]},{"pos":[9489,9497],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[9501,9610],"content":"<bpt id=\"p1\">[</bpt>Learning by Walkthroughs<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)</ept>","source":"[Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)"}]}