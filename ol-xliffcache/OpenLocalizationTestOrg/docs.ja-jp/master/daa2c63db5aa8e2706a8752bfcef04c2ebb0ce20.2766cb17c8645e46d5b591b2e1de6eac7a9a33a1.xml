{"content":"---\ntitle: \"IMetaDataEmit::DefineImportMember Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.DefineImportMember\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::DefineImportMember\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DefineImportMember method [.NET Framework metadata]\"\n  - \"IMetaDataEmit::DefineImportMember method [.NET Framework metadata]\"\nms.assetid: c7dd94c6-335b-46ff-9dfe-505056db5673\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataEmit::DefineImportMember Method\nCreates a reference to the specified member of a type or module that is defined outside the current scope, and defines a token for that reference.  \n  \n## Syntax  \n  \n```  \nHRESULT DefineImportMember (   \n    [in]  IMetaDataAssemblyImport  *pAssemImport,   \n    [in]  const void               *pbHashValue,   \n    [in]  ULONG                    cbHashValue,  \n    [in]  IMetaDataImport          *pImport,   \n    [in]  mdToken                  mbMember,   \n    [in]  IMetaDataAssemblyEmit    *pAssemEmit,   \n    [in]  mdToken                  tkParent,   \n    [out] mdMemberRef              *pmr   \n);  \n```  \n  \n#### Parameters  \n `pAssemImport`  \n [in] An [IMetaDataAssemblyImport](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyimport-interface.md) interface that represents the assembly from which the target member is imported.  \n  \n `pbHashValue`  \n [in] An array that contains the hash for the assembly specified by `pAssemImport`.  \n  \n `cbHashValue`  \n [in] The number of bytes in the `pbHashValue` array.  \n  \n `pImport`  \n [in] An [IMetaDataImport](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md) interface that represents the metadata scope from which the target member is imported.  \n  \n `mbMember`  \n [in] The metadata token that specifies the target member. The token can be an `mdMethodDef` (for a member method), `mdProperty` (for a member property), or `mdFieldDef` (for a member field) token.  \n  \n `pAssemEmit`  \n [in] An [IMetaDataAssemblyEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md) interface that represents the assembly into which the target member is imported.  \n  \n `tkParent`  \n [in] The `mdTypeRef` or `mdModuleRef` token for the type or module, respectively, that owns the target member.  \n  \n `pmr`  \n [out] The `mdMemberRef` token that is defined in the current scope for the member reference.  \n  \n## Remarks  \n The `DefineImportMember` method looks up the member, specified by `mbMember`, that is defined in another scope, specified by `pImport`, and retrieves its properties. It uses this information to call the [IMetaDataEmit::DefineMemberRef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definememberref-method.md) method in the current scope to create the member reference.  \n  \n Generally, before you use the `DefineImportMember` method, you must create, in the current scope, a type reference or module reference for the target member's parent class, interface, or module. The metadata token for this reference is then passed in the `tkParent` argument. You do not need to create a reference to the target member's parent if it will be resolved later by the compiler or linker. To summarize:  \n  \n-   If the target member is a field or method, use either the [IMetaDataEmit::DefineTypeRefByName](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetyperefbyname-method.md) or the [IMetaDataEmit::DefineImportType](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-defineimporttype-method.md) method to create a type reference, in the current scope, for the member's parent class or parent interface.  \n  \n-   If the target member is a global variable or global function (that is, not a member of a class or interface), use the [IMetaDataEmit::DefineModuleRef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemoduleref-method.md) method to create a module reference, in the current scope, for the member's parent module.  \n  \n-   If the target member's parent will be resolved later by the compiler or linker, then pass `mdTokenNil` in `tkParent`. The only scenario in which this applies is when a global function or global variable is being imported from a .obj file that will ultimately be linked into the current module and the metadata merged.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)   \n [IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)","nodes":[{"pos":[4,724],"embed":true,"restype":"x-metadata","content":"title: \"IMetaDataEmit::DefineImportMember Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.DefineImportMember\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::DefineImportMember\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DefineImportMember method [.NET Framework metadata]\"\n  - \"IMetaDataEmit::DefineImportMember method [.NET Framework metadata]\"\nms.assetid: c7dd94c6-335b-46ff-9dfe-505056db5673\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"IMetaDataEmit::DefineImportMember Method | Microsoft Docs","nodes":[{"pos":[0,57],"content":"IMetaDataEmit::DefineImportMember Method | Microsoft Docs","nodes":[{"content":"IMetaDataEmit::DefineImportMember Method | Microsoft Docs","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[731,771],"content":"IMetaDataEmit::DefineImportMember Method","linkify":"IMetaDataEmit::DefineImportMember Method","nodes":[{"content":"IMetaDataEmit::DefineImportMember Method","pos":[0,40]}]},{"content":"Creates a reference to the specified member of a type or module that is defined outside the current scope, and defines a token for that reference.","pos":[772,918]},{"pos":[927,933],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1389,1399],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] An <bpt id=\"p1\">[</bpt>IMetaDataAssemblyImport<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyimport-interface.md)</ept> interface that represents the assembly from which the target member is imported.","pos":[1421,1623],"source":"[in] An [IMetaDataAssemblyImport](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyimport-interface.md) interface that represents the assembly from which the target member is imported."},{"content":"[in] An array that contains the hash for the assembly specified by <ph id=\"ph1\">`pAssemImport`</ph>.","pos":[1647,1729],"source":"[in] An array that contains the hash for the assembly specified by `pAssemImport`."},{"content":"[in] The number of bytes in the <ph id=\"ph1\">`pbHashValue`</ph> array.","pos":[1753,1805],"source":"[in] The number of bytes in the `pbHashValue` array."},{"content":"[in] An <bpt id=\"p1\">[</bpt>IMetaDataImport<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md)</ept> interface that represents the metadata scope from which the target member is imported.","pos":[1825,2017],"source":"[in] An [IMetaDataImport](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md) interface that represents the metadata scope from which the target member is imported."},{"content":"[in] The metadata token that specifies the target member.","pos":[2038,2095]},{"content":"The token can be an <ph id=\"ph1\">`mdMethodDef`</ph> (for a member method), <ph id=\"ph2\">`mdProperty`</ph> (for a member property), or <ph id=\"ph3\">`mdFieldDef`</ph> (for a member field) token.","pos":[2096,2234],"source":" The token can be an `mdMethodDef` (for a member method), `mdProperty` (for a member property), or `mdFieldDef` (for a member field) token."},{"content":"[in] An <bpt id=\"p1\">[</bpt>IMetaDataAssemblyEmit<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md)</ept> interface that represents the assembly into which the target member is imported.","pos":[2257,2455],"source":"[in] An [IMetaDataAssemblyEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md) interface that represents the assembly into which the target member is imported."},{"content":"[in] The <ph id=\"ph1\">`mdTypeRef`</ph> or <ph id=\"ph2\">`mdModuleRef`</ph> token for the type or module, respectively, that owns the target member.","pos":[2476,2586],"source":"[in] The `mdTypeRef` or `mdModuleRef` token for the type or module, respectively, that owns the target member."},{"content":"[out] The <ph id=\"ph1\">`mdMemberRef`</ph> token that is defined in the current scope for the member reference.","pos":[2602,2694],"source":"[out] The `mdMemberRef` token that is defined in the current scope for the member reference."},{"pos":[2703,2710],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`DefineImportMember`</ph> method looks up the member, specified by <ph id=\"ph2\">`mbMember`</ph>, that is defined in another scope, specified by <ph id=\"ph3\">`pImport`</ph>, and retrieves its properties.","pos":[2714,2879],"source":"The `DefineImportMember` method looks up the member, specified by `mbMember`, that is defined in another scope, specified by `pImport`, and retrieves its properties."},{"content":"It uses this information to call the <bpt id=\"p1\">[</bpt>IMetaDataEmit::DefineMemberRef<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definememberref-method.md)</ept> method in the current scope to create the member reference.","pos":[2880,3100],"source":" It uses this information to call the [IMetaDataEmit::DefineMemberRef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definememberref-method.md) method in the current scope to create the member reference."},{"content":"Generally, before you use the <ph id=\"ph1\">`DefineImportMember`</ph> method, you must create, in the current scope, a type reference or module reference for the target member's parent class, interface, or module.","pos":[3107,3301],"source":"Generally, before you use the `DefineImportMember` method, you must create, in the current scope, a type reference or module reference for the target member's parent class, interface, or module."},{"content":"The metadata token for this reference is then passed in the <ph id=\"ph1\">`tkParent`</ph> argument.","pos":[3302,3382],"source":" The metadata token for this reference is then passed in the `tkParent` argument."},{"content":"You do not need to create a reference to the target member's parent if it will be resolved later by the compiler or linker.","pos":[3383,3506]},{"content":"To summarize:","pos":[3507,3520]},{"pos":[3530,3960],"content":"If the target member is a field or method, use either the <bpt id=\"p1\">[</bpt>IMetaDataEmit::DefineTypeRefByName<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetyperefbyname-method.md)</ept> or the <bpt id=\"p2\">[</bpt>IMetaDataEmit::DefineImportType<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-defineimporttype-method.md)</ept> method to create a type reference, in the current scope, for the member's parent class or parent interface.","source":"If the target member is a field or method, use either the [IMetaDataEmit::DefineTypeRefByName](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetyperefbyname-method.md) or the [IMetaDataEmit::DefineImportType](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-defineimporttype-method.md) method to create a type reference, in the current scope, for the member's parent class or parent interface."},{"pos":[3970,4302],"content":"If the target member is a global variable or global function (that is, not a member of a class or interface), use the <bpt id=\"p1\">[</bpt>IMetaDataEmit::DefineModuleRef<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemoduleref-method.md)</ept> method to create a module reference, in the current scope, for the member's parent module.","source":"If the target member is a global variable or global function (that is, not a member of a class or interface), use the [IMetaDataEmit::DefineModuleRef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemoduleref-method.md) method to create a module reference, in the current scope, for the member's parent module."},{"content":"If the target member's parent will be resolved later by the compiler or linker, then pass <ph id=\"ph1\">`mdTokenNil`</ph> in <ph id=\"ph2\">`tkParent`</ph>.","pos":[4312,4429],"source":"If the target member's parent will be resolved later by the compiler or linker, then pass `mdTokenNil` in `tkParent`."},{"content":"The only scenario in which this applies is when a global function or global variable is being imported from a .obj file that will ultimately be linked into the current module and the metadata merged.","pos":[4430,4629]},{"pos":[4638,4650],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4654,4758],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4765,4782],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[4789,4835],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MSCorEE.dll","source":"**Library:** Used as a resource in MSCorEE.dll"},{"pos":[4842,4870],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[4959,4967],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[4971,5075],"source":"[IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)</ept>","pos":[5079,5184],"source":"[IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)"}]}