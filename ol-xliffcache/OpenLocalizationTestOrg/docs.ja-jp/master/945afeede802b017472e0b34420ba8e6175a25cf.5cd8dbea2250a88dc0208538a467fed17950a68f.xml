{"content":"---\ntitle: \"Operator Statement | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.operator\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"operators [Visual Basic]\"\n  - \"procedures, operator\"\n  - \"Narrowing keyword, conversion operators\"\n  - \"Visual Basic code, operators\"\n  - \"Widening keyword, conversion operators\"\n  - \"syntax, Operator procedures\"\n  - \"operators [Visual Basic], overloading\"\n  - \"overloaded operators\"\n  - \"operator overloading\"\n  - \"operator procedures\"\n  - \"Operator statement\"\n  - \"CType function, Operator statement\"\nms.assetid: b12ec4af-1ad7-4a17-865b-c5ee96320ae5\ncaps.latest.revision: 28\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Operator Statement\nDeclares the operator symbol, operands, and code that define an operator procedure on a class or structure.  \n  \n## Syntax  \n  \n```  \n[ <attrlist> ] Public [ Overloads ] Shared [ Shadows ] [ Widening | Narrowing ]   \nOperator operatorsymbol ( operand1 [, operand2 ]) [ As [ <attrlist> ] type ]  \n    [ statements ]  \n    [ statements ]  \n    Return returnvalue  \n    [ statements ]  \nEnd Operator  \n```  \n  \n## Parts  \n `attrlist`  \n Optional. See [Attribute List](../../../visual-basic/language-reference/statements/attribute-list.md).  \n  \n `Public`  \n Required. Indicates that this operator procedure has [Public](../../../visual-basic/language-reference/modifiers/public.md) access.  \n  \n `Overloads`  \n Optional. See [Overloads](../../../visual-basic/language-reference/modifiers/overloads.md).  \n  \n `Shared`  \n Required. Indicates that this operator procedure is a [Shared](../../../visual-basic/language-reference/modifiers/shared.md) procedure.  \n  \n `Shadows`  \n Optional. See [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md).  \n  \n `Widening`  \n Required for a conversion operator unless you specify `Narrowing`. Indicates that this operator procedure defines a [Widening](../../../visual-basic/language-reference/modifiers/widening.md) conversion. See \"Widening and Narrowing Conversions\" on this Help page.  \n  \n `Narrowing`  \n Required for a conversion operator unless you specify `Widening`. Indicates that this operator procedure defines a [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md) conversion. See \"Widening and Narrowing Conversions\" on this Help page.  \n  \n `operatorsymbol`  \n Required. The symbol or identifier of the operator that this operator procedure defines.  \n  \n `operand1`  \n Required. The name and type of the single operand of a unary operator (including a conversion operator) or the left operand of a binary operator.  \n  \n `operand2`  \n Required for binary operators. The name and type of the right operand of a binary operator.  \n  \n `operand1` and `operand2` have the following syntax and parts:  \n  \n `[ ByVal ] operandname [ As operandtype ]`  \n  \n|Part|Description|  \n|----------|-----------------|  \n|`ByVal`|Optional, but the passing mechanism must be [ByVal](../../../visual-basic/language-reference/modifiers/byval.md).|  \n|`operandname`|Required. Name of the variable representing this operand. See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).|  \n|`operandtype`|Optional unless `Option Strict` is `On`. Data type of this operand.|  \n  \n `type`  \n Optional unless `Option Strict` is `On`. Data type of the value the operator procedure returns.  \n  \n `statements`  \n Optional. Block of statements that the operator procedure runs.  \n  \n `returnvalue`  \n Required. The value that the operator procedure returns to the calling code.  \n  \n `End` `Operator`  \n Required. Terminates the definition of this operator procedure.  \n  \n## Remarks  \n You can use `Operator` only in a class or structure. This means the *declaration context* for an operator cannot be a source file, namespace, module, interface, procedure, or block. For more information, see [Declaration Contexts and Default Access Levels](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).  \n  \n All operators must be `Public Shared`. You cannot specify `ByRef`, `Optional`, or `ParamArray` for either operand.  \n  \n You cannot use the operator symbol or identifier to hold a return value. You must use the `Return` statement, and it must specify a value. Any number of `Return` statements can appear anywhere in the procedure.  \n  \n Defining an operator in this way is called *operator overloading*, whether or not you use the `Overloads` keyword. The following table lists the operators you can define.  \n  \n|Type|Operators|  \n|----------|---------------|  \n|Unary|`+`, `-`, `IsFalse`, `IsTrue`, `Not`|  \n|Binary|`+`, `-`, `*`, `/`, `\\`, `&`, `^`, `>>`, `<<`, `=`, `<>`, `>`, `>=`, `<`, `<=`, `And`, `Like`, `Mod`, `Or`, `Xor`|  \n|Conversion (unary)|`CType`|  \n  \n Note that the `=` operator in the binary list is the comparison operator, not the assignment operator.  \n  \n When you define `CType`, you must specify either `Widening` or `Narrowing`.  \n  \n## Matched Pairs  \n You must define certain operators as matched pairs. If you define either operator of such a pair, you must define the other as well. The matched pairs are the following:  \n  \n-   `=` and `<>`  \n  \n-   `>` and `<`  \n  \n-   `>=` and `<=`  \n  \n-   `IsTrue` and `IsFalse`  \n  \n## Data Type Restrictions  \n Every operator you define must involve the class or structure on which you define it. This means that the class or structure must appear as the data type of the following:  \n  \n-   The operand of a unary operator.  \n  \n-   At least one of the operands of a binary operator.  \n  \n-   Either the operand or the return type of a conversion operator.  \n  \n Certain operators have additional data type restrictions, as follows:  \n  \n-   If you define the `IsTrue` and `IsFalse` operators, they must both return the `Boolean` type.  \n  \n-   If you define the `<<` and `>>` operators, they must both specify the `Integer` type for the `operandtype` of `operand2`.  \n  \n The return type does not have to correspond to the type of either operand. For example, a comparison operator such as `=` or `<>` can return `Boolean` even if neither operand is `Boolean`.  \n  \n## Logical and Bitwise Operators  \n The `And`, `Or`, `Not`, and `Xor` operators can perform either logical or bitwise operations in Visual Basic. However, if you define one of these operators on a class or structure, you can define only its bitwise operation.  \n  \n You cannot define the `AndAlso` operator directly with an `Operator` statement. However, you can use `AndAlso` if you have fulfilled the following conditions:  \n  \n-   You have defined `And` on the same operand types you want to use for `AndAlso`.  \n  \n-   Your definition of `And` returns the same type as the class or structure on which you have defined it.  \n  \n-   You have defined the `IsFalse` operator on the class or structure on which you have defined `And`.  \n  \n Similarly, you can use `OrElse` if you have defined `Or` on the same operands, with the return type of the class or structure, and you have defined `IsTrue` on the class or structure.  \n  \n## Widening and Narrowing Conversions  \n A *widening conversion* always succeeds at run time, while a *narrowing conversion* can fail at run time. For more information, see [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).  \n  \n If you declare a conversion procedure to be `Widening`, your procedure code must not generate any failures. This means the following:  \n  \n-   It must always return a valid value of type `type`.  \n  \n-   It must handle all possible exceptions and other error conditions.  \n  \n-   It must handle any error returns from any procedures it calls.  \n  \n If there is any possibility that a conversion procedure might not succeed, or that it might cause an unhandled exception, you must declare it to be `Narrowing`.  \n  \n## Example  \n The following code example uses the `Operator` statement to define the outline of a structure that includes operator procedures for the `And`, `Or`, `IsFalse`, and `IsTrue` operators. `And` and `Or` each take two operands of type `abc` and return type `abc`. `IsFalse` and `IsTrue` each take a single operand of type `abc` and return `Boolean`. These definitions allow the calling code to use `And`, `AndAlso`, `Or`, and `OrElse` with operands of type `abc`.  \n  \n [!code-vb[VbVbalrStatements#44](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/operator-statement_1.vb)]  \n  \n## See Also  \n [IsFalse Operator](../../../visual-basic/language-reference/operators/isfalse-operator.md)   \n [IsTrue Operator](../../../visual-basic/language-reference/operators/istrue-operator.md)   \n [Widening](../../../visual-basic/language-reference/modifiers/widening.md)   \n [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md)   \n [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)   \n [Operator Procedures](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md)   \n [How to: Define an Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-an-operator.md)   \n [How to: Define a Conversion Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)   \n [How to: Call an Operator Procedure](../../../visual-basic/programming-guide/language-features/procedures/how-to-call-an-operator-procedure.md)   \n [How to: Use a Class that Defines Operators](../../../visual-basic/programming-guide/language-features/procedures/how-to-use-a-class-that-defines-operators.md)\n","nodes":[{"pos":[4,962],"nodes":[{"content":"Operator Statement | Microsoft Docs","nodes":[{"pos":[0,35],"content":"Operator Statement | Microsoft Docs","nodes":[{"content":"Operator Statement | Microsoft Docs","pos":[0,35]}]}],"pos":[6,44],"yaml":true}],"content":"title: \"Operator Statement | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.operator\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"operators [Visual Basic]\"\n  - \"procedures, operator\"\n  - \"Narrowing keyword, conversion operators\"\n  - \"Visual Basic code, operators\"\n  - \"Widening keyword, conversion operators\"\n  - \"syntax, Operator procedures\"\n  - \"operators [Visual Basic], overloading\"\n  - \"overloaded operators\"\n  - \"operator overloading\"\n  - \"operator procedures\"\n  - \"Operator statement\"\n  - \"CType function, Operator statement\"\nms.assetid: b12ec4af-1ad7-4a17-865b-c5ee96320ae5\ncaps.latest.revision: 28\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[969,987],"content":"Operator Statement","linkify":"Operator Statement","nodes":[{"content":"Operator Statement","pos":[0,18]}]},{"content":"Declares the operator symbol, operands, and code that define an operator procedure on a class or structure.","pos":[988,1095]},{"pos":[1104,1110],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1399,1404],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Optional.","pos":[1422,1431]},{"content":"See <bpt id=\"p1\">[</bpt>Attribute List<ept id=\"p1\">](../../../visual-basic/language-reference/statements/attribute-list.md)</ept>.","pos":[1432,1524],"source":" See [Attribute List](../../../visual-basic/language-reference/statements/attribute-list.md)."},{"content":"Required.","pos":[1543,1552]},{"content":"Indicates that this operator procedure has <bpt id=\"p1\">[</bpt>Public<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/public.md)</ept> access.","pos":[1553,1674],"source":" Indicates that this operator procedure has [Public](../../../visual-basic/language-reference/modifiers/public.md) access."},{"content":"Optional.","pos":[1696,1705]},{"content":"See <bpt id=\"p1\">[</bpt>Overloads<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/overloads.md)</ept>.","pos":[1706,1787],"source":" See [Overloads](../../../visual-basic/language-reference/modifiers/overloads.md)."},{"content":"Required.","pos":[1806,1815]},{"content":"Indicates that this operator procedure is a <bpt id=\"p1\">[</bpt>Shared<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/shared.md)</ept> procedure.","pos":[1816,1941],"source":" Indicates that this operator procedure is a [Shared](../../../visual-basic/language-reference/modifiers/shared.md) procedure."},{"content":"Optional.","pos":[1961,1970]},{"content":"See <bpt id=\"p1\">[</bpt>Shadows<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/shadows.md)</ept>.","pos":[1971,2048],"source":" See [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md)."},{"content":"Required for a conversion operator unless you specify <ph id=\"ph1\">`Narrowing`</ph>.","pos":[2069,2135],"source":"Required for a conversion operator unless you specify `Narrowing`."},{"content":"Indicates that this operator procedure defines a <bpt id=\"p1\">[</bpt>Widening<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/widening.md)</ept> conversion.","pos":[2136,2271],"source":" Indicates that this operator procedure defines a [Widening](../../../visual-basic/language-reference/modifiers/widening.md) conversion."},{"content":"See \"Widening and Narrowing Conversions\" on this Help page.","pos":[2272,2331]},{"content":"Required for a conversion operator unless you specify <ph id=\"ph1\">`Widening`</ph>.","pos":[2353,2418],"source":"Required for a conversion operator unless you specify `Widening`."},{"content":"Indicates that this operator procedure defines a <bpt id=\"p1\">[</bpt>Narrowing<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/narrowing.md)</ept> conversion.","pos":[2419,2556],"source":" Indicates that this operator procedure defines a [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md) conversion."},{"content":"See \"Widening and Narrowing Conversions\" on this Help page.","pos":[2557,2616]},{"content":"Required.","pos":[2643,2652]},{"content":"The symbol or identifier of the operator that this operator procedure defines.","pos":[2653,2731]},{"content":"Required.","pos":[2752,2761]},{"content":"The name and type of the single operand of a unary operator (including a conversion operator) or the left operand of a binary operator.","pos":[2762,2897]},{"content":"Required for binary operators.","pos":[2918,2948]},{"content":"The name and type of the right operand of a binary operator.","pos":[2949,3009]},{"pos":[3016,3078],"content":"<ph id=\"ph1\">`operand1`</ph> and <ph id=\"ph2\">`operand2`</ph> have the following syntax and parts:","source":"`operand1` and `operand2` have the following syntax and parts:"},{"content":"Part","pos":[3134,3138]},{"content":"Description","pos":[3139,3150]},{"pos":[3196,3309],"content":"Optional, but the passing mechanism must be <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/byval.md)</ept>.","source":"Optional, but the passing mechanism must be [ByVal](../../../visual-basic/language-reference/modifiers/byval.md)."},{"content":"Required.","pos":[3328,3337]},{"content":"Name of the variable representing this operand.","pos":[3338,3385]},{"content":"See <bpt id=\"p1\">[</bpt>Declared Element Names<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)</ept>.","pos":[3386,3518],"source":" See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)."},{"content":"Optional unless <ph id=\"ph1\">`Option Strict`</ph> is <ph id=\"ph2\">`On`</ph>.","pos":[3537,3577],"source":"Optional unless `Option Strict` is `On`."},{"content":"Data type of this operand.","pos":[3578,3604]},{"content":"Optional unless <ph id=\"ph1\">`Option Strict`</ph> is <ph id=\"ph2\">`On`</ph>.","pos":[3622,3662],"source":"Optional unless `Option Strict` is `On`."},{"content":"Data type of the value the operator procedure returns.","pos":[3663,3717]},{"content":"Optional.","pos":[3740,3749]},{"content":"Block of statements that the operator procedure runs.","pos":[3750,3803]},{"content":"Required.","pos":[3827,3836]},{"content":"The value that the operator procedure returns to the calling code.","pos":[3837,3903]},{"content":"<ph id=\"ph1\">`End`</ph> <ph id=\"ph2\">`Operator`</ph>","pos":[3910,3926],"source":"`End` `Operator`"},{"content":"Required.","pos":[3930,3939]},{"content":"Terminates the definition of this operator procedure.","pos":[3940,3993]},{"pos":[4002,4009],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can use <ph id=\"ph1\">`Operator`</ph> only in a class or structure.","pos":[4013,4065],"source":"You can use `Operator` only in a class or structure."},{"content":"This means the <bpt id=\"p1\">*</bpt>declaration context<ept id=\"p1\">*</ept> for an operator cannot be a source file, namespace, module, interface, procedure, or block.","pos":[4066,4194],"source":" This means the *declaration context* for an operator cannot be a source file, namespace, module, interface, procedure, or block."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Declaration Contexts and Default Access Levels<ept id=\"p1\">](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md)</ept>.","pos":[4195,4373],"source":" For more information, see [Declaration Contexts and Default Access Levels](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md)."},{"content":"All operators must be <ph id=\"ph1\">`Public Shared`</ph>.","pos":[4380,4418],"source":"All operators must be `Public Shared`."},{"content":"You cannot specify <ph id=\"ph1\">`ByRef`</ph>, <ph id=\"ph2\">`Optional`</ph>, or <ph id=\"ph3\">`ParamArray`</ph> for either operand.","pos":[4419,4494],"source":" You cannot specify `ByRef`, `Optional`, or `ParamArray` for either operand."},{"content":"You cannot use the operator symbol or identifier to hold a return value.","pos":[4501,4573]},{"content":"You must use the <ph id=\"ph1\">`Return`</ph> statement, and it must specify a value.","pos":[4574,4639],"source":" You must use the `Return` statement, and it must specify a value."},{"content":"Any number of <ph id=\"ph1\">`Return`</ph> statements can appear anywhere in the procedure.","pos":[4640,4711],"source":" Any number of `Return` statements can appear anywhere in the procedure."},{"content":"Defining an operator in this way is called <bpt id=\"p1\">*</bpt>operator overloading<ept id=\"p1\">*</ept>, whether or not you use the <ph id=\"ph1\">`Overloads`</ph> keyword.","pos":[4718,4832],"source":"Defining an operator in this way is called *operator overloading*, whether or not you use the `Overloads` keyword."},{"content":"The following table lists the operators you can define.","pos":[4833,4888]},{"content":"Type","pos":[4895,4899]},{"content":"Operators","pos":[4900,4909]},{"content":"Unary","pos":[4945,4950]},{"pos":[4951,4987],"content":"<ph id=\"ph1\">`+`</ph>, <ph id=\"ph2\">`-`</ph>, <ph id=\"ph3\">`IsFalse`</ph>, <ph id=\"ph4\">`IsTrue`</ph>, <ph id=\"ph5\">`Not`</ph>","source":"`+`, `-`, `IsFalse`, `IsTrue`, `Not`"},{"content":"Binary","pos":[4992,4998]},{"pos":[4999,5112],"content":"<ph id=\"ph1\">`+`</ph>, <ph id=\"ph2\">`-`</ph>, <ph id=\"ph3\">`*`</ph>, <ph id=\"ph4\">`/`</ph>, <ph id=\"ph5\">`\\`</ph>, <ph id=\"ph6\">`&amp;`</ph>, <ph id=\"ph7\">`^`</ph>, <ph id=\"ph8\">`&gt;&gt;`</ph>, <ph id=\"ph9\">`&lt;&lt;`</ph>, <ph id=\"ph10\">`=`</ph>, <ph id=\"ph11\">`&lt;&gt;`</ph>, <ph id=\"ph12\">`&gt;`</ph>, <ph id=\"ph13\">`&gt;=`</ph>, <ph id=\"ph14\">`&lt;`</ph>, <ph id=\"ph15\">`&lt;=`</ph>, <ph id=\"ph16\">`And`</ph>, <ph id=\"ph17\">`Like`</ph>, <ph id=\"ph18\">`Mod`</ph>, <ph id=\"ph19\">`Or`</ph>, <ph id=\"ph20\">`Xor`</ph>","source":"`+`, `-`, `*`, `/`, `\\`, `&`, `^`, `>>`, `<<`, `=`, `<>`, `>`, `>=`, `<`, `<=`, `And`, `Like`, `Mod`, `Or`, `Xor`"},{"content":"Conversion (unary)","pos":[5117,5135]},{"pos":[5151,5253],"content":"Note that the <ph id=\"ph1\">`=`</ph> operator in the binary list is the comparison operator, not the assignment operator.","source":"Note that the `=` operator in the binary list is the comparison operator, not the assignment operator."},{"pos":[5260,5335],"content":"When you define <ph id=\"ph1\">`CType`</ph>, you must specify either <ph id=\"ph2\">`Widening`</ph> or <ph id=\"ph3\">`Narrowing`</ph>.","source":"When you define `CType`, you must specify either `Widening` or `Narrowing`."},{"pos":[5344,5357],"content":"Matched Pairs","linkify":"Matched Pairs","nodes":[{"content":"Matched Pairs","pos":[0,13]}]},{"content":"You must define certain operators as matched pairs.","pos":[5361,5412]},{"content":"If you define either operator of such a pair, you must define the other as well.","pos":[5413,5493]},{"content":"The matched pairs are the following:","pos":[5494,5530]},{"pos":[5540,5552],"content":"<ph id=\"ph1\">`=`</ph> and <ph id=\"ph2\">`&lt;&gt;`</ph>","source":"`=` and `<>`"},{"pos":[5562,5573],"content":"<ph id=\"ph1\">`&gt;`</ph> and <ph id=\"ph2\">`&lt;`</ph>","source":"`>` and `<`"},{"pos":[5583,5596],"content":"<ph id=\"ph1\">`&gt;=`</ph> and <ph id=\"ph2\">`&lt;=`</ph>","source":"`>=` and `<=`"},{"pos":[5606,5628],"content":"<ph id=\"ph1\">`IsTrue`</ph> and <ph id=\"ph2\">`IsFalse`</ph>","source":"`IsTrue` and `IsFalse`"},{"pos":[5637,5659],"content":"Data Type Restrictions","linkify":"Data Type Restrictions","nodes":[{"content":"Data Type Restrictions","pos":[0,22]}]},{"content":"Every operator you define must involve the class or structure on which you define it.","pos":[5663,5748]},{"content":"This means that the class or structure must appear as the data type of the following:","pos":[5749,5834]},{"content":"The operand of a unary operator.","pos":[5844,5876]},{"content":"At least one of the operands of a binary operator.","pos":[5886,5936]},{"content":"Either the operand or the return type of a conversion operator.","pos":[5946,6009]},{"content":"Certain operators have additional data type restrictions, as follows:","pos":[6016,6085]},{"pos":[6095,6188],"content":"If you define the <ph id=\"ph1\">`IsTrue`</ph> and <ph id=\"ph2\">`IsFalse`</ph> operators, they must both return the <ph id=\"ph3\">`Boolean`</ph> type.","source":"If you define the `IsTrue` and `IsFalse` operators, they must both return the `Boolean` type."},{"pos":[6198,6319],"content":"If you define the <ph id=\"ph1\">`&lt;&lt;`</ph> and <ph id=\"ph2\">`&gt;&gt;`</ph> operators, they must both specify the <ph id=\"ph3\">`Integer`</ph> type for the <ph id=\"ph4\">`operandtype`</ph> of <ph id=\"ph5\">`operand2`</ph>.","source":"If you define the `<<` and `>>` operators, they must both specify the `Integer` type for the `operandtype` of `operand2`."},{"content":"The return type does not have to correspond to the type of either operand.","pos":[6326,6400]},{"content":"For example, a comparison operator such as <ph id=\"ph1\">`=`</ph> or <ph id=\"ph2\">`&lt;&gt;`</ph> can return <ph id=\"ph3\">`Boolean`</ph> even if neither operand is <ph id=\"ph4\">`Boolean`</ph>.","pos":[6401,6514],"source":" For example, a comparison operator such as `=` or `<>` can return `Boolean` even if neither operand is `Boolean`."},{"pos":[6523,6552],"content":"Logical and Bitwise Operators","linkify":"Logical and Bitwise Operators","nodes":[{"content":"Logical and Bitwise Operators","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">`And`</ph>, <ph id=\"ph2\">`Or`</ph>, <ph id=\"ph3\">`Not`</ph>, and <ph id=\"ph4\">`Xor`</ph> operators can perform either logical or bitwise operations in Visual Basic.","pos":[6556,6665],"source":"The `And`, `Or`, `Not`, and `Xor` operators can perform either logical or bitwise operations in Visual Basic."},{"content":"However, if you define one of these operators on a class or structure, you can define only its bitwise operation.","pos":[6666,6779]},{"content":"You cannot define the <ph id=\"ph1\">`AndAlso`</ph> operator directly with an <ph id=\"ph2\">`Operator`</ph> statement.","pos":[6786,6865],"source":"You cannot define the `AndAlso` operator directly with an `Operator` statement."},{"content":"However, you can use <ph id=\"ph1\">`AndAlso`</ph> if you have fulfilled the following conditions:","pos":[6866,6944],"source":" However, you can use `AndAlso` if you have fulfilled the following conditions:"},{"pos":[6954,7033],"content":"You have defined <ph id=\"ph1\">`And`</ph> on the same operand types you want to use for <ph id=\"ph2\">`AndAlso`</ph>.","source":"You have defined `And` on the same operand types you want to use for `AndAlso`."},{"pos":[7043,7145],"content":"Your definition of <ph id=\"ph1\">`And`</ph> returns the same type as the class or structure on which you have defined it.","source":"Your definition of `And` returns the same type as the class or structure on which you have defined it."},{"pos":[7155,7253],"content":"You have defined the <ph id=\"ph1\">`IsFalse`</ph> operator on the class or structure on which you have defined <ph id=\"ph2\">`And`</ph>.","source":"You have defined the `IsFalse` operator on the class or structure on which you have defined `And`."},{"pos":[7260,7443],"content":"Similarly, you can use <ph id=\"ph1\">`OrElse`</ph> if you have defined <ph id=\"ph2\">`Or`</ph> on the same operands, with the return type of the class or structure, and you have defined <ph id=\"ph3\">`IsTrue`</ph> on the class or structure.","source":"Similarly, you can use `OrElse` if you have defined `Or` on the same operands, with the return type of the class or structure, and you have defined `IsTrue` on the class or structure."},{"pos":[7452,7486],"content":"Widening and Narrowing Conversions","linkify":"Widening and Narrowing Conversions","nodes":[{"content":"Widening and Narrowing Conversions","pos":[0,34]}]},{"content":"A <bpt id=\"p1\">*</bpt>widening conversion<ept id=\"p1\">*</ept> always succeeds at run time, while a <bpt id=\"p2\">*</bpt>narrowing conversion<ept id=\"p2\">*</ept> can fail at run time.","pos":[7490,7595],"source":"A *widening conversion* always succeeds at run time, while a *narrowing conversion* can fail at run time."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>.","pos":[7596,7767],"source":" For more information, see [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)."},{"content":"If you declare a conversion procedure to be <ph id=\"ph1\">`Widening`</ph>, your procedure code must not generate any failures.","pos":[7774,7881],"source":"If you declare a conversion procedure to be `Widening`, your procedure code must not generate any failures."},{"content":"This means the following:","pos":[7882,7907]},{"pos":[7917,7968],"content":"It must always return a valid value of type <ph id=\"ph1\">`type`</ph>.","source":"It must always return a valid value of type `type`."},{"content":"It must handle all possible exceptions and other error conditions.","pos":[7978,8044]},{"content":"It must handle any error returns from any procedures it calls.","pos":[8054,8116]},{"pos":[8123,8283],"content":"If there is any possibility that a conversion procedure might not succeed, or that it might cause an unhandled exception, you must declare it to be <ph id=\"ph1\">`Narrowing`</ph>.","source":"If there is any possibility that a conversion procedure might not succeed, or that it might cause an unhandled exception, you must declare it to be `Narrowing`."},{"pos":[8292,8299],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example uses the <ph id=\"ph1\">`Operator`</ph> statement to define the outline of a structure that includes operator procedures for the <ph id=\"ph2\">`And`</ph>, <ph id=\"ph3\">`Or`</ph>, <ph id=\"ph4\">`IsFalse`</ph>, and <ph id=\"ph5\">`IsTrue`</ph> operators.","pos":[8303,8486],"source":"The following code example uses the `Operator` statement to define the outline of a structure that includes operator procedures for the `And`, `Or`, `IsFalse`, and `IsTrue` operators."},{"content":"<ph id=\"ph1\">`And`</ph> and <ph id=\"ph2\">`Or`</ph> each take two operands of type <ph id=\"ph3\">`abc`</ph> and return type <ph id=\"ph4\">`abc`</ph>.","pos":[8487,8561],"source":"`And` and `Or` each take two operands of type `abc` and return type `abc`."},{"content":"<ph id=\"ph1\">`IsFalse`</ph> and <ph id=\"ph2\">`IsTrue`</ph> each take a single operand of type <ph id=\"ph3\">`abc`</ph> and return <ph id=\"ph4\">`Boolean`</ph>.","pos":[8562,8647],"source":"`IsFalse` and `IsTrue` each take a single operand of type `abc` and return `Boolean`."},{"content":"These definitions allow the calling code to use <ph id=\"ph1\">`And`</ph>, <ph id=\"ph2\">`AndAlso`</ph>, <ph id=\"ph3\">`Or`</ph>, and <ph id=\"ph4\">`OrElse`</ph> with operands of type <ph id=\"ph5\">`abc`</ph>.","pos":[8648,8761],"source":" These definitions allow the calling code to use `And`, `AndAlso`, `Or`, and `OrElse` with operands of type `abc`."},{"pos":[8768,8905],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#44<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/operator-statement_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#44](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/operator-statement_1.vb)]"},{"pos":[8914,8922],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IsFalse Operator<ept id=\"p1\">](../../../visual-basic/language-reference/operators/isfalse-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[8926,9017],"source":"[IsFalse Operator](../../../visual-basic/language-reference/operators/isfalse-operator.md) "},{"content":"<bpt id=\"p1\">[</bpt>IsTrue Operator<ept id=\"p1\">](../../../visual-basic/language-reference/operators/istrue-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[9021,9110],"source":"[IsTrue Operator](../../../visual-basic/language-reference/operators/istrue-operator.md) "},{"content":"<bpt id=\"p1\">[</bpt>Widening<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/widening.md)</ept><ph id=\"ph1\"> </ph>","pos":[9114,9189],"source":"[Widening](../../../visual-basic/language-reference/modifiers/widening.md) "},{"content":"<bpt id=\"p1\">[</bpt>Narrowing<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/narrowing.md)</ept><ph id=\"ph1\"> </ph>","pos":[9193,9270],"source":"[Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md) "},{"content":"<bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept><ph id=\"ph1\"> </ph>","pos":[9274,9419],"source":"[Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md) "},{"content":"<bpt id=\"p1\">[</bpt>Operator Procedures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md)</ept><ph id=\"ph1\"> </ph>","pos":[9423,9538],"source":"[Operator Procedures](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Define an Operator<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-an-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[9542,9670],"source":"[How to: Define an Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-an-operator.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Define a Conversion Operator<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[9674,9822],"source":"[How to: Define a Conversion Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Call an Operator Procedure<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/how-to-call-an-operator-procedure.md)</ept><ph id=\"ph1\"> </ph>","pos":[9826,9970],"source":"[How to: Call an Operator Procedure](../../../visual-basic/programming-guide/language-features/procedures/how-to-call-an-operator-procedure.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Use a Class that Defines Operators<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/how-to-use-a-class-that-defines-operators.md)</ept>","pos":[9974,10133],"source":"[How to: Use a Class that Defines Operators](../../../visual-basic/programming-guide/language-features/procedures/how-to-use-a-class-that-defines-operators.md)"}]}