{"content":"---\ntitle: \"Write LINQ queries in C#\"\ndescription: How to write queries.\nkeywords: .NET, .NET Core, C#\nauthor: BillWagner\nmanager: wpickett\nms.author: wiwagn\nms.date: 12/1/2016\nms.topic: article\nms.prod: .net-core\nms.technology: .net-core-technologies\nms.devlang: dotnet\nms.assetid: 30703f79-cf3a-4d02-b892-c95d58a1d9ed\n---\n\n# Write LINQ queries in C#\n\nThis topic shows the three ways in which you can write a LINQ query in C#:  \n  \n1.  Use query syntax.  \n  \n2.  Use method syntax.  \n  \n3.  Use a combination of query syntax and method syntax.  \n  \n The following examples demonstrate some simple LINQ queries by using each approach listed previously. In general, the rule is to use (1) whenever possible, and use (2) and (3) whenever necessary.  \n  \n> [!NOTE]\n>  These queries operate on simple in-memory collections; however, the basic syntax is identical to that used in LINQ to Entities and LINQ to XML.  \n  \n## Example  \n  \n## Query syntax  \n The recommended way to write most queries is to use *query syntax* to create *query expressions*. The following example shows three query expressions. The first query expression demonstrates how to filter or restrict results by applying conditions with a `where` clause. It returns all elements in the source sequence whose values are greater than 7 or less than 3. The second expression demonstrates how to order the returned results. The third expression demonstrates how to group results according to a key. This query returns two groups based on the first letter of the word.  \n  \n [!code-cs[csProgGuideLINQ#5](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_1.cs)]  \n  \n Note that the type of the queries is <xref:System.Collections.Generic.IEnumerable%601>. All of these queries could be written using `var` as shown in the following example:  \n  \n `var query = from num in numbers...`  \n  \n In each previous example, the queries do not actually execute until you iterate over the query variable in a `foreach` statement or other statement. For more information, see [Introduction to LINQ Queries](../programming-guide/concepts/linq/introduction-to-linq-queries.md).  \n  \n## Example  \n  \n## Method syntax  \n Some query operations must be expressed as a method call. The most common such methods are those that return singleton numeric values, such as <xref:System.Linq.Enumerable.Sum%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, <xref:System.Linq.Enumerable.Average%2A>, and so on. These methods must always be called last in any query because they represent only a single value and cannot serve as the source for an additional query operation. The following example shows a method call in a query expression:  \n  \n [!code-cs[csProgGuideLINQ#6](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_2.cs)]  \n  \n## Example  \n If the method has  Action or Func parameters, these are provided in the form of a [lambda](../programming-guide/statements-expressions-operators/lambda-expressions.md) expression, as shown in the following example:  \n  \n [!code-cs[csProgGuideLINQ#7](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_3.cs)]  \n  \n In the previous queries, only Query #4 executes immediately. This is because it returns a single value, and not a generic <xref:System.Collections.Generic.IEnumerable%601> collection. The method itself has to use `foreach` in order to compute its value.  \n  \n Each of the previous queries can be written by using implicit typing with [var](../language-reference/keywords/var.md), as shown in the following example:  \n  \n [!code-cs[csProgGuideLINQ#8](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_4.cs)]  \n  \n## Example  \n  \n## Mixed query and method syntax  \n This example shows how to use method syntax on the results of a query clause. Just enclose the query expression in parentheses, and then apply the dot operator and call the method. In the following example, query #7 returns a count of the numbers whose value is between 3 and 7. In general, however, it is better to use a second variable to store the result of the method call. In this manner, the query is less likely to be confused with the results of the query.  \n  \n [!code-cs[csProgGuideLINQ#9](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_5.cs)]  \n  \n Because Query #7 returns a single value and not a collection, the query executes immediately.  \n  \n The previous query can be written by using implicit typing with `var`, as follows:  \n  \n```csharp  \nvar numCount = (from num in numbers...  \n```  \n  \n It can be written in method syntax as follows:  \n  \n```csharp  \nvar numCount = numbers.Where(n => n < 3 || n > 7).Count();  \n```  \n  \n It can be written by using explicit typing, as follows:  \n  \n```csharp  \nint numCount = numbers.Where(n => n < 3 || n > 7).Count();  \n```  \n  \n## See Also  \n  [Walkthrough: Writing Queries in C#](../programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)   \n [LINQ Query Expressions](index.md)   \n [where clause](../language-reference/keywords/where-clause.md)","nodes":[{"pos":[4,319],"nodes":[{"content":"Write LINQ queries in C#","nodes":[{"pos":[0,24],"content":"Write LINQ queries in C#","nodes":[{"content":"Write LINQ queries in C#","pos":[0,24]}]}],"pos":[6,33],"yaml":true},{"content":"How to write queries.","nodes":[{"pos":[0,21],"content":"How to write queries.","nodes":[{"content":"How to write queries.","pos":[0,21]}]}],"pos":[46,68],"yaml":true},{"content":".NET, .NET Core, C#","nodes":[{"pos":[0,19],"content":".NET, .NET Core, C#","nodes":[{"content":".NET, .NET Core, C#","pos":[0,19]}]}],"pos":[78,98],"yaml":true}],"content":"title: \"Write LINQ queries in C#\"\ndescription: How to write queries.\nkeywords: .NET, .NET Core, C#\nauthor: BillWagner\nmanager: wpickett\nms.author: wiwagn\nms.date: 12/1/2016\nms.topic: article\nms.prod: .net-core\nms.technology: .net-core-technologies\nms.devlang: dotnet\nms.assetid: 30703f79-cf3a-4d02-b892-c95d58a1d9ed","yamlblock":true},{"pos":[327,351],"content":"Write LINQ queries in C#","linkify":"Write LINQ queries in C#","nodes":[{"content":"Write LINQ queries in C#","pos":[0,24]}]},{"content":"This topic shows the three ways in which you can write a LINQ query in C#:","pos":[353,427]},{"content":"Use query syntax.","pos":[437,454]},{"content":"Use method syntax.","pos":[464,482]},{"content":"Use a combination of query syntax and method syntax.","pos":[492,544]},{"content":"The following examples demonstrate some simple LINQ queries by using each approach listed previously.","pos":[551,652]},{"content":"In general, the rule is to use (1) whenever possible, and use (2) and (3) whenever necessary.","pos":[653,746]},{"pos":[754,908],"content":"[!NOTE]\n These queries operate on simple in-memory collections; however, the basic syntax is identical to that used in LINQ to Entities and LINQ to XML.","leadings":["","> "],"nodes":[{"content":"These queries operate on simple in-memory collections; however, the basic syntax is identical to that used in LINQ to Entities and LINQ to XML.","pos":[9,152]}]},{"pos":[917,924],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[933,945],"content":"Query syntax","linkify":"Query syntax","nodes":[{"content":"Query syntax","pos":[0,12]}]},{"content":"The recommended way to write most queries is to use <bpt id=\"p1\">*</bpt>query syntax<ept id=\"p1\">*</ept> to create <bpt id=\"p2\">*</bpt>query expressions<ept id=\"p2\">*</ept>.","pos":[949,1046],"source":"The recommended way to write most queries is to use *query syntax* to create *query expressions*."},{"content":"The following example shows three query expressions.","pos":[1047,1099]},{"content":"The first query expression demonstrates how to filter or restrict results by applying conditions with a <ph id=\"ph1\">`where`</ph> clause.","pos":[1100,1219],"source":" The first query expression demonstrates how to filter or restrict results by applying conditions with a `where` clause."},{"content":"It returns all elements in the source sequence whose values are greater than 7 or less than 3.","pos":[1220,1314]},{"content":"The second expression demonstrates how to order the returned results.","pos":[1315,1384]},{"content":"The third expression demonstrates how to group results according to a key.","pos":[1385,1459]},{"content":"This query returns two groups based on the first letter of the word.","pos":[1460,1528]},{"pos":[1535,1643],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideLINQ#5<ept id=\"p2\">](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_1.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideLINQ#5](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_1.cs)]"},{"content":"Note that the type of the queries is <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","pos":[1650,1737],"source":"Note that the type of the queries is <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"All of these queries could be written using <ph id=\"ph1\">`var`</ph> as shown in the following example:","pos":[1738,1822],"source":" All of these queries could be written using `var` as shown in the following example:"},{"content":"In each previous example, the queries do not actually execute until you iterate over the query variable in a <ph id=\"ph1\">`foreach`</ph> statement or other statement.","pos":[1872,2020],"source":"In each previous example, the queries do not actually execute until you iterate over the query variable in a `foreach` statement or other statement."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Introduction to LINQ Queries<ept id=\"p1\">](../programming-guide/concepts/linq/introduction-to-linq-queries.md)</ept>.","pos":[2021,2146],"source":" For more information, see [Introduction to LINQ Queries](../programming-guide/concepts/linq/introduction-to-linq-queries.md)."},{"pos":[2155,2162],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2171,2184],"content":"Method syntax","linkify":"Method syntax","nodes":[{"content":"Method syntax","pos":[0,13]}]},{"content":"Some query operations must be expressed as a method call.","pos":[2188,2245]},{"content":"The most common such methods are those that return singleton numeric values, such as <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph>, and so on.","pos":[2246,2497],"source":" The most common such methods are those that return singleton numeric values, such as <xref:System.Linq.Enumerable.Sum%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, <xref:System.Linq.Enumerable.Average%2A>, and so on."},{"content":"These methods must always be called last in any query because they represent only a single value and cannot serve as the source for an additional query operation.","pos":[2498,2660]},{"content":"The following example shows a method call in a query expression:","pos":[2661,2725]},{"pos":[2732,2840],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideLINQ#6<ept id=\"p2\">](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_2.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideLINQ#6](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_2.cs)]"},{"pos":[2849,2856],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2860,3074],"content":"If the method has  Action or Func parameters, these are provided in the form of a <bpt id=\"p1\">[</bpt>lambda<ept id=\"p1\">](../programming-guide/statements-expressions-operators/lambda-expressions.md)</ept> expression, as shown in the following example:","source":"If the method has  Action or Func parameters, these are provided in the form of a [lambda](../programming-guide/statements-expressions-operators/lambda-expressions.md) expression, as shown in the following example:"},{"pos":[3081,3189],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideLINQ#7<ept id=\"p2\">](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_3.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideLINQ#7](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_3.cs)]"},{"content":"In the previous queries, only Query #4 executes immediately.","pos":[3196,3256]},{"content":"This is because it returns a single value, and not a generic <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> collection.","pos":[3257,3379],"source":" This is because it returns a single value, and not a generic <xref:System.Collections.Generic.IEnumerable%601> collection."},{"content":"The method itself has to use <ph id=\"ph1\">`foreach`</ph> in order to compute its value.","pos":[3380,3449],"source":" The method itself has to use `foreach` in order to compute its value."},{"pos":[3456,3610],"content":"Each of the previous queries can be written by using implicit typing with <bpt id=\"p1\">[</bpt>var<ept id=\"p1\">](../language-reference/keywords/var.md)</ept>, as shown in the following example:","source":"Each of the previous queries can be written by using implicit typing with [var](../language-reference/keywords/var.md), as shown in the following example:"},{"pos":[3617,3725],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideLINQ#8<ept id=\"p2\">](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_4.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideLINQ#8](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_4.cs)]"},{"pos":[3734,3741],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3750,3779],"content":"Mixed query and method syntax","linkify":"Mixed query and method syntax","nodes":[{"content":"Mixed query and method syntax","pos":[0,29]}]},{"content":"This example shows how to use method syntax on the results of a query clause.","pos":[3783,3860]},{"content":"Just enclose the query expression in parentheses, and then apply the dot operator and call the method.","pos":[3861,3963]},{"content":"In the following example, query #7 returns a count of the numbers whose value is between 3 and 7.","pos":[3964,4061]},{"content":"In general, however, it is better to use a second variable to store the result of the method call.","pos":[4062,4160]},{"content":"In this manner, the query is less likely to be confused with the results of the query.","pos":[4161,4247]},{"pos":[4254,4362],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideLINQ#9<ept id=\"p2\">](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_5.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideLINQ#9](../../../samples/snippets/csharp/concepts/linq/how-to-write-linq-queries_5.cs)]"},{"content":"Because Query #7 returns a single value and not a collection, the query executes immediately.","pos":[4369,4462]},{"pos":[4469,4551],"content":"The previous query can be written by using implicit typing with <ph id=\"ph1\">`var`</ph>, as follows:","source":"The previous query can be written by using implicit typing with `var`, as follows:"},{"content":"It can be written in method syntax as follows:","pos":[4620,4666]},{"content":"It can be written by using explicit typing, as follows:","pos":[4755,4810]},{"pos":[4901,4909],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Writing Queries in C#<ept id=\"p1\">](../programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[4914,5023],"source":"[Walkthrough: Writing Queries in C#](../programming-guide/concepts/linq/walkthrough-writing-queries-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>LINQ Query Expressions<ept id=\"p1\">](index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5027,5062],"source":"[LINQ Query Expressions](index.md) "},{"content":"<bpt id=\"p1\">[</bpt>where clause<ept id=\"p1\">](../language-reference/keywords/where-clause.md)</ept>","pos":[5066,5128],"source":"[where clause](../language-reference/keywords/where-clause.md)"}]}