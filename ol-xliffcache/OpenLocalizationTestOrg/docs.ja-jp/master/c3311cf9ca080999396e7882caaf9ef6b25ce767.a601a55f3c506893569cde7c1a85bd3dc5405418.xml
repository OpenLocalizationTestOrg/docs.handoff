{"content":"---\ntitle: \"Data and Data Objects | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"data transfer [WPF], drag-and-drop\"\n  - \"DataFormats class [WPF]\"\n  - \"DataObject class [WPF]\"\nms.assetid: 5967d557-1867-420f-a524-ae3af78402da\ncaps.latest.revision: 5\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Data and Data Objects\nData that is transferred as part of a drag-and-drop operation is stored in a data object.  Conceptually, a data object consists of one or more of the following pairs:  \n  \n-   An <xref:System.Object> that contains the actual data.  \n  \n-   A corresponding data format identifier.  \n  \n The data itself can consist of anything that can be represented as a base <xref:System.Object>.  The corresponding data format is a string or <xref:System.Type> that provides a hint about what format the data is in.  Data objects support hosting multiple data/data format pairs; this enables a single data object to provide data in multiple formats.  \n  \n<a name=\"Data_and_Data_Objects\"></a>   \n## Data Objects  \n All data objects must implement the <xref:System.Windows.IDataObject> interface, which provides the following standard set of methods that enable and facilitate data transfer.  \n  \n|Method|Summary|  \n|------------|-------------|  \n|<xref:System.Windows.IDataObject.GetData%2A>|Retrieves a data object in a specified data format.|  \n|<xref:System.Windows.IDataObject.GetDataPresent%2A>|Checks to see whether the data is available in, or can be converted to, a specified format.|  \n|<xref:System.Windows.IDataObject.GetFormats%2A>|Returns a list of formats that the data in this data object is stored in, or can be converted to.|  \n|<xref:System.Windows.IDataObject.SetData%2A>|Stores the specified data in this data object.|  \n  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a basic implementation of <xref:System.Windows.IDataObject> in the <xref:System.Windows.DataObject> class. The stock <xref:System.Windows.DataObject> class is sufficient for many common data transfer scenarios.  \n  \n There are several pre-defined formats, such as bitmap, CSV, file, HTML, RTF, string, text, and audio. For information about pre-defined data formats provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see the <xref:System.Windows.DataFormats> class reference topic.  \n  \n Data objects commonly include a facility for automatically converting data stored in one format to a different format while extracting data; this facility is referred to as auto-convert. When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> method and specifying the `autoConvert` parameter as `false`.  When adding data to a data object with the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> method, auto-conversion of data can be prohibited by setting the `autoConvert` parameter to `false`.  \n  \n<a name=\"Working_with_Data_Objects\"></a>   \n## Working with Data Objects  \n This section describes common techniques for creating and working with data objects.  \n  \n### Creating New Data Objects  \n The <xref:System.Windows.DataObject> class provides several overloaded constructors that facilitate populating a new <xref:System.Windows.DataObject> instance with a single data/data format pair.  \n  \n The following example code creates a new data object and uses one of the overloaded constructors <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) to initialize the data object with a string and a specified data format.  In this case, the data format is specified by a string; the <xref:System.Windows.DataFormats> class provides a set of pre-defined type strings. Auto-conversion of the stored data is allowed by default.  \n  \n [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)]  \n  \n For more examples of code that creates a data object, see [Create a Data Object](../../../../docs/framework/wpf/advanced/how-to-create-a-data-object.md).  \n  \n### Storing Data in Multiple Formats  \n A single data object is able to store data in multiple formats.   Strategic use of multiple data formats within a single data object potentially makes the data object consumable by a wider variety of drop targets than if only a single data format could be represented.  Note that, in general, a drag source must be agnostic about the data formats that are consumable by potential drop targets.  \n  \n The following example shows how to use the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> method to add data to a data object in multiple formats.  \n  \n [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)]  \n  \n### Querying a Data Object for Available Formats  \n Because a single data object can contain an arbitrary number of data formats, data objects include facilities for retrieving a list of available data formats.  \n  \n The following example code uses the <xref:System.Windows.DataObject.GetFormats%2A> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert).  \n  \n [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)]  \n  \n For more examples of code that queries a data object for available data formats, see [List the Data Formats in a Data Object](../../../../docs/framework/wpf/advanced/how-to-list-the-data-formats-in-a-data-object.md).  For examples of querying a data object for the presence of a particular data format, see [Determine if a Data Format is Present in a Data Object](../../../../docs/framework/wpf/advanced/how-to-determine-if-a-data-format-is-present-in-a-data-object.md).  \n  \n### Retrieving Data from a Data Object  \n Retrieving data from a data object in a particular format simply involves calling one of the <xref:System.Windows.DataObject.GetData%2A> methods and specifying the desired data format.  One of the <xref:System.Windows.DataObject.GetDataPresent%2A> methods can be used to check for the presence of a particular data format.  <xref:System.Windows.DataObject.GetData%2A> returns the data in an <xref:System.Object>; depending on the data format, this object can be cast to a type-specific container.  \n  \n The following example code uses the <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload to check if a specified data format is available (native or by auto-convert). If the specified format is available, the example retrieves the data by using the <xref:System.Windows.DataObject.GetData%28System.String%29> method.  \n  \n [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)]  \n  \n For more examples of code that retrieves data from a data object, see [Retrieve Data in a Particular Data Format](../../../../docs/framework/wpf/advanced/how-to-retrieve-data-in-a-particular-data-format.md).  \n  \n### Removing Data From a Data Object  \n Data cannot be directly removed from a data object.  To effectively remove data from a data object, follow these steps:  \n  \n1.  Create a new data object that will contain only the data you want to retain.  \n  \n2.  \"Copy\" the desired data from the old data object to the new data object.  To copy the data, use one of the <xref:System.Windows.DataObject.GetData%2A> methods to retrieve an <xref:System.Object> that contains the raw data, and then use one of the <xref:System.Windows.DataObject.SetData%2A> methods to add the data to the new data object.  \n  \n3.  Replace the old data object with the new one.  \n  \n> [!NOTE]\n>  The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call. Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.","nodes":[{"pos":[12,50],"content":"Data and Data Objects | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Data and Data Objects | Microsoft Docs","pos":[0,38]}]},{"pos":[479,500],"content":"Data and Data Objects","linkify":"Data and Data Objects","nodes":[{"content":"Data and Data Objects","pos":[0,21]}]},{"content":"Data that is transferred as part of a drag-and-drop operation is stored in a data object.","pos":[501,590]},{"content":"Conceptually, a data object consists of one or more of the following pairs:","pos":[592,667]},{"content":"An <ph id=\"ph1\">&lt;xref:System.Object&gt;</ph> that contains the actual data.","pos":[677,731],"source":"An <xref:System.Object> that contains the actual data."},{"content":"A corresponding data format identifier.","pos":[741,780]},{"content":"The data itself can consist of anything that can be represented as a base <ph id=\"ph1\">&lt;xref:System.Object&gt;</ph>.","pos":[787,882],"source":"The data itself can consist of anything that can be represented as a base <xref:System.Object>."},{"content":"The corresponding data format is a string or <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> that provides a hint about what format the data is in.","pos":[884,1002],"source":"  The corresponding data format is a string or <xref:System.Type> that provides a hint about what format the data is in."},{"content":"Data objects support hosting multiple data/data format pairs; this enables a single data object to provide data in multiple formats.","pos":[1004,1136]},{"pos":[1185,1197],"content":"Data Objects","linkify":"Data Objects","nodes":[{"content":"Data Objects","pos":[0,12]}]},{"content":"All data objects must implement the <ph id=\"ph1\">&lt;xref:System.Windows.IDataObject&gt;</ph> interface, which provides the following standard set of methods that enable and facilitate data transfer.","pos":[1201,1376],"source":"All data objects must implement the <xref:System.Windows.IDataObject> interface, which provides the following standard set of methods that enable and facilitate data transfer."},{"content":"Method","pos":[1383,1389]},{"content":"Summary","pos":[1390,1397]},{"content":"Retrieves a data object in a specified data format.","pos":[1478,1529]},{"content":"Checks to see whether the data is available in, or can be converted to, a specified format.","pos":[1586,1677]},{"content":"Returns a list of formats that the data in this data object is stored in, or can be converted to.","pos":[1730,1827]},{"content":"Stores the specified data in this data object.","pos":[1877,1923]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a basic implementation of <ph id=\"ph2\">&lt;xref:System.Windows.IDataObject&gt;</ph> in the <ph id=\"ph3\">&lt;xref:System.Windows.DataObject&gt;</ph> class.","pos":[1931,2128],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a basic implementation of <xref:System.Windows.IDataObject> in the <xref:System.Windows.DataObject> class."},{"content":"The stock <ph id=\"ph1\">&lt;xref:System.Windows.DataObject&gt;</ph> class is sufficient for many common data transfer scenarios.","pos":[2129,2232],"source":" The stock <xref:System.Windows.DataObject> class is sufficient for many common data transfer scenarios."},{"content":"There are several pre-defined formats, such as bitmap, CSV, file, HTML, RTF, string, text, and audio.","pos":[2239,2340]},{"content":"For information about pre-defined data formats provided with <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, see the <ph id=\"ph2\">&lt;xref:System.Windows.DataFormats&gt;</ph> class reference topic.","pos":[2341,2549],"source":" For information about pre-defined data formats provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see the <xref:System.Windows.DataFormats> class reference topic."},{"content":"Data objects commonly include a facility for automatically converting data stored in one format to a different format while extracting data; this facility is referred to as auto-convert.","pos":[2556,2742]},{"content":"When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetFormats%28System.Boolean%29&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29&gt;</ph> method and specifying the <ph id=\"ph3\">`autoConvert`</ph> parameter as <ph id=\"ph4\">`false`</ph>.","pos":[2743,3104],"source":" When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> method and specifying the `autoConvert` parameter as `false`."},{"content":"When adding data to a data object with the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29&gt;</ph> method, auto-conversion of data can be prohibited by setting the <ph id=\"ph2\">`autoConvert`</ph> parameter to <ph id=\"ph3\">`false`</ph>.","pos":[3106,3342],"source":"  When adding data to a data object with the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> method, auto-conversion of data can be prohibited by setting the `autoConvert` parameter to `false`."},{"pos":[3395,3420],"content":"Working with Data Objects","linkify":"Working with Data Objects","nodes":[{"content":"Working with Data Objects","pos":[0,25]}]},{"content":"This section describes common techniques for creating and working with data objects.","pos":[3424,3508]},{"pos":[3518,3543],"content":"Creating New Data Objects","linkify":"Creating New Data Objects","nodes":[{"content":"Creating New Data Objects","pos":[0,25]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.DataObject&gt;</ph> class provides several overloaded constructors that facilitate populating a new <ph id=\"ph2\">&lt;xref:System.Windows.DataObject&gt;</ph> instance with a single data/data format pair.","pos":[3547,3742],"source":"The <xref:System.Windows.DataObject> class provides several overloaded constructors that facilitate populating a new <xref:System.Windows.DataObject> instance with a single data/data format pair."},{"content":"The following example code creates a new data object and uses one of the overloaded constructors <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.%23ctor%2A&gt;</ph>(<ph id=\"ph2\">&lt;xref:System.Windows.DataObject.%23ctor(System.String,System.Object)&gt;</ph>) to initialize the data object with a string and a specified data format.","pos":[3749,4033],"source":"The following example code creates a new data object and uses one of the overloaded constructors <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) to initialize the data object with a string and a specified data format."},{"content":"In this case, the data format is specified by a string; the <ph id=\"ph1\">&lt;xref:System.Windows.DataFormats&gt;</ph> class provides a set of pre-defined type strings.","pos":[4035,4178],"source":"  In this case, the data format is specified by a string; the <xref:System.Windows.DataFormats> class provides a set of pre-defined type strings."},{"content":"Auto-conversion of the stored data is allowed by default.","pos":[4179,4236]},{"pos":[4243,4689],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)]"},{"pos":[4696,4849],"content":"For more examples of code that creates a data object, see <bpt id=\"p1\">[</bpt>Create a Data Object<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-create-a-data-object.md)</ept>.","source":"For more examples of code that creates a data object, see [Create a Data Object](../../../../docs/framework/wpf/advanced/how-to-create-a-data-object.md)."},{"pos":[4859,4891],"content":"Storing Data in Multiple Formats","linkify":"Storing Data in Multiple Formats","nodes":[{"content":"Storing Data in Multiple Formats","pos":[0,32]}]},{"content":"A single data object is able to store data in multiple formats.","pos":[4895,4958]},{"content":"Strategic use of multiple data formats within a single data object potentially makes the data object consumable by a wider variety of drop targets than if only a single data format could be represented.","pos":[4961,5163]},{"content":"Note that, in general, a drag source must be agnostic about the data formats that are consumable by potential drop targets.","pos":[5165,5288]},{"content":"The following example shows how to use the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29&gt;</ph> method to add data to a data object in multiple formats.","pos":[5295,5470],"source":"The following example shows how to use the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> method to add data to a data object in multiple formats."},{"pos":[5477,5895],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)]"},{"pos":[5905,5949],"content":"Querying a Data Object for Available Formats","linkify":"Querying a Data Object for Available Formats","nodes":[{"content":"Querying a Data Object for Available Formats","pos":[0,44]}]},{"content":"Because a single data object can contain an arbitrary number of data formats, data objects include facilities for retrieving a list of available data formats.","pos":[5953,6111]},{"content":"The following example code uses the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetFormats%2A&gt;</ph> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert).","pos":[6118,6324],"source":"The following example code uses the <xref:System.Windows.DataObject.GetFormats%2A> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert)."},{"pos":[6331,6737],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)]"},{"content":"For more examples of code that queries a data object for available data formats, see <bpt id=\"p1\">[</bpt>List the Data Formats in a Data Object<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-list-the-data-formats-in-a-data-object.md)</ept>.","pos":[6744,6960],"source":"For more examples of code that queries a data object for available data formats, see [List the Data Formats in a Data Object](../../../../docs/framework/wpf/advanced/how-to-list-the-data-formats-in-a-data-object.md)."},{"content":"For examples of querying a data object for the presence of a particular data format, see <bpt id=\"p1\">[</bpt>Determine if a Data Format is Present in a Data Object<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-determine-if-a-data-format-is-present-in-a-data-object.md)</ept>.","pos":[6962,7214],"source":"  For examples of querying a data object for the presence of a particular data format, see [Determine if a Data Format is Present in a Data Object](../../../../docs/framework/wpf/advanced/how-to-determine-if-a-data-format-is-present-in-a-data-object.md)."},{"pos":[7224,7258],"content":"Retrieving Data from a Data Object","linkify":"Retrieving Data from a Data Object","nodes":[{"content":"Retrieving Data from a Data Object","pos":[0,34]}]},{"content":"Retrieving data from a data object in a particular format simply involves calling one of the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetData%2A&gt;</ph> methods and specifying the desired data format.","pos":[7262,7446],"source":"Retrieving data from a data object in a particular format simply involves calling one of the <xref:System.Windows.DataObject.GetData%2A> methods and specifying the desired data format."},{"content":"One of the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetDataPresent%2A&gt;</ph> methods can be used to check for the presence of a particular data format.","pos":[7448,7584],"source":"  One of the <xref:System.Windows.DataObject.GetDataPresent%2A> methods can be used to check for the presence of a particular data format."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetData%2A&gt;</ph> returns the data in an <ph id=\"ph2\">&lt;xref:System.Object&gt;</ph>; depending on the data format, this object can be cast to a type-specific container.","pos":[7586,7758],"source":"<xref:System.Windows.DataObject.GetData%2A> returns the data in an <xref:System.Object>; depending on the data format, this object can be cast to a type-specific container."},{"content":"The following example code uses the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetDataPresent%28System.String%29&gt;</ph> overload to check if a specified data format is available (native or by auto-convert).","pos":[7765,7954],"source":"The following example code uses the <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload to check if a specified data format is available (native or by auto-convert)."},{"content":"If the specified format is available, the example retrieves the data by using the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetData%28System.String%29&gt;</ph> method.","pos":[7955,8104],"source":" If the specified format is available, the example retrieves the data by using the <xref:System.Windows.DataObject.GetData%28System.String%29> method."},{"pos":[8111,8533],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)]\n [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)]"},{"pos":[8540,8747],"content":"For more examples of code that retrieves data from a data object, see <bpt id=\"p1\">[</bpt>Retrieve Data in a Particular Data Format<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-retrieve-data-in-a-particular-data-format.md)</ept>.","source":"For more examples of code that retrieves data from a data object, see [Retrieve Data in a Particular Data Format](../../../../docs/framework/wpf/advanced/how-to-retrieve-data-in-a-particular-data-format.md)."},{"pos":[8757,8789],"content":"Removing Data From a Data Object","linkify":"Removing Data From a Data Object","nodes":[{"content":"Removing Data From a Data Object","pos":[0,32]}]},{"content":"Data cannot be directly removed from a data object.","pos":[8793,8844]},{"content":"To effectively remove data from a data object, follow these steps:","pos":[8846,8912]},{"content":"Create a new data object that will contain only the data you want to retain.","pos":[8922,8998]},{"content":"\"Copy\" the desired data from the old data object to the new data object.","pos":[9008,9080]},{"content":"To copy the data, use one of the <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.GetData%2A&gt;</ph> methods to retrieve an <ph id=\"ph2\">&lt;xref:System.Object&gt;</ph> that contains the raw data, and then use one of the <ph id=\"ph3\">&lt;xref:System.Windows.DataObject.SetData%2A&gt;</ph> methods to add the data to the new data object.","pos":[9082,9346],"source":"  To copy the data, use one of the <xref:System.Windows.DataObject.GetData%2A> methods to retrieve an <xref:System.Object> that contains the raw data, and then use one of the <xref:System.Windows.DataObject.SetData%2A> methods to add the data to the new data object."},{"content":"Replace the old data object with the new one.","pos":[9356,9401]},{"pos":[9409,9775],"content":"[!NOTE]\n The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call. Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.","leadings":["","> "],"nodes":[{"content":" The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call. Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.","pos":[8,364],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.SetData%2A&gt;</ph> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call.","pos":[1,188],"source":" The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call."},{"content":"Calling <ph id=\"ph1\">&lt;xref:System.Windows.DataObject.SetData%2A&gt;</ph> twice for the same data and data format will result in the data/data format being present twice in the data object.","pos":[189,356],"source":" Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object."}]}]}]}