{"content":"---\ntitle: \"Interoperability Overview (C# Programming Guide) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\n\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"COM interop\"\n  - \"C# language, interoperability\"\n  - \"C++ Interop\"\n  - \"interoperability, about interoperability\"\n  - \"platform invoke\"\nms.assetid: c025b2e0-2357-4c27-8461-118f0090aeff\ncaps.latest.revision: 43\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Interoperability Overview (C# Programming Guide)\nThe topic describes methods to enable interoperability between C# managed code and unmanaged code.  \n  \n## Platform Invoke  \n *Platform invoke* is a service that enables managed code to call unmanaged functions that are implemented in dynamic link libraries (DLLs), such as those in the Microsoft Win32 API. It locates and invokes an exported function and marshals its arguments (integers, strings, arrays, structures, and so on) across the interoperation boundary as needed.  \n  \n For more information, see [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md) and [How to: Use Platform Invoke to Play a Wave File](../../../csharp/programming-guide/interop/how-to-use-platform-invoke-to-play-a-wave-file.md).  \n  \n> [!NOTE]\n>  The [Common Language Runtime](../../../standard/clr.md) (CLR) manages access to system resources. Calling unmanaged code that is outside the CLR bypasses this security mechanism, and therefore presents a security risk. For example, unmanaged code might call resources in unmanaged code directly, bypassing CLR security mechanisms. For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122).  \n  \n## C++ Interop  \n You can use C++ interop, also known as It Just Works (IJW), to wrap a native C++ class so that it can be consumed by code that is authored in C# or another .NET Framework language. To do this, you write C++ code to wrap a native DLL or COM component. Unlike other .NET Framework languages, [!INCLUDE[vcprvc](../../../csharp/programming-guide/interop/includes/vcprvc_md.md)] has interoperability support that enables managed and unmanaged code to be located in the same application and even in the same file. You then build the C++ code by using the **/clr** compiler switch to produce a managed assembly. Finally, you add a reference to the assembly in your C# project and use the wrapped objects just as you would use other managed classes.  \n  \n## Exposing COM Components to C#  \n You can consume a COM component from a C# project. The general steps are as follows:  \n  \n1.  Locate a COM component to use and register it. Use regsvr32.exe to register or un–register a COM DLL.  \n  \n2.  Add to the project a reference to the COM component or type library.  \n  \n     When you add the reference, [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] uses the [Tlbimp.exe (Type Library Importer)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382), which takes a type library as input, to output a .NET Framework interop assembly. The assembly, also named a runtime callable wrapper (RCW), contains managed classes and interfaces that wrap the COM classes and interfaces that are in the type library. [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] adds to the project a reference to the generated assembly.  \n  \n3.  Create an instance of a class that is defined in the RCW. This, in turn, creates an instance of the COM object.  \n  \n4.  Use the object just as you use other managed objects. When the object is reclaimed by garbage collection, the instance of the COM object is also released from memory.  \n  \n For more information, see [Exposing COM Components to the .NET Framework](http://msdn.microsoft.com/library/e78b14f1-e487-43cd-9c6d-1a07483f1730).  \n  \n## Exposing C# to COM  \n COM clients can consume C# types that have been correctly exposed. The basic steps to expose C# types are as follows:  \n  \n1.  Add interop attributes in the C# project.  \n  \n     You can make an assembly COM visible by modifying [!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)] project properties. For more information, see [Assembly Information Dialog Box](https://docs.microsoft.com/visualstudio/ide/reference/assembly-information-dialog-box).  \n  \n2.  Generate a COM type library and register it for COM usage.  \n  \n     You can modify [!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)] project properties to automatically register the C# assembly for COM interop. [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] uses the [Regasm.exe (Assembly Registration Tool)](http://msdn.microsoft.com/library/e190e342-36ef-4651-a0b4-0e8c2c0281cb), using the `/tlb` command-line switch, which takes a managed assembly as input, to generate a type library. This type library describes the `public` types in the assembly and adds registry entries so that COM clients can create managed classes.  \n  \n For more information, see [Exposing .NET Framework Components to COM](http://msdn.microsoft.com/library/e42a65f7-1e61-411f-b09a-aca1bbce24c6) and [Example COM Class](../../../csharp/programming-guide/interop/example-com-class.md).  \n  \n## See Also  \n [Improving Interop Performance](http://go.microsoft.com/fwlink/?LinkId=99564)   \n [Introduction to COM Interop](http://go.microsoft.com/fwlink/?LinkId=112406)   \n [Marshaling between Managed and Unmanaged Code](http://go.microsoft.com/fwlink/?LinkId=112398)   \n [Interoperating with Unmanaged Code](https://msdn.microsoft.com/library/sd10k43k)   \n [Advanced COM Interoperability](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb)   \n [C# Programming Guide](../../../csharp/programming-guide/index.md)","nodes":[{"pos":[4,661],"nodes":[{"content":"Interoperability Overview (C# Programming Guide) | Microsoft Docs","nodes":[{"pos":[0,65],"content":"Interoperability Overview (C# Programming Guide) | Microsoft Docs","nodes":[{"content":"Interoperability Overview (C# Programming Guide) | Microsoft Docs","pos":[0,65]}]}],"pos":[6,74],"yaml":true}],"content":"title: \"Interoperability Overview (C# Programming Guide) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\n\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"COM interop\"\n  - \"C# language, interoperability\"\n  - \"C++ Interop\"\n  - \"interoperability, about interoperability\"\n  - \"platform invoke\"\nms.assetid: c025b2e0-2357-4c27-8461-118f0090aeff\ncaps.latest.revision: 43\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[668,716],"content":"Interoperability Overview (C# Programming Guide)","linkify":"Interoperability Overview (C# Programming Guide)","nodes":[{"content":"Interoperability Overview (C# Programming Guide)","pos":[0,48]}]},{"content":"The topic describes methods to enable interoperability between C# managed code and unmanaged code.","pos":[717,815]},{"pos":[824,839],"content":"Platform Invoke","linkify":"Platform Invoke","nodes":[{"content":"Platform Invoke","pos":[0,15]}]},{"content":"<bpt id=\"p1\">*</bpt>Platform invoke<ept id=\"p1\">*</ept> is a service that enables managed code to call unmanaged functions that are implemented in dynamic link libraries (DLLs), such as those in the Microsoft Win32 API.","pos":[843,1024],"source":"*Platform invoke* is a service that enables managed code to call unmanaged functions that are implemented in dynamic link libraries (DLLs), such as those in the Microsoft Win32 API."},{"content":"It locates and invokes an exported function and marshals its arguments (integers, strings, arrays, structures, and so on) across the interoperation boundary as needed.","pos":[1025,1192]},{"pos":[1199,1473],"content":"For more information, see <bpt id=\"p1\">[</bpt>Consuming Unmanaged DLL Functions<ept id=\"p1\">](../../../framework/interop/consuming-unmanaged-dll-functions.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Use Platform Invoke to Play a Wave File<ept id=\"p2\">](../../../csharp/programming-guide/interop/how-to-use-platform-invoke-to-play-a-wave-file.md)</ept>.","source":"For more information, see [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md) and [How to: Use Platform Invoke to Play a Wave File](../../../csharp/programming-guide/interop/how-to-use-platform-invoke-to-play-a-wave-file.md)."},{"pos":[1481,1921],"content":"[!NOTE]\n The [Common Language Runtime](../../../standard/clr.md) (CLR) manages access to system resources. Calling unmanaged code that is outside the CLR bypasses this security mechanism, and therefore presents a security risk. For example, unmanaged code might call resources in unmanaged code directly, bypassing CLR security mechanisms. For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122).","leadings":["","> "],"nodes":[{"content":"The [Common Language Runtime](../../../standard/clr.md) (CLR) manages access to system resources. Calling unmanaged code that is outside the CLR bypasses this security mechanism, and therefore presents a security risk. For example, unmanaged code might call resources in unmanaged code directly, bypassing CLR security mechanisms. For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122).","pos":[9,438],"nodes":[{"content":"The <bpt id=\"p1\">[</bpt>Common Language Runtime<ept id=\"p1\">](../../../standard/clr.md)</ept> (CLR) manages access to system resources.","pos":[0,97],"source":"The [Common Language Runtime](../../../standard/clr.md) (CLR) manages access to system resources."},{"content":"Calling unmanaged code that is outside the CLR bypasses this security mechanism, and therefore presents a security risk.","pos":[98,218]},{"content":"For example, unmanaged code might call resources in unmanaged code directly, bypassing CLR security mechanisms.","pos":[219,330]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>.NET Framework Security<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=37122)</ept>.","pos":[331,429],"source":" For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122)."}]}]},{"pos":[1930,1941],"content":"C++ Interop","linkify":"C++ Interop","nodes":[{"content":"C++ Interop","pos":[0,11]}]},{"content":"You can use C++ interop, also known as It Just Works (IJW), to wrap a native C++ class so that it can be consumed by code that is authored in C# or another .NET Framework language.","pos":[1945,2125]},{"content":"To do this, you write C++ code to wrap a native DLL or COM component.","pos":[2126,2195]},{"content":"Unlike other .NET Framework languages, <ph id=\"ph1\">[!INCLUDE[vcprvc](../../../csharp/programming-guide/interop/includes/vcprvc_md.md)]</ph> has interoperability support that enables managed and unmanaged code to be located in the same application and even in the same file.","pos":[2196,2452],"source":" Unlike other .NET Framework languages, [!INCLUDE[vcprvc](../../../csharp/programming-guide/interop/includes/vcprvc_md.md)] has interoperability support that enables managed and unmanaged code to be located in the same application and even in the same file."},{"content":"You then build the C++ code by using the <bpt id=\"p1\">**</bpt>/clr<ept id=\"p1\">**</ept> compiler switch to produce a managed assembly.","pos":[2453,2549],"source":" You then build the C++ code by using the **/clr** compiler switch to produce a managed assembly."},{"content":"Finally, you add a reference to the assembly in your C# project and use the wrapped objects just as you would use other managed classes.","pos":[2550,2686]},{"pos":[2695,2724],"content":"Exposing COM Components to C#","linkify":"Exposing COM Components to C#","nodes":[{"content":"Exposing COM Components to C#","pos":[0,29]}]},{"content":"You can consume a COM component from a C# project.","pos":[2728,2778]},{"content":"The general steps are as follows:","pos":[2779,2812]},{"content":"Locate a COM component to use and register it.","pos":[2822,2868]},{"content":"Use regsvr32.exe to register or un–register a COM DLL.","pos":[2869,2923]},{"content":"Add to the project a reference to the COM component or type library.","pos":[2933,3001]},{"content":"When you add the reference, <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)]</ph> uses the <bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382)</ept>, which takes a type library as input, to output a .NET Framework interop assembly.","pos":[3012,3298],"source":"When you add the reference, [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] uses the [Tlbimp.exe (Type Library Importer)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382), which takes a type library as input, to output a .NET Framework interop assembly."},{"content":"The assembly, also named a runtime callable wrapper (RCW), contains managed classes and interfaces that wrap the COM classes and interfaces that are in the type library.","pos":[3299,3468]},{"content":"<ph id=\"ph1\">[!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)]</ph> adds to the project a reference to the generated assembly.","pos":[3469,3585],"source":"[!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] adds to the project a reference to the generated assembly."},{"content":"Create an instance of a class that is defined in the RCW.","pos":[3595,3652]},{"content":"This, in turn, creates an instance of the COM object.","pos":[3653,3706]},{"content":"Use the object just as you use other managed objects.","pos":[3716,3769]},{"content":"When the object is reclaimed by garbage collection, the instance of the COM object is also released from memory.","pos":[3770,3882]},{"pos":[3889,4035],"content":"For more information, see <bpt id=\"p1\">[</bpt>Exposing COM Components to the .NET Framework<ept id=\"p1\">](http://msdn.microsoft.com/library/e78b14f1-e487-43cd-9c6d-1a07483f1730)</ept>.","source":"For more information, see [Exposing COM Components to the .NET Framework](http://msdn.microsoft.com/library/e78b14f1-e487-43cd-9c6d-1a07483f1730)."},{"pos":[4044,4062],"content":"Exposing C# to COM","linkify":"Exposing C# to COM","nodes":[{"content":"Exposing C# to COM","pos":[0,18]}]},{"content":"COM clients can consume C# types that have been correctly exposed.","pos":[4066,4132]},{"content":"The basic steps to expose C# types are as follows:","pos":[4133,4183]},{"content":"Add interop attributes in the C# project.","pos":[4193,4234]},{"content":"You can make an assembly COM visible by modifying <ph id=\"ph1\">[!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)]</ph> project properties.","pos":[4245,4372],"source":"You can make an assembly COM visible by modifying [!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)] project properties."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Assembly Information Dialog Box<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/reference/assembly-information-dialog-box)</ept>.","pos":[4373,4520],"source":" For more information, see [Assembly Information Dialog Box](https://docs.microsoft.com/visualstudio/ide/reference/assembly-information-dialog-box)."},{"content":"Generate a COM type library and register it for COM usage.","pos":[4530,4588]},{"content":"You can modify <ph id=\"ph1\">[!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)]</ph> project properties to automatically register the C# assembly for COM interop.","pos":[4599,4749],"source":"You can modify [!INCLUDE[csprcs](../../../csharp/includes/csprcs_md.md)] project properties to automatically register the C# assembly for COM interop."},{"content":"<ph id=\"ph1\">[!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)]</ph> uses the <bpt id=\"p1\">[</bpt>Regasm.exe (Assembly Registration Tool)<ept id=\"p1\">](http://msdn.microsoft.com/library/e190e342-36ef-4651-a0b4-0e8c2c0281cb)</ept>, using the <ph id=\"ph2\">`/tlb`</ph> command-line switch, which takes a managed assembly as input, to generate a type library.","pos":[4750,5038],"source":"[!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] uses the [Regasm.exe (Assembly Registration Tool)](http://msdn.microsoft.com/library/e190e342-36ef-4651-a0b4-0e8c2c0281cb), using the `/tlb` command-line switch, which takes a managed assembly as input, to generate a type library."},{"content":"This type library describes the <ph id=\"ph1\">`public`</ph> types in the assembly and adds registry entries so that COM clients can create managed classes.","pos":[5039,5175],"source":" This type library describes the `public` types in the assembly and adds registry entries so that COM clients can create managed classes."},{"pos":[5182,5412],"content":"For more information, see <bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](http://msdn.microsoft.com/library/e42a65f7-1e61-411f-b09a-aca1bbce24c6)</ept> and <bpt id=\"p2\">[</bpt>Example COM Class<ept id=\"p2\">](../../../csharp/programming-guide/interop/example-com-class.md)</ept>.","source":"For more information, see [Exposing .NET Framework Components to COM](http://msdn.microsoft.com/library/e42a65f7-1e61-411f-b09a-aca1bbce24c6) and [Example COM Class](../../../csharp/programming-guide/interop/example-com-class.md)."},{"pos":[5421,5429],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Improving Interop Performance<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=99564)</ept><ph id=\"ph1\"> </ph>","pos":[5433,5511],"source":"[Improving Interop Performance](http://go.microsoft.com/fwlink/?LinkId=99564) "},{"content":"<bpt id=\"p1\">[</bpt>Introduction to COM Interop<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=112406)</ept><ph id=\"ph1\"> </ph>","pos":[5515,5592],"source":"[Introduction to COM Interop](http://go.microsoft.com/fwlink/?LinkId=112406) "},{"content":"<bpt id=\"p1\">[</bpt>Marshaling between Managed and Unmanaged Code<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=112398)</ept><ph id=\"ph1\"> </ph>","pos":[5596,5691],"source":"[Marshaling between Managed and Unmanaged Code](http://go.microsoft.com/fwlink/?LinkId=112398) "},{"content":"<bpt id=\"p1\">[</bpt>Interoperating with Unmanaged Code<ept id=\"p1\">](https://msdn.microsoft.com/library/sd10k43k)</ept><ph id=\"ph1\"> </ph>","pos":[5695,5777],"source":"[Interoperating with Unmanaged Code](https://msdn.microsoft.com/library/sd10k43k) "},{"content":"<bpt id=\"p1\">[</bpt>Advanced COM Interoperability<ept id=\"p1\">](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb)</ept><ph id=\"ph1\"> </ph>","pos":[5781,5883],"source":"[Advanced COM Interoperability](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb) "},{"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","pos":[5887,5953],"source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"}]}