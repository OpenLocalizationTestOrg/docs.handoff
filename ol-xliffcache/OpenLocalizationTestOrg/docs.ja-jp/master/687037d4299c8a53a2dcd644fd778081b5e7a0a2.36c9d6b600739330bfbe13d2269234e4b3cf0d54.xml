{"content":"---\ntitle: \"Application Management Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"application management [WPF]\"\nms.assetid: 32b1c054-5aca-423b-b4b5-ed8dc4dc637d\n---\n# Application Management Overview\nAll applications tend to share a common set of functionality that applies to application implementation and management. This topic provides an overview of the functionality in the <xref:System.Windows.Application> class for creating and managing applications.  \n\n## The Application Class  \n In WPF, common application-scoped functionality is encapsulated in the <xref:System.Windows.Application> class. The <xref:System.Windows.Application> class includes the following functionality:  \n  \n-   Tracking and interacting with application lifetime.  \n  \n-   Retrieving and processing command-line parameters.  \n  \n-   Detecting and responding to unhandled exceptions.  \n  \n-   Sharing application-scope properties and resources.  \n  \n-   Managing windows in standalone applications.  \n  \n-   Tracking and managing navigation.  \n  \n<a name=\"The_Application_Class\"></a>   \n## How to Perform Common Tasks Using the Application Class  \n If you are not interested in all of the details of the <xref:System.Windows.Application> class, the following table lists some of the common tasks for <xref:System.Windows.Application> and how to accomplish them. By viewing the related API and topics, you can find more information and sample code.  \n  \n|Task|Approach|  \n|----------|--------------|  \n|Get an object that represents the current application|Use the <xref:System.Windows.Application.Current%2A?displayProperty=nameWithType> property.|  \n|Add a startup screen to an application|See [Add a Splash Screen to a WPF Application](how-to-add-a-splash-screen-to-a-wpf-application.md).|  \n|Start an application|Use the <xref:System.Windows.Application.Run%2A?displayProperty=nameWithType> method.|  \n|Stop an application|Use the <xref:System.Windows.Application.Shutdown%2A> method of the <xref:System.Windows.Application.Current%2A?displayProperty=nameWithType> object.|  \n|Get arguments from the command line|Handle the <xref:System.Windows.Application.Startup?displayProperty=nameWithType> event and use the <xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=nameWithType> property. For an example, see the <xref:System.Windows.Application.Startup?displayProperty=nameWithType> event.|  \n|Get and set the application exit code|Set the <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=nameWithType> property in the <xref:System.Windows.Application.Exit?displayProperty=nameWithType> event handler or call the <xref:System.Windows.Application.Shutdown%2A> method and pass in an integer.|  \n|Detect and respond to unhandled exceptions|Handle the <xref:System.Windows.Application.DispatcherUnhandledException> event.|  \n|Get and set application-scoped resources|Use the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType> property.|  \n|Use an application-scope resource dictionary|See [Use an Application-Scope Resource Dictionary](how-to-use-an-application-scope-resource-dictionary.md).|  \n|Get and set application-scoped properties|Use the <xref:System.Windows.Application.Properties%2A?displayProperty=nameWithType> property.|  \n|Get and save an application's state|See [Persist and Restore Application-Scope Properties Across Application Sessions](persist-and-restore-application-scope-properties.md).|  \n|Manage non-code data files, including resource files, content files, and site-of-origin files.|See [WPF Application Resource, Content, and Data Files](wpf-application-resource-content-and-data-files.md).|  \n|Manage windows in standalone applications|See [WPF Windows Overview](wpf-windows-overview.md).|  \n|Track and manage navigation|See [Navigation Overview](navigation-overview.md).|  \n  \n<a name=\"The_Application_Definition\"></a>   \n## The Application Definition  \n To utilize the functionality of the <xref:System.Windows.Application> class, you must implement an application definition. A WPF application definition is a class that derives from <xref:System.Windows.Application> and is configured with a special MSBuild setting.  \n\n### Implementing an Application Definition  \n A typical WPF application definition is implemented using both markup and code-behind. This allows you to use markup to declaratively set application properties, resources, and register events, while handling events and implementing application-specific behavior in code-behind.  \n  \n The following example shows how to implement an application definition using both markup and code-behind:  \n  \n [!code-xaml[ApplicationSnippets#ApplicationXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml#applicationxaml)]  \n  \n [!code-csharp[ApplicationSnippets#ApplicationCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml.cs#applicationcodebehind)]\n [!code-vb[ApplicationSnippets#ApplicationCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSnippets/visualbasic/application.xaml.vb#applicationcodebehind)]  \n  \n To allow a markup file and code-behind file to work together, the following needs to happen:  \n  \n- In markup, the `Application` element must include the `x:Class` attribute. When the application is built, the existence of `x:Class` in the markup file causes MSBuild to create a `partial` class that derives from <xref:System.Windows.Application> and has the name that is specified by the `x:Class` attribute. This requires the addition of an XML namespace declaration for the XAML schema (`xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"`).\n  \n-   In code-behind, the class must be a `partial` class with the same name that is specified by the `x:Class` attribute in markup and must derive from <xref:System.Windows.Application>. This allows the code-behind file to be associated with the `partial` class that is generated for the markup file when the application is built (see [Building a WPF Application](building-a-wpf-application-wpf.md)).  \n  \n> [!NOTE]\n>  When you create a new WPF Application project or WPF Browser Application project using Visual Studio, an application definition is included by default and is defined using both markup and code-behind.  \n  \n This code is the minimum that is required to implement an application definition. However, an additional MSBuild configuration needs to be made to the application definition before building and running the application.  \n  \n### Configuring the Application Definition for MSBuild  \n Standalone applications and XAML browser applications (XBAPs) require the implementation of a certain level of infrastructure before they can run. The most important part of this infrastructure is the entry point. When an application is launched by a user, the operating system calls the entry point, which is a well-known function for starting applications.  \n  \n Traditionally, developers have needed to write some or all of this code for themselves, depending on the technology. However, WPF generates this code for you when the markup file of your application definition is configured as an MSBuild `ApplicationDefinition` item, as shown in the following MSBuild project file:  \n  \n```xml  \n<Project   \n  DefaultTargets=\"Build\"  \n                        xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">  \n  ...  \n  <ApplicationDefinition Include=\"App.xaml\" />  \n  <Compile Include=\"App.xaml.cs\" />  \n  ...  \n</Project>  \n```  \n  \n Because the code-behind file contains code, it is marked as an MSBuild `Compile` item, as is normal.  \n  \n The application of these MSBuild configurations to the markup and code-behind files of an application definition causes MSBuild to generate code like the following:  \n  \n [!code-csharp[auto-generated-code](~/samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs)]\n [!code-vb[auto-generated-code](~/samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb)]  \n  \n The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method `Main`. The <xref:System.STAThreadAttribute> attribute is applied to the `Main` method to indicate that the main UI thread for the WPF application is an STA thread, which is required for WPF applications. When called, `Main` creates a new instance of `App` before calling the `InitializeComponent` method to register the events and set the properties that are implemented in markup. Because `InitializeComponent` is generated for you, you don't need to explicitly call `InitializeComponent` from an application definition like you do for <xref:System.Windows.Controls.Page> and <xref:System.Windows.Window> implementations. Finally, the <xref:System.Windows.Application.Run%2A> method is called to start the application.  \n  \n<a name=\"Getting_the_Current_Application\"></a>   \n## Getting the Current Application  \n Because the functionality of the <xref:System.Windows.Application> class are shared across an application, there can be only one instance of the <xref:System.Windows.Application> class per <xref:System.AppDomain>. To enforce this, the <xref:System.Windows.Application> class is implemented as a singleton class (see [Implementing Singleton in C#](https://go.microsoft.com/fwlink/?LinkId=100567)), which creates a single instance of itself and provides shared access to it with the `static`<xref:System.Windows.Application.Current%2A> property.  \n  \n The following code shows how to acquire a reference to the <xref:System.Windows.Application> object for the current <xref:System.AppDomain>.  \n  \n [!code-csharp[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getcurrentappcode)]\n [!code-vb[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getcurrentappcode)]  \n  \n <xref:System.Windows.Application.Current%2A> returns a reference to an instance of the <xref:System.Windows.Application> class. If you want a reference to your <xref:System.Windows.Application> derived class you must cast the value of the <xref:System.Windows.Application.Current%2A> property, as shown in the following example.  \n  \n [!code-csharp[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getstcurrentappcode)]\n [!code-vb[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getstcurrentappcode)]  \n  \n You can inspect the value of <xref:System.Windows.Application.Current%2A> at any point in the lifetime of an <xref:System.Windows.Application> object. However, you should be careful. After the <xref:System.Windows.Application> class is instantiated, there is a period during which the state of the <xref:System.Windows.Application> object is inconsistent. During this period, <xref:System.Windows.Application> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events. If you try to use the <xref:System.Windows.Application> object during this period, your code may have unexpected results, particularly if it depends on the various <xref:System.Windows.Application> properties being set.  \n  \n When <xref:System.Windows.Application> completes its initialization work, its lifetime truly begins.  \n  \n<a name=\"Application_Lifetime\"></a>   \n## Application Lifetime  \n The lifetime of a WPF application is marked by several events that are raised by <xref:System.Windows.Application> to let you know when your application has started, has been activated and deactivated, and has been shut down.  \n\n<a name=\"Splash_Screen\"></a>   \n### Splash Screen  \n Starting in the [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], you can specify an image to be used in a startup window, or *splash screen*. The <xref:System.Windows.SplashScreen> class makes it easy to display a startup window while your application is loading. The <xref:System.Windows.SplashScreen> window is created and shown before <xref:System.Windows.Application.Run%2A> is called. For more information, see [Application Startup Time](../advanced/application-startup-time.md) and [Add a Splash Screen to a WPF Application](how-to-add-a-splash-screen-to-a-wpf-application.md).  \n  \n<a name=\"Starting_an_Application\"></a>   \n### Starting an Application  \n After <xref:System.Windows.Application.Run%2A> is called and the application is initialized, the application is ready to run. This moment is signified when the <xref:System.Windows.Application.Startup> event is raised:  \n  \n[!code-csharp[Startup-event](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs?range=3-11,31-33)]\n[!code-vb[Startup-event](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb?range=5-11,30-32)]\n  \n At this point in an application's lifetime, the most common thing to do is to show a UI.  \n  \n<a name=\"Showing_a_User_Interface\"></a>\n### Showing a User Interface  \n Most standalone Windows applications open a <xref:System.Windows.Window> when they begin running. The <xref:System.Windows.Application.Startup> event handler is one location from which you can do this, as demonstrated by the following code.  \n  \n [!code-xaml[AppShowWindowHardSnippets#StartupEventMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml#startupeventmarkup)]  \n  \n [!code-csharp[AppShowWindowHardSnippets#StartupEventCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml.cs#startupeventcodebehind)]\n [!code-vb[AppShowWindowHardSnippets#StartupEventCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/AppShowWindowHardSnippets/VisualBasic/Application.xaml.vb#startupeventcodebehind)]  \n  \n> [!NOTE]\n>  The first <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This <xref:System.Windows.Window> object is referenced by the <xref:System.Windows.Application.MainWindow%2A?displayProperty=nameWithType> property. The value of the <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated <xref:System.Windows.Window> should be the main window.  \n  \n When an XBAP first starts, it will most likely navigate to a <xref:System.Windows.Controls.Page>. This is shown in the following code.  \n  \n [!code-xaml[XBAPAppStartupSnippets#StartupXBAPMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml#startupxbapmarkup)]  \n  \n [!code-csharp[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml.cs#startupxbapcodebehind)]\n [!code-vb[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XBAPAppStartupSnippets/VisualBasic/Application.xaml.vb#startupxbapcodebehind)]  \n  \n If you handle <xref:System.Windows.Application.Startup> to only open a <xref:System.Windows.Window> or navigate to a <xref:System.Windows.Controls.Page>, you can set the `StartupUri` attribute in markup instead.  \n  \n The following example shows how to use the <xref:System.Windows.Application.StartupUri%2A> from a standalone application to open a <xref:System.Windows.Window>.  \n  \n [!code-xaml[ApplicationManagementOverviewSnippets#OverviewStartupUriMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/App.xaml#overviewstartupurimarkup)]  \n  \n The following example shows how to use <xref:System.Windows.Application.StartupUri%2A> from an XBAP to navigate to a <xref:System.Windows.Controls.Page>.  \n  \n [!code-xaml[PageSnippets#XBAPStartupUriMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/PageSnippets/CSharp/App.xaml#xbapstartupurimarkup)]  \n  \n This markup has the same effect as the previous code for opening a window.  \n  \n> [!NOTE]\n>  For more information on navigation, see [Navigation Overview](navigation-overview.md).  \n  \n You need to handle the <xref:System.Windows.Application.Startup> event to open a <xref:System.Windows.Window> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched.  \n  \n<a name=\"Processing_Command_Line_Arguments\"></a>   \n### Processing Command-Line Arguments  \n In Windows, standalone applications can be launched from either a command prompt or the desktop. In both cases, command-line arguments can be passed to the application. The following example shows an application that is launched with a single command-line argument, \"/StartMinimized\":  \n  \n `wpfapplication.exe /StartMinimized`  \n  \n During application initialization, WPF retrieves the command-line arguments from the operating system and passes them to the <xref:System.Windows.Application.Startup> event handler via the <xref:System.Windows.StartupEventArgs.Args%2A> property of the <xref:System.Windows.StartupEventArgs> parameter. You can retrieve and store the command-line arguments using code like the following.  \n  \n [!code-xaml[ApplicationStartupSnippets#HandleStartupXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml#handlestartupxaml)]  \n  \n [!code-csharp[ApplicationStartupSnippets#HandleStartupCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#handlestartupcodebehind)]\n [!code-vb[ApplicationStartupSnippets#HandleStartupCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#handlestartupcodebehind)]  \n  \n The code handles <xref:System.Windows.Application.Startup> to check whether the **/StartMinimized** command-line argument was provided; if so, it opens the main window with a <xref:System.Windows.WindowState> of <xref:System.Windows.WindowState.Minimized>. Note that because the <xref:System.Windows.Window.WindowState%2A> property must be set programmatically, the main <xref:System.Windows.Window> must be opened explicitly in code.  \n  \n XBAPs cannot retrieve and process command-line arguments because they are launched using ClickOnce deployment (see [Deploying a WPF Application](deploying-a-wpf-application-wpf.md)). However, they can retrieve and process query string parameters from the URLs that are used to launch them.  \n  \n<a name=\"Application_Activation_and_Deactivation\"></a>   \n### Application Activation and Deactivation  \n Windows allows users to switch between applications. The most common way is to use the ALT+TAB key combination. An application can only be switched to if it has a visible <xref:System.Windows.Window> that a user can select. The currently selected <xref:System.Windows.Window> is the *active window* (also known as the *foreground window*) and is the <xref:System.Windows.Window> that receives user input. The application with the active window is the *active application* (or *foreground application*). An application becomes the active application in the following circumstances:  \n  \n-   It is launched and shows a <xref:System.Windows.Window>.  \n  \n-   A user switches from another application by selecting a <xref:System.Windows.Window> in the application.  \n  \n You can detect when an application becomes active by handling the <xref:System.Windows.Application.Activated?displayProperty=nameWithType> event.  \n  \n Likewise, an application can become inactive in the following circumstances:  \n  \n-   A user switches to another application from the current one.  \n  \n-   When the application shuts down.  \n  \n You can detect when an application becomes inactive by handling the <xref:System.Windows.Application.Deactivated?displayProperty=nameWithType> event.  \n  \n The following code shows how to handle the <xref:System.Windows.Application.Activated> and <xref:System.Windows.Application.Deactivated> events to determine whether an application is active.  \n  \n [!code-xaml[ApplicationActivationSnippets#DetectActivationStateXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml#detectactivationstatexaml)]  \n  \n [!code-csharp[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)]\n [!code-vb[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)]  \n  \n A <xref:System.Windows.Window> can also be activated and deactivated. See <xref:System.Windows.Window.Activated?displayProperty=nameWithType> and <xref:System.Windows.Window.Deactivated?displayProperty=nameWithType> for more information.  \n  \n> [!NOTE]\n>  Neither <xref:System.Windows.Application.Activated?displayProperty=nameWithType> nor <xref:System.Windows.Application.Deactivated?displayProperty=nameWithType> is raised for XBAPs.  \n  \n<a name=\"Application_Shutdown\"></a>   \n### Application Shutdown  \n The life of an application ends when it is shut down, which can occur for the following reasons:  \n  \n-   A user closes every <xref:System.Windows.Window>.  \n  \n-   A user closes the main <xref:System.Windows.Window>.  \n  \n-   A user ends the Windows session by logging off or shutting down.  \n  \n-   An application-specific condition has been met.  \n  \n To help you manage application shutdown, <xref:System.Windows.Application> provides the <xref:System.Windows.Application.Shutdown%2A> method, the <xref:System.Windows.Application.ShutdownMode%2A> property, and the <xref:System.Windows.Application.SessionEnding> and <xref:System.Windows.Application.Exit> events.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have <xref:System.Security.Permissions.UIPermission>. Standalone WPF applications always have this permission. However, XBAPs running in the Internet zone partial-trust security sandbox do not.  \n  \n#### Shutdown Mode  \n Most applications shut down either when all the windows are closed or when the main window is closed. Sometimes, however, other application-specific conditions may determine when an application shuts down. You can specify the conditions under which your application will shut down by setting <xref:System.Windows.Application.ShutdownMode%2A> with one of the following <xref:System.Windows.ShutdownMode> enumeration values:  \n  \n-   <xref:System.Windows.ShutdownMode.OnLastWindowClose>  \n  \n-   <xref:System.Windows.ShutdownMode.OnMainWindowClose>  \n  \n-   <xref:System.Windows.ShutdownMode.OnExplicitShutdown>  \n  \n The default value of <xref:System.Windows.Application.ShutdownMode%2A> is <xref:System.Windows.ShutdownMode.OnLastWindowClose>, which means that an application automatically shuts down when the last window in the application is closed by the user. However, if your application should be shut down when the main window is closed, WPF automatically does that if you set <xref:System.Windows.Application.ShutdownMode%2A> to <xref:System.Windows.ShutdownMode.OnMainWindowClose>. This is shown in the following example.  \n  \n [!code-xaml[ApplicationShutdownModeSnippets#OnMainWindowCloseMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationShutdownModeSnippets/CS/Page1.xaml#onmainwindowclosemarkup)]  \n  \n When you have application-specific shutdown conditions, you set <xref:System.Windows.Application.ShutdownMode%2A> to <xref:System.Windows.ShutdownMode.OnExplicitShutdown>. In this case, it is your responsibility to shut an application down by explicitly calling the <xref:System.Windows.Application.Shutdown%2A> method; otherwise, your application will continue running even if all the windows are closed. Note that <xref:System.Windows.Application.Shutdown%2A> is called implicitly when the <xref:System.Windows.Application.ShutdownMode%2A> is either <xref:System.Windows.ShutdownMode.OnLastWindowClose> or <xref:System.Windows.ShutdownMode.OnMainWindowClose>.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.ShutdownMode%2A> can be set from an XBAP, but it is ignored; an XBAP is always shut down when it is navigated away from in a browser or when the browser that hosts the XBAP is closed. For more information, see [Navigation Overview](navigation-overview.md).  \n  \n#### Session Ending  \n The shutdown conditions that are described by the <xref:System.Windows.Application.ShutdownMode%2A> property are specific to an application. In some cases, though, an application may shut down as a result of an external condition. The most common external condition occurs when a user ends the Windows session by the following actions:  \n  \n-   Logging off  \n  \n-   Shutting down  \n  \n-   Restarting  \n  \n-   Hibernating  \n  \n To detect when a Windows session ends, you can handle the <xref:System.Windows.Application.SessionEnding> event, as illustrated in the following example.  \n  \n [!code-xaml[ApplicationSessionEndingSnippets#HandlingSessionEndingXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml#handlingsessionendingxaml)]  \n  \n [!code-csharp[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)]\n [!code-vb[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)]  \n  \n In this example, the code inspects the <xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A> property to determine how the Windows session is ending. It uses this value to display a confirmation message to the user. If the user does not want the session to end, the code sets <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> to `true` to prevent the Windows session from ending.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.SessionEnding> is not raised for XBAPs.\n\n#### Exit  \n When an application shuts down, it may need to perform some final processing, such as persisting application state. For these situations, you can handle the <xref:System.Windows.Application.Exit> event, as the `App_Exit` event handler does in the following example. It is defined as an event handler in the *App.xaml* file. Its implementation is highlighted in the *App.xaml.cs* and *Application.xaml.vb* files.\n  \n[!code-xaml[Defining-the-Exit-event-handler](~/samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml?highlight=1-7)]  \n  \n [!code-csharp[Handling-the-Exit-event](~/samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs?highlight=42-55)]\n [!code-vb[Handling-the-Exit-event](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb?highlight=34-45)]  \n  \n For the complete example, see [Persist and Restore Application-Scope Properties Across Application Sessions](persist-and-restore-application-scope-properties.md).  \n  \n <xref:System.Windows.Application.Exit> can be handled by both standalone applications and XBAPs. For XBAPs, <xref:System.Windows.Application.Exit> is raised when in the following circumstances:  \n  \n-   An XBAP is navigated away from.  \n  \n-   In [!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)], when the tab that is hosting the XBAP is closed.  \n  \n-   When the browser is closed.  \n  \n#### Exit Code  \n Applications are mostly launched by the operating system in response to a user request. However, an application can be launched by another application to perform some specific task. When the launched application shuts down, the launching application may want to know the condition under which the launched application shut down. In these situations, Windows allows applications to return an application exit code on shutdown. By default, WPF applications return an exit code value of 0.  \n  \n> [!NOTE]\n>  When you debug from Visual Studio, the application exit code is displayed in the **Output** window when the application shuts down, in a message that looks like the following:  \n>   \n>  `The program '[5340] AWPFApp.vshost.exe: Managed' has exited with code 0 (0x0).`  \n>   \n>  You open the **Output** window by clicking **Output** on the **View** menu.  \n  \n To change the exit code, you can call the <xref:System.Windows.Application.Shutdown%28System.Int32%29> overload, which accepts an integer argument to be the exit code:  \n  \n [!code-csharp[ApplicationExitSnippets#AppExitCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationExitSnippets/CSharp/MainWindow.xaml.cs#appexitcode)]\n [!code-vb[ApplicationExitSnippets#AppExitCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationExitSnippets/visualbasic/mainwindow.xaml.vb#appexitcode)]  \n  \n You can detect the value of the exit code, and change it, by handling the <xref:System.Windows.Application.Exit> event. The <xref:System.Windows.Application.Exit> event handler is passed an <xref:System.Windows.ExitEventArgs> which provides access to the exit code with the <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A> property. For more information, see <xref:System.Windows.Application.Exit>.  \n  \n> [!NOTE]\n>  You can set the exit code in both standalone applications and XBAPs. However, the exit code value is ignored for XBAPs.  \n  \n<a name=\"Unhandled_Exceptions\"></a>   \n### Unhandled Exceptions  \n Sometimes an application may shut down under abnormal conditions, such as when an unanticipated exception is thrown. In this case, the application may not have the code to detect and process the exception. This type of exception is an unhandled exception; a notification similar to that shown in the following figure is displayed before the application is closed.  \n  \n ![Screenshot that shows an unhandled exception notification.](./media/application-management-overview/unhandled-exception-notification.png)  \n  \n From the user experience perspective, it is better for an application to avoid this default behavior by doing some or all of the following:  \n  \n-   Displaying user-friendly information.  \n  \n-   Attempting to keep an application running.  \n  \n-   Recording detailed, developer-friendly exception information in the Windows event log.  \n  \n Implementing this support depends on being able to detect unhandled exceptions, which is what the <xref:System.Windows.Application.DispatcherUnhandledException> event is raised for.  \n  \n[!code-xaml[detecting-unhandled-exceptions](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml#handledispatcherunhandledexceptionxaml)]  \n  \n[!code-csharp[code-to-detect-unhandled-exceptions](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs)]\n[!code-vb[code-to-detect-unhandled-exceptions](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb)]  \n  \n The <xref:System.Windows.Application.DispatcherUnhandledException> event handler is passed a <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs> parameter that contains contextual information regarding the unhandled exception, including the exception itself (<xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=nameWithType>). You can use this information to determine how to handle the exception.  \n  \n When you handle <xref:System.Windows.Application.DispatcherUnhandledException>, you should set the <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=nameWithType> property to `true`; otherwise, WPF still considers the exception to be unhandled and reverts to the default behavior described earlier. If an unhandled exception is raised and either the <xref:System.Windows.Application.DispatcherUnhandledException> event is not handled, or the event is handled and <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A> is set to `false`, the application shuts down immediately. Furthermore, no other <xref:System.Windows.Application> events are raised. Consequently, you need to handle <xref:System.Windows.Application.DispatcherUnhandledException> if your application has code that must run before the application shuts down.  \n  \n Although an application may shut down as a result of an unhandled exception, an application usually shuts down in response to a user request, as discussed in the next section.  \n  \n<a name=\"Application_Lifetime_Events\"></a>   \n### Application Lifetime Events  \n Standalone applications and XBAPs don't have exactly the same lifetimes. The following figure illustrates the key events in the lifetime of a standalone application and shows the sequence in which they are raised.  \n  \n ![Standalone Application &#45; Application Object Events](./media/applicationmodeloverview-applicationobjectevents.png \"ApplicationModelOverview_ApplicationObjectEvents\")  \n  \n Likewise, the following figure illustrates the key events in the lifetime of an XBAP, and shows the sequence in which they are raised.  \n  \n ![XBAP &#45; Application Object Events](./media/applicationmodeloverview-applicationobjectevents-xbap.png \"ApplicationModelOverview_ApplicationObjectEvents_xbap\")  \n  \n## See also\n\n- <xref:System.Windows.Application>\n- [WPF Windows Overview](wpf-windows-overview.md)\n- [Navigation Overview](navigation-overview.md)\n- [WPF Application Resource, Content, and Data Files](wpf-application-resource-content-and-data-files.md)\n- [Pack URIs in WPF](pack-uris-in-wpf.md)\n- [Application Model: How-to Topics](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms749013(v=vs.100))\n- [Application Development](index.md)\n","nodes":[{"pos":[4,206],"embed":true,"restype":"x-metadata","content":"title: \"Application Management Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"application management [WPF]\"\nms.assetid: 32b1c054-5aca-423b-b4b5-ed8dc4dc637d","nodes":[{"content":"Application Management Overview","nodes":[{"pos":[0,31],"content":"Application Management Overview","nodes":[{"content":"Application Management Overview","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[213,244],"content":"Application Management Overview","linkify":"Application Management Overview","nodes":[{"content":"Application Management Overview","pos":[0,31]}]},{"content":"All applications tend to share a common set of functionality that applies to application implementation and management.","pos":[245,364]},{"content":"This topic provides an overview of the functionality in the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class for creating and managing applications.","pos":[365,504],"source":" This topic provides an overview of the functionality in the <xref:System.Windows.Application> class for creating and managing applications."},{"pos":[511,532],"content":"The Application Class","linkify":"The Application Class","nodes":[{"content":"The Application Class","pos":[0,21]}]},{"content":"In WPF, common application-scoped functionality is encapsulated in the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class.","pos":[536,647],"source":"In WPF, common application-scoped functionality is encapsulated in the <xref:System.Windows.Application> class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class includes the following functionality:","pos":[648,729],"source":" The <xref:System.Windows.Application> class includes the following functionality:"},{"content":"Tracking and interacting with application lifetime.","pos":[739,790]},{"content":"Retrieving and processing command-line parameters.","pos":[800,850]},{"content":"Detecting and responding to unhandled exceptions.","pos":[860,909]},{"content":"Sharing application-scope properties and resources.","pos":[919,970]},{"content":"Managing windows in standalone applications.","pos":[980,1024]},{"content":"Tracking and managing navigation.","pos":[1034,1067]},{"pos":[1116,1171],"content":"How to Perform Common Tasks Using the Application Class","linkify":"How to Perform Common Tasks Using the Application Class","nodes":[{"content":"How to Perform Common Tasks Using the Application Class","pos":[0,55]}]},{"content":"If you are not interested in all of the details of the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class, the following table lists some of the common tasks for <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> and how to accomplish them.","pos":[1175,1387],"source":"If you are not interested in all of the details of the <xref:System.Windows.Application> class, the following table lists some of the common tasks for <xref:System.Windows.Application> and how to accomplish them."},{"content":"By viewing the related API and topics, you can find more information and sample code.","pos":[1388,1473]},{"content":"Task","pos":[1480,1484]},{"content":"Approach","pos":[1485,1493]},{"content":"Get an object that represents the current application","pos":[1528,1581]},{"pos":[1582,1673],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A?displayProperty=nameWithType&gt;</ph> property.","source":"Use the <xref:System.Windows.Application.Current%2A?displayProperty=nameWithType> property."},{"content":"Add a startup screen to an application","pos":[1678,1716]},{"pos":[1717,1816],"content":"See <bpt id=\"p1\">[</bpt>Add a Splash Screen to a WPF Application<ept id=\"p1\">](how-to-add-a-splash-screen-to-a-wpf-application.md)</ept>.","source":"See [Add a Splash Screen to a WPF Application](how-to-add-a-splash-screen-to-a-wpf-application.md)."},{"content":"Start an application","pos":[1821,1841]},{"pos":[1842,1927],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Use the <xref:System.Windows.Application.Run%2A?displayProperty=nameWithType> method."},{"content":"Stop an application","pos":[1932,1951]},{"pos":[1952,2101],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Application.Current%2A?displayProperty=nameWithType&gt;</ph> object.","source":"Use the <xref:System.Windows.Application.Shutdown%2A> method of the <xref:System.Windows.Application.Current%2A?displayProperty=nameWithType> object."},{"content":"Get arguments from the command line","pos":[2106,2141]},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup?displayProperty=nameWithType&gt;</ph> event and use the <ph id=\"ph2\">&lt;xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[2142,2327],"source":"Handle the <xref:System.Windows.Application.Startup?displayProperty=nameWithType> event and use the <xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=nameWithType> property."},{"content":"For an example, see the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup?displayProperty=nameWithType&gt;</ph> event.","pos":[2328,2429],"source":" For an example, see the <xref:System.Windows.Application.Startup?displayProperty=nameWithType> event."},{"content":"Get and set the application exit code","pos":[2434,2471]},{"pos":[2472,2754],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=nameWithType&gt;</ph> property in the <ph id=\"ph2\">&lt;xref:System.Windows.Application.Exit?displayProperty=nameWithType&gt;</ph> event handler or call the <ph id=\"ph3\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method and pass in an integer.","source":"Set the <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=nameWithType> property in the <xref:System.Windows.Application.Exit?displayProperty=nameWithType> event handler or call the <xref:System.Windows.Application.Shutdown%2A> method and pass in an integer."},{"content":"Detect and respond to unhandled exceptions","pos":[2759,2801]},{"pos":[2802,2882],"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event.","source":"Handle the <xref:System.Windows.Application.DispatcherUnhandledException> event."},{"content":"Get and set application-scoped resources","pos":[2887,2927]},{"pos":[2928,3021],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType&gt;</ph> property.","source":"Use the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType> property."},{"content":"Use an application-scope resource dictionary","pos":[3026,3070]},{"pos":[3071,3178],"content":"See <bpt id=\"p1\">[</bpt>Use an Application-Scope Resource Dictionary<ept id=\"p1\">](how-to-use-an-application-scope-resource-dictionary.md)</ept>.","source":"See [Use an Application-Scope Resource Dictionary](how-to-use-an-application-scope-resource-dictionary.md)."},{"content":"Get and set application-scoped properties","pos":[3183,3224]},{"pos":[3225,3319],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Properties%2A?displayProperty=nameWithType&gt;</ph> property.","source":"Use the <xref:System.Windows.Application.Properties%2A?displayProperty=nameWithType> property."},{"content":"Get and save an application's state","pos":[3324,3359]},{"pos":[3360,3496],"content":"See <bpt id=\"p1\">[</bpt>Persist and Restore Application-Scope Properties Across Application Sessions<ept id=\"p1\">](persist-and-restore-application-scope-properties.md)</ept>.","source":"See [Persist and Restore Application-Scope Properties Across Application Sessions](persist-and-restore-application-scope-properties.md)."},{"content":"Manage non-code data files, including resource files, content files, and site-of-origin files.","pos":[3501,3595]},{"pos":[3596,3704],"content":"See <bpt id=\"p1\">[</bpt>WPF Application Resource, Content, and Data Files<ept id=\"p1\">](wpf-application-resource-content-and-data-files.md)</ept>.","source":"See [WPF Application Resource, Content, and Data Files](wpf-application-resource-content-and-data-files.md)."},{"content":"Manage windows in standalone applications","pos":[3709,3750]},{"pos":[3751,3803],"content":"See <bpt id=\"p1\">[</bpt>WPF Windows Overview<ept id=\"p1\">](wpf-windows-overview.md)</ept>.","source":"See [WPF Windows Overview](wpf-windows-overview.md)."},{"content":"Track and manage navigation","pos":[3808,3835]},{"pos":[3836,3886],"content":"See <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](navigation-overview.md)</ept>.","source":"See [Navigation Overview](navigation-overview.md)."},{"pos":[3941,3967],"content":"The Application Definition","linkify":"The Application Definition","nodes":[{"content":"The Application Definition","pos":[0,26]}]},{"content":"To utilize the functionality of the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class, you must implement an application definition.","pos":[3971,4093],"source":"To utilize the functionality of the <xref:System.Windows.Application> class, you must implement an application definition."},{"content":"A WPF application definition is a class that derives from <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> and is configured with a special MSBuild setting.","pos":[4094,4235],"source":" A WPF application definition is a class that derives from <xref:System.Windows.Application> and is configured with a special MSBuild setting."},{"pos":[4243,4281],"content":"Implementing an Application Definition","linkify":"Implementing an Application Definition","nodes":[{"content":"Implementing an Application Definition","pos":[0,38]}]},{"content":"A typical WPF application definition is implemented using both markup and code-behind.","pos":[4285,4371]},{"content":"This allows you to use markup to declaratively set application properties, resources, and register events, while handling events and implementing application-specific behavior in code-behind.","pos":[4372,4563]},{"content":"The following example shows how to implement an application definition using both markup and code-behind:","pos":[4570,4675]},{"content":"To allow a markup file and code-behind file to work together, the following needs to happen:","pos":[5178,5270]},{"content":"In markup, the <ph id=\"ph1\">`Application`</ph> element must include the <ph id=\"ph2\">`x:Class`</ph> attribute.","pos":[5278,5352],"source":"In markup, the `Application` element must include the `x:Class` attribute."},{"content":"When the application is built, the existence of <ph id=\"ph1\">`x:Class`</ph> in the markup file causes MSBuild to create a <ph id=\"ph2\">`partial`</ph> class that derives from <ph id=\"ph3\">&lt;xref:System.Windows.Application&gt;</ph> and has the name that is specified by the <ph id=\"ph4\">`x:Class`</ph> attribute.","pos":[5353,5587],"source":" When the application is built, the existence of `x:Class` in the markup file causes MSBuild to create a `partial` class that derives from <xref:System.Windows.Application> and has the name that is specified by the `x:Class` attribute."},{"content":"This requires the addition of an XML namespace declaration for the XAML schema (<ph id=\"ph1\">`xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"`</ph>).","pos":[5588,5726],"source":" This requires the addition of an XML namespace declaration for the XAML schema (`xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"`)."},{"content":"In code-behind, the class must be a <ph id=\"ph1\">`partial`</ph> class with the same name that is specified by the <ph id=\"ph2\">`x:Class`</ph> attribute in markup and must derive from <ph id=\"ph3\">&lt;xref:System.Windows.Application&gt;</ph>.","pos":[5734,5915],"source":"In code-behind, the class must be a `partial` class with the same name that is specified by the `x:Class` attribute in markup and must derive from <xref:System.Windows.Application>."},{"content":"This allows the code-behind file to be associated with the <ph id=\"ph1\">`partial`</ph> class that is generated for the markup file when the application is built (see <bpt id=\"p1\">[</bpt>Building a WPF Application<ept id=\"p1\">](building-a-wpf-application-wpf.md)</ept>).","pos":[5916,6129],"source":" This allows the code-behind file to be associated with the `partial` class that is generated for the markup file when the application is built (see [Building a WPF Application](building-a-wpf-application-wpf.md))."},{"pos":[6137,6348],"content":"[!NOTE]\n When you create a new WPF Application project or WPF Browser Application project using Visual Studio, an application definition is included by default and is defined using both markup and code-behind.","leadings":["","> "],"nodes":[{"content":"When you create a new WPF Application project or WPF Browser Application project using Visual Studio, an application definition is included by default and is defined using both markup and code-behind.","pos":[9,209]}]},{"content":"This code is the minimum that is required to implement an application definition.","pos":[6355,6436]},{"content":"However, an additional MSBuild configuration needs to be made to the application definition before building and running the application.","pos":[6437,6573]},{"pos":[6583,6633],"content":"Configuring the Application Definition for MSBuild","linkify":"Configuring the Application Definition for MSBuild","nodes":[{"content":"Configuring the Application Definition for MSBuild","pos":[0,50]}]},{"content":"Standalone applications and XAML browser applications (XBAPs) require the implementation of a certain level of infrastructure before they can run.","pos":[6637,6783]},{"content":"The most important part of this infrastructure is the entry point.","pos":[6784,6850]},{"content":"When an application is launched by a user, the operating system calls the entry point, which is a well-known function for starting applications.","pos":[6851,6995]},{"content":"Traditionally, developers have needed to write some or all of this code for themselves, depending on the technology.","pos":[7002,7118]},{"content":"However, WPF generates this code for you when the markup file of your application definition is configured as an MSBuild <ph id=\"ph1\">`ApplicationDefinition`</ph> item, as shown in the following MSBuild project file:","pos":[7119,7317],"source":" However, WPF generates this code for you when the markup file of your application definition is configured as an MSBuild `ApplicationDefinition` item, as shown in the following MSBuild project file:"},{"pos":[7584,7684],"content":"Because the code-behind file contains code, it is marked as an MSBuild <ph id=\"ph1\">`Compile`</ph> item, as is normal.","source":"Because the code-behind file contains code, it is marked as an MSBuild `Compile` item, as is normal."},{"content":"The application of these MSBuild configurations to the markup and code-behind files of an application definition causes MSBuild to generate code like the following:","pos":[7691,7855]},{"content":"The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method <ph id=\"ph1\">`Main`</ph>.","pos":[8097,8235],"source":"The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method `Main`."},{"content":"The <ph id=\"ph1\">&lt;xref:System.STAThreadAttribute&gt;</ph> attribute is applied to the <ph id=\"ph2\">`Main`</ph> method to indicate that the main UI thread for the WPF application is an STA thread, which is required for WPF applications.","pos":[8236,8432],"source":" The <xref:System.STAThreadAttribute> attribute is applied to the `Main` method to indicate that the main UI thread for the WPF application is an STA thread, which is required for WPF applications."},{"content":"When called, <ph id=\"ph1\">`Main`</ph> creates a new instance of <ph id=\"ph2\">`App`</ph> before calling the <ph id=\"ph3\">`InitializeComponent`</ph> method to register the events and set the properties that are implemented in markup.","pos":[8433,8610],"source":" When called, `Main` creates a new instance of `App` before calling the `InitializeComponent` method to register the events and set the properties that are implemented in markup."},{"content":"Because <ph id=\"ph1\">`InitializeComponent`</ph> is generated for you, you don't need to explicitly call <ph id=\"ph2\">`InitializeComponent`</ph> from an application definition like you do for <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Page&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Window&gt;</ph> implementations.","pos":[8611,8851],"source":" Because `InitializeComponent` is generated for you, you don't need to explicitly call `InitializeComponent` from an application definition like you do for <xref:System.Windows.Controls.Page> and <xref:System.Windows.Window> implementations."},{"content":"Finally, the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> method is called to start the application.","pos":[8852,8948],"source":" Finally, the <xref:System.Windows.Application.Run%2A> method is called to start the application."},{"pos":[9007,9038],"content":"Getting the Current Application","linkify":"Getting the Current Application","nodes":[{"content":"Getting the Current Application","pos":[0,31]}]},{"content":"Because the functionality of the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class are shared across an application, there can be only one instance of the <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> class per <ph id=\"ph3\">&lt;xref:System.AppDomain&gt;</ph>.","pos":[9042,9255],"source":"Because the functionality of the <xref:System.Windows.Application> class are shared across an application, there can be only one instance of the <xref:System.Windows.Application> class per <xref:System.AppDomain>."},{"content":"To enforce this, the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class is implemented as a singleton class (see <bpt id=\"p1\">[</bpt>Implementing Singleton in C#<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=100567)</ept>), which creates a single instance of itself and provides shared access to it with the <ph id=\"ph2\">`static`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> property.","pos":[9256,9585],"source":" To enforce this, the <xref:System.Windows.Application> class is implemented as a singleton class (see [Implementing Singleton in C#](https://go.microsoft.com/fwlink/?LinkId=100567)), which creates a single instance of itself and provides shared access to it with the `static`<xref:System.Windows.Application.Current%2A> property."},{"pos":[9592,9732],"content":"The following code shows how to acquire a reference to the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> object for the current <ph id=\"ph2\">&lt;xref:System.AppDomain&gt;</ph>.","source":"The following code shows how to acquire a reference to the <xref:System.Windows.Application> object for the current <xref:System.AppDomain>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> returns a reference to an instance of the <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> class.","pos":[10146,10273],"source":"<xref:System.Windows.Application.Current%2A> returns a reference to an instance of the <xref:System.Windows.Application> class."},{"content":"If you want a reference to your <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> derived class you must cast the value of the <ph id=\"ph2\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> property, as shown in the following example.","pos":[10274,10474],"source":" If you want a reference to your <xref:System.Windows.Application> derived class you must cast the value of the <xref:System.Windows.Application.Current%2A> property, as shown in the following example."},{"content":"You can inspect the value of <ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> at any point in the lifetime of an <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> object.","pos":[10896,11046],"source":"You can inspect the value of <xref:System.Windows.Application.Current%2A> at any point in the lifetime of an <xref:System.Windows.Application> object."},{"content":"However, you should be careful.","pos":[11047,11078]},{"content":"After the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class is instantiated, there is a period during which the state of the <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> object is inconsistent.","pos":[11079,11251],"source":" After the <xref:System.Windows.Application> class is instantiated, there is a period during which the state of the <xref:System.Windows.Application> object is inconsistent."},{"content":"During this period, <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events.","pos":[11252,11486],"source":" During this period, <xref:System.Windows.Application> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events."},{"content":"If you try to use the <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> object during this period, your code may have unexpected results, particularly if it depends on the various <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> properties being set.","pos":[11487,11706],"source":" If you try to use the <xref:System.Windows.Application> object during this period, your code may have unexpected results, particularly if it depends on the various <xref:System.Windows.Application> properties being set."},{"pos":[11713,11813],"content":"When <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> completes its initialization work, its lifetime truly begins.","source":"When <xref:System.Windows.Application> completes its initialization work, its lifetime truly begins."},{"pos":[11861,11881],"content":"Application Lifetime","linkify":"Application Lifetime","nodes":[{"content":"Application Lifetime","pos":[0,20]}]},{"pos":[11885,12110],"content":"The lifetime of a WPF application is marked by several events that are raised by <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> to let you know when your application has started, has been activated and deactivated, and has been shut down.","source":"The lifetime of a WPF application is marked by several events that are raised by <xref:System.Windows.Application> to let you know when your application has started, has been activated and deactivated, and has been shut down."},{"pos":[12150,12163],"content":"Splash Screen","linkify":"Splash Screen","nodes":[{"content":"Splash Screen","pos":[0,13]}]},{"content":"Starting in the <ph id=\"ph1\">[!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)]</ph>, you can specify an image to be used in a startup window, or <bpt id=\"p1\">*</bpt>splash screen<ept id=\"p1\">*</ept>.","pos":[12167,12334],"source":"Starting in the [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], you can specify an image to be used in a startup window, or *splash screen*."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.SplashScreen&gt;</ph> class makes it easy to display a startup window while your application is loading.","pos":[12335,12456],"source":" The <xref:System.Windows.SplashScreen> class makes it easy to display a startup window while your application is loading."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.SplashScreen&gt;</ph> window is created and shown before <ph id=\"ph2\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> is called.","pos":[12457,12582],"source":" The <xref:System.Windows.SplashScreen> window is created and shown before <xref:System.Windows.Application.Run%2A> is called."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Application Startup Time<ept id=\"p1\">](../advanced/application-startup-time.md)</ept> and <bpt id=\"p2\">[</bpt>Add a Splash Screen to a WPF Application<ept id=\"p2\">](how-to-add-a-splash-screen-to-a-wpf-application.md)</ept>.","pos":[12583,12776],"source":" For more information, see [Application Startup Time](../advanced/application-startup-time.md) and [Add a Splash Screen to a WPF Application](how-to-add-a-splash-screen-to-a-wpf-application.md)."},{"pos":[12828,12851],"content":"Starting an Application","linkify":"Starting an Application","nodes":[{"content":"Starting an Application","pos":[0,23]}]},{"content":"After <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> is called and the application is initialized, the application is ready to run.","pos":[12855,12980],"source":"After <xref:System.Windows.Application.Run%2A> is called and the application is initialized, the application is ready to run."},{"content":"This moment is signified when the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event is raised:","pos":[12981,13073],"source":" This moment is signified when the <xref:System.Windows.Application.Startup> event is raised:"},{"content":"At this point in an application's lifetime, the most common thing to do is to show a UI.","pos":[13369,13457]},{"pos":[13507,13531],"content":"Showing a User Interface","linkify":"Showing a User Interface","nodes":[{"content":"Showing a User Interface","pos":[0,24]}]},{"content":"Most standalone Windows applications open a <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> when they begin running.","pos":[13535,13632],"source":"Most standalone Windows applications open a <xref:System.Windows.Window> when they begin running."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event handler is one location from which you can do this, as demonstrated by the following code.","pos":[13633,13775],"source":" The <xref:System.Windows.Application.Startup> event handler is one location from which you can do this, as demonstrated by the following code."},{"pos":[14325,14830],"content":"[!NOTE]\n The first <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This <xref:System.Windows.Window> object is referenced by the <xref:System.Windows.Application.MainWindow%2A?displayProperty=nameWithType> property. The value of the <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated <xref:System.Windows.Window> should be the main window.","leadings":["","> "],"nodes":[{"content":"The first <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This <xref:System.Windows.Window> object is referenced by the <xref:System.Windows.Application.MainWindow%2A?displayProperty=nameWithType> property. The value of the <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated <xref:System.Windows.Window> should be the main window.","pos":[9,503],"nodes":[{"content":"The first <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> to be instantiated in a standalone application becomes the main application window by default.","pos":[0,133],"source":"The first <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default."},{"content":"This <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> object is referenced by the <ph id=\"ph2\">&lt;xref:System.Windows.Application.MainWindow%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[134,282],"source":" This <xref:System.Windows.Window> object is referenced by the <xref:System.Windows.Application.MainWindow%2A?displayProperty=nameWithType> property."},{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.Windows.Application.MainWindow%2A&gt;</ph> property can be changed programmatically if a different window than the first instantiated <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> should be the main window.","pos":[283,494],"source":" The value of the <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated <xref:System.Windows.Window> should be the main window."}]}]},{"content":"When an XBAP first starts, it will most likely navigate to a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Page&gt;</ph>.","pos":[14837,14934],"source":"When an XBAP first starts, it will most likely navigate to a <xref:System.Windows.Controls.Page>."},{"content":"This is shown in the following code.","pos":[14935,14971]},{"pos":[15496,15707],"content":"If you handle <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> to only open a <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> or navigate to a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Page&gt;</ph>, you can set the <ph id=\"ph4\">`StartupUri`</ph> attribute in markup instead.","source":"If you handle <xref:System.Windows.Application.Startup> to only open a <xref:System.Windows.Window> or navigate to a <xref:System.Windows.Controls.Page>, you can set the `StartupUri` attribute in markup instead."},{"pos":[15714,15874],"content":"The following example shows how to use the <ph id=\"ph1\">&lt;xref:System.Windows.Application.StartupUri%2A&gt;</ph> from a standalone application to open a <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph>.","source":"The following example shows how to use the <xref:System.Windows.Application.StartupUri%2A> from a standalone application to open a <xref:System.Windows.Window>."},{"pos":[16086,16239],"content":"The following example shows how to use <ph id=\"ph1\">&lt;xref:System.Windows.Application.StartupUri%2A&gt;</ph> from an XBAP to navigate to a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Page&gt;</ph>.","source":"The following example shows how to use <xref:System.Windows.Application.StartupUri%2A> from an XBAP to navigate to a <xref:System.Windows.Controls.Page>."},{"content":"This markup has the same effect as the previous code for opening a window.","pos":[16393,16467]},{"pos":[16475,16572],"content":"[!NOTE]\n For more information on navigation, see [Navigation Overview](navigation-overview.md).","leadings":["","> "],"nodes":[{"content":"For more information on navigation, see <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](navigation-overview.md)</ept>.","pos":[9,95],"source":"For more information on navigation, see [Navigation Overview](navigation-overview.md)."}]},{"pos":[16579,16935],"content":"You need to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event to open a <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched.","source":"You need to handle the <xref:System.Windows.Application.Startup> event to open a <xref:System.Windows.Window> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched."},{"pos":[16997,17030],"content":"Processing Command-Line Arguments","linkify":"Processing Command-Line Arguments","nodes":[{"content":"Processing Command-Line Arguments","pos":[0,33]}]},{"content":"In Windows, standalone applications can be launched from either a command prompt or the desktop.","pos":[17034,17130]},{"content":"In both cases, command-line arguments can be passed to the application.","pos":[17131,17202]},{"content":"The following example shows an application that is launched with a single command-line argument, \"/StartMinimized\":","pos":[17203,17318]},{"content":"During application initialization, WPF retrieves the command-line arguments from the operating system and passes them to the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event handler via the <ph id=\"ph2\">&lt;xref:System.Windows.StartupEventArgs.Args%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.StartupEventArgs&gt;</ph> parameter.","pos":[17368,17669],"source":"During application initialization, WPF retrieves the command-line arguments from the operating system and passes them to the <xref:System.Windows.Application.Startup> event handler via the <xref:System.Windows.StartupEventArgs.Args%2A> property of the <xref:System.Windows.StartupEventArgs> parameter."},{"content":"You can retrieve and store the command-line arguments using code like the following.","pos":[17670,17754]},{"content":"The code handles <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> to check whether the <bpt id=\"p1\">**</bpt>/StartMinimized<ept id=\"p1\">**</ept> command-line argument was provided; if so, it opens the main window with a <ph id=\"ph2\">&lt;xref:System.Windows.WindowState&gt;</ph> of <ph id=\"ph3\">&lt;xref:System.Windows.WindowState.Minimized&gt;</ph>.","pos":[18311,18567],"source":"The code handles <xref:System.Windows.Application.Startup> to check whether the **/StartMinimized** command-line argument was provided; if so, it opens the main window with a <xref:System.Windows.WindowState> of <xref:System.Windows.WindowState.Minimized>."},{"content":"Note that because the <ph id=\"ph1\">&lt;xref:System.Windows.Window.WindowState%2A&gt;</ph> property must be set programmatically, the main <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> must be opened explicitly in code.","pos":[18568,18745],"source":" Note that because the <xref:System.Windows.Window.WindowState%2A> property must be set programmatically, the main <xref:System.Windows.Window> must be opened explicitly in code."},{"content":"XBAPs cannot retrieve and process command-line arguments because they are launched using ClickOnce deployment (see <bpt id=\"p1\">[</bpt>Deploying a WPF Application<ept id=\"p1\">](deploying-a-wpf-application-wpf.md)</ept>).","pos":[18752,18934],"source":"XBAPs cannot retrieve and process command-line arguments because they are launched using ClickOnce deployment (see [Deploying a WPF Application](deploying-a-wpf-application-wpf.md))."},{"content":"However, they can retrieve and process query string parameters from the URLs that are used to launch them.","pos":[18935,19041]},{"pos":[19109,19148],"content":"Application Activation and Deactivation","linkify":"Application Activation and Deactivation","nodes":[{"content":"Application Activation and Deactivation","pos":[0,39]}]},{"content":"Windows allows users to switch between applications.","pos":[19152,19204]},{"content":"The most common way is to use the ALT+TAB key combination.","pos":[19205,19263]},{"content":"An application can only be switched to if it has a visible <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> that a user can select.","pos":[19264,19375],"source":" An application can only be switched to if it has a visible <xref:System.Windows.Window> that a user can select."},{"content":"The currently selected <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> is the <bpt id=\"p1\">*</bpt>active window<ept id=\"p1\">*</ept> (also known as the <bpt id=\"p2\">*</bpt>foreground window<ept id=\"p2\">*</ept>) and is the <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> that receives user input.","pos":[19376,19556],"source":" The currently selected <xref:System.Windows.Window> is the *active window* (also known as the *foreground window*) and is the <xref:System.Windows.Window> that receives user input."},{"content":"The application with the active window is the <bpt id=\"p1\">*</bpt>active application<ept id=\"p1\">*</ept> (or <bpt id=\"p2\">*</bpt>foreground application<ept id=\"p2\">*</ept>).","pos":[19557,19654],"source":" The application with the active window is the *active application* (or *foreground application*)."},{"content":"An application becomes the active application in the following circumstances:","pos":[19655,19732]},{"pos":[19742,19798],"content":"It is launched and shows a <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","source":"It is launched and shows a <xref:System.Windows.Window>."},{"pos":[19808,19912],"content":"A user switches from another application by selecting a <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> in the application.","source":"A user switches from another application by selecting a <xref:System.Windows.Window> in the application."},{"pos":[19919,20064],"content":"You can detect when an application becomes active by handling the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated?displayProperty=nameWithType&gt;</ph> event.","source":"You can detect when an application becomes active by handling the <xref:System.Windows.Application.Activated?displayProperty=nameWithType> event."},{"content":"Likewise, an application can become inactive in the following circumstances:","pos":[20071,20147]},{"content":"A user switches to another application from the current one.","pos":[20157,20217]},{"content":"When the application shuts down.","pos":[20227,20259]},{"pos":[20266,20415],"content":"You can detect when an application becomes inactive by handling the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Deactivated?displayProperty=nameWithType&gt;</ph> event.","source":"You can detect when an application becomes inactive by handling the <xref:System.Windows.Application.Deactivated?displayProperty=nameWithType> event."},{"pos":[20422,20612],"content":"The following code shows how to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Application.Deactivated&gt;</ph> events to determine whether an application is active.","source":"The following code shows how to handle the <xref:System.Windows.Application.Activated> and <xref:System.Windows.Application.Deactivated> events to determine whether an application is active."},{"pos":[20810,21228],"content":"[!code-csharp[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)]\n[!code-vb[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)]","leadings":[""," "],"nodes":[]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> can also be activated and deactivated.","pos":[21235,21304],"source":"A <xref:System.Windows.Window> can also be activated and deactivated."},{"content":"See <ph id=\"ph1\">&lt;xref:System.Windows.Window.Activated?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Window.Deactivated?displayProperty=nameWithType&gt;</ph> for more information.","pos":[21305,21472],"source":" See <xref:System.Windows.Window.Activated?displayProperty=nameWithType> and <xref:System.Windows.Window.Deactivated?displayProperty=nameWithType> for more information."},{"pos":[21480,21671],"content":"[!NOTE]\n Neither <xref:System.Windows.Application.Activated?displayProperty=nameWithType> nor <xref:System.Windows.Application.Deactivated?displayProperty=nameWithType> is raised for XBAPs.","leadings":["","> "],"nodes":[{"content":"Neither <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated?displayProperty=nameWithType&gt;</ph> nor <ph id=\"ph2\">&lt;xref:System.Windows.Application.Deactivated?displayProperty=nameWithType&gt;</ph> is raised for XBAPs.","pos":[9,189],"source":"Neither <xref:System.Windows.Application.Activated?displayProperty=nameWithType> nor <xref:System.Windows.Application.Deactivated?displayProperty=nameWithType> is raised for XBAPs."}]},{"pos":[21720,21740],"content":"Application Shutdown","linkify":"Application Shutdown","nodes":[{"content":"Application Shutdown","pos":[0,20]}]},{"content":"The life of an application ends when it is shut down, which can occur for the following reasons:","pos":[21744,21840]},{"pos":[21850,21899],"content":"A user closes every <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","source":"A user closes every <xref:System.Windows.Window>."},{"pos":[21909,21961],"content":"A user closes the main <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","source":"A user closes the main <xref:System.Windows.Window>."},{"content":"A user ends the Windows session by logging off or shutting down.","pos":[21971,22035]},{"content":"An application-specific condition has been met.","pos":[22045,22092]},{"pos":[22099,22411],"content":"To help you manage application shutdown, <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> provides the <ph id=\"ph2\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method, the <ph id=\"ph3\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> property, and the <ph id=\"ph4\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Application.Exit&gt;</ph> events.","source":"To help you manage application shutdown, <xref:System.Windows.Application> provides the <xref:System.Windows.Application.Shutdown%2A> method, the <xref:System.Windows.Application.ShutdownMode%2A> property, and the <xref:System.Windows.Application.SessionEnding> and <xref:System.Windows.Application.Exit> events."},{"pos":[22419,22711],"content":"[!NOTE]\n <xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have <xref:System.Security.Permissions.UIPermission>. Standalone WPF applications always have this permission. However, XBAPs running in the Internet zone partial-trust security sandbox do not.","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have <xref:System.Security.Permissions.UIPermission>. Standalone WPF applications always have this permission. However, XBAPs running in the Internet zone partial-trust security sandbox do not.","pos":[9,290],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> can only be called from applications that have <ph id=\"ph2\">&lt;xref:System.Security.Permissions.UIPermission&gt;</ph>.","pos":[0,141],"source":"<xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have <xref:System.Security.Permissions.UIPermission>."},{"content":"Standalone WPF applications always have this permission.","pos":[142,198]},{"content":"However, XBAPs running in the Internet zone partial-trust security sandbox do not.","pos":[199,281]}]}]},{"pos":[22722,22735],"content":"Shutdown Mode","linkify":"Shutdown Mode","nodes":[{"content":"Shutdown Mode","pos":[0,13]}]},{"content":"Most applications shut down either when all the windows are closed or when the main window is closed.","pos":[22739,22840]},{"content":"Sometimes, however, other application-specific conditions may determine when an application shuts down.","pos":[22841,22944]},{"content":"You can specify the conditions under which your application will shut down by setting <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> with one of the following <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode&gt;</ph> enumeration values:","pos":[22945,23161],"source":" You can specify the conditions under which your application will shut down by setting <xref:System.Windows.Application.ShutdownMode%2A> with one of the following <xref:System.Windows.ShutdownMode> enumeration values:"},{"content":"The default value of <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> is <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode.OnLastWindowClose&gt;</ph>, which means that an application automatically shuts down when the last window in the application is closed by the user.","pos":[23355,23602],"source":"The default value of <xref:System.Windows.Application.ShutdownMode%2A> is <xref:System.Windows.ShutdownMode.OnLastWindowClose>, which means that an application automatically shuts down when the last window in the application is closed by the user."},{"content":"However, if your application should be shut down when the main window is closed, WPF automatically does that if you set <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> to <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode.OnMainWindowClose&gt;</ph>.","pos":[23603,23829],"source":" However, if your application should be shut down when the main window is closed, WPF automatically does that if you set <xref:System.Windows.Application.ShutdownMode%2A> to <xref:System.Windows.ShutdownMode.OnMainWindowClose>."},{"content":"This is shown in the following example.","pos":[23830,23869]},{"content":"When you have application-specific shutdown conditions, you set <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> to <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode.OnExplicitShutdown&gt;</ph>.","pos":[24065,24236],"source":"When you have application-specific shutdown conditions, you set <xref:System.Windows.Application.ShutdownMode%2A> to <xref:System.Windows.ShutdownMode.OnExplicitShutdown>."},{"content":"In this case, it is your responsibility to shut an application down by explicitly calling the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method; otherwise, your application will continue running even if all the windows are closed.","pos":[24237,24470],"source":" In this case, it is your responsibility to shut an application down by explicitly calling the <xref:System.Windows.Application.Shutdown%2A> method; otherwise, your application will continue running even if all the windows are closed."},{"content":"Note that <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> is called implicitly when the <ph id=\"ph2\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> is either <ph id=\"ph3\">&lt;xref:System.Windows.ShutdownMode.OnLastWindowClose&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.ShutdownMode.OnMainWindowClose&gt;</ph>.","pos":[24471,24726],"source":" Note that <xref:System.Windows.Application.Shutdown%2A> is called implicitly when the <xref:System.Windows.Application.ShutdownMode%2A> is either <xref:System.Windows.ShutdownMode.OnLastWindowClose> or <xref:System.Windows.ShutdownMode.OnMainWindowClose>."},{"pos":[24734,25034],"content":"[!NOTE]\n <xref:System.Windows.Application.ShutdownMode%2A> can be set from an XBAP, but it is ignored; an XBAP is always shut down when it is navigated away from in a browser or when the browser that hosts the XBAP is closed. For more information, see [Navigation Overview](navigation-overview.md).","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Application.ShutdownMode%2A> can be set from an XBAP, but it is ignored; an XBAP is always shut down when it is navigated away from in a browser or when the browser that hosts the XBAP is closed. For more information, see [Navigation Overview](navigation-overview.md).","pos":[9,298],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> can be set from an XBAP, but it is ignored; an XBAP is always shut down when it is navigated away from in a browser or when the browser that hosts the XBAP is closed.","pos":[0,216],"source":"<xref:System.Windows.Application.ShutdownMode%2A> can be set from an XBAP, but it is ignored; an XBAP is always shut down when it is navigated away from in a browser or when the browser that hosts the XBAP is closed."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](navigation-overview.md)</ept>.","pos":[217,289],"source":" For more information, see [Navigation Overview](navigation-overview.md)."}]}]},{"pos":[25045,25059],"content":"Session Ending","linkify":"Session Ending","nodes":[{"content":"Session Ending","pos":[0,14]}]},{"content":"The shutdown conditions that are described by the <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> property are specific to an application.","pos":[25063,25203],"source":"The shutdown conditions that are described by the <xref:System.Windows.Application.ShutdownMode%2A> property are specific to an application."},{"content":"In some cases, though, an application may shut down as a result of an external condition.","pos":[25204,25293]},{"content":"The most common external condition occurs when a user ends the Windows session by the following actions:","pos":[25294,25398]},{"content":"Logging off","pos":[25408,25419]},{"content":"Shutting down","pos":[25429,25442]},{"content":"Restarting","pos":[25452,25462]},{"content":"Hibernating","pos":[25472,25483]},{"pos":[25490,25643],"content":"To detect when a Windows session ends, you can handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> event, as illustrated in the following example.","source":"To detect when a Windows session ends, you can handle the <xref:System.Windows.Application.SessionEnding> event, as illustrated in the following example."},{"pos":[25847,26277],"content":"[!code-csharp[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)]\n[!code-vb[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)]","leadings":[""," "],"nodes":[]},{"content":"In this example, the code inspects the <ph id=\"ph1\">&lt;xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A&gt;</ph> property to determine how the Windows session is ending.","pos":[26284,26453],"source":"In this example, the code inspects the <xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A> property to determine how the Windows session is ending."},{"content":"It uses this value to display a confirmation message to the user.","pos":[26454,26519]},{"content":"If the user does not want the session to end, the code sets <ph id=\"ph1\">&lt;xref:System.ComponentModel.CancelEventArgs.Cancel%2A&gt;</ph> to <ph id=\"ph2\">`true`</ph> to prevent the Windows session from ending.","pos":[26520,26688],"source":" If the user does not want the session to end, the code sets <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> to `true` to prevent the Windows session from ending."},{"pos":[26696,26779],"content":"[!NOTE]\n <xref:System.Windows.Application.SessionEnding> is not raised for XBAPs.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> is not raised for XBAPs.","pos":[9,81],"source":"<xref:System.Windows.Application.SessionEnding> is not raised for XBAPs."}]},{"pos":[26786,26790],"content":"Exit","linkify":"Exit","nodes":[{"content":"Exit","pos":[0,4]}]},{"content":"When an application shuts down, it may need to perform some final processing, such as persisting application state.","pos":[26794,26909]},{"content":"For these situations, you can handle the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event, as the <ph id=\"ph2\">`App_Exit`</ph> event handler does in the following example.","pos":[26910,27059],"source":" For these situations, you can handle the <xref:System.Windows.Application.Exit> event, as the `App_Exit` event handler does in the following example."},{"content":"It is defined as an event handler in the <bpt id=\"p1\">*</bpt>App.xaml<ept id=\"p1\">*</ept> file.","pos":[27060,27117],"source":" It is defined as an event handler in the *App.xaml* file."},{"content":"Its implementation is highlighted in the <bpt id=\"p1\">*</bpt>App.xaml.cs<ept id=\"p1\">*</ept> and <bpt id=\"p2\">*</bpt>Application.xaml.vb<ept id=\"p2\">*</ept> files.","pos":[27118,27205],"source":" Its implementation is highlighted in the *App.xaml.cs* and *Application.xaml.vb* files."},{"pos":[27681,27843],"content":"For the complete example, see <bpt id=\"p1\">[</bpt>Persist and Restore Application-Scope Properties Across Application Sessions<ept id=\"p1\">](persist-and-restore-application-scope-properties.md)</ept>.","source":"For the complete example, see [Persist and Restore Application-Scope Properties Across Application Sessions](persist-and-restore-application-scope-properties.md)."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> can be handled by both standalone applications and XBAPs.","pos":[27850,27946],"source":"<xref:System.Windows.Application.Exit> can be handled by both standalone applications and XBAPs."},{"content":"For XBAPs, <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> is raised when in the following circumstances:","pos":[27947,28043],"source":" For XBAPs, <xref:System.Windows.Application.Exit> is raised when in the following circumstances:"},{"content":"An XBAP is navigated away from.","pos":[28053,28084]},{"pos":[28094,28216],"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)]</ph>, when the tab that is hosting the XBAP is closed.","source":"In [!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)], when the tab that is hosting the XBAP is closed."},{"content":"When the browser is closed.","pos":[28226,28253]},{"pos":[28264,28273],"content":"Exit Code","linkify":"Exit Code","nodes":[{"content":"Exit Code","pos":[0,9]}]},{"content":"Applications are mostly launched by the operating system in response to a user request.","pos":[28277,28364]},{"content":"However, an application can be launched by another application to perform some specific task.","pos":[28365,28458]},{"content":"When the launched application shuts down, the launching application may want to know the condition under which the launched application shut down.","pos":[28459,28605]},{"content":"In these situations, Windows allows applications to return an application exit code on shutdown.","pos":[28606,28702]},{"content":"By default, WPF applications return an exit code value of 0.","pos":[28703,28763]},{"pos":[28771,28957],"content":"[!NOTE]\n When you debug from Visual Studio, the application exit code is displayed in the **Output** window when the application shuts down, in a message that looks like the following:","leadings":["","> "],"nodes":[{"content":"When you debug from Visual Studio, the application exit code is displayed in the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window when the application shuts down, in a message that looks like the following:","pos":[9,184],"source":"When you debug from Visual Studio, the application exit code is displayed in the **Output** window when the application shuts down, in a message that looks like the following:"}]},{"pos":[29059,29134],"content":"You open the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window by clicking <bpt id=\"p2\">**</bpt>Output<ept id=\"p2\">**</ept> on the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","source":"You open the **Output** window by clicking **Output** on the **View** menu."},{"pos":[29141,29308],"content":"To change the exit code, you can call the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%28System.Int32%29&gt;</ph> overload, which accepts an integer argument to be the exit code:","source":"To change the exit code, you can call the <xref:System.Windows.Application.Shutdown%28System.Int32%29> overload, which accepts an integer argument to be the exit code:"},{"content":"You can detect the value of the exit code, and change it, by handling the <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event.","pos":[29642,29761],"source":"You can detect the value of the exit code, and change it, by handling the <xref:System.Windows.Application.Exit> event."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event handler is passed an <ph id=\"ph2\">&lt;xref:System.Windows.ExitEventArgs&gt;</ph> which provides access to the exit code with the <ph id=\"ph3\">&lt;xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A&gt;</ph> property.","pos":[29762,29984],"source":" The <xref:System.Windows.Application.Exit> event handler is passed an <xref:System.Windows.ExitEventArgs> which provides access to the exit code with the <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A> property."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph>.","pos":[29985,30050],"source":" For more information, see <xref:System.Windows.Application.Exit>."},{"pos":[30058,30188],"content":"[!NOTE]\n You can set the exit code in both standalone applications and XBAPs. However, the exit code value is ignored for XBAPs.","leadings":["","> "],"nodes":[{"content":"You can set the exit code in both standalone applications and XBAPs. However, the exit code value is ignored for XBAPs.","pos":[9,128],"nodes":[{"content":"You can set the exit code in both standalone applications and XBAPs.","pos":[0,68]},{"content":"However, the exit code value is ignored for XBAPs.","pos":[69,119]}]}]},{"pos":[30237,30257],"content":"Unhandled Exceptions","linkify":"Unhandled Exceptions","nodes":[{"content":"Unhandled Exceptions","pos":[0,20]}]},{"content":"Sometimes an application may shut down under abnormal conditions, such as when an unanticipated exception is thrown.","pos":[30261,30377]},{"content":"In this case, the application may not have the code to detect and process the exception.","pos":[30378,30466]},{"content":"This type of exception is an unhandled exception; a notification similar to that shown in the following figure is displayed before the application is closed.","pos":[30467,30624]},{"content":"Screenshot that shows an unhandled exception notification.","pos":[30633,30691]},{"content":"From the user experience perspective, it is better for an application to avoid this default behavior by doing some or all of the following:","pos":[30777,30916]},{"content":"Displaying user-friendly information.","pos":[30926,30963]},{"content":"Attempting to keep an application running.","pos":[30973,31015]},{"content":"Recording detailed, developer-friendly exception information in the Windows event log.","pos":[31025,31111]},{"pos":[31118,31299],"content":"Implementing this support depends on being able to detect unhandled exceptions, which is what the <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event is raised for.","source":"Implementing this support depends on being able to detect unhandled exceptions, which is what the <xref:System.Windows.Application.DispatcherUnhandledException> event is raised for."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event handler is passed a <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs&gt;</ph> parameter that contains contextual information regarding the unhandled exception, including the exception itself (<ph id=\"ph3\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=nameWithType&gt;</ph>).","pos":[31845,32235],"source":"The <xref:System.Windows.Application.DispatcherUnhandledException> event handler is passed a <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs> parameter that contains contextual information regarding the unhandled exception, including the exception itself (<xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=nameWithType>)."},{"content":"You can use this information to determine how to handle the exception.","pos":[32236,32306]},{"content":"When you handle <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph>, you should set the <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=nameWithType&gt;</ph> property to <ph id=\"ph3\">`true`</ph>; otherwise, WPF still considers the exception to be unhandled and reverts to the default behavior described earlier.","pos":[32313,32657],"source":"When you handle <xref:System.Windows.Application.DispatcherUnhandledException>, you should set the <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=nameWithType> property to `true`; otherwise, WPF still considers the exception to be unhandled and reverts to the default behavior described earlier."},{"content":"If an unhandled exception is raised and either the <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event is not handled, or the event is handled and <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A&gt;</ph> is set to <ph id=\"ph3\">`false`</ph>, the application shuts down immediately.","pos":[32658,32961],"source":" If an unhandled exception is raised and either the <xref:System.Windows.Application.DispatcherUnhandledException> event is not handled, or the event is handled and <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A> is set to `false`, the application shuts down immediately."},{"content":"Furthermore, no other <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> events are raised.","pos":[32962,33036],"source":" Furthermore, no other <xref:System.Windows.Application> events are raised."},{"content":"Consequently, you need to handle <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> if your application has code that must run before the application shuts down.","pos":[33037,33210],"source":" Consequently, you need to handle <xref:System.Windows.Application.DispatcherUnhandledException> if your application has code that must run before the application shuts down."},{"content":"Although an application may shut down as a result of an unhandled exception, an application usually shuts down in response to a user request, as discussed in the next section.","pos":[33217,33392]},{"pos":[33448,33475],"content":"Application Lifetime Events","linkify":"Application Lifetime Events","nodes":[{"content":"Application Lifetime Events","pos":[0,27]}]},{"content":"Standalone applications and XBAPs don't have exactly the same lifetimes.","pos":[33479,33551]},{"content":"The following figure illustrates the key events in the lifetime of a standalone application and shows the sequence in which they are raised.","pos":[33552,33692]},{"pos":[33699,33869],"content":"<bpt id=\"p1\">![</bpt>Standalone Application &amp;#45; Application Object Events<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/applicationmodeloverview-applicationobjectevents.png \"</bpt>ApplicationModelOverview_ApplicationObjectEvents<ept id=\"p2\">\")</ept>","source":"![Standalone Application &#45; Application Object Events](./media/applicationmodeloverview-applicationobjectevents.png \"ApplicationModelOverview_ApplicationObjectEvents\")"},{"content":"Likewise, the following figure illustrates the key events in the lifetime of an XBAP, and shows the sequence in which they are raised.","pos":[33876,34010]},{"pos":[34017,34179],"content":"<bpt id=\"p1\">![</bpt>XBAP &amp;#45; Application Object Events<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/applicationmodeloverview-applicationobjectevents-xbap.png \"</bpt>ApplicationModelOverview_ApplicationObjectEvents_xbap<ept id=\"p2\">\")</ept>","source":"![XBAP &#45; Application Object Events](./media/applicationmodeloverview-applicationobjectevents-xbap.png \"ApplicationModelOverview_ApplicationObjectEvents_xbap\")"},{"pos":[34188,34196],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[34236,34283],"content":"<bpt id=\"p1\">[</bpt>WPF Windows Overview<ept id=\"p1\">](wpf-windows-overview.md)</ept>","source":"[WPF Windows Overview](wpf-windows-overview.md)"},{"pos":[34286,34331],"content":"<bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](navigation-overview.md)</ept>","source":"[Navigation Overview](navigation-overview.md)"},{"pos":[34334,34437],"content":"<bpt id=\"p1\">[</bpt>WPF Application Resource, Content, and Data Files<ept id=\"p1\">](wpf-application-resource-content-and-data-files.md)</ept>","source":"[WPF Application Resource, Content, and Data Files](wpf-application-resource-content-and-data-files.md)"},{"pos":[34440,34479],"content":"<bpt id=\"p1\">[</bpt>Pack URIs in WPF<ept id=\"p1\">](pack-uris-in-wpf.md)</ept>","source":"[Pack URIs in WPF](pack-uris-in-wpf.md)"},{"pos":[34482,34605],"content":"<bpt id=\"p1\">[</bpt>Application Model: How-to Topics<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms749013(v=vs.100))</ept>","source":"[Application Model: How-to Topics](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms749013(v=vs.100))"},{"pos":[34608,34643],"content":"<bpt id=\"p1\">[</bpt>Application Development<ept id=\"p1\">](index.md)</ept>","source":"[Application Development](index.md)"}]}