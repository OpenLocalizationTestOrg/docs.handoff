{"content":"---\ntitle: \"Walkthrough: Creating COM Objects with Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"COM interop [Visual Basic], creating COM objects\"\n  - \"COM objects, creating\"\n  - \"COM interop [Visual Basic], walkthroughs\"\n  - \"object creation [Visual Basic], COM objects\"\n  - \"COM objects, walkthroughs\"\nms.assetid: 7b07a463-bc72-4392-9ba0-9dfcb697a44f\n---\n# Walkthrough: Creating COM Objects with Visual Basic\nWhen creating new applications or components, it is best to create .NET Framework assemblies. However, Visual Basic also makes it easy to expose a .NET Framework component to COM. This enables you to provide new components for earlier application suites that require COM components. This walkthrough demonstrates how to use Visual Basic to expose [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] objects as COM objects, both with and without the COM class template.  \n  \n The easiest way to expose COM objects is by using the COM class template. The COM class template creates a new class, and then configures your project to generate the class and interoperability layer as a COM object and register it with the operating system.  \n  \n> [!NOTE]\n>  Although you can also expose a class created in Visual Basic as a COM object for unmanaged code to use, it is not a true COM object and cannot be used by Visual Basic. For more information, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).  \n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n### To create a COM object by using the COM class template  \n  \n1.  Open a new Windows Application project from the **File** menu by clicking **New Project**.  \n  \n2.  In the **New Project** dialog box under the **Project Types** field, check that Windows is selected. Select **Class Library** from the **Templates** list, and then click **OK**. The new project is displayed.  \n  \n3.  Select **Add New Item** from the **Project** menu. The **Add New Item** dialog box is displayed.  \n  \n4.  Select **COM Class** from the **Templates** list, and then click **Add**. Visual Basic adds a new class and configures the new project for COM interop.  \n  \n5.  Add code such as properties, methods, and events to the COM class.  \n  \n6.  Select **Build ClassLibrary1** from the **Build** menu. Visual Basic builds the assembly and registers the COM object with the operating system.  \n  \n## Creating COM Objects without the COM Class Template  \n You can also create a COM class manually instead of using the COM class template. This procedure is helpful when you are working from the command line or when you want more control over how COM objects are defined.  \n  \n#### To set up your project to generate a COM object  \n  \n1.  Open a new Windows Application project from the **File** menu by clicking **NewProject**.  \n  \n2.  In the **New Project** dialog box under the **Project Types** field, check that Windows is selected. Select **Class Library** from the **Templates** list, and then click **OK**. The new project is displayed.  \n  \n3.  In **Solution Explorer**, right-click your project, and then click **Properties**. The **Project Designer** is displayed.  \n  \n4.  Click the **Compile** tab.  \n  \n5.  Select the **Register for COM Interop** check box.  \n  \n#### To set up the code in your class to create a COM object  \n  \n1.  In **Solution Explorer**, double-click **Class1.vb** to display its code.  \n  \n2.  Rename the class to `ComClass1`.  \n  \n3.  Add the following constants to `ComClass1`. They will store the Globally Unique Identifier (GUID) constants that the COM objects are required to have.  \n  \n     [!code-vb[VbVbalrInterop#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#2)]  \n  \n4.  On the **Tools** menu, click **Create Guid**. In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**. Click **Exit**.  \n  \n5.  Replace the empty string for the `ClassId` with the GUID, removing the leading and trailing braces. For example, if the GUID provided by Guidgen is `\"{2C8B0AEE-02C9-486e-B809-C780A11530FE}\"` then your code should appear as follows.  \n  \n     [!code-vb[VbVbalrInterop#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#3)]  \n  \n6.  Repeat the previous steps for the `InterfaceId` and `EventsId` constants, as in the following example.  \n  \n     [!code-vb[VbVbalrInterop#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#4)]  \n  \n    > [!NOTE]\n    >  Make sure that the GUIDs are new and unique; otherwise, your COM component could conflict with other COM components.  \n  \n7.  Add the `ComClass` attribute to `ComClass1`, specifying the GUIDs for the Class ID, Interface ID, and Events ID as in the following example:  \n  \n     [!code-vb[VbVbalrInterop#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#5)]  \n  \n8.  COM classes must have a parameterless `Public Sub New()` constructor, or the class will not register correctly. Add a parameterless constructor to the class:  \n  \n     [!code-vb[VbVbalrInterop#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#6)]  \n  \n9. Add properties, methods, and events to the class, ending it with an `End Class` statement. Select **Build Solution** from the **Build** menu. Visual Basic builds the assembly and registers the COM object with the operating system.  \n  \n    > [!NOTE]\n    >  The COM objects you generate with Visual Basic cannot be used by other Visual Basic applications because they are not true COM objects. Attempts to add references to such COM objects will raise an error. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.ComClassAttribute>\n- [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)\n- [Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)\n- [#Region Directive](../../../visual-basic/language-reference/directives/region-directive.md)\n- [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)\n- [Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)\n","nodes":[{"pos":[4,367],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating COM Objects with Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"COM interop [Visual Basic], creating COM objects\"\n  - \"COM objects, creating\"\n  - \"COM interop [Visual Basic], walkthroughs\"\n  - \"object creation [Visual Basic], COM objects\"\n  - \"COM objects, walkthroughs\"\nms.assetid: 7b07a463-bc72-4392-9ba0-9dfcb697a44f","nodes":[{"content":"Walkthrough: Creating COM Objects with Visual Basic","nodes":[{"pos":[0,51],"content":"Walkthrough: Creating COM Objects with Visual Basic","nodes":[{"content":"Walkthrough: Creating COM Objects with Visual Basic","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[374,425],"content":"Walkthrough: Creating COM Objects with Visual Basic","linkify":"Walkthrough: Creating COM Objects with Visual Basic","nodes":[{"content":"Walkthrough: Creating COM Objects with Visual Basic","pos":[0,51]}]},{"content":"When creating new applications or components, it is best to create .NET Framework assemblies.","pos":[426,519]},{"content":"However, Visual Basic also makes it easy to expose a .NET Framework component to COM.","pos":[520,605]},{"content":"This enables you to provide new components for earlier application suites that require COM components.","pos":[606,708]},{"content":"This walkthrough demonstrates how to use Visual Basic to expose <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> objects as COM objects, both with and without the COM class template.","pos":[709,896],"source":" This walkthrough demonstrates how to use Visual Basic to expose [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] objects as COM objects, both with and without the COM class template."},{"content":"The easiest way to expose COM objects is by using the COM class template.","pos":[903,976]},{"content":"The COM class template creates a new class, and then configures your project to generate the class and interoperability layer as a COM object and register it with the operating system.","pos":[977,1161]},{"pos":[1169,1535],"content":"[!NOTE]\n Although you can also expose a class created in Visual Basic as a COM object for unmanaged code to use, it is not a true COM object and cannot be used by Visual Basic. For more information, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","leadings":["","> "],"nodes":[{"content":"Although you can also expose a class created in Visual Basic as a COM object for unmanaged code to use, it is not a true COM object and cannot be used by Visual Basic. For more information, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","pos":[9,364],"nodes":[{"content":"Although you can also expose a class created in Visual Basic as a COM object for unmanaged code to use, it is not a true COM object and cannot be used by Visual Basic.","pos":[0,167]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept>.","pos":[168,355],"source":" For more information, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)."}]}]},{"pos":[1624,1678],"content":"To create a COM object by using the COM class template","linkify":"To create a COM object by using the COM class template","nodes":[{"content":"To create a COM object by using the COM class template","pos":[0,54]}]},{"pos":[1688,1778],"content":"Open a new Windows Application project from the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu by clicking <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept>.","source":"Open a new Windows Application project from the **File** menu by clicking **New Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box under the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> field, check that Windows is selected.","pos":[1788,1888],"source":"In the **New Project** dialog box under the **Project Types** field, check that Windows is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Class Library<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> list, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[1889,1965],"source":" Select **Class Library** from the **Templates** list, and then click **OK**."},{"content":"The new project is displayed.","pos":[1966,1995]},{"content":"Select <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Project<ept id=\"p2\">**</ept> menu.","pos":[2005,2055],"source":"Select **Add New Item** from the **Project** menu."},{"content":"The <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box is displayed.","pos":[2056,2101],"source":" The **Add New Item** dialog box is displayed."},{"content":"Select <bpt id=\"p1\">**</bpt>COM Class<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> list, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[2111,2184],"source":"Select **COM Class** from the **Templates** list, and then click **Add**."},{"content":"Visual Basic adds a new class and configures the new project for COM interop.","pos":[2185,2262]},{"content":"Add code such as properties, methods, and events to the COM class.","pos":[2272,2338]},{"content":"Select <bpt id=\"p1\">**</bpt>Build ClassLibrary1<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","pos":[2348,2403],"source":"Select **Build ClassLibrary1** from the **Build** menu."},{"content":"Visual Basic builds the assembly and registers the COM object with the operating system.","pos":[2404,2492]},{"pos":[2501,2552],"content":"Creating COM Objects without the COM Class Template","linkify":"Creating COM Objects without the COM Class Template","nodes":[{"content":"Creating COM Objects without the COM Class Template","pos":[0,51]}]},{"content":"You can also create a COM class manually instead of using the COM class template.","pos":[2556,2637]},{"content":"This procedure is helpful when you are working from the command line or when you want more control over how COM objects are defined.","pos":[2638,2770]},{"pos":[2781,2828],"content":"To set up your project to generate a COM object","linkify":"To set up your project to generate a COM object","nodes":[{"content":"To set up your project to generate a COM object","pos":[0,47]}]},{"pos":[2838,2927],"content":"Open a new Windows Application project from the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu by clicking <bpt id=\"p2\">**</bpt>NewProject<ept id=\"p2\">**</ept>.","source":"Open a new Windows Application project from the **File** menu by clicking **NewProject**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box under the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> field, check that Windows is selected.","pos":[2937,3037],"source":"In the **New Project** dialog box under the **Project Types** field, check that Windows is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Class Library<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> list, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[3038,3114],"source":" Select **Class Library** from the **Templates** list, and then click **OK**."},{"content":"The new project is displayed.","pos":[3115,3144]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click your project, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[3154,3236],"source":"In **Solution Explorer**, right-click your project, and then click **Properties**."},{"content":"The <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept> is displayed.","pos":[3237,3275],"source":" The **Project Designer** is displayed."},{"pos":[3285,3311],"content":"Click the <bpt id=\"p1\">**</bpt>Compile<ept id=\"p1\">**</ept> tab.","source":"Click the **Compile** tab."},{"pos":[3321,3371],"content":"Select the <bpt id=\"p1\">**</bpt>Register for COM Interop<ept id=\"p1\">**</ept> check box.","source":"Select the **Register for COM Interop** check box."},{"pos":[3382,3437],"content":"To set up the code in your class to create a COM object","linkify":"To set up the code in your class to create a COM object","nodes":[{"content":"To set up the code in your class to create a COM object","pos":[0,55]}]},{"pos":[3447,3520],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Class1.vb<ept id=\"p2\">**</ept> to display its code.","source":"In **Solution Explorer**, double-click **Class1.vb** to display its code."},{"pos":[3530,3562],"content":"Rename the class to <ph id=\"ph1\">`ComClass1`</ph>.","source":"Rename the class to `ComClass1`."},{"content":"Add the following constants to <ph id=\"ph1\">`ComClass1`</ph>.","pos":[3572,3615],"source":"Add the following constants to `ComClass1`."},{"content":"They will store the Globally Unique Identifier (GUID) constants that the COM objects are required to have.","pos":[3616,3722]},{"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Create Guid<ept id=\"p2\">**</ept>.","pos":[3854,3899],"source":"On the **Tools** menu, click **Create Guid**."},{"content":"In the <bpt id=\"p1\">**</bpt>Create GUID<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Registry Format<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Copy<ept id=\"p3\">**</ept>.","pos":[3900,3985],"source":" In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**."},{"content":"Click <bpt id=\"p1\">**</bpt>Exit<ept id=\"p1\">**</ept>.","pos":[3986,4001],"source":" Click **Exit**."},{"content":"Replace the empty string for the <ph id=\"ph1\">`ClassId`</ph> with the GUID, removing the leading and trailing braces.","pos":[4011,4110],"source":"Replace the empty string for the `ClassId` with the GUID, removing the leading and trailing braces."},{"content":"For example, if the GUID provided by Guidgen is <ph id=\"ph1\">`\"{2C8B0AEE-02C9-486e-B809-C780A11530FE}\"`</ph> then your code should appear as follows.","pos":[4111,4242],"source":" For example, if the GUID provided by Guidgen is `\"{2C8B0AEE-02C9-486e-B809-C780A11530FE}\"` then your code should appear as follows."},{"pos":[4374,4476],"content":"Repeat the previous steps for the <ph id=\"ph1\">`InterfaceId`</ph> and <ph id=\"ph2\">`EventsId`</ph> constants, as in the following example.","source":"Repeat the previous steps for the `InterfaceId` and `EventsId` constants, as in the following example."},{"pos":[4610,4741],"content":"[!NOTE]\nMake sure that the GUIDs are new and unique; otherwise, your COM component could conflict with other COM components.","leadings":["","    >  "],"nodes":[{"content":"Make sure that the GUIDs are new and unique; otherwise, your COM component could conflict with other COM components.","pos":[8,124]}]},{"pos":[4751,4891],"content":"Add the <ph id=\"ph1\">`ComClass`</ph> attribute to <ph id=\"ph2\">`ComClass1`</ph>, specifying the GUIDs for the Class ID, Interface ID, and Events ID as in the following example:","source":"Add the `ComClass` attribute to `ComClass1`, specifying the GUIDs for the Class ID, Interface ID, and Events ID as in the following example:"},{"content":"COM classes must have a parameterless <ph id=\"ph1\">`Public Sub New()`</ph> constructor, or the class will not register correctly.","pos":[5023,5134],"source":"COM classes must have a parameterless `Public Sub New()` constructor, or the class will not register correctly."},{"content":"Add a parameterless constructor to the class:","pos":[5135,5180]},{"content":"Add properties, methods, and events to the class, ending it with an <ph id=\"ph1\">`End Class`</ph> statement.","pos":[5311,5401],"source":"Add properties, methods, and events to the class, ending it with an `End Class` statement."},{"content":"Select <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","pos":[5402,5452],"source":" Select **Build Solution** from the **Build** menu."},{"content":"Visual Basic builds the assembly and registers the COM object with the operating system.","pos":[5453,5541]},{"pos":[5553,5950],"content":"[!NOTE]\nThe COM objects you generate with Visual Basic cannot be used by other Visual Basic applications because they are not true COM objects. Attempts to add references to such COM objects will raise an error. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","leadings":["","    >  "],"nodes":[{"content":"The COM objects you generate with Visual Basic cannot be used by other Visual Basic applications because they are not true COM objects. Attempts to add references to such COM objects will raise an error. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","pos":[8,390],"nodes":[{"content":"The COM objects you generate with Visual Basic cannot be used by other Visual Basic applications because they are not true COM objects.","pos":[0,135]},{"content":"Attempts to add references to such COM objects will raise an error.","pos":[136,203]},{"content":"For details, see <bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept>.","pos":[204,382],"source":" For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)."}]}]},{"pos":[5959,5967],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6020,6095],"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>","source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)"},{"pos":[6098,6264],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Implementing Inheritance with COM Objects<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)</ept>","source":"[Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)"},{"pos":[6267,6359],"content":"<bpt id=\"p1\">[</bpt>#Region Directive<ept id=\"p1\">](../../../visual-basic/language-reference/directives/region-directive.md)</ept>","source":"[#Region Directive](../../../visual-basic/language-reference/directives/region-directive.md)"},{"pos":[6362,6522],"content":"<bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept>","source":"[COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)"},{"pos":[6525,6648],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Interoperability<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)</ept>","source":"[Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)"}]}