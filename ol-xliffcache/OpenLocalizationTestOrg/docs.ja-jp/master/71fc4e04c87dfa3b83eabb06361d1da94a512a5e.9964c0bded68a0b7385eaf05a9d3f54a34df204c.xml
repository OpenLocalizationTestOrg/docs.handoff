{"content":"---\ntitle: \"How to: Restore time zones from an embedded resource\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"time zones [.NET Framework], deserializing\"\n  - \"time zones [.NET Framework], restoring\"\nms.assetid: 6b7b4de9-da07-47e3-8f4c-823f81798ee7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Restore time zones from an embedded resource\n\nThis topic describes how to restore time zones that have been saved in a resource file. For information and instructions about saving time zones, see [How to: Save time zones to an embedded resource](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md).\n\n### To deserialize a TimeZoneInfo object from an embedded resource\n\n1. If the time zone to be retrieved is not a custom time zone, try to instantiate it by using the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method.\n\n2. Instantiate a <xref:System.Resources.ResourceManager> object by passing the fully qualified name of the embedded resource file and a reference to the assembly that contains the resource file.\n\n   If you cannot determine the fully qualified name of the embedded resource file, use the [Ildasm.exe (IL Disassembler)](../../../docs/framework/tools/ildasm-exe-il-disassembler.md) to examine the assembly's manifest. An `.mresource` entry identifies the resource. In the example, the resource's fully qualified name is `SerializeTimeZoneData.SerializedTimeZones`.\n\n   If the resource file is embedded in the same assembly that contains the time zone instantiation code, you can retrieve a reference to it by calling the `static` (`Shared` in Visual Basic) <xref:System.Reflection.Assembly.GetExecutingAssembly%2A> method.\n\n3. If the call to the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method fails, or if a custom time zone is to be instantiated, retrieve a string that contains the serialized time zone by calling the <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=nameWithType> method.\n\n4. Deserialize the time zone data by calling the <xref:System.TimeZoneInfo.FromSerializedString%2A> method.\n\n## Example\n\nThe following example deserializes a <xref:System.TimeZoneInfo> object stored in an embedded .NET XML resource file.\n\n[!code-csharp[TimeZone2.Serialization#3](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#3)]\n[!code-vb[TimeZone2.Serialization#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#3)]\n\nThis code illustrates exception handling to ensure that a <xref:System.TimeZoneInfo> object required by the application is present. It first tries to instantiate a <xref:System.TimeZoneInfo> object by retrieving it from the registry using the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method. If the time zone cannot be instantiated, the code retrieves it from the embedded resource file.\n\nBecause data for custom time zones (time zones instantiated by using the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method) are not stored in the registry, the code does not call the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> to instantiate the time zone for Palmer, Antarctica. Instead, it immediately looks to the embedded resource file to retrieve a string that contains the time zone's data before it calls the <xref:System.TimeZoneInfo.FromSerializedString%2A> method.\n\n## Compiling the code\n\nThis example requires:\n\n* That a reference to System.Windows.Forms.dll and System.Core.dll be added to the project.\n\n* That the following namespaces be imported:\n\n  [!code-csharp[TimeZone2.Serialization#2](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#2)]\n  [!code-vb[TimeZone2.Serialization#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#2)]\n\n## See also\n\n- [Dates, times, and time zones](../../../docs/standard/datetime/index.md)\n- [Time zone overview](../../../docs/standard/datetime/time-zone-overview.md)\n- [How to: Save time zones to an embedded resource](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md)\n","nodes":[{"pos":[4,357],"embed":true,"restype":"x-metadata","content":"title: \"How to: Restore time zones from an embedded resource\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"time zones [.NET Framework], deserializing\"\n  - \"time zones [.NET Framework], restoring\"\nms.assetid: 6b7b4de9-da07-47e3-8f4c-823f81798ee7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Restore time zones from an embedded resource","nodes":[{"pos":[0,52],"content":"How to: Restore time zones from an embedded resource","nodes":[{"content":"How to: Restore time zones from an embedded resource","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[364,416],"content":"How to: Restore time zones from an embedded resource","linkify":"How to: Restore time zones from an embedded resource","nodes":[{"content":"How to: Restore time zones from an embedded resource","pos":[0,52]}]},{"content":"This topic describes how to restore time zones that have been saved in a resource file.","pos":[418,505]},{"content":"For information and instructions about saving time zones, see <bpt id=\"p1\">[</bpt>How to: Save time zones to an embedded resource<ept id=\"p1\">](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md)</ept>.","pos":[506,694],"source":" For information and instructions about saving time zones, see [How to: Save time zones to an embedded resource](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md)."},{"pos":[700,762],"content":"To deserialize a TimeZoneInfo object from an embedded resource","linkify":"To deserialize a TimeZoneInfo object from an embedded resource","nodes":[{"content":"To deserialize a TimeZoneInfo object from an embedded resource","pos":[0,62]}]},{"pos":[767,922],"content":"If the time zone to be retrieved is not a custom time zone, try to instantiate it by using the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A&gt;</ph> method.","source":"If the time zone to be retrieved is not a custom time zone, try to instantiate it by using the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method."},{"pos":[927,1118],"content":"Instantiate a <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object by passing the fully qualified name of the embedded resource file and a reference to the assembly that contains the resource file.","source":"Instantiate a <xref:System.Resources.ResourceManager> object by passing the fully qualified name of the embedded resource file and a reference to the assembly that contains the resource file."},{"content":"If you cannot determine the fully qualified name of the embedded resource file, use the <bpt id=\"p1\">[</bpt>Ildasm.exe (IL Disassembler)<ept id=\"p1\">](../../../docs/framework/tools/ildasm-exe-il-disassembler.md)</ept> to examine the assembly's manifest.","pos":[1123,1338],"source":"If you cannot determine the fully qualified name of the embedded resource file, use the [Ildasm.exe (IL Disassembler)](../../../docs/framework/tools/ildasm-exe-il-disassembler.md) to examine the assembly's manifest."},{"content":"An <ph id=\"ph1\">`.mresource`</ph> entry identifies the resource.","pos":[1339,1385],"source":" An `.mresource` entry identifies the resource."},{"content":"In the example, the resource's fully qualified name is <ph id=\"ph1\">`SerializeTimeZoneData.SerializedTimeZones`</ph>.","pos":[1386,1485],"source":" In the example, the resource's fully qualified name is `SerializeTimeZoneData.SerializedTimeZones`."},{"pos":[1490,1743],"content":"If the resource file is embedded in the same assembly that contains the time zone instantiation code, you can retrieve a reference to it by calling the <ph id=\"ph1\">`static`</ph> (<ph id=\"ph2\">`Shared`</ph> in Visual Basic) <ph id=\"ph3\">&lt;xref:System.Reflection.Assembly.GetExecutingAssembly%2A&gt;</ph> method.","source":"If the resource file is embedded in the same assembly that contains the time zone instantiation code, you can retrieve a reference to it by calling the `static` (`Shared` in Visual Basic) <xref:System.Reflection.Assembly.GetExecutingAssembly%2A> method."},{"pos":[1748,2043],"content":"If the call to the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A&gt;</ph> method fails, or if a custom time zone is to be instantiated, retrieve a string that contains the serialized time zone by calling the <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetString%2A?displayProperty=nameWithType&gt;</ph> method.","source":"If the call to the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method fails, or if a custom time zone is to be instantiated, retrieve a string that contains the serialized time zone by calling the <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=nameWithType> method."},{"pos":[2048,2152],"content":"Deserialize the time zone data by calling the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FromSerializedString%2A&gt;</ph> method.","source":"Deserialize the time zone data by calling the <xref:System.TimeZoneInfo.FromSerializedString%2A> method."},{"pos":[2157,2164],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2166,2282],"content":"The following example deserializes a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object stored in an embedded .NET XML resource file.","source":"The following example deserializes a <xref:System.TimeZoneInfo> object stored in an embedded .NET XML resource file."},{"content":"This code illustrates exception handling to ensure that a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object required by the application is present.","pos":[2578,2709],"source":"This code illustrates exception handling to ensure that a <xref:System.TimeZoneInfo> object required by the application is present."},{"content":"It first tries to instantiate a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object by retrieving it from the registry using the <ph id=\"ph2\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A&gt;</ph> method.","pos":[2710,2881],"source":" It first tries to instantiate a <xref:System.TimeZoneInfo> object by retrieving it from the registry using the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> method."},{"content":"If the time zone cannot be instantiated, the code retrieves it from the embedded resource file.","pos":[2882,2977]},{"content":"Because data for custom time zones (time zones instantiated by using the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.CreateCustomTimeZone%2A&gt;</ph> method) are not stored in the registry, the code does not call the <ph id=\"ph2\">&lt;xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A&gt;</ph> to instantiate the time zone for Palmer, Antarctica.","pos":[2979,3275],"source":"Because data for custom time zones (time zones instantiated by using the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method) are not stored in the registry, the code does not call the <xref:System.TimeZoneInfo.FindSystemTimeZoneById%2A> to instantiate the time zone for Palmer, Antarctica."},{"content":"Instead, it immediately looks to the embedded resource file to retrieve a string that contains the time zone's data before it calls the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.FromSerializedString%2A&gt;</ph> method.","pos":[3276,3470],"source":" Instead, it immediately looks to the embedded resource file to retrieve a string that contains the time zone's data before it calls the <xref:System.TimeZoneInfo.FromSerializedString%2A> method."},{"pos":[3475,3493],"content":"Compiling the code","linkify":"Compiling the code","nodes":[{"content":"Compiling the code","pos":[0,18]}]},{"content":"This example requires:","pos":[3495,3517]},{"content":"That a reference to System.Windows.Forms.dll and System.Core.dll be added to the project.","pos":[3521,3610]},{"content":"That the following namespaces be imported:","pos":[3614,3656]},{"pos":[3660,3954],"content":"[!code-csharp[TimeZone2.Serialization#2](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#2)]\n[!code-vb[TimeZone2.Serialization#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#2)]","leadings":["","  "],"nodes":[]},{"pos":[3959,3967],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3971,4043],"content":"<bpt id=\"p1\">[</bpt>Dates, times, and time zones<ept id=\"p1\">](../../../docs/standard/datetime/index.md)</ept>","source":"[Dates, times, and time zones](../../../docs/standard/datetime/index.md)"},{"pos":[4046,4121],"content":"<bpt id=\"p1\">[</bpt>Time zone overview<ept id=\"p1\">](../../../docs/standard/datetime/time-zone-overview.md)</ept>","source":"[Time zone overview](../../../docs/standard/datetime/time-zone-overview.md)"},{"pos":[4124,4249],"content":"<bpt id=\"p1\">[</bpt>How to: Save time zones to an embedded resource<ept id=\"p1\">](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md)</ept>","source":"[How to: Save time zones to an embedded resource](../../../docs/standard/datetime/save-time-zones-to-an-embedded-resource.md)"}]}