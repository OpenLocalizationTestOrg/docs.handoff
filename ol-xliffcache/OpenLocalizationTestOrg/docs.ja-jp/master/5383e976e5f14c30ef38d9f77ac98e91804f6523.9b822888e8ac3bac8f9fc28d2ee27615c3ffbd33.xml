{"content":"---\ntitle: \"Optimizing Performance: Text | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"rendering text\"\n  - \"hyperlinks\"\n  - \"formatted text [WPF]\"\n  - \"text, performance\"\n  - \"glyphs\"\nms.assetid: 66b1b9a7-8618-48db-b616-c57ea4327b98\ncaps.latest.revision: 10\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Optimizing Performance: Text\n[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] includes support for the presentation of text content through the use of feature-rich [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] controls. In general you can divide text rendering in three layers:  \n  \n1.  Using the <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> objects directly.  \n  \n2.  Using the <xref:System.Windows.Media.FormattedText> object.  \n  \n3.  Using high-level controls, such as the <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument> objects.  \n  \n This topic provides text rendering performance recommendations.  \n  \n  \n<a name=\"Glyph_Level\"></a>   \n## Rendering Text at the Glyph Level  \n [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides advanced text support including glyph-level markup with direct access to <xref:System.Windows.Documents.Glyphs> for customers who want to intercept and persist text after formatting. These features provide critical support for the different text rendering requirements in each of the following scenarios.  \n  \n-   Screen display of fixed-format documents.  \n  \n-   Print scenarios.  \n  \n    -   [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] as a device printer language.  \n  \n    -   [!INCLUDE[TLA#tla_mxdw](../../../../includes/tlasharptla-mxdw-md.md)].  \n  \n    -   Previous printer drivers, output from [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] applications to the fixed format.  \n  \n    -   Print spool format.  \n  \n-   Fixed-format document representation, including clients for previous versions of [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] and other computing devices.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> are designed for fixed-format document presentation and print scenarios. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides several elements for general layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] scenarios such as <xref:System.Windows.Controls.Label> and <xref:System.Windows.Controls.TextBlock>. For more information on layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] scenarios, see the [Typography in WPF](../../../../docs/framework/wpf/advanced/typography-in-wpf.md).  \n  \n The following examples show how to define properties for a <xref:System.Windows.Documents.Glyphs> object in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]. The <xref:System.Windows.Documents.Glyphs> object represents the output of a <xref:System.Windows.Media.GlyphRun> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]. The examples assume that the Arial, Courier New, and Times New Roman fonts are installed in the **C:\\WINDOWS\\Fonts** folder on the local computer.  \n  \n [!code-xml[GlyphsOvwSample1#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/GlyphsOvwSample1/CS/default.xaml#1)]  \n  \n### Using DrawGlyphRun  \n If you have custom control and you want to render glyphs, use the <xref:System.Windows.Media.DrawingContext.DrawGlyphRun%2A> method.  \n  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also provides lower-level services for custom text formatting through the use of the <xref:System.Windows.Media.FormattedText> object. The most efficient way of rendering text in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] is by generating text content at the glyph level using <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun>. However, the cost of this efficiency is the loss of easy to use rich text formatting, which are built-in features of [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] controls, such as <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument>.  \n  \n<a name=\"FormattedText_Object\"></a>   \n## FormattedText Object  \n The <xref:System.Windows.Media.FormattedText> object allows you to draw multi-line text, in which each character in the text can be individually formatted. For more information, see [Drawing Formatted Text](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md).  \n  \n To create formatted text, call the <xref:System.Windows.Media.FormattedText.%23ctor%2A> constructor to create a <xref:System.Windows.Media.FormattedText> object. Once you have created the initial formatted text string, you can apply a range of formatting styles. If your application wants to implement its own layout, then the <xref:System.Windows.Media.FormattedText> object is better choice than using a control, such as <xref:System.Windows.Controls.TextBlock>. For more information on the <xref:System.Windows.Media.FormattedText> object, see [Drawing Formatted Text](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md) .  \n  \n The <xref:System.Windows.Media.FormattedText> object provides low-level text formatting capability. You can apply multiple formatting styles to one or more characters. For example, you could call both the <xref:System.Windows.Media.FormattedText.SetFontSize%2A> and <xref:System.Windows.Media.FormattedText.SetForegroundBrush%2A> methods to change the formatting of the first five characters in the text.  \n  \n The following code example creates a <xref:System.Windows.Media.FormattedText> object and renders it.  \n  \n [!code-csharp[formattedtextsnippets#FormattedTextSnippets1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FormattedTextSnippets/CSharp/Window1.xaml.cs#formattedtextsnippets1)]\n [!code-vb[formattedtextsnippets#FormattedTextSnippets1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FormattedTextSnippets/visualbasic/window1.xaml.vb#formattedtextsnippets1)]  \n  \n<a name=\"FlowDocument_TextBlock_Label\"></a>   \n## FlowDocument, TextBlock, and Label Controls  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] includes multiple controls for drawing text to the screen. Each control is targeted to a different scenario and has its own list of features and limitations.  \n  \n### FlowDocument Impacts Performance More than TextBlock or Label  \n In general, the <xref:System.Windows.Controls.TextBlock> element should be used when limited text support is required, such as a brief sentence in a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]. <xref:System.Windows.Controls.Label> can be used when minimal text support is required. The <xref:System.Windows.Documents.FlowDocument> element is a container for re-flowable documents that support rich presentation of content, and therefore, has a greater performance impact than using the <xref:System.Windows.Controls.TextBlock> or <xref:System.Windows.Controls.Label> controls.  \n  \n For more information on <xref:System.Windows.Documents.FlowDocument>, see [Flow Document Overview](../../../../docs/framework/wpf/advanced/flow-document-overview.md).  \n  \n### Avoid Using TextBlock in FlowDocument  \n The <xref:System.Windows.Controls.TextBlock> element is derived from <xref:System.Windows.UIElement>. The <xref:System.Windows.Documents.Run> element is derived from <xref:System.Windows.Documents.TextElement>, which is less costly to use than a <xref:System.Windows.UIElement>-derived object. When possible, use <xref:System.Windows.Documents.Run> rather than <xref:System.Windows.Controls.TextBlock> for displaying text content in a <xref:System.Windows.Documents.FlowDocument>.  \n  \n The following markup sample illustrates two ways of setting text content within a <xref:System.Windows.Documents.FlowDocument>:  \n  \n [!code-xml[Performance#PerformanceSnippet13](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/FlowDocument.xaml#performancesnippet13)]  \n  \n### Avoid Using Run to Set Text Properties  \n In general, using a <xref:System.Windows.Documents.Run> within a <xref:System.Windows.Controls.TextBlock> is more performance intensive than not using an explicit <xref:System.Windows.Documents.Run> object at all. If you are using a <xref:System.Windows.Documents.Run> in order to set text properties, set those properties directly on the <xref:System.Windows.Controls.TextBlock> instead.  \n  \n The following markup sample illustrates these two ways of setting a text property, in this case, the <xref:System.Windows.Controls.TextBlock.FontWeight%2A> property:  \n  \n [!code-xml[Performance#PerformanceSnippet12](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml#performancesnippet12)]  \n  \n The following table shows the cost of displaying 1000 <xref:System.Windows.Controls.TextBlock> objects with and without an explicit <xref:System.Windows.Documents.Run>.  \n  \n|**TextBlock type**|**Creation time (ms)**|**Render time (ms)**|  \n|------------------------|------------------------------|----------------------------|  \n|Run setting text properties|146|540|  \n|TextBlock setting text properties|43|453|  \n  \n### Avoid Databinding to the Label.Content Property  \n Imagine a scenario where you have a <xref:System.Windows.Controls.Label> object that is updated frequently from a <xref:System.String> source. When data binding the <xref:System.Windows.Controls.Label> element's <xref:System.Windows.Controls.ContentControl.Content%2A> property to the <xref:System.String> source object, you may experience poor performance. Each time the source <xref:System.String> is updated, the old <xref:System.String> object is discarded and a new <xref:System.String> is recreated—because a <xref:System.String> object is immutable, it cannot be modified. This, in turn, causes the <xref:System.Windows.Controls.ContentPresenter> of the <xref:System.Windows.Controls.Label> object to discard its old content and regenerate the new content to display the new <xref:System.String>.  \n  \n The solution to this problem is simple. If the <xref:System.Windows.Controls.Label> is not set to a custom <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> value, replace the <xref:System.Windows.Controls.Label> with a <xref:System.Windows.Controls.TextBlock> and data bind its <xref:System.Windows.Controls.TextBlock.Text%2A> property to the source string.  \n  \n|**Data bound property**|**Update time (ms)**|  \n|-----------------------------|----------------------------|  \n|Label.Content|835|  \n|TextBlock.Text|242|  \n  \n<a name=\"Hyperlink\"></a>   \n## Hyperlink  \n The <xref:System.Windows.Documents.Hyperlink> object is an inline-level flow content element that allows you to host hyperlinks within the flow content.  \n  \n### Combine Hyperlinks in One TextBlock Object  \n You can optimize the use of multiple <xref:System.Windows.Documents.Hyperlink> elements by grouping them together within the same <xref:System.Windows.Controls.TextBlock>. This helps to minimize the number of objects you create in your application. For example, you may want to display multiple hyperlinks, such as the following:  \n  \n MSN Home &#124; My MSN  \n  \n The following markup example shows multiple <xref:System.Windows.Controls.TextBlock> elements used to display the hyperlinks:  \n  \n [!code-xml[Performance#PerformanceSnippet9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet9)]  \n  \n The following markup example shows a more efficient way of displaying the hyperlinks, this time, using a single <xref:System.Windows.Controls.TextBlock>:  \n  \n [!code-xml[Performance#PerformanceSnippet10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet10)]  \n  \n### Showing Underlines on Hyperlinks Only on MouseEnter Events  \n A <xref:System.Windows.TextDecoration> object is a visual ornamentation that you can add to text; however, it can be performance intensive to instantiate. If you make extensive use of <xref:System.Windows.Documents.Hyperlink> elements, consider showing an underline only when triggering an event, such as the <xref:System.Windows.ContentElement.MouseEnter> event. For more information, see [Specify Whether a Hyperlink is Underlined](../../../../docs/framework/wpf/advanced/how-to-specify-whether-a-hyperlink-is-underlined.md).  \n  \n ![Hyperlinks displaying TextDecorations](../../../../docs/framework/wpf/advanced/media/textdecoration03.png \"TextDecoration03\")  \nHyperlink appearing on MouseEnter  \n  \n The following markup sample shows a <xref:System.Windows.Documents.Hyperlink> defined with and without an underline:  \n  \n [!code-xml[Performance#PerformanceSnippet11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet11)]  \n  \n The following table shows the performance cost of displaying 1000 <xref:System.Windows.Documents.Hyperlink> elements with and without an underline.  \n  \n|**Hyperlink**|**Creation time (ms)**|**Render time (ms)**|  \n|-------------------|------------------------------|----------------------------|  \n|With underline|289|1130|  \n|Without underline|299|776|  \n  \n<a name=\"Text_Formatting_Features\"></a>   \n## Text Formatting Features  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides rich text formatting services, such as automatic hyphenations. These services may impact application performance and should only be used when needed.  \n  \n### Avoid Unnecessary Use of Hyphenation  \n Automatic hyphenation finds hyphen breakpoints for lines of text, and allows additional break positions for lines in <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument> objects. By default, the automatic hyphenation feature is disabled in these objects. You can enable this feature by setting the object's IsHyphenationEnabled property to `true`. However, enabling this feature causes [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to initiate [!INCLUDE[TLA#tla_com](../../../../includes/tlasharptla-com-md.md)] interoperability, which can impact application performance. It is recommended that you do not use automatic hyphenation unless you need it.  \n  \n### Use Figures Carefully  \n A <xref:System.Windows.Documents.Figure> element represents a portion of flow content that can be absolutely-positioned within a page of content. In some cases, a <xref:System.Windows.Documents.Figure> may cause an entire page to automatically reformat if its position collides with content that has already been laid-out. You can minimize the possibility of unnecessary reformatting by either grouping <xref:System.Windows.Documents.Figure> elements next to each other, or declaring them near the top of content in a fixed page size scenario.  \n  \n### Optimal Paragraph  \n The optimal paragraph feature of the <xref:System.Windows.Documents.FlowDocument> object lays out paragraphs so that white space is distributed as evenly as possible. By default, the optimal paragraph feature is disabled. You can enable this feature by setting the object's <xref:System.Windows.Documents.FlowDocument.IsOptimalParagraphEnabled%2A> property to `true`. However, enabling this feature impacts application performance. It is recommended that you do not use the optimal paragraph feature unless you need it.  \n  \n## See Also  \n [Optimizing WPF Application Performance](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md)   \n [Planning for Application Performance](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md)   \n [Taking Advantage of Hardware](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md)   \n [Layout and Design](../../../../docs/framework/wpf/advanced/optimizing-performance-layout-and-design.md)   \n [2D Graphics and Imaging](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md)   \n [Object Behavior](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md)   \n [Application Resources](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md)   \n [Data Binding](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)   \n [Other Performance Recommendations](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)","nodes":[{"pos":[12,57],"content":"Optimizing Performance: Text | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Optimizing Performance: Text | Microsoft Docs","pos":[0,45]}]},{"pos":[489,517],"content":"Optimizing Performance: Text","linkify":"Optimizing Performance: Text","nodes":[{"content":"Optimizing Performance: Text","pos":[0,28]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> includes support for the presentation of text content through the use of feature-rich <ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> controls.","pos":[518,761],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] includes support for the presentation of text content through the use of feature-rich [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] controls."},{"content":"In general you can divide text rendering in three layers:","pos":[762,819]},{"content":"Using the <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Media.GlyphRun&gt;</ph> objects directly.","pos":[829,936],"source":"Using the <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> objects directly."},{"content":"Using the <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object.","pos":[946,1005],"source":"Using the <xref:System.Windows.Media.FormattedText> object."},{"content":"Using high-level controls, such as the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph> objects.","pos":[1015,1152],"source":"Using high-level controls, such as the <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument> objects."},{"content":"This topic provides text rendering performance recommendations.","pos":[1159,1222]},{"pos":[1264,1297],"content":"Rendering Text at the Glyph Level","linkify":"Rendering Text at the Glyph Level","nodes":[{"content":"Rendering Text at the Glyph Level","pos":[0,33]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides advanced text support including glyph-level markup with direct access to <ph id=\"ph2\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> for customers who want to intercept and persist text after formatting.","pos":[1301,1572],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides advanced text support including glyph-level markup with direct access to <xref:System.Windows.Documents.Glyphs> for customers who want to intercept and persist text after formatting."},{"content":"These features provide critical support for the different text rendering requirements in each of the following scenarios.","pos":[1573,1694]},{"content":"Screen display of fixed-format documents.","pos":[1704,1745]},{"content":"Print scenarios.","pos":[1755,1771]},{"pos":[1785,1884],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph> as a device printer language.","source":"[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] as a device printer language."},{"pos":[1898,1968],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_mxdw](../../../../includes/tlasharptla-mxdw-md.md)]</ph>.","source":"[!INCLUDE[TLA#tla_mxdw](../../../../includes/tlasharptla-mxdw-md.md)]."},{"pos":[1982,2125],"content":"Previous printer drivers, output from <ph id=\"ph1\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> applications to the fixed format.","source":"Previous printer drivers, output from [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] applications to the fixed format."},{"content":"Print spool format.","pos":[2139,2158]},{"pos":[2168,2349],"content":"Fixed-format document representation, including clients for previous versions of <ph id=\"ph1\">[!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)]</ph> and other computing devices.","source":"Fixed-format document representation, including clients for previous versions of [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] and other computing devices."},{"pos":[2357,3021],"content":"[!NOTE]\n <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> are designed for fixed-format document presentation and print scenarios. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides several elements for general layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] scenarios such as <xref:System.Windows.Controls.Label> and <xref:System.Windows.Controls.TextBlock>. For more information on layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] scenarios, see the [Typography in WPF](../../../../docs/framework/wpf/advanced/typography-in-wpf.md).","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> are designed for fixed-format document presentation and print scenarios. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides several elements for general layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] scenarios such as <xref:System.Windows.Controls.Label> and <xref:System.Windows.Controls.TextBlock>. For more information on layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] scenarios, see the [Typography in WPF](../../../../docs/framework/wpf/advanced/typography-in-wpf.md).","pos":[9,662],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Media.GlyphRun&gt;</ph> are designed for fixed-format document presentation and print scenarios.","pos":[0,152],"source":"<xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun> are designed for fixed-format document presentation and print scenarios."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides several elements for general layout and <ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> scenarios such as <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Label&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>.","pos":[153,448],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides several elements for general layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] scenarios such as <xref:System.Windows.Controls.Label> and <xref:System.Windows.Controls.TextBlock>."},{"content":"For more information on layout and <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> scenarios, see the <bpt id=\"p1\">[</bpt>Typography in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/typography-in-wpf.md)</ept>.","pos":[449,653],"source":" For more information on layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] scenarios, see the [Typography in WPF](../../../../docs/framework/wpf/advanced/typography-in-wpf.md)."}]}]},{"content":"The following examples show how to define properties for a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> object in <ph id=\"ph2\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph>.","pos":[3028,3206],"source":"The following examples show how to define properties for a <xref:System.Windows.Documents.Glyphs> object in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> object represents the output of a <ph id=\"ph2\">&lt;xref:System.Windows.Media.GlyphRun&gt;</ph> in <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>.","pos":[3207,3396],"source":" The <xref:System.Windows.Documents.Glyphs> object represents the output of a <xref:System.Windows.Media.GlyphRun> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]."},{"content":"The examples assume that the Arial, Courier New, and Times New Roman fonts are installed in the <bpt id=\"p1\">**</bpt>C:\\WINDOWS\\Fonts<ept id=\"p1\">**</ept> folder on the local computer.","pos":[3397,3543],"source":" The examples assume that the Arial, Courier New, and Times New Roman fonts are installed in the **C:\\WINDOWS\\Fonts** folder on the local computer."},{"pos":[3550,3669],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>GlyphsOvwSample1#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/GlyphsOvwSample1/CS/default.xaml#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[GlyphsOvwSample1#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/GlyphsOvwSample1/CS/default.xaml#1)]"},{"pos":[3679,3697],"content":"Using DrawGlyphRun","linkify":"Using DrawGlyphRun","nodes":[{"content":"Using DrawGlyphRun","pos":[0,18]}]},{"content":"If you have custom control and you want to render glyphs, use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingContext.DrawGlyphRun%2A&gt;</ph> method.","pos":[3701,3833],"source":"If you have custom control and you want to render glyphs, use the <xref:System.Windows.Media.DrawingContext.DrawGlyphRun%2A> method."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> also provides lower-level services for custom text formatting through the use of the <ph id=\"ph2\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object.","pos":[3840,4056],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also provides lower-level services for custom text formatting through the use of the <xref:System.Windows.Media.FormattedText> object."},{"content":"The most efficient way of rendering text in <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> is by generating text content at the glyph level using <ph id=\"ph2\">&lt;xref:System.Windows.Documents.Glyphs&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Media.GlyphRun&gt;</ph>.","pos":[4057,4316],"source":" The most efficient way of rendering text in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] is by generating text content at the glyph level using <xref:System.Windows.Documents.Glyphs> and <xref:System.Windows.Media.GlyphRun>."},{"content":"However, the cost of this efficiency is the loss of easy to use rich text formatting, which are built-in features of <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> controls, such as <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph>.","pos":[4317,4622],"source":" However, the cost of this efficiency is the loss of easy to use rich text formatting, which are built-in features of [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] controls, such as <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument>."},{"pos":[4670,4690],"content":"FormattedText Object","linkify":"FormattedText Object","nodes":[{"content":"FormattedText Object","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object allows you to draw multi-line text, in which each character in the text can be individually formatted.","pos":[4694,4849],"source":"The <xref:System.Windows.Media.FormattedText> object allows you to draw multi-line text, in which each character in the text can be individually formatted."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Drawing Formatted Text<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md)</ept>.","pos":[4850,4968],"source":" For more information, see [Drawing Formatted Text](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md)."},{"content":"To create formatted text, call the <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText.%23ctor%2A&gt;</ph> constructor to create a <ph id=\"ph2\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object.","pos":[4975,5136],"source":"To create formatted text, call the <xref:System.Windows.Media.FormattedText.%23ctor%2A> constructor to create a <xref:System.Windows.Media.FormattedText> object."},{"content":"Once you have created the initial formatted text string, you can apply a range of formatting styles.","pos":[5137,5237]},{"content":"If your application wants to implement its own layout, then the <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object is better choice than using a control, such as <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>.","pos":[5238,5439],"source":" If your application wants to implement its own layout, then the <xref:System.Windows.Media.FormattedText> object is better choice than using a control, such as <xref:System.Windows.Controls.TextBlock>."},{"content":"For more information on the <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object, see <bpt id=\"p1\">[</bpt>Drawing Formatted Text<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md)</ept> .","pos":[5440,5615],"source":" For more information on the <xref:System.Windows.Media.FormattedText> object, see [Drawing Formatted Text](../../../../docs/framework/wpf/advanced/drawing-formatted-text.md) ."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object provides low-level text formatting capability.","pos":[5622,5721],"source":"The <xref:System.Windows.Media.FormattedText> object provides low-level text formatting capability."},{"content":"You can apply multiple formatting styles to one or more characters.","pos":[5722,5789]},{"content":"For example, you could call both the <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText.SetFontSize%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Media.FormattedText.SetForegroundBrush%2A&gt;</ph> methods to change the formatting of the first five characters in the text.","pos":[5790,6026],"source":" For example, you could call both the <xref:System.Windows.Media.FormattedText.SetFontSize%2A> and <xref:System.Windows.Media.FormattedText.SetForegroundBrush%2A> methods to change the formatting of the first five characters in the text."},{"content":"The following code example creates a <ph id=\"ph1\">&lt;xref:System.Windows.Media.FormattedText&gt;</ph> object and renders it.","pos":[6033,6134],"source":"The following code example creates a <xref:System.Windows.Media.FormattedText> object and renders it."},{"pos":[6141,6511],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>formattedtextsnippets#FormattedTextSnippets1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FormattedTextSnippets/CSharp/Window1.xaml.cs#formattedtextsnippets1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>formattedtextsnippets#FormattedTextSnippets1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FormattedTextSnippets/visualbasic/window1.xaml.vb#formattedtextsnippets1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[formattedtextsnippets#FormattedTextSnippets1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FormattedTextSnippets/CSharp/Window1.xaml.cs#formattedtextsnippets1)]\n [!code-vb[formattedtextsnippets#FormattedTextSnippets1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FormattedTextSnippets/visualbasic/window1.xaml.vb#formattedtextsnippets1)]"},{"pos":[6567,6610],"content":"FlowDocument, TextBlock, and Label Controls","linkify":"FlowDocument, TextBlock, and Label Controls","nodes":[{"content":"FlowDocument, TextBlock, and Label Controls","pos":[0,43]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> includes multiple controls for drawing text to the screen.","pos":[6614,6754],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] includes multiple controls for drawing text to the screen."},{"content":"Each control is targeted to a different scenario and has its own list of features and limitations.","pos":[6755,6853]},{"pos":[6863,6924],"content":"FlowDocument Impacts Performance More than TextBlock or Label","linkify":"FlowDocument Impacts Performance More than TextBlock or Label","nodes":[{"content":"FlowDocument Impacts Performance More than TextBlock or Label","pos":[0,61]}]},{"content":"In general, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> element should be used when limited text support is required, such as a brief sentence in a <ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph>.","pos":[6928,7143],"source":"In general, the <xref:System.Windows.Controls.TextBlock> element should be used when limited text support is required, such as a brief sentence in a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> can be used when minimal text support is required.","pos":[7144,7231],"source":"<xref:System.Windows.Controls.Label> can be used when minimal text support is required."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph> element is a container for re-flowable documents that support rich presentation of content, and therefore, has a greater performance impact than using the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Label&gt;</ph> controls.","pos":[7232,7526],"source":" The <xref:System.Windows.Documents.FlowDocument> element is a container for re-flowable documents that support rich presentation of content, and therefore, has a greater performance impact than using the <xref:System.Windows.Controls.TextBlock> or <xref:System.Windows.Controls.Label> controls."},{"pos":[7533,7699],"content":"For more information on <ph id=\"ph1\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph>, see <bpt id=\"p1\">[</bpt>Flow Document Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/flow-document-overview.md)</ept>.","source":"For more information on <xref:System.Windows.Documents.FlowDocument>, see [Flow Document Overview](../../../../docs/framework/wpf/advanced/flow-document-overview.md)."},{"pos":[7709,7746],"content":"Avoid Using TextBlock in FlowDocument","linkify":"Avoid Using TextBlock in FlowDocument","nodes":[{"content":"Avoid Using TextBlock in FlowDocument","pos":[0,37]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> element is derived from <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph>.","pos":[7750,7851],"source":"The <xref:System.Windows.Controls.TextBlock> element is derived from <xref:System.Windows.UIElement>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Run&gt;</ph> element is derived from <ph id=\"ph2\">&lt;xref:System.Windows.Documents.TextElement&gt;</ph>, which is less costly to use than a <ph id=\"ph3\">&lt;xref:System.Windows.UIElement&gt;</ph>-derived object.","pos":[7852,8043],"source":" The <xref:System.Windows.Documents.Run> element is derived from <xref:System.Windows.Documents.TextElement>, which is less costly to use than a <xref:System.Windows.UIElement>-derived object."},{"content":"When possible, use <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Run&gt;</ph> rather than <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> for displaying text content in a <ph id=\"ph3\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph>.","pos":[8044,8230],"source":" When possible, use <xref:System.Windows.Documents.Run> rather than <xref:System.Windows.Controls.TextBlock> for displaying text content in a <xref:System.Windows.Documents.FlowDocument>."},{"content":"The following markup sample illustrates two ways of setting text content within a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph>:","pos":[8237,8364],"source":"The following markup sample illustrates two ways of setting text content within a <xref:System.Windows.Documents.FlowDocument>:"},{"pos":[8371,8527],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>Performance#PerformanceSnippet13<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/FlowDocument.xaml#performancesnippet13)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[Performance#PerformanceSnippet13](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/FlowDocument.xaml#performancesnippet13)]"},{"pos":[8537,8575],"content":"Avoid Using Run to Set Text Properties","linkify":"Avoid Using Run to Set Text Properties","nodes":[{"content":"Avoid Using Run to Set Text Properties","pos":[0,38]}]},{"content":"In general, using a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Run&gt;</ph> within a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> is more performance intensive than not using an explicit <ph id=\"ph3\">&lt;xref:System.Windows.Documents.Run&gt;</ph> object at all.","pos":[8579,8792],"source":"In general, using a <xref:System.Windows.Documents.Run> within a <xref:System.Windows.Controls.TextBlock> is more performance intensive than not using an explicit <xref:System.Windows.Documents.Run> object at all."},{"content":"If you are using a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Run&gt;</ph> in order to set text properties, set those properties directly on the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> instead.","pos":[8793,8967],"source":" If you are using a <xref:System.Windows.Documents.Run> in order to set text properties, set those properties directly on the <xref:System.Windows.Controls.TextBlock> instead."},{"content":"The following markup sample illustrates these two ways of setting a text property, in this case, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock.FontWeight%2A&gt;</ph> property:","pos":[8974,9139],"source":"The following markup sample illustrates these two ways of setting a text property, in this case, the <xref:System.Windows.Controls.TextBlock.FontWeight%2A> property:"},{"pos":[9146,9297],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>Performance#PerformanceSnippet12<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml#performancesnippet12)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[Performance#PerformanceSnippet12](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml#performancesnippet12)]"},{"content":"The following table shows the cost of displaying 1000 <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> objects with and without an explicit <ph id=\"ph2\">&lt;xref:System.Windows.Documents.Run&gt;</ph>.","pos":[9304,9472],"source":"The following table shows the cost of displaying 1000 <xref:System.Windows.Controls.TextBlock> objects with and without an explicit <xref:System.Windows.Documents.Run>."},{"pos":[9479,9497],"content":"<bpt id=\"p1\">**</bpt>TextBlock type<ept id=\"p1\">**</ept>","source":"**TextBlock type**"},{"pos":[9498,9520],"content":"<bpt id=\"p1\">**</bpt>Creation time (ms)<ept id=\"p1\">**</ept>","source":"**Creation time (ms)**"},{"pos":[9521,9541],"content":"<bpt id=\"p1\">**</bpt>Render time (ms)<ept id=\"p1\">**</ept>","source":"**Render time (ms)**"},{"content":"Run setting text properties","pos":[9635,9662]},{"content":"146","pos":[9663,9666]},{"content":"540","pos":[9667,9670]},{"content":"TextBlock setting text properties","pos":[9675,9708]},{"content":"43","pos":[9709,9711]},{"content":"453","pos":[9712,9715]},{"pos":[9726,9773],"content":"Avoid Databinding to the Label.Content Property","linkify":"Avoid Databinding to the Label.Content Property","nodes":[{"content":"Avoid Databinding to the Label.Content Property","pos":[0,47]}]},{"content":"Imagine a scenario where you have a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> object that is updated frequently from a <ph id=\"ph2\">&lt;xref:System.String&gt;</ph> source.","pos":[9777,9919],"source":"Imagine a scenario where you have a <xref:System.Windows.Controls.Label> object that is updated frequently from a <xref:System.String> source."},{"content":"When data binding the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> element's <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ContentControl.Content%2A&gt;</ph> property to the <ph id=\"ph3\">&lt;xref:System.String&gt;</ph> source object, you may experience poor performance.","pos":[9920,10134],"source":" When data binding the <xref:System.Windows.Controls.Label> element's <xref:System.Windows.Controls.ContentControl.Content%2A> property to the <xref:System.String> source object, you may experience poor performance."},{"content":"Each time the source <ph id=\"ph1\">&lt;xref:System.String&gt;</ph> is updated, the old <ph id=\"ph2\">&lt;xref:System.String&gt;</ph> object is discarded and a new <ph id=\"ph3\">&lt;xref:System.String&gt;</ph> is recreated—because a <ph id=\"ph4\">&lt;xref:System.String&gt;</ph> object is immutable, it cannot be modified.","pos":[10135,10356],"source":" Each time the source <xref:System.String> is updated, the old <xref:System.String> object is discarded and a new <xref:System.String> is recreated—because a <xref:System.String> object is immutable, it cannot be modified."},{"content":"This, in turn, causes the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ContentPresenter&gt;</ph> of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Label&gt;</ph> object to discard its old content and regenerate the new content to display the new <ph id=\"ph3\">&lt;xref:System.String&gt;</ph>.","pos":[10357,10580],"source":" This, in turn, causes the <xref:System.Windows.Controls.ContentPresenter> of the <xref:System.Windows.Controls.Label> object to discard its old content and regenerate the new content to display the new <xref:System.String>."},{"content":"The solution to this problem is simple.","pos":[10587,10626]},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> is not set to a custom <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ContentControl.ContentTemplate%2A&gt;</ph> value, replace the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Label&gt;</ph> with a <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> and data bind its <ph id=\"ph5\">&lt;xref:System.Windows.Controls.TextBlock.Text%2A&gt;</ph> property to the source string.","pos":[10627,10960],"source":" If the <xref:System.Windows.Controls.Label> is not set to a custom <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> value, replace the <xref:System.Windows.Controls.Label> with a <xref:System.Windows.Controls.TextBlock> and data bind its <xref:System.Windows.Controls.TextBlock.Text%2A> property to the source string."},{"pos":[10967,10990],"content":"<bpt id=\"p1\">**</bpt>Data bound property<ept id=\"p1\">**</ept>","source":"**Data bound property**"},{"pos":[10991,11011],"content":"<bpt id=\"p1\">**</bpt>Update time (ms)<ept id=\"p1\">**</ept>","source":"**Update time (ms)**"},{"content":"Label.Content","pos":[11079,11092]},{"content":"835","pos":[11093,11096]},{"content":"TextBlock.Text","pos":[11101,11115]},{"content":"242","pos":[11116,11119]},{"pos":[11157,11166],"content":"Hyperlink","linkify":"Hyperlink","nodes":[{"content":"Hyperlink","pos":[0,9]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> object is an inline-level flow content element that allows you to host hyperlinks within the flow content.","pos":[11170,11322],"source":"The <xref:System.Windows.Documents.Hyperlink> object is an inline-level flow content element that allows you to host hyperlinks within the flow content."},{"pos":[11332,11374],"content":"Combine Hyperlinks in One TextBlock Object","linkify":"Combine Hyperlinks in One TextBlock Object","nodes":[{"content":"Combine Hyperlinks in One TextBlock Object","pos":[0,42]}]},{"content":"You can optimize the use of multiple <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> elements by grouping them together within the same <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>.","pos":[11378,11549],"source":"You can optimize the use of multiple <xref:System.Windows.Documents.Hyperlink> elements by grouping them together within the same <xref:System.Windows.Controls.TextBlock>."},{"content":"This helps to minimize the number of objects you create in your application.","pos":[11550,11626]},{"content":"For example, you may want to display multiple hyperlinks, such as the following:","pos":[11627,11707]},{"content":"MSN Home &amp;#124; My MSN","pos":[11714,11736],"source":"MSN Home &#124; My MSN"},{"content":"The following markup example shows multiple <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> elements used to display the hyperlinks:","pos":[11743,11868],"source":"The following markup example shows multiple <xref:System.Windows.Controls.TextBlock> elements used to display the hyperlinks:"},{"pos":[11875,12026],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>Performance#PerformanceSnippet9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet9)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[Performance#PerformanceSnippet9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet9)]"},{"content":"The following markup example shows a more efficient way of displaying the hyperlinks, this time, using a single <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>:","pos":[12033,12186],"source":"The following markup example shows a more efficient way of displaying the hyperlinks, this time, using a single <xref:System.Windows.Controls.TextBlock>:"},{"pos":[12193,12346],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>Performance#PerformanceSnippet10<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet10)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[Performance#PerformanceSnippet10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet10)]"},{"pos":[12356,12414],"content":"Showing Underlines on Hyperlinks Only on MouseEnter Events","linkify":"Showing Underlines on Hyperlinks Only on MouseEnter Events","nodes":[{"content":"Showing Underlines on Hyperlinks Only on MouseEnter Events","pos":[0,58]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.TextDecoration&gt;</ph> object is a visual ornamentation that you can add to text; however, it can be performance intensive to instantiate.","pos":[12418,12572],"source":"A <xref:System.Windows.TextDecoration> object is a visual ornamentation that you can add to text; however, it can be performance intensive to instantiate."},{"content":"If you make extensive use of <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> elements, consider showing an underline only when triggering an event, such as the <ph id=\"ph2\">&lt;xref:System.Windows.ContentElement.MouseEnter&gt;</ph> event.","pos":[12573,12781],"source":" If you make extensive use of <xref:System.Windows.Documents.Hyperlink> elements, consider showing an underline only when triggering an event, such as the <xref:System.Windows.ContentElement.MouseEnter> event."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Specify Whether a Hyperlink is Underlined<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-specify-whether-a-hyperlink-is-underlined.md)</ept>.","pos":[12782,12945],"source":" For more information, see [Specify Whether a Hyperlink is Underlined](../../../../docs/framework/wpf/advanced/how-to-specify-whether-a-hyperlink-is-underlined.md)."},{"content":"<bpt id=\"p1\">![</bpt>Hyperlinks displaying TextDecorations<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/media/textdecoration03.png \"TextDecoration03\")</ept>","pos":[12952,13079],"source":"![Hyperlinks displaying TextDecorations](../../../../docs/framework/wpf/advanced/media/textdecoration03.png \"TextDecoration03\")"},{"content":"Hyperlink appearing on MouseEnter","pos":[13082,13115]},{"content":"The following markup sample shows a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> defined with and without an underline:","pos":[13122,13238],"source":"The following markup sample shows a <xref:System.Windows.Documents.Hyperlink> defined with and without an underline:"},{"pos":[13245,13398],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>Performance#PerformanceSnippet11<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet11)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[Performance#PerformanceSnippet11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Hyperlink.xaml#performancesnippet11)]"},{"content":"The following table shows the performance cost of displaying 1000 <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> elements with and without an underline.","pos":[13405,13552],"source":"The following table shows the performance cost of displaying 1000 <xref:System.Windows.Documents.Hyperlink> elements with and without an underline."},{"pos":[13559,13572],"content":"<bpt id=\"p1\">**</bpt>Hyperlink<ept id=\"p1\">**</ept>","source":"**Hyperlink**"},{"pos":[13573,13595],"content":"<bpt id=\"p1\">**</bpt>Creation time (ms)<ept id=\"p1\">**</ept>","source":"**Creation time (ms)**"},{"pos":[13596,13616],"content":"<bpt id=\"p1\">**</bpt>Render time (ms)<ept id=\"p1\">**</ept>","source":"**Render time (ms)**"},{"content":"With underline","pos":[13705,13719]},{"content":"289","pos":[13720,13723]},{"content":"1130","pos":[13724,13728]},{"content":"Without underline","pos":[13733,13750]},{"content":"299","pos":[13751,13754]},{"content":"776","pos":[13755,13758]},{"pos":[13811,13835],"content":"Text Formatting Features","linkify":"Text Formatting Features","nodes":[{"content":"Text Formatting Features","pos":[0,24]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides rich text formatting services, such as automatic hyphenations.","pos":[13839,13992],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides rich text formatting services, such as automatic hyphenations."},{"content":"These services may impact application performance and should only be used when needed.","pos":[13993,14079]},{"pos":[14089,14125],"content":"Avoid Unnecessary Use of Hyphenation","linkify":"Avoid Unnecessary Use of Hyphenation","nodes":[{"content":"Avoid Unnecessary Use of Hyphenation","pos":[0,36]}]},{"content":"Automatic hyphenation finds hyphen breakpoints for lines of text, and allows additional break positions for lines in <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph> objects.","pos":[14129,14344],"source":"Automatic hyphenation finds hyphen breakpoints for lines of text, and allows additional break positions for lines in <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Documents.FlowDocument> objects."},{"content":"By default, the automatic hyphenation feature is disabled in these objects.","pos":[14345,14420]},{"content":"You can enable this feature by setting the object's IsHyphenationEnabled property to <ph id=\"ph1\">`true`</ph>.","pos":[14421,14513],"source":" You can enable this feature by setting the object's IsHyphenationEnabled property to `true`."},{"content":"However, enabling this feature causes <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> to initiate <ph id=\"ph2\">[!INCLUDE[TLA#tla_com](../../../../includes/tlasharptla-com-md.md)]</ph> interoperability, which can impact application performance.","pos":[14514,14773],"source":" However, enabling this feature causes [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to initiate [!INCLUDE[TLA#tla_com](../../../../includes/tlasharptla-com-md.md)] interoperability, which can impact application performance."},{"content":"It is recommended that you do not use automatic hyphenation unless you need it.","pos":[14774,14853]},{"pos":[14863,14884],"content":"Use Figures Carefully","linkify":"Use Figures Carefully","nodes":[{"content":"Use Figures Carefully","pos":[0,21]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Figure&gt;</ph> element represents a portion of flow content that can be absolutely-positioned within a page of content.","pos":[14888,15033],"source":"A <xref:System.Windows.Documents.Figure> element represents a portion of flow content that can be absolutely-positioned within a page of content."},{"content":"In some cases, a <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Figure&gt;</ph> may cause an entire page to automatically reformat if its position collides with content that has already been laid-out.","pos":[15034,15210],"source":" In some cases, a <xref:System.Windows.Documents.Figure> may cause an entire page to automatically reformat if its position collides with content that has already been laid-out."},{"content":"You can minimize the possibility of unnecessary reformatting by either grouping <ph id=\"ph1\">&lt;xref:System.Windows.Documents.Figure&gt;</ph> elements next to each other, or declaring them near the top of content in a fixed page size scenario.","pos":[15211,15431],"source":" You can minimize the possibility of unnecessary reformatting by either grouping <xref:System.Windows.Documents.Figure> elements next to each other, or declaring them near the top of content in a fixed page size scenario."},{"pos":[15441,15458],"content":"Optimal Paragraph","linkify":"Optimal Paragraph","nodes":[{"content":"Optimal Paragraph","pos":[0,17]}]},{"content":"The optimal paragraph feature of the <ph id=\"ph1\">&lt;xref:System.Windows.Documents.FlowDocument&gt;</ph> object lays out paragraphs so that white space is distributed as evenly as possible.","pos":[15462,15628],"source":"The optimal paragraph feature of the <xref:System.Windows.Documents.FlowDocument> object lays out paragraphs so that white space is distributed as evenly as possible."},{"content":"By default, the optimal paragraph feature is disabled.","pos":[15629,15683]},{"content":"You can enable this feature by setting the object's <ph id=\"ph1\">&lt;xref:System.Windows.Documents.FlowDocument.IsOptimalParagraphEnabled%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","pos":[15684,15829],"source":" You can enable this feature by setting the object's <xref:System.Windows.Documents.FlowDocument.IsOptimalParagraphEnabled%2A> property to `true`."},{"content":"However, enabling this feature impacts application performance.","pos":[15830,15893]},{"content":"It is recommended that you do not use the optimal paragraph feature unless you need it.","pos":[15894,15981]},{"pos":[15990,15998],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Optimizing WPF Application Performance<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md)</ept><ph id=\"ph1\"> </ph>","pos":[16002,16126],"source":"[Optimizing WPF Application Performance](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Planning for Application Performance<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md)</ept><ph id=\"ph1\"> </ph>","pos":[16129,16250],"source":" [Planning for Application Performance](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Taking Advantage of Hardware<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md)</ept><ph id=\"ph1\"> </ph>","pos":[16253,16381],"source":" [Taking Advantage of Hardware](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Layout and Design<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-layout-and-design.md)</ept><ph id=\"ph1\"> </ph>","pos":[16384,16490],"source":" [Layout and Design](../../../../docs/framework/wpf/advanced/optimizing-performance-layout-and-design.md) "},{"content":"<bpt id=\"p1\"> [</bpt>2D Graphics and Imaging<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md)</ept><ph id=\"ph1\"> </ph>","pos":[16493,16611],"source":" [2D Graphics and Imaging](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Object Behavior<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md)</ept><ph id=\"ph1\"> </ph>","pos":[16614,16716],"source":" [Object Behavior](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Application Resources<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md)</ept><ph id=\"ph1\"> </ph>","pos":[16719,16833],"source":" [Application Resources](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Data Binding<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)</ept><ph id=\"ph1\"> </ph>","pos":[16836,16932],"source":" [Data Binding](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Other Performance Recommendations<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)</ept>","pos":[16935,17060],"source":" [Other Performance Recommendations](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)"}]}