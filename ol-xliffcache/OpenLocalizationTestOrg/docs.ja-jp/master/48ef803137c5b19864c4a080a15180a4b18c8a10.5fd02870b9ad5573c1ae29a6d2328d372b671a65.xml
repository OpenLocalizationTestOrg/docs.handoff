{"content":"---\ntitle: \"ICLRMetaHostPolicy::GetRequestedRuntime Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRMetaHostPolicy.GetRequestedRuntime\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRMetaHostPolicy::GetRequestedRuntime\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRequestedRuntime method [.NET Framework hosting]\"\n  - \"ICLRMetaHostPolicy::GetRequestedRuntime method [.NET Framework hosting]\"\nms.assetid: 59ec1832-9cc1-4b5c-983d-03407e51de56\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 19\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRMetaHostPolicy::GetRequestedRuntime Method\nProvides an interface to a preferred version of the common language runtime (CLR) based on a hosting policy, managed assembly, version string, and configuration stream. This method does not actually load or activate the CLR, but simply returns the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that represents the policy result. This method supersedes the [GetRequestedRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md), [GetRequestedRuntimeVersion](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md), [CorBindToRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md), [CorBindToRuntimeByCfg](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md), and [GetCORRequiredVersion](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md) methods.  \n  \n## Syntax  \n  \n```  \nHRESULT GetRequestedRuntime(  \n    [in]  METAHOST_POLICY_FLAGS dwPolicyFlags,  \n    [in]  LPCWSTR pwzBinary,  \n    [in]  IStream *pCfgStream,  \n    [in, out, size_is(*pcchVersion)] LPWSTR pwzVersion,  \n    [in, out]  DWORD *pcchVersion,  \n    [out, size_is(*pcchImageVersion)] LPWSTR pwzImageVersion,  \n    [in, out]  DWORD *pcchImageVersion,  \n    [out] DWORD *pdwConfigFlags,  \n    [in]  REFIID  riid  \n    [out, iid_is(riid), retval] LPVOID *ppRuntime);  \n```  \n  \n#### Parameters  \n  \n|Name|Description|  \n|----------|-----------------|  \n|`dwPolicyFlags`|[in] Required. Specifies a member of the [METAHOST_POLICY_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md) enumeration, representing a binding policy, and any number of modifiers. The only policy that is currently available is [METAHOST_POLICY_HIGHCOMPAT](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).<br /><br /> Modifiers include [METAHOST_POLICY_EMULATE_EXE_LAUNCH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_APPLY_UPGRADE_POLICY](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_SHOW_ERROR_DIALOG](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_USE_PROCESS_IMAGE_PATH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), and [METAHOST_POLICY_ENSURE_SKU_SUPPORTED](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).|  \n|`pwzBinary`|[in] Optional. Specifies the assembly file path.|  \n|`pCfgStream`|[in] Optional. Specifies the configuration file as a <xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=fullName>.|  \n|`pwzVersion`|[in, out] Optional. Specifies or returns the preferred CLR version to be loaded.|  \n|`pcchVersion`|[in, out] Required. Specifies the expected size of `pwzVersion` as input, to avoid buffer overruns. If `pwzVersion` is null, `pcchVersion` contains the expected size of `pwzVersion` when `GetRequestedRuntime` returns, to allow pre-allocation; otherwise, `pcchVersion` contains the number of characters written to `pwzVersion`.|  \n|`pwzImageVersion`|[out] Optional. When `GetRequestedRuntime` returns, contains the CLR version corresponding to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that is returned.|  \n|`pcchImageVersion`|[in, out] Optional. Specifies the size of `pwzImageVersion` as input to avoid buffer overruns. If `pwzImageVersion` is null, `pcchImageVersion` contains the required size of `pwzImageVersion` when `GetRequestedRuntime` returns, to allow pre-allocation.|  \n|`pdwConfigFlags`|[out] Optional. If `GetRequestedRuntime` uses a configuration file during the binding process, when it returns, `pdwConfigFlags` contains a [METAHOST_CONFIG_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) value that indicates whether the [\\<startup>](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md) element has the `useLegacyV2RuntimeActivationPolicy` attribute set, and the value of the attribute. Apply the [METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) mask to `pdwConfigFlags` to get the values relevant to `useLegacyV2RuntimeActivationPolicy`.|  \n|`riid`|[in] Specifies the interface identifier IID_ICLRRuntimeInfo for the requested [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.|  \n|`ppRuntime`|[out] When `GetRequestedRuntime` returns, contains a pointer to the corresponding [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.|  \n  \n## Remarks  \n When this method succeeds, it has the side effect of combining additional flags with the current default startup flags of the returned runtime interface, if and only if one or more of the following elements exist in the configuration stream within the `<configuration><runtime>` section:  \n  \n-   `<gcServer enabled=\"true\"/>` causes `STARTUP_SERVER_GC` to be set.  \n  \n-   `<etwEnable enabled=\"true\"/>` causes `STARTUP_ETW` to be set.  \n  \n-   `<appDomainResourceMonitoring enabled=\"true\"/>` causes `STARTUP_ARM` to be set.  \n  \n The resulting default `STARTUP_FLAGS` value is the bitwise OR combination of the values that are set from the preceding list with the default startup flags.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_POINTER|`pwzVersion` is not null and `pcchVersion` is null.<br /><br /> -or-<br /><br /> `pwzImageVersion` is not null and `pcchImageVersion` is null.|  \n|E_INVALIDARG|`dwPolicyFlags` does not specify `METAHOST_POLICY_HIGHCOMPAT`.|  \n|ERROR_INSUFFICIENT_BUFFER|The memory allocated to `pwzVerison` is inadequate.<br /><br /> -or-<br /><br /> The memory allocated to `pwzImageVerison` is inadequate.|  \n|CLR_E_SHIM_RUNTIMELOAD|`dwPolicyFlags` includes METAHOST_POLICY_APPLY_UPGRADE_POLICY, and both `pwzVersion` and `pcchVersion` are null.|  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MetaHost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [ICLRMetaHostPolicy Interface](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-interface.md)   \n [CLR Hosting Interfaces Added in the .NET Framework 4 and 4.5](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces-added-in-the-net-framework-4-and-4-5.md)   \n [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)   \n [Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)","nodes":[{"pos":[4,750],"nodes":[{"content":"ICLRMetaHostPolicy::GetRequestedRuntime Method | Microsoft Docs","nodes":[{"pos":[0,63],"content":"ICLRMetaHostPolicy::GetRequestedRuntime Method | Microsoft Docs","nodes":[{"content":"ICLRMetaHostPolicy::GetRequestedRuntime Method | Microsoft Docs","pos":[0,63]}]}],"pos":[6,72],"yaml":true}],"content":"title: \"ICLRMetaHostPolicy::GetRequestedRuntime Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRMetaHostPolicy.GetRequestedRuntime\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRMetaHostPolicy::GetRequestedRuntime\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRequestedRuntime method [.NET Framework hosting]\"\n  - \"ICLRMetaHostPolicy::GetRequestedRuntime method [.NET Framework hosting]\"\nms.assetid: 59ec1832-9cc1-4b5c-983d-03407e51de56\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 19\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[757,803],"content":"ICLRMetaHostPolicy::GetRequestedRuntime Method","linkify":"ICLRMetaHostPolicy::GetRequestedRuntime Method","nodes":[{"content":"ICLRMetaHostPolicy::GetRequestedRuntime Method","pos":[0,46]}]},{"content":"Provides an interface to a preferred version of the common language runtime (CLR) based on a hosting policy, managed assembly, version string, and configuration stream.","pos":[804,972]},{"content":"This method does not actually load or activate the CLR, but simply returns the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that represents the policy result.","pos":[973,1193],"source":" This method does not actually load or activate the CLR, but simply returns the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that represents the policy result."},{"content":"This method supersedes the <bpt id=\"p1\">[</bpt>GetRequestedRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)</ept>, <bpt id=\"p2\">[</bpt>GetRequestedRuntimeVersion<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)</ept>, <bpt id=\"p3\">[</bpt>CorBindToRuntimeHost<ept id=\"p3\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md)</ept>, <bpt id=\"p4\">[</bpt>CorBindToRuntimeByCfg<ept id=\"p4\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)</ept>, and <bpt id=\"p5\">[</bpt>GetCORRequiredVersion<ept id=\"p5\">](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md)</ept> methods.","pos":[1194,1789],"source":" This method supersedes the [GetRequestedRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md), [GetRequestedRuntimeVersion](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md), [CorBindToRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md), [CorBindToRuntimeByCfg](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md), and [GetCORRequiredVersion](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md) methods."},{"pos":[1798,1804],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[2289,2299],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Name","pos":[2306,2310]},{"content":"Description","pos":[2311,2322]},{"content":"[in] Required.","pos":[2376,2390]},{"content":"Specifies a member of the <bpt id=\"p1\">[</bpt>METAHOST_POLICY_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept> enumeration, representing a binding policy, and any number of modifiers.","pos":[2391,2600],"source":" Specifies a member of the [METAHOST_POLICY_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md) enumeration, representing a binding policy, and any number of modifiers."},{"content":"The only policy that is currently available is <bpt id=\"p1\">[</bpt>METAHOST_POLICY_HIGHCOMPAT<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>.","pos":[2601,2764],"source":" The only policy that is currently available is [METAHOST_POLICY_HIGHCOMPAT](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)."},{"content":"Modifiers include <bpt id=\"p1\">[</bpt>METAHOST_POLICY_EMULATE_EXE_LAUNCH<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id=\"p2\">[</bpt>METAHOST_POLICY_APPLY_UPGRADE_POLICY<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id=\"p3\">[</bpt>METAHOST_POLICY_SHOW_ERROR_DIALOG<ept id=\"p3\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id=\"p4\">[</bpt>METAHOST_POLICY_USE_PROCESS_IMAGE_PATH<ept id=\"p4\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, and <bpt id=\"p5\">[</bpt>METAHOST_POLICY_ENSURE_SKU_SUPPORTED<ept id=\"p5\">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>.","pos":[2777,3430],"source":"Modifiers include [METAHOST_POLICY_EMULATE_EXE_LAUNCH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_APPLY_UPGRADE_POLICY](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_SHOW_ERROR_DIALOG](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_USE_PROCESS_IMAGE_PATH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), and [METAHOST_POLICY_ENSURE_SKU_SUPPORTED](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)."},{"content":"[in] Optional.","pos":[3447,3461]},{"content":"Specifies the assembly file path.","pos":[3462,3495]},{"content":"[in] Optional.","pos":[3513,3527]},{"content":"Specifies the configuration file as a <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=fullName&gt;</ph>.","pos":[3528,3646],"source":" Specifies the configuration file as a <xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=fullName>."},{"content":"[in, out] Optional.","pos":[3664,3683]},{"content":"Specifies or returns the preferred CLR version to be loaded.","pos":[3684,3744]},{"content":"[in, out] Required.","pos":[3763,3782]},{"content":"Specifies the expected size of <ph id=\"ph1\">`pwzVersion`</ph> as input, to avoid buffer overruns.","pos":[3783,3862],"source":" Specifies the expected size of `pwzVersion` as input, to avoid buffer overruns."},{"content":"If <ph id=\"ph1\">`pwzVersion`</ph> is null, <ph id=\"ph2\">`pcchVersion`</ph> contains the expected size of <ph id=\"ph3\">`pwzVersion`</ph> when <ph id=\"ph4\">`GetRequestedRuntime`</ph> returns, to allow pre-allocation; otherwise, <ph id=\"ph5\">`pcchVersion`</ph> contains the number of characters written to <ph id=\"ph6\">`pwzVersion`</ph>.","pos":[3863,4089],"source":" If `pwzVersion` is null, `pcchVersion` contains the expected size of `pwzVersion` when `GetRequestedRuntime` returns, to allow pre-allocation; otherwise, `pcchVersion` contains the number of characters written to `pwzVersion`."},{"content":"[out] Optional.","pos":[4112,4127]},{"content":"When <ph id=\"ph1\">`GetRequestedRuntime`</ph> returns, contains the CLR version corresponding to the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that is returned.","pos":[4128,4334],"source":" When `GetRequestedRuntime` returns, contains the CLR version corresponding to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that is returned."},{"content":"[in, out] Optional.","pos":[4358,4377]},{"content":"Specifies the size of <ph id=\"ph1\">`pwzImageVersion`</ph> as input to avoid buffer overruns.","pos":[4378,4452],"source":" Specifies the size of `pwzImageVersion` as input to avoid buffer overruns."},{"content":"If <ph id=\"ph1\">`pwzImageVersion`</ph> is null, <ph id=\"ph2\">`pcchImageVersion`</ph> contains the required size of <ph id=\"ph3\">`pwzImageVersion`</ph> when <ph id=\"ph4\">`GetRequestedRuntime`</ph> returns, to allow pre-allocation.","pos":[4453,4610],"source":" If `pwzImageVersion` is null, `pcchImageVersion` contains the required size of `pwzImageVersion` when `GetRequestedRuntime` returns, to allow pre-allocation."},{"content":"[out] Optional.","pos":[4632,4647]},{"content":"If <ph id=\"ph1\">`GetRequestedRuntime`</ph> uses a configuration file during the binding process, when it returns, <ph id=\"ph2\">`pdwConfigFlags`</ph> contains a <bpt id=\"p1\">[</bpt>METAHOST_CONFIG_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md)</ept> value that indicates whether the <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\&lt;</ph>startup&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md)</ept> element has the <ph id=\"ph4\">`useLegacyV2RuntimeActivationPolicy`</ph> attribute set, and the value of the attribute.","pos":[4648,5110],"source":" If `GetRequestedRuntime` uses a configuration file during the binding process, when it returns, `pdwConfigFlags` contains a [METAHOST_CONFIG_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) value that indicates whether the [\\<startup>](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md) element has the `useLegacyV2RuntimeActivationPolicy` attribute set, and the value of the attribute."},{"content":"Apply the <bpt id=\"p1\">[</bpt>METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md)</ept> mask to <ph id=\"ph1\">`pdwConfigFlags`</ph> to get the values relevant to <ph id=\"ph2\">`useLegacyV2RuntimeActivationPolicy`</ph>.","pos":[5111,5357],"source":" Apply the [METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) mask to `pdwConfigFlags` to get the values relevant to `useLegacyV2RuntimeActivationPolicy`."},{"pos":[5369,5554],"content":"[in] Specifies the interface identifier IID_ICLRRuntimeInfo for the requested <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface.","source":"[in] Specifies the interface identifier IID_ICLRRuntimeInfo for the requested [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface."},{"pos":[5571,5760],"content":"[out] When <ph id=\"ph1\">`GetRequestedRuntime`</ph> returns, contains a pointer to the corresponding <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface.","source":"[out] When `GetRequestedRuntime` returns, contains a pointer to the corresponding [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface."},{"pos":[5770,5777],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5781,6068],"content":"When this method succeeds, it has the side effect of combining additional flags with the current default startup flags of the returned runtime interface, if and only if one or more of the following elements exist in the configuration stream within the <ph id=\"ph1\">`&lt;configuration&gt;&lt;runtime&gt;`</ph> section:","source":"When this method succeeds, it has the side effect of combining additional flags with the current default startup flags of the returned runtime interface, if and only if one or more of the following elements exist in the configuration stream within the `<configuration><runtime>` section:"},{"pos":[6078,6144],"content":"<ph id=\"ph1\">`&lt;gcServer enabled=\"true\"/&gt;`</ph> causes <ph id=\"ph2\">`STARTUP_SERVER_GC`</ph> to be set.","source":"`<gcServer enabled=\"true\"/>` causes `STARTUP_SERVER_GC` to be set."},{"pos":[6154,6215],"content":"<ph id=\"ph1\">`&lt;etwEnable enabled=\"true\"/&gt;`</ph> causes <ph id=\"ph2\">`STARTUP_ETW`</ph> to be set.","source":"`<etwEnable enabled=\"true\"/>` causes `STARTUP_ETW` to be set."},{"pos":[6225,6304],"content":"<ph id=\"ph1\">`&lt;appDomainResourceMonitoring enabled=\"true\"/&gt;`</ph> causes <ph id=\"ph2\">`STARTUP_ARM`</ph> to be set.","source":"`<appDomainResourceMonitoring enabled=\"true\"/>` causes `STARTUP_ARM` to be set."},{"pos":[6311,6467],"content":"The resulting default <ph id=\"ph1\">`STARTUP_FLAGS`</ph> value is the bitwise OR combination of the values that are set from the preceding list with the default startup flags.","source":"The resulting default `STARTUP_FLAGS` value is the bitwise OR combination of the values that are set from the preceding list with the default startup flags."},{"pos":[6476,6488],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[6492,6599]},{"content":"HRESULT","pos":[6606,6613]},{"content":"Description","pos":[6614,6625]},{"content":"S_OK","pos":[6666,6670]},{"content":"The method completed successfully.","pos":[6671,6705]},{"content":"E_POINTER","pos":[6710,6719]},{"content":"<ph id=\"ph1\">`pwzVersion`</ph> is not null and <ph id=\"ph2\">`pcchVersion`</ph> is null.","pos":[6720,6771],"source":"`pwzVersion` is not null and `pcchVersion` is null."},{"content":"-or-","pos":[6784,6788]},{"content":"<ph id=\"ph1\">`pwzImageVersion`</ph> is not null and <ph id=\"ph2\">`pcchImageVersion`</ph> is null.","pos":[6801,6862],"source":"`pwzImageVersion` is not null and `pcchImageVersion` is null."},{"content":"E_INVALIDARG","pos":[6867,6879]},{"pos":[6880,6942],"content":"<ph id=\"ph1\">`dwPolicyFlags`</ph> does not specify <ph id=\"ph2\">`METAHOST_POLICY_HIGHCOMPAT`</ph>.","source":"`dwPolicyFlags` does not specify `METAHOST_POLICY_HIGHCOMPAT`."},{"content":"ERROR_INSUFFICIENT_BUFFER","pos":[6947,6972]},{"content":"The memory allocated to <ph id=\"ph1\">`pwzVerison`</ph> is inadequate.","pos":[6973,7024],"source":"The memory allocated to `pwzVerison` is inadequate."},{"content":"-or-","pos":[7037,7041]},{"content":"The memory allocated to <ph id=\"ph1\">`pwzImageVerison`</ph> is inadequate.","pos":[7054,7110],"source":"The memory allocated to `pwzImageVerison` is inadequate."},{"content":"CLR_E_SHIM_RUNTIMELOAD","pos":[7115,7137]},{"pos":[7138,7250],"content":"<ph id=\"ph1\">`dwPolicyFlags`</ph> includes METAHOST_POLICY_APPLY_UPGRADE_POLICY, and both <ph id=\"ph2\">`pwzVersion`</ph> and <ph id=\"ph3\">`pcchVersion`</ph> are null.","source":"`dwPolicyFlags` includes METAHOST_POLICY_APPLY_UPGRADE_POLICY, and both `pwzVersion` and `pcchVersion` are null."},{"pos":[7260,7272],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[7276,7380],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[7387,7409],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MetaHost.h","source":"**Header:** MetaHost.h"},{"pos":[7416,7466],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[7473,7581],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[7590,7598],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICLRMetaHostPolicy Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[7602,7715],"source":"[ICLRMetaHostPolicy Interface](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>CLR Hosting Interfaces Added in the .NET Framework 4 and 4.5<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces-added-in-the-net-framework-4-and-4-5.md)</ept><ph id=\"ph1\"> </ph>","pos":[7719,7895],"source":"[CLR Hosting Interfaces Added in the .NET Framework 4 and 4.5](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces-added-in-the-net-framework-4-and-4-5.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[7899,7992],"source":"[Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/index.md)</ept>","pos":[7996,8064],"source":"[Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)"}]}