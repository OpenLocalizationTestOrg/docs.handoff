{"content":"---\ntitle: \"Making an image easier to debug in .NET\"\ndescription: \"Learn how to configure an executable image for easier debugging using IDE switches and command-line options.\"\nms.date: \"08/30/2018\"\nhelpviewer_keywords:\n  - \"images [.NET Framework], debugging\"\n  - \"executable image for debugging\"\n  - \"debugging [.NET Framework], executable images for\"\nms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n\n# Making an image easier to debug in .NET\n\nWhen compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options. For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb). Similarly, the /**Od** command-line option tells the compiler to disable optimization. The resulting code runs more slowly, but it's easier to debug, should this be necessary.\n\nWhen compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL). MSIL is then JIT-compiled, just before execution, into native machine code. As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options. You can also configure the JIT compilation for debugging in much the same way.\n\nThis JIT configuration has two aspects:\n\n- You can request the JIT compiler to generate tracking information. This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored. Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.\n\n- You can request the JIT compiler to not optimize the resulting machine code.\n\nNormally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.\n\nIn some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug. For example, you might want to generate JIT tracking information for a retail build or control optimization. You can do so with an initialization (.ini) file.\n\nFor example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:\n\n```ini\n[.NET Framework Debugging Control]\nGenerateTrackingInfo=1\nAllowOptimize=0\n```\n\nYou can set the value of each option to 0 or 1, and any absent option defaults to 0. Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.\n\nStarting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect. When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes. If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized. If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.\n\nThe <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly. **DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information. Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.\n\nFor a retail build, compilers don't set any **DebuggableAttribute**. By default, the JIT compiler generates the highest performance, hardest to debug machine code. Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.\n\nThe **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly. Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**. The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of. If there's a conflict, the ALink operation fails.\n\n> [!NOTE]\n> In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified. In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.\n\n## See also\n\n- [Debugging, Tracing, and Profiling](../../../docs/framework/debug-trace-profile/index.md)\n- [Enabling JIT-Attach Debugging](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)\n- [Enabling Profiling](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))\n","nodes":[{"pos":[4,439],"embed":true,"restype":"x-metadata","content":"title: \"Making an image easier to debug in .NET\"\ndescription: \"Learn how to configure an executable image for easier debugging using IDE switches and command-line options.\"\nms.date: \"08/30/2018\"\nhelpviewer_keywords:\n  - \"images [.NET Framework], debugging\"\n  - \"executable image for debugging\"\n  - \"debugging [.NET Framework], executable images for\"\nms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Making an image easier to debug in .NET","nodes":[{"pos":[0,39],"content":"Making an image easier to debug in .NET","nodes":[{"content":"Making an image easier to debug in .NET","pos":[0,39]}]}],"path":["title"],"nosxs":false},{"content":"Learn how to configure an executable image for easier debugging using IDE switches and command-line options.","nodes":[{"pos":[0,108],"content":"Learn how to configure an executable image for easier debugging using IDE switches and command-line options.","nodes":[{"content":"Learn how to configure an executable image for easier debugging using IDE switches and command-line options.","pos":[0,108]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[447,486],"content":"Making an image easier to debug in .NET","linkify":"Making an image easier to debug in .NET","nodes":[{"content":"Making an image easier to debug in .NET","pos":[0,39]}]},{"content":"When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.","pos":[488,619]},{"content":"For example, you can use the /<bpt id=\"p1\">**</bpt>Zi<ept id=\"p1\">**</ept> command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).","pos":[620,750],"source":" For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb)."},{"content":"Similarly, the /<bpt id=\"p1\">**</bpt>Od<ept id=\"p1\">**</ept> command-line option tells the compiler to disable optimization.","pos":[751,837],"source":" Similarly, the /**Od** command-line option tells the compiler to disable optimization."},{"content":"The resulting code runs more slowly, but it's easier to debug, should this be necessary.","pos":[838,926]},{"content":"When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL).","pos":[928,1096]},{"content":"MSIL is then JIT-compiled, just before execution, into native machine code.","pos":[1097,1172]},{"content":"As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.","pos":[1173,1297]},{"content":"You can also configure the JIT compilation for debugging in much the same way.","pos":[1298,1376]},{"content":"This JIT configuration has two aspects:","pos":[1378,1417]},{"content":"You can request the JIT compiler to generate tracking information.","pos":[1421,1487]},{"content":"This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.","pos":[1488,1660]},{"content":"Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.","pos":[1661,1797]},{"content":"You can request the JIT compiler to not optimize the resulting machine code.","pos":[1801,1877]},{"pos":[1879,2059],"content":"Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /<bpt id=\"p1\">**</bpt>Od<ept id=\"p1\">**</ept>.","source":"Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**."},{"content":"In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.","pos":[2061,2191]},{"content":"For example, you might want to generate JIT tracking information for a retail build or control optimization.","pos":[2192,2300]},{"content":"You can do so with an initialization (.ini) file.","pos":[2301,2350]},{"pos":[2352,2541],"content":"For example, if the assembly you want to debug is called <bpt id=\"p1\">*</bpt>MyApp.exe<ept id=\"p1\">*</ept>, then you can create a text file named <bpt id=\"p2\">*</bpt>MyApp.ini<ept id=\"p2\">*</ept>, in the same folder as <bpt id=\"p3\">*</bpt>MyApp.exe<ept id=\"p3\">*</ept>, which contains these three lines:","source":"For example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:"},{"content":"You can set the value of each option to 0 or 1, and any absent option defaults to 0.","pos":[2629,2713]},{"content":"Setting <ph id=\"ph1\">`GenerateTrackingInfo`</ph> to 1 and <ph id=\"ph2\">`AllowOptimize`</ph> to 0 provides the easiest debugging.","pos":[2714,2806],"source":" Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging."},{"content":"Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for <ph id=\"ph1\">`GenerateTrackingInfo`</ph>; however, the <ph id=\"ph2\">`AllowOptimize`</ph> value still has an effect.","pos":[2808,3016],"source":"Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect."},{"content":"When using the <bpt id=\"p1\">[</bpt>Ngen.exe (Native Image Generator)<ept id=\"p1\">](../../../docs/framework/tools/ngen-exe-native-image-generator.md)</ept> to precompile the native image without optimization, the .ini file must be present in the target folder with <ph id=\"ph1\">`AllowOptimize=0`</ph> when Ngen.exe executes.","pos":[3017,3284],"source":" When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes."},{"content":"If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe <bpt id=\"p1\">**</bpt>/uninstall<ept id=\"p1\">**</ept> option before rerunning Ngen.exe to precompile the code as optimized.","pos":[3285,3479],"source":" If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized."},{"content":"If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.","pos":[3480,3580]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType&gt;</ph> controls the settings for an assembly.","pos":[3582,3699],"source":"The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly."},{"content":"<bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept> includes two fields that control whether the JIT compiler should optimize and/or generate tracking information.","pos":[3700,3835],"source":"**DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information."},{"content":"Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.","pos":[3836,3937]},{"content":"For a retail build, compilers don't set any <bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept>.","pos":[3939,4007],"source":"For a retail build, compilers don't set any **DebuggableAttribute**."},{"content":"By default, the JIT compiler generates the highest performance, hardest to debug machine code.","pos":[4008,4102]},{"content":"Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.","pos":[4103,4206]},{"content":"The <bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept> applies to a whole assembly at a time, not to individual modules within the assembly.","pos":[4208,4321],"source":"The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly."},{"content":"Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called <bpt id=\"p1\">**</bpt>System.Runtime.CompilerServices.AssemblyAttributesGoHere<ept id=\"p1\">**</ept>.","pos":[4322,4537],"source":" Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**."},{"content":"The ALink tool then promotes these <bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept> attributes from each module to the assembly they become a part of.","pos":[4538,4663],"source":" The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of."},{"content":"If there's a conflict, the ALink operation fails.","pos":[4664,4713]},{"pos":[4717,5046],"content":"[!NOTE]\nIn version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified. In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.","leadings":["","> "],"nodes":[{"content":"In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified. In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.","pos":[8,327],"nodes":[{"content":"In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the <bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept> when the <bpt id=\"p2\">**</bpt>/clr<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>/Zi<ept id=\"p3\">**</ept> compiler options are specified.","pos":[0,166],"source":"In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified."},{"content":"In version 1.1 of the .NET Framework, you must either add the <bpt id=\"p1\">**</bpt>DebuggableAttribute<ept id=\"p1\">**</ept> manually in your code or use the <bpt id=\"p2\">**</bpt>/ASSEMBLYDEBUG<ept id=\"p2\">**</ept> linker option.","pos":[167,319],"source":" In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option."}]}]},{"pos":[5051,5059],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5063,5152],"content":"<bpt id=\"p1\">[</bpt>Debugging, Tracing, and Profiling<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/index.md)</ept>","source":"[Debugging, Tracing, and Profiling](../../../docs/framework/debug-trace-profile/index.md)"},{"pos":[5155,5264],"content":"<bpt id=\"p1\">[</bpt>Enabling JIT-Attach Debugging<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)</ept>","source":"[Enabling JIT-Attach Debugging](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)"},{"pos":[5267,5376],"content":"<bpt id=\"p1\">[</bpt>Enabling Profiling<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</ept>","source":"[Enabling Profiling](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))"}]}