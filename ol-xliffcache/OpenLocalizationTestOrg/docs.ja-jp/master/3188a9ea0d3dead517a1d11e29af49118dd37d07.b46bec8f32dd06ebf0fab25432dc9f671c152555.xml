{"content":"---\ntitle: \"Mage.exe (Manifest Generation and Editing Tool) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"Manifest Generation and Editing tool\"\n  - \"Mage.exe\"\nms.assetid: 77dfe576-2962-407e-af13-82255df725a1\ncaps.latest.revision: 68\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Mage.exe (Manifest Generation and Editing Tool)\nThe Manifest Generation and Editing Tool (Mage.exe) is a command-line tool that supports the creation and editing of application and deployment manifests. As a command-line tool, Mage.exe can be run from both batch scripts and other Windows-based applications, including [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications.  \n  \n You can also use MageUI.exe, a graphical application, instead of Mage.exe. For more information, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).  \n  \n This tool is automatically installed with Visual Studio. To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7). For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).  \n  \n Two versions of Mage.exe and MageUI.exe are included as a component of the [!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)] setup. To see version information, run MageUI.exe, select **Help**, and select **About**. This documentation describes version 4.0.x.x of Mage.exe and MageUI.exe.  \n  \n At the command prompt, type the following:  \n  \n## Syntax  \n  \n```  \nMage [commands] [commandOptions]  \n```  \n  \n#### Parameters  \n The following table shows the commands supported by Mage.exe. For more information about the options supported by these commands, see [New and Update Command Options](#NewUpdate) and [Sign Command Options](#Sign).  \n  \n|Command|Description|  \n|-------------|-----------------|  \n|**-cc, ClearApplicationCache**|Clears the downloaded application cache of all online-only applications.|  \n|**-n, -New** *fileType [newOptions]*|Creates a new file of the given type. Valid types are:<br /><br /> -   `Deployment`: Creates a new deployment manifest.<br />-   `Application`: Creates a new application manifest.<br /><br /> If you do not specify any additional parameters with this command, it will create a file of the appropriate type, with appropriate default tags and attribute values.<br /><br /> Use the **-ToFile** option (see in the following table) to specify the file name and path of the new file.<br /><br /> Use the **-FromDirectory** option (see in the following table) to create an application manifest with all of the assemblies for an application added to the \\<dependency> section of the manifest.|  \n|**-u, -Update** *[filePath] [updateOptions]*|Makes one or more changes to a manifest file. You do not have to specify the type of file that you are editing. Mage.exe will examine the file by using a set of heuristics and determine whether it is a deployment manifest or an application manifest.<br /><br /> If you have already signed a file with a certificate, **-Update** will remove the key signature block. This is because the key signature contains a hash of the file, and modifying the file renders the hash invalid.<br /><br /> Use the **-ToFile** option (see in the following table) to specify a new file name and path instead of overwriting the existing file.|  \n|**-s, -Sign** `[signOptions]`|Uses a key pair or X509 certificate to sign a file. Signatures are inserted as XML elements inside of the files.<br /><br /> You must be connected to the Internet when signing a manifest that specifies a **-TimestampUri** value.|  \n|**-h, -?, -Help** *[verbose]*|Describes all of the available commands and their options. Specify `verbose` to get detailed help.|  \n  \n<a name=\"NewUpdate\"></a>   \n## New and Update Command Options  \n The following table shows the options supported by the `-New` and `-Update` commands.  \n  \n|Options|Default Value|Applies To|Description|  \n|-------------|-------------------|----------------|-----------------|  \n|**-a, -Algorithm**|sha1RSA|Application manifests.<br /><br /> Deployment manifests.|Specifies the algorithm to generate dependency digests with. Value must be \"sha256RSA\" or \"sha1RSA.<br /><br /> Use with the \"-Update\" option. This option is ignored when using the \"-Sign\" option|  \n|**-appc, -AppCodeBase** `manifestReference`||Deployment manifests.|Inserts a URL or file path reference to the application manifest file. This value must be the full path to the application manifest.|  \n|**-appm, -AppManifest** `manifestPath`||Deployment manifests.|Inserts a reference to a deployment's application manifest into its deployment manifest.<br /><br /> The file indicated by `manifestPath` must exist, or Mage.exe will issue an error. If the file referenced by `manifestPath` is not an application manifest, Mage.exe will issue an error.|  \n|**-cf, -CertFile** `filePath`||All file types.|Specifies the location of an X509 digital certificate for signing a manifest. This option can be used in conjunction with the **-Password** option, if the certificate requires a password.|  \n|**-ch, -CertHash** `hashSignature`||All file types.|The hash of a digital certificate stored in the personal certificate store of the client computer. This corresponds to the Thumbprint string of a digital certificate viewed in the Windows Certificates Console.<br /><br /> `hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string, or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.|  \n|**-fd, -FromDirectory** `directoryPath`||Application manifests.|Populates the application manifest with descriptions of all assemblies and files found in `directoryPath`, including all subdirectories, where `directoryPath` is the directory that contains the application that you want to deploy. For each file in the directory, Mage.exe decides whether the file is an assembly or a static file. If it is an assembly, it adds a `<dependency>` tag and `installFrom` attribute to the application with the assembly's name, code base, and version. If it is a static file, it adds a `<file>` tag. Mage.exe will also use a simple set of heuristics to detect the main executable for the application, and will mark it as the ClickOnce application's entry point in the manifest.<br /><br /> Mage.exe will never automatically mark a file as a \"data\" file. You must do this manually. For more information, see [How to: Include a Data File in a ClickOnce Application](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application).<br /><br /> Mage.exe also generates a hash for each file based on its size. ClickOnce uses these hashes to ensure that no one has tampered with the deployment's files since the manifest was created. If any of the files in your deployment change, you can run Mage.exe with the **-Update** command and the **-FromDirectory** option, and it will update the hashes and assembly versions of all referenced files.<br /><br /> **-FromDirectory** will include all files in all subdirectories found within `directoryPath`.<br /><br /> If you use **-FromDirectory** with the **-Update** command, Mage.exe will remove any files in the application manifest that no longer exist in the directory.|  \n|**-if, -IconFile**  `filePath`||Application manifests.|Specifies the full path to an .ICO icon file. This icon appears beside your application name in the start menu, and in its Add-or-Remove Programs entry. If no icon is provided, a default icon is used.|  \n|**-ip, -IncludeProviderURL**  `url`|true|Deployment manifests.|Indicates whether the deployment manifest includes the update location value set by **-ProviderURL**.|  \n|**-i, -Install** `willInstall`|true|Deployment manifests.|Indicates whether or not the ClickOnce application should install onto the local computer, or whether it should run from the Web. Installing an application gives that application a presence in the Windows **Start** menu. Valid values are \"true\" or \"t\", and \"false\" or \"f\".<br /><br /> If you specify the **-MinVersion** option, and a user has a version less than **-MinVersion** installed, it will force the application to install, regardless of the value that you pass to **-Install**.<br /><br /> This option cannot be used with the **-BrowserHosted** option. Attempting to specify both for the same manifest will result in an error.|  \n|**-mv, -MinVersion**  `[version]`|The version listed in the ClickOnce deployment manifest as specified by the **-Version** flag.|Deployment manifests.|The minimum version of this application a user can run. This flag makes the named version of your application a required update. If you release a version of your product with an update to a breaking change or a critical security flaw, you can use this flag to specify that this update must be installed, and that the user cannot continue to run earlier versions.<br /><br /> `version` has the same semantics as the argument to the **-Version** flag.|  \n|**-n, -Name** `nameString`|Deploy|All file types.|The name that is used to identify the application. ClickOnce will use this name to identify the application in the **Start** menu (if the application is configured to install itself) and in Permission Elevation dialog boxes. **Note:**  If you are updating an existing manifest and you do not specify a publisher name with this option, Mage.exe updates the manifest with the organization name defined on the computer. To use a different name, make sure to use this option and specify the desired publisher name.|  \n|**-pwd, -Password** `passwd`||All file types.|The password that is used for signing a manifest with a digital certificate. Must be used in conjunction with the **-CertFile** option.|  \n|**-p, Processor** `processorValue`|Msil|Application manifests.<br /><br /> Deployment manifests.|The microprocessor architecture on which this distribution will run. This value is required if you are preparing one or more installations whose assemblies have been precompiled for a specific microprocessor. Valid values include `msil`, `x86`, `ia64`, and `amd64`. `msil` is Microsoft intermediate language, which means all of your assemblies are platform-independent, and the common language runtime (CLR) will just-in-time compile them when your application is first run.|  \n|**-pu,** **-ProviderURL** `url`||Deployment manifests.|Specifies the URL which ClickOnce will examine for application updates.|  \n|**-pub, -Publisher** `publisherName`||Application manifests.<br /><br /> Deployment manifests.|Adds the publisher name to the description element of either the deployment or application manifest. When used on an application manifest, **-UseManifestForTrust** must also be specified with a value of \"true\" or \"t\"; otherwise, this parameter will raise an error.|  \n|**-s, -SupportURL**  `url`||Application manifests.<br /><br /> Deployment manifests.|Specifies the link that appears in Add or Remove Programs for the ClickOnce application.|  \n|**-ti, -TimestampUri** `uri`||Application manifests.<br /><br /> Deployment manifests.|The URL of a digital timestamping service. Timestamping the manifests prevents you from having to re-sign the manifests should your digital certificate expire before you deploy the next version of your application. For more information, see [Windows root certificate program members](http://go.microsoft.com/fwlink/?LinkId=159000).|  \n|**-t, -ToFile** `filePath`|-   New:<br />-   Deployment: deploy.application<br />-   Application: application.exe.manifest<br />-   Update:<br />-   The input file.|All file types.|Specifies the output path of the file that has been created or modified.<br /><br /> If **-ToFile** is not supplied when you use **-New**, the output is written to the current working directory. If **-ToFile** is not supplied when you use **-Update**, Mage.exe will write the file back to the input file.|  \n|**-tr, -TrustLevel** `level`|Based on the zone in which the application URL resides.|Application manifests.|The level of trust to grant the application on client computers. Values include \"Internet\", \"Intranet\", and \"FullTrust\".|  \n|**-um, -UseManifestForTrust** `willUseForTrust`|False|Application manifests.|Specifies whether the digital signature of the application manifest will be used for making trust decisions when the application runs on the client. Specifying \"true\" or \"t\" indicates that the application manifest will be used for trust decisions. Specifying \"false\" or \"f\" indicates that the signature of the deployment manifest will be used.|  \n|**-v, -Version** `versionNumber`|1.0.0.0|Application manifests.<br /><br /> Deployment manifests.|The version of the deployment. The argument must be a valid version string of the format \"*N.N.N.N*\", where \"*N*\" is an unsigned 32-bit integer.|  \n|**-wpf, -WPFBrowserApp**  `isWPFApp`|false|Application manifests.<br /><br /> Deployment manifests.|Use this flag only if the application is a Windows Presentation Foundation (WPF) application that will be hosted inside of Internet Explorer, and is not a stand-alone executable. Valid values are \"true\" or \"t\", and \"false\" or \"f\".<br /><br /> For application manifests, inserts the `hostInBrowser` attribute under the `entryPoint` element of the application manifest.<br /><br /> For deployment manifests, sets the `install` attribute on the `deployment` element to false, and saves the deployment manifest with a .xbap extension. Specifying this argument along with the **-Install** argument produces an error, because a browser-hosted application cannot be an installed, offline application.|  \n  \n<a name=\"Sign\"></a>   \n## Sign Command Options  \n The following table shows the options supported by the `-Sign` command, which apply to all types of files.  \n  \n|Options|Description|  \n|-------------|-----------------|  \n|**-cf, -CertFile** `filePath`|Specifies The location of a digital certificate for signing a manifest. This option can be used in conjunction with the **-Password** option.|  \n|**-ch, -CertHash** `hashSignature`|The hash of a digital certificate stored in the personal certificate store of the client computer. This corresponds to the Thumbprint property of a digital certificate viewed in the Windows Certificates Console.<br /><br /> `hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.|  \n|**-pwd, -Password** `passwd`|The password that is used for signing a manifest with a digital certificate. Must be used in conjunction with the **-CertFile** option.|  \n|**-t, -ToFile** `filePath`|Specifies the output path of the file that has been created or modified.|  \n  \n## Remarks  \n All arguments to Mage.exe are case-insensitive. Commands and options can be prefixed with a dash (-) or a forward slash (/).  \n  \n All of the arguments used with the **-Sign** command can be used at any time with the **-New** or **-Update** commands as well. The following commands are equivalent.  \n  \n```  \nmage -Sign c:\\HelloWorldDeployment\\HelloWorld.deploy -CertFile cert.pfx  \nmage -Update c:\\HelloWorldDeployment\\HelloWorld.deploy -CertFile cert.pfx  \n```  \n  \n> [!NOTE]\n>  Beginning with .NET Framework version 4.6.2, CNG certificates are also supported.  \n  \n Signing is the last task you should perform, because a signed document uses a hash of the file to verify that the signature is valid for the document. If you make any changes to a signed file, you must sign it again. If you sign a document that was previously signed, Mage.exe will replace the old signature with the new.  \n  \n When you use the **-AppManifest** option to populate a deployment manifest, Mage.exe will assume that your application manifest will reside in the same directory as the deployment manifest within a subdirectory named after the current deployment version, and will configure your deployment manifest appropriately. If your application manifest will reside elsewhere, use the **-AppCodeBase** option to set the alternate location.  \n  \n Your deployment and application manifest must be signed before you deploy your application. For guidance about signing manifests, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview).  \n  \n The **-TrustLevel** option for application manifests describes the permission set an application requires to run on the client computer. By default, applications are assigned a trust level based on the *zone* in which their URL resides. Applications deployed over a corporate network are generally placed in the Intranet zone, while those deployed over the Internet are placed in the Internet zone. Both security zones place restrictions on the application's access to local resources, with the Intranet zone slightly more permissive than the Internet zone. The FullTrust zone gives applications complete access to a computer's local resources. If you use the **-TrustLevel** option to place an application in this zone, the Trust Manager component of the CLR will prompt the user to decide whether he or she wants to grant this higher level of trust. If you are deploying your application over a corporate network, you can use Trusted Application Deployment to raise the trust level of the application without prompting the user.  \n  \n Application manifests also support custom trust sections. This helps your application obey the security principle of requesting least permission, as you can configure the manifest to demand only those specific permissions that the application requires in order to execute. Mage.exe does not directly support adding a custom trust section. You can add one using a text editor, an XML parser, or the graphical tool MageUI.exe. For more information about how to use MageUI.exe to add custom trust sections, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).  \n  \n New manifests that are created with version 4 of Mage.exe, which is included with [!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)], target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]. To target earlier versions of the .NET Framework, you must use an earlier version of Mage.exe. When adding or removing assemblies from an existing manifest, or re-signing an existing manifest, Mage.exe does not update the manifest to target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]. The following tables show these features and restrictions.  \n  \n|Manifest version|Operation|Mage v2.0|Mage v4.0|  \n|----------------------|---------------|---------------|---------------|  \n|Manifest for applications targeting version 2.0 or 3.x of the .NET Framework|Open|OK|OK|  \n||Close|OK|OK|  \n||Save|OK|OK|  \n||Re-sign|OK|OK|  \n||New|OK|Not supported|  \n||Update (see below)|OK|OK|  \n|Manifest for applications targeting version 4 of the .NET Framework|Open|OK|OK|  \n||Close|OK|OK|  \n||Save|OK|OK|  \n||Re-sign|OK|OK|  \n||New|Not supported|OK|  \n||Update (see below)|Not supported|OK|  \n  \n|Manifest version|Update Operation Details|Mage v2.0|Mage v4.0|  \n|----------------------|------------------------------|---------------|---------------|  \n|Manifest for applications targeting version 2.0 or 3.x of the .NET Framework|Modify an assembly|OK|OK|  \n||Add an assembly|OK|OK|  \n||Remove an assembly|OK|OK|  \n|Manifest for applications targeting version 4 of the .NET Framework|Modify an assembly|Not supported|OK|  \n||Add an assembly|Not supported|OK|  \n||Remove an assembly|Not supported|OK|  \n  \n Mage.exe creates new manifests that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]. ClickOnce applications that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] can run on both the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] and the full version of the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]. If your application targets the full version of the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] and cannot run on the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)], remove the client `<framework>` element by using a text editor and re-sign the manifest. The following is a sample `<framework>` element that targets the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)].  \n  \n```  \n<framework targetVersion=\"4.0\" profile=\"client\" supportedRuntime=\"4.0.20506\" />  \n```  \n  \n## Examples  \n The following example opens the user interface for Mage (MageUI.exe).  \n  \n```  \nmage  \n```  \n  \n The following examples create a default deployment manifest and application manifest. These files are all created in the current working directory and are named deploy.application and application.exe.manifest, respectively.  \n  \n```  \nmage -New Deployment  \nmage -New Application  \n```  \n  \n The following example creates an application manifest populated with all of the assemblies and resource files from thecurrent directory.  \n  \n```  \nmage -New Application -FromDirectory . -Version 1.0.0.0  \n```  \n  \n The following example continues the previous example by specifying the deployment name and target microprocessor. It also specifies a URL against which ClickOnce should check for updates.  \n  \n```  \nmage -New Application -FromDirectory . -Name \"Hello, World! Application\" -Version 1.0.0.0 -Processor \"x86\" -ProviderUrl http://internalserver/HelloWorld/  \n```  \n  \n The following example demonstrates how to create a pair of manifests for deploying a WPF application that will be hosted in Internet Explorer.  \n  \n```  \nmage -New Application -FromDirectory . -Version 1.0.0.0 -WPFBrowserApp true  \nmage -New Deployment -AppManifest 1.0.0.0\\application.manifest -WPFBrowserApp true  \n```  \n  \n The following example updates a deployment manifest with information from an application manifest, and sets the code base for the location of the application manifest.  \n  \n```  \nmage -Update HelloWorld.deploy -AppManifest 1.0.0.0\\application.manifest -AppCodeBase http://internalserver/HelloWorld.deploy  \n```  \n  \n The following example edits the deployment manifest to force an update of the user's installed version.  \n  \n```  \nmage -Update c:\\HelloWorldDeployment\\HelloWorld.deploy -MinVersion 1.1.0.0  \n```  \n  \n The following example tells the deployment manifest to retrieve the application manifest from another directory.  \n  \n```  \nmage -Update HelloWorld.deploy -AppCodeBase http://anotherserver/HelloWorld/1.1.0.0/  \n```  \n  \n The following example signs an existing deployment manifest using a digital certificate in the current working directory.  \n  \n```  \nmage -Sign deploy.application -CertFile cert.pfx -Password <passwd>  \n```  \n  \n## See Also  \n [ClickOnce Security and Deployment](/visualstudio/deployment/clickonce-security-and-deployment)   \n [Walkthrough: Manually Deploying a ClickOnce Application](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application)   \n [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview)   \n [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)   \n [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)","nodes":[{"pos":[12,76],"content":"Mage.exe (Manifest Generation and Editing Tool) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mage.exe (Manifest Generation and Editing Tool) | Microsoft Docs","pos":[0,64]}]},{"pos":[521,568],"content":"Mage.exe (Manifest Generation and Editing Tool)","linkify":"Mage.exe (Manifest Generation and Editing Tool)","nodes":[{"content":"Mage.exe (Manifest Generation and Editing Tool)","pos":[0,47]}]},{"content":"The Manifest Generation and Editing Tool (Mage.exe) is a command-line tool that supports the creation and editing of application and deployment manifests.","pos":[569,723]},{"content":"As a command-line tool, Mage.exe can be run from both batch scripts and other Windows-based applications, including <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]</ph> applications.","pos":[724,908],"source":" As a command-line tool, Mage.exe can be run from both batch scripts and other Windows-based applications, including [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications."},{"content":"You can also use MageUI.exe, a graphical application, instead of Mage.exe.","pos":[915,989]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)<ept id=\"p1\">](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)</ept>.","pos":[990,1185],"source":" For more information, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)."},{"content":"This tool is automatically installed with Visual Studio.","pos":[1192,1248]},{"content":"To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7).","pos":[1249,1350]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Command Prompts<ept id=\"p1\">](../../../docs/framework/tools/developer-command-prompt-for-vs.md)</ept>.","pos":[1351,1461],"source":" For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)."},{"content":"Two versions of Mage.exe and MageUI.exe are included as a component of the <ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)]</ph> setup.","pos":[1468,1614],"source":"Two versions of Mage.exe and MageUI.exe are included as a component of the [!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)] setup."},{"content":"To see version information, run MageUI.exe, select <bpt id=\"p1\">**</bpt>Help<ept id=\"p1\">**</ept>, and select <bpt id=\"p2\">**</bpt>About<ept id=\"p2\">**</ept>.","pos":[1615,1697],"source":" To see version information, run MageUI.exe, select **Help**, and select **About**."},{"content":"This documentation describes version 4.0.x.x of Mage.exe and MageUI.exe.","pos":[1698,1770]},{"content":"At the command prompt, type the following:","pos":[1777,1819]},{"pos":[1828,1834],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1895,1905],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The following table shows the commands supported by Mage.exe.","pos":[1909,1970]},{"content":"For more information about the options supported by these commands, see <bpt id=\"p1\">[</bpt>New and Update Command Options<ept id=\"p1\">](#NewUpdate)</ept> and <bpt id=\"p2\">[</bpt>Sign Command Options<ept id=\"p2\">](#Sign)</ept>.","pos":[1971,2122],"source":" For more information about the options supported by these commands, see [New and Update Command Options](#NewUpdate) and [Sign Command Options](#Sign)."},{"content":"Command","pos":[2129,2136]},{"content":"Description","pos":[2137,2148]},{"pos":[2189,2219],"content":"<bpt id=\"p1\">**</bpt>-cc, ClearApplicationCache<ept id=\"p1\">**</ept>","source":"**-cc, ClearApplicationCache**"},{"content":"Clears the downloaded application cache of all online-only applications.","pos":[2220,2292]},{"pos":[2297,2333],"content":"<bpt id=\"p1\">**</bpt>-n, -New<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>fileType [newOptions]<ept id=\"p2\">*</ept>","source":"**-n, -New** *fileType [newOptions]*"},{"content":"Creates a new file of the given type.","pos":[2334,2371]},{"content":"Valid types are:","pos":[2372,2388]},{"content":"<ph id=\"ph1\"> -   </ph><ph id=\"ph2\">`Deployment`</ph>: Creates a new deployment manifest.","pos":[2400,2453],"source":" -   `Deployment`: Creates a new deployment manifest."},{"content":"<ph id=\"ph1\">-   </ph><ph id=\"ph2\">`Application`</ph>: Creates a new application manifest.","pos":[2459,2513],"source":"-   `Application`: Creates a new application manifest."},{"content":"If you do not specify any additional parameters with this command, it will create a file of the appropriate type, with appropriate default tags and attribute values.","pos":[2526,2691]},{"content":"Use the <bpt id=\"p1\">**</bpt>-ToFile<ept id=\"p1\">**</ept> option (see in the following table) to specify the file name and path of the new file.","pos":[2704,2810],"source":" Use the **-ToFile** option (see in the following table) to specify the file name and path of the new file."},{"content":"Use the <bpt id=\"p1\">**</bpt>-FromDirectory<ept id=\"p1\">**</ept> option (see in the following table) to create an application manifest with all of the assemblies for an application added to the <ph id=\"ph1\">\\&lt;</ph>dependency&gt; section of the manifest.","pos":[2823,3017],"source":" Use the **-FromDirectory** option (see in the following table) to create an application manifest with all of the assemblies for an application added to the \\<dependency> section of the manifest."},{"pos":[3022,3066],"content":"<bpt id=\"p1\">**</bpt>-u, -Update<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>[filePath] [updateOptions]<ept id=\"p2\">*</ept>","source":"**-u, -Update** *[filePath] [updateOptions]*"},{"content":"Makes one or more changes to a manifest file.","pos":[3067,3112]},{"content":"You do not have to specify the type of file that you are editing.","pos":[3113,3178]},{"content":"Mage.exe will examine the file by using a set of heuristics and determine whether it is a deployment manifest or an application manifest.","pos":[3179,3316]},{"content":"If you have already signed a file with a certificate, <bpt id=\"p1\">**</bpt>-Update<ept id=\"p1\">**</ept> will remove the key signature block.","pos":[3329,3431],"source":" If you have already signed a file with a certificate, **-Update** will remove the key signature block."},{"content":"This is because the key signature contains a hash of the file, and modifying the file renders the hash invalid.","pos":[3432,3543]},{"content":"Use the <bpt id=\"p1\">**</bpt>-ToFile<ept id=\"p1\">**</ept> option (see in the following table) to specify a new file name and path instead of overwriting the existing file.","pos":[3556,3689],"source":" Use the **-ToFile** option (see in the following table) to specify a new file name and path instead of overwriting the existing file."},{"pos":[3694,3723],"content":"<bpt id=\"p1\">**</bpt>-s, -Sign<ept id=\"p1\">**</ept> <ph id=\"ph1\">`[signOptions]`</ph>","source":"**-s, -Sign** `[signOptions]`"},{"content":"Uses a key pair or X509 certificate to sign a file.","pos":[3724,3775]},{"content":"Signatures are inserted as XML elements inside of the files.","pos":[3776,3836]},{"content":"You must be connected to the Internet when signing a manifest that specifies a <bpt id=\"p1\">**</bpt>-TimestampUri<ept id=\"p1\">**</ept> value.","pos":[3849,3952],"source":" You must be connected to the Internet when signing a manifest that specifies a **-TimestampUri** value."},{"pos":[3957,3986],"content":"<bpt id=\"p1\">**</bpt>-h, -?, -Help<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>[verbose]<ept id=\"p2\">*</ept>","source":"**-h, -?, -Help** *[verbose]*"},{"content":"Describes all of the available commands and their options.","pos":[3987,4045]},{"content":"Specify <ph id=\"ph1\">`verbose`</ph> to get detailed help.","pos":[4046,4085],"source":" Specify `verbose` to get detailed help."},{"pos":[4123,4153],"content":"New and Update Command Options","linkify":"New and Update Command Options","nodes":[{"content":"New and Update Command Options","pos":[0,30]}]},{"pos":[4157,4242],"content":"The following table shows the options supported by the <ph id=\"ph1\">`-New`</ph> and <ph id=\"ph2\">`-Update`</ph> commands.","source":"The following table shows the options supported by the `-New` and `-Update` commands."},{"content":"Options","pos":[4249,4256]},{"content":"Default Value","pos":[4257,4270]},{"content":"Applies To","pos":[4271,4281]},{"content":"Description","pos":[4282,4293]},{"pos":[4371,4389],"content":"<bpt id=\"p1\">**</bpt>-a, -Algorithm<ept id=\"p1\">**</ept>","source":"**-a, -Algorithm**"},{"content":"sha1RSA","pos":[4390,4397]},{"content":"Application manifests.","pos":[4398,4420]},{"content":"Deployment manifests.","pos":[4433,4454]},{"content":"Specifies the algorithm to generate dependency digests with.","pos":[4455,4515]},{"content":"Value must be \"sha256RSA\" or \"sha1RSA.","pos":[4516,4554]},{"content":"Use with the \"-Update\" option.","pos":[4567,4597]},{"content":"This option is ignored when using the \"-Sign\" option","pos":[4598,4650]},{"pos":[4655,4698],"content":"<bpt id=\"p1\">**</bpt>-appc, -AppCodeBase<ept id=\"p1\">**</ept> <ph id=\"ph1\">`manifestReference`</ph>","source":"**-appc, -AppCodeBase** `manifestReference`"},{"content":"Deployment manifests.","pos":[4700,4721]},{"content":"Inserts a URL or file path reference to the application manifest file.","pos":[4722,4792]},{"content":"This value must be the full path to the application manifest.","pos":[4793,4854]},{"pos":[4859,4897],"content":"<bpt id=\"p1\">**</bpt>-appm, -AppManifest<ept id=\"p1\">**</ept> <ph id=\"ph1\">`manifestPath`</ph>","source":"**-appm, -AppManifest** `manifestPath`"},{"content":"Deployment manifests.","pos":[4899,4920]},{"content":"Inserts a reference to a deployment's application manifest into its deployment manifest.","pos":[4921,5009]},{"content":"The file indicated by <ph id=\"ph1\">`manifestPath`</ph> must exist, or Mage.exe will issue an error.","pos":[5022,5103],"source":" The file indicated by `manifestPath` must exist, or Mage.exe will issue an error."},{"content":"If the file referenced by <ph id=\"ph1\">`manifestPath`</ph> is not an application manifest, Mage.exe will issue an error.","pos":[5104,5206],"source":" If the file referenced by `manifestPath` is not an application manifest, Mage.exe will issue an error."},{"pos":[5211,5240],"content":"<bpt id=\"p1\">**</bpt>-cf, -CertFile<ept id=\"p1\">**</ept> <ph id=\"ph1\">`filePath`</ph>","source":"**-cf, -CertFile** `filePath`"},{"content":"All file types.","pos":[5242,5257]},{"content":"Specifies the location of an X509 digital certificate for signing a manifest.","pos":[5258,5335]},{"content":"This option can be used in conjunction with the <bpt id=\"p1\">**</bpt>-Password<ept id=\"p1\">**</ept> option, if the certificate requires a password.","pos":[5336,5445],"source":" This option can be used in conjunction with the **-Password** option, if the certificate requires a password."},{"pos":[5450,5484],"content":"<bpt id=\"p1\">**</bpt>-ch, -CertHash<ept id=\"p1\">**</ept> <ph id=\"ph1\">`hashSignature`</ph>","source":"**-ch, -CertHash** `hashSignature`"},{"content":"All file types.","pos":[5486,5501]},{"content":"The hash of a digital certificate stored in the personal certificate store of the client computer.","pos":[5502,5600]},{"content":"This corresponds to the Thumbprint string of a digital certificate viewed in the Windows Certificates Console.","pos":[5601,5711]},{"content":"<ph id=\"ph1\">`hashSignature`</ph> can be either uppercase or lowercase, and can be supplied either as a single string, or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.","pos":[5724,5936],"source":"`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string, or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks."},{"pos":[5941,5980],"content":"<bpt id=\"p1\">**</bpt>-fd, -FromDirectory<ept id=\"p1\">**</ept> <ph id=\"ph1\">`directoryPath`</ph>","source":"**-fd, -FromDirectory** `directoryPath`"},{"content":"Application manifests.","pos":[5982,6004]},{"content":"Populates the application manifest with descriptions of all assemblies and files found in <ph id=\"ph1\">`directoryPath`</ph>, including all subdirectories, where <ph id=\"ph2\">`directoryPath`</ph> is the directory that contains the application that you want to deploy.","pos":[6005,6235],"source":"Populates the application manifest with descriptions of all assemblies and files found in `directoryPath`, including all subdirectories, where `directoryPath` is the directory that contains the application that you want to deploy."},{"content":"For each file in the directory, Mage.exe decides whether the file is an assembly or a static file.","pos":[6236,6334]},{"content":"If it is an assembly, it adds a <ph id=\"ph1\">`&lt;dependency&gt;`</ph> tag and <ph id=\"ph2\">`installFrom`</ph> attribute to the application with the assembly's name, code base, and version.","pos":[6335,6482],"source":" If it is an assembly, it adds a `<dependency>` tag and `installFrom` attribute to the application with the assembly's name, code base, and version."},{"content":"If it is a static file, it adds a <ph id=\"ph1\">`&lt;file&gt;`</ph> tag.","pos":[6483,6530],"source":" If it is a static file, it adds a `<file>` tag."},{"content":"Mage.exe will also use a simple set of heuristics to detect the main executable for the application, and will mark it as the ClickOnce application's entry point in the manifest.","pos":[6531,6708]},{"content":"Mage.exe will never automatically mark a file as a \"data\" file.","pos":[6721,6784]},{"content":"You must do this manually.","pos":[6785,6811]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Include a Data File in a ClickOnce Application<ept id=\"p1\">](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application)</ept>.","pos":[6812,6975],"source":" For more information, see [How to: Include a Data File in a ClickOnce Application](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application)."},{"content":"Mage.exe also generates a hash for each file based on its size.","pos":[6988,7051]},{"content":"ClickOnce uses these hashes to ensure that no one has tampered with the deployment's files since the manifest was created.","pos":[7052,7174]},{"content":"If any of the files in your deployment change, you can run Mage.exe with the <bpt id=\"p1\">**</bpt>-Update<ept id=\"p1\">**</ept> command and the <bpt id=\"p2\">**</bpt>-FromDirectory<ept id=\"p2\">**</ept> option, and it will update the hashes and assembly versions of all referenced files.","pos":[7175,7383],"source":" If any of the files in your deployment change, you can run Mage.exe with the **-Update** command and the **-FromDirectory** option, and it will update the hashes and assembly versions of all referenced files."},{"content":"<bpt id=\"p1\">**</bpt>-FromDirectory<ept id=\"p1\">**</ept> will include all files in all subdirectories found within <ph id=\"ph1\">`directoryPath`</ph>.","pos":[7396,7489],"source":"**-FromDirectory** will include all files in all subdirectories found within `directoryPath`."},{"content":"If you use <bpt id=\"p1\">**</bpt>-FromDirectory<ept id=\"p1\">**</ept> with the <bpt id=\"p2\">**</bpt>-Update<ept id=\"p2\">**</ept> command, Mage.exe will remove any files in the application manifest that no longer exist in the directory.","pos":[7502,7659],"source":" If you use **-FromDirectory** with the **-Update** command, Mage.exe will remove any files in the application manifest that no longer exist in the directory."},{"pos":[7664,7694],"content":"<bpt id=\"p1\">**</bpt>-if, -IconFile<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`filePath`</ph>","source":"**-if, -IconFile**  `filePath`"},{"content":"Application manifests.","pos":[7696,7718]},{"content":"Specifies the full path to an .ICO icon file.","pos":[7719,7764]},{"content":"This icon appears beside your application name in the start menu, and in its Add-or-Remove Programs entry.","pos":[7765,7871]},{"content":"If no icon is provided, a default icon is used.","pos":[7872,7919]},{"pos":[7924,7959],"content":"<bpt id=\"p1\">**</bpt>-ip, -IncludeProviderURL<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`url`</ph>","source":"**-ip, -IncludeProviderURL**  `url`"},{"content":"true","pos":[7960,7964]},{"content":"Deployment manifests.","pos":[7965,7986]},{"pos":[7987,8088],"content":"Indicates whether the deployment manifest includes the update location value set by <bpt id=\"p1\">**</bpt>-ProviderURL<ept id=\"p1\">**</ept>.","source":"Indicates whether the deployment manifest includes the update location value set by **-ProviderURL**."},{"pos":[8093,8123],"content":"<bpt id=\"p1\">**</bpt>-i, -Install<ept id=\"p1\">**</ept> <ph id=\"ph1\">`willInstall`</ph>","source":"**-i, -Install** `willInstall`"},{"content":"true","pos":[8124,8128]},{"content":"Deployment manifests.","pos":[8129,8150]},{"content":"Indicates whether or not the ClickOnce application should install onto the local computer, or whether it should run from the Web.","pos":[8151,8280]},{"content":"Installing an application gives that application a presence in the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu.","pos":[8281,8371],"source":" Installing an application gives that application a presence in the Windows **Start** menu."},{"content":"Valid values are \"true\" or \"t\", and \"false\" or \"f\".","pos":[8372,8423]},{"content":"If you specify the <bpt id=\"p1\">**</bpt>-MinVersion<ept id=\"p1\">**</ept> option, and a user has a version less than <bpt id=\"p2\">**</bpt>-MinVersion<ept id=\"p2\">**</ept> installed, it will force the application to install, regardless of the value that you pass to <bpt id=\"p3\">**</bpt>-Install<ept id=\"p3\">**</ept>.","pos":[8436,8637],"source":" If you specify the **-MinVersion** option, and a user has a version less than **-MinVersion** installed, it will force the application to install, regardless of the value that you pass to **-Install**."},{"content":"This option cannot be used with the <bpt id=\"p1\">**</bpt>-BrowserHosted<ept id=\"p1\">**</ept> option.","pos":[8650,8712],"source":" This option cannot be used with the **-BrowserHosted** option."},{"content":"Attempting to specify both for the same manifest will result in an error.","pos":[8713,8786]},{"pos":[8791,8824],"content":"<bpt id=\"p1\">**</bpt>-mv, -MinVersion<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`[version]`</ph>","source":"**-mv, -MinVersion**  `[version]`"},{"pos":[8825,8919],"content":"The version listed in the ClickOnce deployment manifest as specified by the <bpt id=\"p1\">**</bpt>-Version<ept id=\"p1\">**</ept> flag.","source":"The version listed in the ClickOnce deployment manifest as specified by the **-Version** flag."},{"content":"Deployment manifests.","pos":[8920,8941]},{"content":"The minimum version of this application a user can run.","pos":[8942,8997]},{"content":"This flag makes the named version of your application a required update.","pos":[8998,9070]},{"content":"If you release a version of your product with an update to a breaking change or a critical security flaw, you can use this flag to specify that this update must be installed, and that the user cannot continue to run earlier versions.","pos":[9071,9304]},{"content":"<ph id=\"ph1\">`version`</ph> has the same semantics as the argument to the <bpt id=\"p1\">**</bpt>-Version<ept id=\"p1\">**</ept> flag.","pos":[9317,9391],"source":"`version` has the same semantics as the argument to the **-Version** flag."},{"pos":[9396,9422],"content":"<bpt id=\"p1\">**</bpt>-n, -Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">`nameString`</ph>","source":"**-n, -Name** `nameString`"},{"content":"Deploy","pos":[9423,9429]},{"content":"All file types.","pos":[9430,9445]},{"content":"The name that is used to identify the application.","pos":[9446,9496]},{"content":"ClickOnce will use this name to identify the application in the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu (if the application is configured to install itself) and in Permission Elevation dialog boxes.","pos":[9497,9670],"source":" ClickOnce will use this name to identify the application in the **Start** menu (if the application is configured to install itself) and in Permission Elevation dialog boxes."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  If you are updating an existing manifest and you do not specify a publisher name with this option, Mage.exe updates the manifest with the organization name defined on the computer.","pos":[9671,9862],"source":"**Note:**  If you are updating an existing manifest and you do not specify a publisher name with this option, Mage.exe updates the manifest with the organization name defined on the computer."},{"content":"To use a different name, make sure to use this option and specify the desired publisher name.","pos":[9863,9956]},{"pos":[9961,9989],"content":"<bpt id=\"p1\">**</bpt>-pwd, -Password<ept id=\"p1\">**</ept> <ph id=\"ph1\">`passwd`</ph>","source":"**-pwd, -Password** `passwd`"},{"content":"All file types.","pos":[9991,10006]},{"content":"The password that is used for signing a manifest with a digital certificate.","pos":[10007,10083]},{"content":"Must be used in conjunction with the <bpt id=\"p1\">**</bpt>-CertFile<ept id=\"p1\">**</ept> option.","pos":[10084,10142],"source":" Must be used in conjunction with the **-CertFile** option."},{"pos":[10147,10181],"content":"<bpt id=\"p1\">**</bpt>-p, Processor<ept id=\"p1\">**</ept> <ph id=\"ph1\">`processorValue`</ph>","source":"**-p, Processor** `processorValue`"},{"content":"Msil","pos":[10182,10186]},{"content":"Application manifests.","pos":[10187,10209]},{"content":"Deployment manifests.","pos":[10222,10243]},{"content":"The microprocessor architecture on which this distribution will run.","pos":[10244,10312]},{"content":"This value is required if you are preparing one or more installations whose assemblies have been precompiled for a specific microprocessor.","pos":[10313,10452]},{"content":"Valid values include <ph id=\"ph1\">`msil`</ph>, <ph id=\"ph2\">`x86`</ph>, <ph id=\"ph3\">`ia64`</ph>, and <ph id=\"ph4\">`amd64`</ph>.","pos":[10453,10509],"source":" Valid values include `msil`, `x86`, `ia64`, and `amd64`."},{"content":"<ph id=\"ph1\">`msil`</ph> is Microsoft intermediate language, which means all of your assemblies are platform-independent, and the common language runtime (CLR) will just-in-time compile them when your application is first run.","pos":[10510,10718],"source":"`msil` is Microsoft intermediate language, which means all of your assemblies are platform-independent, and the common language runtime (CLR) will just-in-time compile them when your application is first run."},{"pos":[10723,10754],"content":"<bpt id=\"p1\">**</bpt>-pu,<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>-ProviderURL<ept id=\"p2\">**</ept> <ph id=\"ph1\">`url`</ph>","source":"**-pu,** **-ProviderURL** `url`"},{"content":"Deployment manifests.","pos":[10756,10777]},{"content":"Specifies the URL which ClickOnce will examine for application updates.","pos":[10778,10849]},{"pos":[10854,10890],"content":"<bpt id=\"p1\">**</bpt>-pub, -Publisher<ept id=\"p1\">**</ept> <ph id=\"ph1\">`publisherName`</ph>","source":"**-pub, -Publisher** `publisherName`"},{"content":"Application manifests.","pos":[10892,10914]},{"content":"Deployment manifests.","pos":[10927,10948]},{"content":"Adds the publisher name to the description element of either the deployment or application manifest.","pos":[10949,11049]},{"content":"When used on an application manifest, <bpt id=\"p1\">**</bpt>-UseManifestForTrust<ept id=\"p1\">**</ept> must also be specified with a value of \"true\" or \"t\"; otherwise, this parameter will raise an error.","pos":[11050,11213],"source":" When used on an application manifest, **-UseManifestForTrust** must also be specified with a value of \"true\" or \"t\"; otherwise, this parameter will raise an error."},{"pos":[11218,11244],"content":"<bpt id=\"p1\">**</bpt>-s, -SupportURL<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`url`</ph>","source":"**-s, -SupportURL**  `url`"},{"content":"Application manifests.","pos":[11246,11268]},{"content":"Deployment manifests.","pos":[11281,11302]},{"content":"Specifies the link that appears in Add or Remove Programs for the ClickOnce application.","pos":[11303,11391]},{"pos":[11396,11424],"content":"<bpt id=\"p1\">**</bpt>-ti, -TimestampUri<ept id=\"p1\">**</ept> <ph id=\"ph1\">`uri`</ph>","source":"**-ti, -TimestampUri** `uri`"},{"content":"Application manifests.","pos":[11426,11448]},{"content":"Deployment manifests.","pos":[11461,11482]},{"content":"The URL of a digital timestamping service.","pos":[11483,11525]},{"content":"Timestamping the manifests prevents you from having to re-sign the manifests should your digital certificate expire before you deploy the next version of your application.","pos":[11526,11697]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows root certificate program members<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=159000)</ept>.","pos":[11698,11814],"source":" For more information, see [Windows root certificate program members](http://go.microsoft.com/fwlink/?LinkId=159000)."},{"pos":[11819,11845],"content":"<bpt id=\"p1\">**</bpt>-t, -ToFile<ept id=\"p1\">**</ept> <ph id=\"ph1\">`filePath`</ph>","source":"**-t, -ToFile** `filePath`"},{"content":"-   New:","pos":[11846,11854]},{"content":"-   Deployment: deploy.application","pos":[11860,11894]},{"content":"-   Application: application.exe.manifest","pos":[11900,11941]},{"content":"-   Update:","pos":[11947,11958]},{"content":"-   The input file.","pos":[11964,11983]},{"content":"All file types.","pos":[11984,11999]},{"content":"Specifies the output path of the file that has been created or modified.","pos":[12000,12072]},{"content":"If <bpt id=\"p1\">**</bpt>-ToFile<ept id=\"p1\">**</ept> is not supplied when you use <bpt id=\"p2\">**</bpt>-New<ept id=\"p2\">**</ept>, the output is written to the current working directory.","pos":[12085,12194],"source":" If **-ToFile** is not supplied when you use **-New**, the output is written to the current working directory."},{"content":"If <bpt id=\"p1\">**</bpt>-ToFile<ept id=\"p1\">**</ept> is not supplied when you use <bpt id=\"p2\">**</bpt>-Update<ept id=\"p2\">**</ept>, Mage.exe will write the file back to the input file.","pos":[12195,12304],"source":" If **-ToFile** is not supplied when you use **-Update**, Mage.exe will write the file back to the input file."},{"pos":[12309,12337],"content":"<bpt id=\"p1\">**</bpt>-tr, -TrustLevel<ept id=\"p1\">**</ept> <ph id=\"ph1\">`level`</ph>","source":"**-tr, -TrustLevel** `level`"},{"content":"Based on the zone in which the application URL resides.","pos":[12338,12393]},{"content":"Application manifests.","pos":[12394,12416]},{"content":"The level of trust to grant the application on client computers.","pos":[12417,12481]},{"content":"Values include \"Internet\", \"Intranet\", and \"FullTrust\".","pos":[12482,12537]},{"pos":[12542,12589],"content":"<bpt id=\"p1\">**</bpt>-um, -UseManifestForTrust<ept id=\"p1\">**</ept> <ph id=\"ph1\">`willUseForTrust`</ph>","source":"**-um, -UseManifestForTrust** `willUseForTrust`"},{"content":"False","pos":[12590,12595]},{"content":"Application manifests.","pos":[12596,12618]},{"content":"Specifies whether the digital signature of the application manifest will be used for making trust decisions when the application runs on the client.","pos":[12619,12767]},{"content":"Specifying \"true\" or \"t\" indicates that the application manifest will be used for trust decisions.","pos":[12768,12866]},{"content":"Specifying \"false\" or \"f\" indicates that the signature of the deployment manifest will be used.","pos":[12867,12962]},{"pos":[12967,12999],"content":"<bpt id=\"p1\">**</bpt>-v, -Version<ept id=\"p1\">**</ept> <ph id=\"ph1\">`versionNumber`</ph>","source":"**-v, -Version** `versionNumber`"},{"content":"1.0.0.0","pos":[13000,13007]},{"content":"Application manifests.","pos":[13008,13030]},{"content":"Deployment manifests.","pos":[13043,13064]},{"content":"The version of the deployment.","pos":[13065,13095]},{"content":"The argument must be a valid version string of the format \"<bpt id=\"p1\">*</bpt>N.N.N.N<ept id=\"p1\">*</ept>\", where \"<bpt id=\"p2\">*</bpt>N<ept id=\"p2\">*</ept>\" is an unsigned 32-bit integer.","pos":[13096,13209],"source":" The argument must be a valid version string of the format \"*N.N.N.N*\", where \"*N*\" is an unsigned 32-bit integer."},{"pos":[13214,13250],"content":"<bpt id=\"p1\">**</bpt>-wpf, -WPFBrowserApp<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`isWPFApp`</ph>","source":"**-wpf, -WPFBrowserApp**  `isWPFApp`"},{"content":"false","pos":[13251,13256]},{"content":"Application manifests.","pos":[13257,13279]},{"content":"Deployment manifests.","pos":[13292,13313]},{"content":"Use this flag only if the application is a Windows Presentation Foundation (WPF) application that will be hosted inside of Internet Explorer, and is not a stand-alone executable.","pos":[13314,13492]},{"content":"Valid values are \"true\" or \"t\", and \"false\" or \"f\".","pos":[13493,13544]},{"content":"For application manifests, inserts the <ph id=\"ph1\">`hostInBrowser`</ph> attribute under the <ph id=\"ph2\">`entryPoint`</ph> element of the application manifest.","pos":[13557,13681],"source":" For application manifests, inserts the `hostInBrowser` attribute under the `entryPoint` element of the application manifest."},{"content":"For deployment manifests, sets the <ph id=\"ph1\">`install`</ph> attribute on the <ph id=\"ph2\">`deployment`</ph> element to false, and saves the deployment manifest with a .xbap extension.","pos":[13694,13844],"source":" For deployment manifests, sets the `install` attribute on the `deployment` element to false, and saves the deployment manifest with a .xbap extension."},{"content":"Specifying this argument along with the <bpt id=\"p1\">**</bpt>-Install<ept id=\"p1\">**</ept> argument produces an error, because a browser-hosted application cannot be an installed, offline application.","pos":[13845,14007],"source":" Specifying this argument along with the **-Install** argument produces an error, because a browser-hosted application cannot be an installed, offline application."},{"pos":[14040,14060],"content":"Sign Command Options","linkify":"Sign Command Options","nodes":[{"content":"Sign Command Options","pos":[0,20]}]},{"pos":[14064,14170],"content":"The following table shows the options supported by the <ph id=\"ph1\">`-Sign`</ph> command, which apply to all types of files.","source":"The following table shows the options supported by the `-Sign` command, which apply to all types of files."},{"content":"Options","pos":[14177,14184]},{"content":"Description","pos":[14185,14196]},{"pos":[14237,14266],"content":"<bpt id=\"p1\">**</bpt>-cf, -CertFile<ept id=\"p1\">**</ept> <ph id=\"ph1\">`filePath`</ph>","source":"**-cf, -CertFile** `filePath`"},{"content":"Specifies The location of a digital certificate for signing a manifest.","pos":[14267,14338]},{"content":"This option can be used in conjunction with the <bpt id=\"p1\">**</bpt>-Password<ept id=\"p1\">**</ept> option.","pos":[14339,14408],"source":" This option can be used in conjunction with the **-Password** option."},{"pos":[14413,14447],"content":"<bpt id=\"p1\">**</bpt>-ch, -CertHash<ept id=\"p1\">**</ept> <ph id=\"ph1\">`hashSignature`</ph>","source":"**-ch, -CertHash** `hashSignature`"},{"content":"The hash of a digital certificate stored in the personal certificate store of the client computer.","pos":[14448,14546]},{"content":"This corresponds to the Thumbprint property of a digital certificate viewed in the Windows Certificates Console.","pos":[14547,14659]},{"content":"<ph id=\"ph1\">`hashSignature`</ph> can be either uppercase or lowercase, and can be supplied either as a single string or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.","pos":[14672,14883],"source":"`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks."},{"pos":[14888,14916],"content":"<bpt id=\"p1\">**</bpt>-pwd, -Password<ept id=\"p1\">**</ept> <ph id=\"ph1\">`passwd`</ph>","source":"**-pwd, -Password** `passwd`"},{"content":"The password that is used for signing a manifest with a digital certificate.","pos":[14917,14993]},{"content":"Must be used in conjunction with the <bpt id=\"p1\">**</bpt>-CertFile<ept id=\"p1\">**</ept> option.","pos":[14994,15052],"source":" Must be used in conjunction with the **-CertFile** option."},{"pos":[15057,15083],"content":"<bpt id=\"p1\">**</bpt>-t, -ToFile<ept id=\"p1\">**</ept> <ph id=\"ph1\">`filePath`</ph>","source":"**-t, -ToFile** `filePath`"},{"content":"Specifies the output path of the file that has been created or modified.","pos":[15084,15156]},{"pos":[15166,15173],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"All arguments to Mage.exe are case-insensitive.","pos":[15177,15224]},{"content":"Commands and options can be prefixed with a dash (-) or a forward slash (/).","pos":[15225,15301]},{"content":"All of the arguments used with the <bpt id=\"p1\">**</bpt>-Sign<ept id=\"p1\">**</ept> command can be used at any time with the <bpt id=\"p2\">**</bpt>-New<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>-Update<ept id=\"p3\">**</ept> commands as well.","pos":[15308,15435],"source":"All of the arguments used with the **-Sign** command can be used at any time with the **-New** or **-Update** commands as well."},{"content":"The following commands are equivalent.","pos":[15436,15474]},{"pos":[15647,15739],"content":"[!NOTE]\n Beginning with .NET Framework version 4.6.2, CNG certificates are also supported.","leadings":["","> "],"nodes":[{"content":"Beginning with .NET Framework version 4.6.2, CNG certificates are also supported.","pos":[9,90]}]},{"content":"Signing is the last task you should perform, because a signed document uses a hash of the file to verify that the signature is valid for the document.","pos":[15746,15896]},{"content":"If you make any changes to a signed file, you must sign it again.","pos":[15897,15962]},{"content":"If you sign a document that was previously signed, Mage.exe will replace the old signature with the new.","pos":[15963,16067]},{"content":"When you use the <bpt id=\"p1\">**</bpt>-AppManifest<ept id=\"p1\">**</ept> option to populate a deployment manifest, Mage.exe will assume that your application manifest will reside in the same directory as the deployment manifest within a subdirectory named after the current deployment version, and will configure your deployment manifest appropriately.","pos":[16074,16387],"source":"When you use the **-AppManifest** option to populate a deployment manifest, Mage.exe will assume that your application manifest will reside in the same directory as the deployment manifest within a subdirectory named after the current deployment version, and will configure your deployment manifest appropriately."},{"content":"If your application manifest will reside elsewhere, use the <bpt id=\"p1\">**</bpt>-AppCodeBase<ept id=\"p1\">**</ept> option to set the alternate location.","pos":[16388,16502],"source":" If your application manifest will reside elsewhere, use the **-AppCodeBase** option to set the alternate location."},{"content":"Your deployment and application manifest must be signed before you deploy your application.","pos":[16509,16600]},{"content":"For guidance about signing manifests, see <bpt id=\"p1\">[</bpt>Trusted Application Deployment Overview<ept id=\"p1\">](/visualstudio/deployment/trusted-application-deployment-overview)</ept>.","pos":[16601,16751],"source":" For guidance about signing manifests, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview)."},{"content":"The <bpt id=\"p1\">**</bpt>-TrustLevel<ept id=\"p1\">**</ept> option for application manifests describes the permission set an application requires to run on the client computer.","pos":[16758,16894],"source":"The **-TrustLevel** option for application manifests describes the permission set an application requires to run on the client computer."},{"content":"By default, applications are assigned a trust level based on the <bpt id=\"p1\">*</bpt>zone<ept id=\"p1\">*</ept> in which their URL resides.","pos":[16895,16994],"source":" By default, applications are assigned a trust level based on the *zone* in which their URL resides."},{"content":"Applications deployed over a corporate network are generally placed in the Intranet zone, while those deployed over the Internet are placed in the Internet zone.","pos":[16995,17156]},{"content":"Both security zones place restrictions on the application's access to local resources, with the Intranet zone slightly more permissive than the Internet zone.","pos":[17157,17315]},{"content":"The FullTrust zone gives applications complete access to a computer's local resources.","pos":[17316,17402]},{"content":"If you use the <bpt id=\"p1\">**</bpt>-TrustLevel<ept id=\"p1\">**</ept> option to place an application in this zone, the Trust Manager component of the CLR will prompt the user to decide whether he or she wants to grant this higher level of trust.","pos":[17403,17609],"source":" If you use the **-TrustLevel** option to place an application in this zone, the Trust Manager component of the CLR will prompt the user to decide whether he or she wants to grant this higher level of trust."},{"content":"If you are deploying your application over a corporate network, you can use Trusted Application Deployment to raise the trust level of the application without prompting the user.","pos":[17610,17788]},{"content":"Application manifests also support custom trust sections.","pos":[17795,17852]},{"content":"This helps your application obey the security principle of requesting least permission, as you can configure the manifest to demand only those specific permissions that the application requires in order to execute.","pos":[17853,18067]},{"content":"Mage.exe does not directly support adding a custom trust section.","pos":[18068,18133]},{"content":"You can add one using a text editor, an XML parser, or the graphical tool MageUI.exe.","pos":[18134,18219]},{"content":"For more information about how to use MageUI.exe to add custom trust sections, see <bpt id=\"p1\">[</bpt>MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)<ept id=\"p1\">](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)</ept>.","pos":[18220,18472],"source":" For more information about how to use MageUI.exe to add custom trust sections, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)."},{"content":"New manifests that are created with version 4 of Mage.exe, which is included with <ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)]</ph>, target the <ph id=\"ph2\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph>.","pos":[18479,18715],"source":"New manifests that are created with version 4 of Mage.exe, which is included with [!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)], target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]."},{"content":"To target earlier versions of the .NET Framework, you must use an earlier version of Mage.exe.","pos":[18716,18810]},{"content":"When adding or removing assemblies from an existing manifest, or re-signing an existing manifest, Mage.exe does not update the manifest to target the <ph id=\"ph1\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph>.","pos":[18811,19038],"source":" When adding or removing assemblies from an existing manifest, or re-signing an existing manifest, Mage.exe does not update the manifest to target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]."},{"content":"The following tables show these features and restrictions.","pos":[19039,19097]},{"content":"Manifest version","pos":[19104,19120]},{"content":"Operation","pos":[19121,19130]},{"content":"Mage v2.0","pos":[19131,19140]},{"content":"Mage v4.0","pos":[19141,19150]},{"content":"Manifest for applications targeting version 2.0 or 3.x of the .NET Framework","pos":[19230,19306]},{"content":"Open","pos":[19307,19311]},{"content":"OK","pos":[19312,19314]},{"content":"OK","pos":[19315,19317]},{"content":"Close","pos":[19323,19328]},{"content":"OK","pos":[19329,19331]},{"content":"OK","pos":[19332,19334]},{"content":"Save","pos":[19340,19344]},{"content":"OK","pos":[19345,19347]},{"content":"OK","pos":[19348,19350]},{"content":"Re-sign","pos":[19356,19363]},{"content":"OK","pos":[19364,19366]},{"content":"OK","pos":[19367,19369]},{"content":"New","pos":[19375,19378]},{"content":"OK","pos":[19379,19381]},{"content":"Not supported","pos":[19382,19395]},{"content":"Update (see below)","pos":[19401,19419]},{"content":"OK","pos":[19420,19422]},{"content":"OK","pos":[19423,19425]},{"content":"Manifest for applications targeting version 4 of the .NET Framework","pos":[19430,19497]},{"content":"Open","pos":[19498,19502]},{"content":"OK","pos":[19503,19505]},{"content":"OK","pos":[19506,19508]},{"content":"Close","pos":[19514,19519]},{"content":"OK","pos":[19520,19522]},{"content":"OK","pos":[19523,19525]},{"content":"Save","pos":[19531,19535]},{"content":"OK","pos":[19536,19538]},{"content":"OK","pos":[19539,19541]},{"content":"Re-sign","pos":[19547,19554]},{"content":"OK","pos":[19555,19557]},{"content":"OK","pos":[19558,19560]},{"content":"New","pos":[19566,19569]},{"content":"Not supported","pos":[19570,19583]},{"content":"OK","pos":[19584,19586]},{"content":"Update (see below)","pos":[19592,19610]},{"content":"Not supported","pos":[19611,19624]},{"content":"OK","pos":[19625,19627]},{"content":"Manifest version","pos":[19635,19651]},{"content":"Update Operation Details","pos":[19652,19676]},{"content":"Mage v2.0","pos":[19677,19686]},{"content":"Mage v4.0","pos":[19687,19696]},{"content":"Manifest for applications targeting version 2.0 or 3.x of the .NET Framework","pos":[19791,19867]},{"content":"Modify an assembly","pos":[19868,19886]},{"content":"OK","pos":[19887,19889]},{"content":"OK","pos":[19890,19892]},{"content":"Add an assembly","pos":[19898,19913]},{"content":"OK","pos":[19914,19916]},{"content":"OK","pos":[19917,19919]},{"content":"Remove an assembly","pos":[19925,19943]},{"content":"OK","pos":[19944,19946]},{"content":"OK","pos":[19947,19949]},{"content":"Manifest for applications targeting version 4 of the .NET Framework","pos":[19954,20021]},{"content":"Modify an assembly","pos":[20022,20040]},{"content":"Not supported","pos":[20041,20054]},{"content":"OK","pos":[20055,20057]},{"content":"Add an assembly","pos":[20063,20078]},{"content":"Not supported","pos":[20079,20092]},{"content":"OK","pos":[20093,20095]},{"content":"Remove an assembly","pos":[20101,20119]},{"content":"Not supported","pos":[20120,20133]},{"content":"OK","pos":[20134,20136]},{"content":"Mage.exe creates new manifests that target the <ph id=\"ph1\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph>.","pos":[20144,20268],"source":"Mage.exe creates new manifests that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]."},{"content":"ClickOnce applications that target the <ph id=\"ph1\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph> can run on both the <ph id=\"ph2\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph> and the full version of the <ph id=\"ph3\">[!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]</ph>.","pos":[20269,20575],"source":" ClickOnce applications that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] can run on both the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] and the full version of the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]."},{"content":"If your application targets the full version of the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]</ph> and cannot run on the <ph id=\"ph2\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph>, remove the client <ph id=\"ph3\">`&lt;framework&gt;`</ph> element by using a text editor and re-sign the manifest.","pos":[20576,20881],"source":" If your application targets the full version of the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] and cannot run on the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)], remove the client `<framework>` element by using a text editor and re-sign the manifest."},{"content":"The following is a sample <ph id=\"ph1\">`&lt;framework&gt;`</ph> element that targets the <ph id=\"ph2\">[!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]</ph>.","pos":[20882,21024],"source":" The following is a sample `<framework>` element that targets the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]."},{"pos":[21130,21138],"content":"Examples","linkify":"Examples","nodes":[{"content":"Examples","pos":[0,8]}]},{"content":"The following example opens the user interface for Mage (MageUI.exe).","pos":[21142,21211]},{"content":"The following examples create a default deployment manifest and application manifest.","pos":[21240,21325]},{"content":"These files are all created in the current working directory and are named deploy.application and application.exe.manifest, respectively.","pos":[21326,21463]},{"content":"The following example creates an application manifest populated with all of the assemblies and resource files from thecurrent directory.","pos":[21532,21668]},{"content":"The following example continues the previous example by specifying the deployment name and target microprocessor.","pos":[21748,21861]},{"content":"It also specifies a URL against which ClickOnce should check for updates.","pos":[21862,21935]},{"content":"The following example demonstrates how to create a pair of manifests for deploying a WPF application that will be hosted in Internet Explorer.","pos":[22113,22255]},{"content":"The following example updates a deployment manifest with information from an application manifest, and sets the code base for the location of the application manifest.","pos":[22440,22607]},{"content":"The following example edits the deployment manifest to force an update of the user's installed version.","pos":[22757,22860]},{"content":"The following example tells the deployment manifest to retrieve the application manifest from another directory.","pos":[22959,23071]},{"content":"The following example signs an existing deployment manifest using a digital certificate in the current working directory.","pos":[23180,23301]},{"pos":[23395,23403],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ClickOnce Security and Deployment<ept id=\"p1\">](/visualstudio/deployment/clickonce-security-and-deployment)</ept><ph id=\"ph1\"> </ph>","pos":[23407,23503],"source":"[ClickOnce Security and Deployment](/visualstudio/deployment/clickonce-security-and-deployment) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Manually Deploying a ClickOnce Application<ept id=\"p1\">](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application)</ept><ph id=\"ph1\"> </ph>","pos":[23506,23646],"source":" [Walkthrough: Manually Deploying a ClickOnce Application](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application) "},{"content":"<bpt id=\"p1\"> [</bpt>Trusted Application Deployment Overview<ept id=\"p1\">](/visualstudio/deployment/trusted-application-deployment-overview)</ept><ph id=\"ph1\"> </ph>","pos":[23649,23758],"source":" [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview) "},{"content":"<bpt id=\"p1\"> [</bpt>MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)<ept id=\"p1\">](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)</ept><ph id=\"ph1\"> </ph>","pos":[23761,23931],"source":" [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Command Prompts<ept id=\"p1\">](../../../docs/framework/tools/developer-command-prompt-for-vs.md)</ept>","pos":[23934,24018],"source":" [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)"}]}