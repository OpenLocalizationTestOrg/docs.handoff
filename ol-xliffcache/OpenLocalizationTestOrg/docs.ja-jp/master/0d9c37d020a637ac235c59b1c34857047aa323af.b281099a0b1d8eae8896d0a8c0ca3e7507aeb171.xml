{"content":"---\ntitle: \"Bulk Copy Example Setup | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: d4dde6ac-b8b6-4593-965a-635c8fb2dadb\ncaps.latest.revision: 5\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Bulk Copy Example Setup\nThe <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables. The code samples shown in this topic use the SQL Server sample database, **AdventureWorks**. To avoid altering the existing tables code samples write data to tables that you must create first.  \n  \n The **BulkCopyDemoMatchingColumns** and **BulkCopyDemoDifferentColumns** tables are both based on the **AdventureWorks** **Production.Products** table. In code samples that use these tables, data is added from the **Production.Products** table to one of these sample tables. The **BulkCopyDemoDifferentColumns** table is used when the sample illustrates how to map columns from the source data to the destination table; **BulkCopyDemoMatchingColumns** is used for most other samples.  \n  \n A few of the code samples demonstrate how to use one <xref:System.Data.SqlClient.SqlBulkCopy> class to write to multiple tables. For these samples, the **BulkCopyDemoOrderHeader** and **BulkCopyDemoOrderDetail** tables are used as the destination tables. These tables are based on the **Sales.SalesOrderHeader** and **Sales.SalesOrderDetail** tables in **AdventureWorks**.  \n  \n> [!NOTE]\n>  The **SqlBulkCopy** code samples are provided to demonstrate the syntax for using **SqlBulkCopy** only. If the source and destination tables are located in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.  \n  \n## Table Setup  \n To create the tables necessary for the code samples to run correctly, you must run the following Transact-SQL statements in a SQL Server database.  \n  \n```  \nUSE AdventureWorks  \n  \nIF EXISTS (SELECT * FROM dbo.sysobjects   \n WHERE id = object_id(N'[dbo].[BulkCopyDemoMatchingColumns]')   \n AND OBJECTPROPERTY(id, N'IsUserTable') = 1)  \n    DROP TABLE [dbo].[BulkCopyDemoMatchingColumns]  \n  \nCREATE TABLE [dbo].[BulkCopyDemoMatchingColumns]([ProductID] [int] IDENTITY(1,1) NOT NULL,  \n    [Name] [nvarchar](50) NOT NULL,  \n    [ProductNumber] [nvarchar](25) NOT NULL,  \n CONSTRAINT [PK_ProductID] PRIMARY KEY CLUSTERED   \n(  \n    [ProductID] ASC  \n) ON [PRIMARY]) ON [PRIMARY]  \n  \nIF EXISTS (SELECT * FROM dbo.sysobjects   \n WHERE id = object_id(N'[dbo].[BulkCopyDemoDifferentColumns]')   \n AND OBJECTPROPERTY(id, N'IsUserTable') = 1)  \n    DROP TABLE [dbo].[BulkCopyDemoDifferentColumns]  \n  \nCREATE TABLE [dbo].[BulkCopyDemoDifferentColumns]([ProdID] [int] IDENTITY(1,1) NOT NULL,  \n    [ProdNum] [nvarchar](25) NOT NULL,  \n    [ProdName] [nvarchar](50) NOT NULL,  \n CONSTRAINT [PK_ProdID] PRIMARY KEY CLUSTERED   \n(  \n    [ProdID] ASC  \n) ON [PRIMARY]) ON [PRIMARY]  \n  \nIF EXISTS (SELECT * FROM dbo.sysobjects   \n WHERE id = object_id(N'[dbo].[BulkCopyDemoOrderHeader]')   \n AND OBJECTPROPERTY(id, N'IsUserTable') = 1)  \n    DROP TABLE [dbo].[BulkCopyDemoOrderHeader]  \n  \nCREATE TABLE [dbo].[BulkCopyDemoOrderHeader]([SalesOrderID] [int] IDENTITY(1,1) NOT NULL,  \n    [OrderDate] [datetime] NOT NULL,  \n    [AccountNumber] [nvarchar](15) NULL,  \n CONSTRAINT [PK_SalesOrderID] PRIMARY KEY CLUSTERED   \n(  \n    [SalesOrderID] ASC  \n) ON [PRIMARY]) ON [PRIMARY]  \n  \nIF EXISTS (SELECT * FROM dbo.sysobjects   \n WHERE id = object_id(N'[dbo].[BulkCopyDemoOrderDetail]')   \n AND OBJECTPROPERTY(id, N'IsUserTable') = 1)  \n    DROP TABLE [dbo].[BulkCopyDemoOrderDetail]  \n  \nCREATE TABLE [dbo].[BulkCopyDemoOrderDetail]([SalesOrderID] [int] NOT NULL,  \n    [SalesOrderDetailID] [int] NOT NULL,  \n    [OrderQty] [smallint] NOT NULL,  \n    [ProductID] [int] NOT NULL,  \n    [UnitPrice] [money] NOT NULL,  \n CONSTRAINT [PK_LineNumber] PRIMARY KEY CLUSTERED   \n(  \n    [SalesOrderID] ASC,  \n    [SalesOrderDetailID] ASC  \n) ON [PRIMARY]) ON [PRIMARY]  \n```  \n  \n## See Also  \n [Bulk Copy Operations in SQL Server](../../../../../docs/framework/data/adonet/sql/bulk-copy-operations-in-sql-server.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[12,52],"content":"Bulk Copy Example Setup | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Bulk Copy Example Setup | Microsoft Docs","pos":[0,40]}]},{"pos":[361,384],"content":"Bulk Copy Example Setup","linkify":"Bulk Copy Example Setup","nodes":[{"content":"Bulk Copy Example Setup","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlBulkCopy&gt;</ph> class can be used to write data only to SQL Server tables.","pos":[385,488],"source":"The <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables."},{"content":"The code samples shown in this topic use the SQL Server sample database, <bpt id=\"p1\">**</bpt>AdventureWorks<ept id=\"p1\">**</ept>.","pos":[489,581],"source":" The code samples shown in this topic use the SQL Server sample database, **AdventureWorks**."},{"content":"To avoid altering the existing tables code samples write data to tables that you must create first.","pos":[582,681]},{"content":"The <bpt id=\"p1\">**</bpt>BulkCopyDemoMatchingColumns<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>BulkCopyDemoDifferentColumns<ept id=\"p2\">**</ept> tables are both based on the <bpt id=\"p3\">**</bpt>AdventureWorks<ept id=\"p3\">**</ept> <bpt id=\"p4\">**</bpt>Production.Products<ept id=\"p4\">**</ept> table.","pos":[688,839],"source":"The **BulkCopyDemoMatchingColumns** and **BulkCopyDemoDifferentColumns** tables are both based on the **AdventureWorks** **Production.Products** table."},{"content":"In code samples that use these tables, data is added from the <bpt id=\"p1\">**</bpt>Production.Products<ept id=\"p1\">**</ept> table to one of these sample tables.","pos":[840,962],"source":" In code samples that use these tables, data is added from the **Production.Products** table to one of these sample tables."},{"content":"The <bpt id=\"p1\">**</bpt>BulkCopyDemoDifferentColumns<ept id=\"p1\">**</ept> table is used when the sample illustrates how to map columns from the source data to the destination table; <bpt id=\"p2\">**</bpt>BulkCopyDemoMatchingColumns<ept id=\"p2\">**</ept> is used for most other samples.","pos":[963,1171],"source":" The **BulkCopyDemoDifferentColumns** table is used when the sample illustrates how to map columns from the source data to the destination table; **BulkCopyDemoMatchingColumns** is used for most other samples."},{"content":"A few of the code samples demonstrate how to use one <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlBulkCopy&gt;</ph> class to write to multiple tables.","pos":[1178,1306],"source":"A few of the code samples demonstrate how to use one <xref:System.Data.SqlClient.SqlBulkCopy> class to write to multiple tables."},{"content":"For these samples, the <bpt id=\"p1\">**</bpt>BulkCopyDemoOrderHeader<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>BulkCopyDemoOrderDetail<ept id=\"p2\">**</ept> tables are used as the destination tables.","pos":[1307,1432],"source":" For these samples, the **BulkCopyDemoOrderHeader** and **BulkCopyDemoOrderDetail** tables are used as the destination tables."},{"content":"These tables are based on the <bpt id=\"p1\">**</bpt>Sales.SalesOrderHeader<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Sales.SalesOrderDetail<ept id=\"p2\">**</ept> tables in <bpt id=\"p3\">**</bpt>AdventureWorks<ept id=\"p3\">**</ept>.","pos":[1433,1550],"source":" These tables are based on the **Sales.SalesOrderHeader** and **Sales.SalesOrderDetail** tables in **AdventureWorks**."},{"pos":[1558,1846],"content":"[!NOTE]\n The **SqlBulkCopy** code samples are provided to demonstrate the syntax for using **SqlBulkCopy** only. If the source and destination tables are located in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.","leadings":["","> "],"nodes":[{"content":" The **SqlBulkCopy** code samples are provided to demonstrate the syntax for using **SqlBulkCopy** only. If the source and destination tables are located in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.","pos":[8,286],"nodes":[{"content":"The <bpt id=\"p1\">**</bpt>SqlBulkCopy<ept id=\"p1\">**</ept> code samples are provided to demonstrate the syntax for using <bpt id=\"p2\">**</bpt>SqlBulkCopy<ept id=\"p2\">**</ept> only.","pos":[1,104],"source":" The **SqlBulkCopy** code samples are provided to demonstrate the syntax for using **SqlBulkCopy** only."},{"content":"If the source and destination tables are located in the same SQL Server instance, it is easier and faster to use a Transact-SQL <ph id=\"ph1\">`INSERT … SELECT`</ph> statement to copy the data.","pos":[105,278],"source":" If the source and destination tables are located in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data."}]}]},{"pos":[1855,1866],"content":"Table Setup","linkify":"Table Setup","nodes":[{"content":"Table Setup","pos":[0,11]}]},{"content":"To create the tables necessary for the code samples to run correctly, you must run the following Transact-SQL statements in a SQL Server database.","pos":[1870,2016]},{"pos":[4130,4138],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Bulk Copy Operations in SQL Server<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/bulk-copy-operations-in-sql-server.md)</ept><ph id=\"ph1\"> </ph>","pos":[4142,4264],"source":"[Bulk Copy Operations in SQL Server](../../../../../docs/framework/data/adonet/sql/bulk-copy-operations-in-sql-server.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[4267,4371],"source":" [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}