{"content":"---\ntitle: \"Use of TransactedReceiveScope | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: d455f1dc-bfc5-43d6-8ae9-bc3b3a3ea08a\ncaps.latest.revision: 10\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Use of TransactedReceiveScope\nThis sample shows how to flow a transaction from a client to a server using <xref:System.Activities.Statements.TransactionScope> to create a new transaction on the client and a <xref:System.ServiceModel.Activities.TransactedReceiveScope> to receive a message with a flowed transaction and scope the lifetime of the transaction on the server. The sample consists of two projects that fill the roles of client and server.  \n  \n## Client Application  \n The client application runs a workflow that prints the distributed transaction ID, sends a message to the server, flows the transaction, receives the reply, prints the distributed transaction ID again and completes. When the distributed transaction ID is initially prints, it is an empty GUID as the transaction is still only local.  \n  \n## Server Application  \n The server project is similar, however, the workflow is hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> because it must listen on an endpoint for the message from the client. The workflow is centered on the <xref:System.ServiceModel.Activities.TransactedReceiveScope>, which receives the flowed transaction from the client, prints the message that was sent, prints the distributed transaction ID and sends the reply to the client. The distributed transaction ID is now a non-empty GUID and if a transaction-aware activity was added to the body of the <xref:System.ServiceModel.Activities.TransactedReceiveScope>, it would execute under the flowed transaction.  \n  \n#### To run the sample  \n  \n1.  Open the TransactedReceiveScope.sln solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].  \n  \n2.  To build the solution, press CTRL+SHIFT+B or select **Build Solution** from the **Build** menu.  \n  \n3.  Once the build has succeeded, right-click the solution and select **Set Startup Projects**. From the dialog, select **Multiple Startup Projects** and ensure the action for both projects is **Start**.  \n  \n4.  Press F5 or select **Start Debugging** from the **Debug** menu. Alternatively, you can press CTRL+F5 or select **Start Without Debugging** from the **Debug** menu to run without debugging.  \n  \n    > [!NOTE]\n    >  The server must be running prior to starting the client. The output from the console window hosting the service indicates when it has started.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Transactions\\TransactedReceiveScope`  \n  \n## See Also","nodes":[{"pos":[12,58],"content":"Use of TransactedReceiveScope | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Use of TransactedReceiveScope | Microsoft Docs","pos":[0,46]}]},{"pos":[324,353],"content":"Use of TransactedReceiveScope","linkify":"Use of TransactedReceiveScope","nodes":[{"content":"Use of TransactedReceiveScope","pos":[0,29]}]},{"content":"This sample shows how to flow a transaction from a client to a server using <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> to create a new transaction on the client and a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.TransactedReceiveScope&gt;</ph> to receive a message with a flowed transaction and scope the lifetime of the transaction on the server.","pos":[354,695],"source":"This sample shows how to flow a transaction from a client to a server using <xref:System.Activities.Statements.TransactionScope> to create a new transaction on the client and a <xref:System.ServiceModel.Activities.TransactedReceiveScope> to receive a message with a flowed transaction and scope the lifetime of the transaction on the server."},{"content":"The sample consists of two projects that fill the roles of client and server.","pos":[696,773]},{"pos":[782,800],"content":"Client Application","linkify":"Client Application","nodes":[{"content":"Client Application","pos":[0,18]}]},{"content":"The client application runs a workflow that prints the distributed transaction ID, sends a message to the server, flows the transaction, receives the reply, prints the distributed transaction ID again and completes.","pos":[804,1019]},{"content":"When the distributed transaction ID is initially prints, it is an empty GUID as the transaction is still only local.","pos":[1020,1136]},{"pos":[1145,1163],"content":"Server Application","linkify":"Server Application","nodes":[{"content":"Server Application","pos":[0,18]}]},{"content":"The server project is similar, however, the workflow is hosted in <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> because it must listen on an endpoint for the message from the client.","pos":[1167,1361],"source":"The server project is similar, however, the workflow is hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> because it must listen on an endpoint for the message from the client."},{"content":"The workflow is centered on the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.TransactedReceiveScope&gt;</ph>, which receives the flowed transaction from the client, prints the message that was sent, prints the distributed transaction ID and sends the reply to the client.","pos":[1362,1617],"source":" The workflow is centered on the <xref:System.ServiceModel.Activities.TransactedReceiveScope>, which receives the flowed transaction from the client, prints the message that was sent, prints the distributed transaction ID and sends the reply to the client."},{"content":"The distributed transaction ID is now a non-empty GUID and if a transaction-aware activity was added to the body of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.TransactedReceiveScope&gt;</ph>, it would execute under the flowed transaction.","pos":[1618,1846],"source":" The distributed transaction ID is now a non-empty GUID and if a transaction-aware activity was added to the body of the <xref:System.ServiceModel.Activities.TransactedReceiveScope>, it would execute under the flowed transaction."},{"pos":[1857,1874],"content":"To run the sample","linkify":"To run the sample","nodes":[{"content":"To run the sample","pos":[0,17]}]},{"pos":[1884,1986],"content":"Open the TransactedReceiveScope.sln solution in <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>.","source":"Open the TransactedReceiveScope.sln solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]."},{"pos":[1996,2091],"content":"To build the solution, press CTRL+SHIFT+B or select <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","source":"To build the solution, press CTRL+SHIFT+B or select **Build Solution** from the **Build** menu."},{"content":"Once the build has succeeded, right-click the solution and select <bpt id=\"p1\">**</bpt>Set Startup Projects<ept id=\"p1\">**</ept>.","pos":[2101,2192],"source":"Once the build has succeeded, right-click the solution and select **Set Startup Projects**."},{"content":"From the dialog, select <bpt id=\"p1\">**</bpt>Multiple Startup Projects<ept id=\"p1\">**</ept> and ensure the action for both projects is <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept>.","pos":[2193,2300],"source":" From the dialog, select **Multiple Startup Projects** and ensure the action for both projects is **Start**."},{"content":"Press F5 or select <bpt id=\"p1\">**</bpt>Start Debugging<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu.","pos":[2310,2373],"source":"Press F5 or select **Start Debugging** from the **Debug** menu."},{"content":"Alternatively, you can press CTRL+F5 or select <bpt id=\"p1\">**</bpt>Start Without Debugging<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu to run without debugging.","pos":[2374,2498],"source":" Alternatively, you can press CTRL+F5 or select **Start Without Debugging** from the **Debug** menu to run without debugging."},{"pos":[2510,2667],"content":"[!NOTE]\nThe server must be running prior to starting the client. The output from the console window hosting the service indicates when it has started.","leadings":["","    >  "],"nodes":[{"content":"The server must be running prior to starting the client. The output from the console window hosting the service indicates when it has started.","pos":[8,150],"nodes":[{"content":"The server must be running prior to starting the client.","pos":[0,56]},{"content":"The output from the console window hosting the service indicates when it has started.","pos":[57,142]}]}]},{"pos":[2675,2807],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[2861,3187],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3188,3238]},{"pos":[3335,3343],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}