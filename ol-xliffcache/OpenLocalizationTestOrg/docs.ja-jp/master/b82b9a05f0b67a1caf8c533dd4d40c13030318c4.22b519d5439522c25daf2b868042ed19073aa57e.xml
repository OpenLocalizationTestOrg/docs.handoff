{"content":"---\ntitle: \"Pipeline Development | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"add-in pipeline [.NET Framework], segments\"\n  - \"activation path for add-ins [.NET Framework]\"\n  - \"add-in pipeline [.NET Framework], activation path\"\n  - \"communication pipeline for add-ins [.NET Framework]\"\n  - \"add-in pipeline [.NET Framework], about\"\n  - \"add-ins [.NET Framework], pipeline development\"\nms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722\ncaps.latest.revision: 31\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Pipeline Development\nThe add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.  \n  \n The following illustration shows the communication pipeline and its segments.  \n  \n ![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png \"AddIn1\")  \nAdd-in pipeline  \n  \n The host application is at one end of the pipeline and the add-in is at the other end. Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share. These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment. The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.  \n  \n The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment. The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface. This contract defines the methods that the host application and its add-in will both use.  \n  \n If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in. The contract is the only assembly that is loaded in both the host and add-in application domains. The host and the add-in each refer only to their view of the contract methods. Therefore, they are separated by a layer of abstraction from the contract.  \n  \n To develop pipeline segments, you must create a directory structure that will contain them. For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/en-us/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  \n  \n The following illustration shows the types that make up the pipeline segments. The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.  \n  \n ![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png \"AddIn_Model\")  \nAdd-in pipeline with types  \n  \n The following table describes the pipeline segments for activating an add-in. For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/en-us/a6460173-9507-4b87-8c07-d4ee245d715c).  \n  \n|Pipeline segment|Description|  \n|----------------------|-----------------|  \n|Host|The application assembly that creates an instance of an add-in.|  \n|Host view of the add-in|Represents the host application's view of the object types and methods used to communicate with the add-in. The host view is an abstract base class or interface.|  \n|Host-side adapter|An assembly with one or more classes that adapts methods to and from the contract.<br /><br /> This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.<br /><br /> Multi-module assemblies are not supported.|  \n|Contract|An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.<br /><br /> This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.|  \n|Add-in-side adapter|An assembly with one or more classes that adapts methods to and from the contract.<br /><br /> This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.<br /><br /> Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.<br /><br /> Each assembly in the add-in-side directory is loaded in its own application domain.<br /><br /> Multi-module assemblies are not supported|  \n|Add-in view|An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host. The add-in view is an abstract base class or interface.<br /><br /> This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.<br /><br /> Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.|  \n|Add-in|An instantiated type that performs a service for the host.|  \n  \n## Pipeline Activation Path  \n The following illustration shows the activation of types when an add-in is activated. It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects. This is the most typical scenario.  \n  \n ![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png \"AddIn6\")  \nActivation path from the add-in to the host  \n  \n The activation path of the pipeline occurs as follows:  \n  \n1.  The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.  \n  \n2.  The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.  \n  \n3.  An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor. The add-in-side adapter inherits from the contract.  \n  \n4.  The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.  \n  \n5.  The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.  \n  \n6.  An instance of the host-side adapter is created using the contract as its constructor. The host-side adapter inherits from the host view of the add-in.  \n  \n7.  The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.  \n  \n## Walkthroughs  \n There are three walkthrough topics that describe how to create pipelines using Visual Studio:  \n  \n-   [Walkthrough: Creating an Extensible Application](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  \n  \n     Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.  \n  \n-   [Walkthrough: Enabling Backward Compatibility as Your Host Changes](http://msdn.microsoft.com/en-us/6fa15bb5-8f04-407d-bd7d-675dc043c848)  \n  \n     Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.  \n  \n-   [Walkthrough: Passing Collections Between Hosts and Add-Ins](http://msdn.microsoft.com/en-us/b532c604-548e-4fab-b11c-377257dd0ee5)  \n  \n     Describes how to pass data collections over the pipeline using a book store scenario.  \n  \n## See Also  \n [Add-in Pipeline Scenarios](http://msdn.microsoft.com/en-us/feb70e0b-8734-494c-aeaf-b567f014043e)   \n [Add-ins and Extensibility](../../../docs/framework/add-ins/index.md)","nodes":[{"pos":[12,49],"content":"Pipeline Development | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Pipeline Development | Microsoft Docs","pos":[0,37]}]},{"pos":[688,708],"content":"Pipeline Development","linkify":"Pipeline Development","nodes":[{"content":"Pipeline Development","pos":[0,20]}]},{"content":"The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.","pos":[709,843]},{"content":"The following illustration shows the communication pipeline and its segments.","pos":[850,927]},{"content":"<bpt id=\"p1\">![</bpt>Add&amp;#45;in pipeline model.<ept id=\"p1\">](../../../docs/framework/add-ins/media/addin1.png \"AddIn1\")</ept>","pos":[934,1022],"source":"![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png \"AddIn1\")"},{"content":"Add-in pipeline","pos":[1025,1040]},{"content":"The host application is at one end of the pipeline and the add-in is at the other end.","pos":[1047,1133]},{"content":"Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.","pos":[1134,1317]},{"content":"These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.","pos":[1318,1430]},{"content":"The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.","pos":[1431,1580]},{"content":"The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.","pos":[1587,1768]},{"content":"The central segment of the pipeline is a contract that is derived from the <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.IContract&gt;</ph> interface.","pos":[1769,1893],"source":" The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface."},{"content":"This contract defines the methods that the host application and its add-in will both use.","pos":[1894,1983]},{"content":"If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.","pos":[1990,2170]},{"content":"The contract is the only assembly that is loaded in both the host and add-in application domains.","pos":[2171,2268]},{"content":"The host and the add-in each refer only to their view of the contract methods.","pos":[2269,2347]},{"content":"Therefore, they are separated by a layer of abstraction from the contract.","pos":[2348,2422]},{"content":"To develop pipeline segments, you must create a directory structure that will contain them.","pos":[2429,2520]},{"content":"For more information about development requirements and scope guidelines, see <bpt id=\"p1\">[</bpt>Pipeline Development Requirements<ept id=\"p1\">](http://msdn.microsoft.com/en-us/ef9fa986-e80b-43e1-868b-247f4c1d9da5)</ept>.","pos":[2521,2705],"source":" For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/en-us/ef9fa986-e80b-43e1-868b-247f4c1d9da5)."},{"content":"The following illustration shows the types that make up the pipeline segments.","pos":[2712,2790]},{"content":"The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.","pos":[2791,3013]},{"content":"<bpt id=\"p1\">![</bpt>Add&amp;#45;in model with required attributes on types.<ept id=\"p1\">](../../../docs/framework/add-ins/media/addin-model.png \"AddIn_Model\")</ept>","pos":[3020,3143],"source":"![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png \"AddIn_Model\")"},{"content":"Add-in pipeline with types","pos":[3146,3172]},{"content":"The following table describes the pipeline segments for activating an add-in.","pos":[3179,3256]},{"content":"For more information about these segments, see <bpt id=\"p1\">[</bpt>Contracts, Views, and Adapters<ept id=\"p1\">](http://msdn.microsoft.com/en-us/a6460173-9507-4b87-8c07-d4ee245d715c)</ept>.","pos":[3257,3407],"source":" For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/en-us/a6460173-9507-4b87-8c07-d4ee245d715c)."},{"content":"Pipeline segment","pos":[3414,3430]},{"content":"Description","pos":[3431,3442]},{"content":"Host","pos":[3492,3496]},{"content":"The application assembly that creates an instance of an add-in.","pos":[3497,3560]},{"content":"Host view of the add-in","pos":[3565,3588]},{"content":"Represents the host application's view of the object types and methods used to communicate with the add-in.","pos":[3589,3696]},{"content":"The host view is an abstract base class or interface.","pos":[3697,3750]},{"content":"Host-side adapter","pos":[3755,3772]},{"content":"An assembly with one or more classes that adapts methods to and from the contract.","pos":[3773,3855]},{"content":"This pipeline segment is identified by using the <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.HostAdapterAttribute&gt;</ph> attribute.","pos":[3868,3977],"source":"This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute."},{"content":"Multi-module assemblies are not supported.","pos":[3990,4032]},{"content":"Contract","pos":[4037,4045]},{"content":"An interface that is derived from the <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.IContract&gt;</ph> interface and that defines the protocol for communicating types between the host and its add-in.","pos":[4046,4219],"source":"An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in."},{"content":"This pipeline segment is identified by setting the <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInContractAttribute&gt;</ph> attribute.","pos":[4232,4345],"source":"This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute."},{"content":"Add-in-side adapter","pos":[4350,4369]},{"content":"An assembly with one or more classes that adapts methods to and from the contract.","pos":[4370,4452]},{"content":"This pipeline segment is identified by using the <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInAdapterAttribute&gt;</ph> attribute.","pos":[4465,4575],"source":"This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute."},{"content":"Each assembly in the add-in-side adapter directory that contains a type that has an <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInAdapterAttribute&gt;</ph> attribute is loaded into the add-in's application domain.","pos":[4588,4780],"source":"Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain."},{"content":"Each assembly in the add-in-side directory is loaded in its own application domain.","pos":[4793,4876]},{"content":"Multi-module assemblies are not supported","pos":[4889,4930]},{"content":"Add-in view","pos":[4935,4946]},{"content":"An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.","pos":[4947,5068]},{"content":"The add-in view is an abstract base class or interface.","pos":[5069,5124]},{"content":"This pipeline segment is identified by using the <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInBaseAttribute&gt;</ph> attribute.","pos":[5137,5244],"source":"This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute."},{"content":"Each assembly in the AddInViews directory that contains a type that has an <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInBaseAttribute&gt;</ph> attribute is loaded into the add-in's application domain.","pos":[5257,5437],"source":"Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain."},{"content":"Add-in","pos":[5442,5448]},{"content":"An instantiated type that performs a service for the host.","pos":[5449,5507]},{"pos":[5517,5541],"content":"Pipeline Activation Path","linkify":"Pipeline Activation Path","nodes":[{"content":"Pipeline Activation Path","pos":[0,24]}]},{"content":"The following illustration shows the activation of types when an add-in is activated.","pos":[5545,5630]},{"content":"It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.","pos":[5631,5745]},{"content":"This is the most typical scenario.","pos":[5746,5780]},{"content":"<bpt id=\"p1\">![</bpt>Add&amp;#45;in model with activation path.<ept id=\"p1\">](../../../docs/framework/add-ins/media/addin6.png \"AddIn6\")</ept>","pos":[5787,5887],"source":"![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png \"AddIn6\")"},{"content":"Activation path from the add-in to the host","pos":[5890,5933]},{"content":"The activation path of the pipeline occurs as follows:","pos":[5940,5994]},{"content":"The host application activates the add-in with the <ph id=\"ph1\">&lt;xref:System.AddIn.Hosting.AddInToken.Activate%2A&gt;</ph> method.","pos":[6004,6113],"source":"The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method."},{"content":"The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.","pos":[6123,6245]},{"content":"An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.AddInBaseAttribute&gt;</ph> attribute) as its constructor.","pos":[6255,6439],"source":"An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor."},{"content":"The add-in-side adapter inherits from the contract.","pos":[6440,6491]},{"content":"The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.","pos":[6501,6648]},{"content":"The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.","pos":[6658,6780]},{"content":"An instance of the host-side adapter is created using the contract as its constructor.","pos":[6790,6876]},{"content":"The host-side adapter inherits from the host view of the add-in.","pos":[6877,6941]},{"content":"The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.","pos":[6951,7060]},{"pos":[7069,7081],"content":"Walkthroughs","linkify":"Walkthroughs","nodes":[{"content":"Walkthroughs","pos":[0,12]}]},{"content":"There are three walkthrough topics that describe how to create pipelines using Visual Studio:","pos":[7085,7178]},{"pos":[7188,7307],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Creating an Extensible Application<ept id=\"p1\">](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)</ept>","source":"[Walkthrough: Creating an Extensible Application](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)"},{"content":"Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.","pos":[7318,7439]},{"pos":[7449,7586],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Enabling Backward Compatibility as Your Host Changes<ept id=\"p1\">](http://msdn.microsoft.com/en-us/6fa15bb5-8f04-407d-bd7d-675dc043c848)</ept>","source":"[Walkthrough: Enabling Backward Compatibility as Your Host Changes](http://msdn.microsoft.com/en-us/6fa15bb5-8f04-407d-bd7d-675dc043c848)"},{"content":"Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.","pos":[7597,7734]},{"pos":[7744,7874],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Passing Collections Between Hosts and Add-Ins<ept id=\"p1\">](http://msdn.microsoft.com/en-us/b532c604-548e-4fab-b11c-377257dd0ee5)</ept>","source":"[Walkthrough: Passing Collections Between Hosts and Add-Ins](http://msdn.microsoft.com/en-us/b532c604-548e-4fab-b11c-377257dd0ee5)"},{"content":"Describes how to pass data collections over the pipeline using a book store scenario.","pos":[7885,7970]},{"pos":[7979,7987],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Add-in Pipeline Scenarios<ept id=\"p1\">](http://msdn.microsoft.com/en-us/feb70e0b-8734-494c-aeaf-b567f014043e)</ept><ph id=\"ph1\"> </ph>","pos":[7991,8089],"source":"[Add-in Pipeline Scenarios](http://msdn.microsoft.com/en-us/feb70e0b-8734-494c-aeaf-b567f014043e) "},{"content":"<bpt id=\"p1\"> [</bpt>Add-ins and Extensibility<ept id=\"p1\">](../../../docs/framework/add-ins/index.md)</ept>","pos":[8092,8162],"source":" [Add-ins and Extensibility](../../../docs/framework/add-ins/index.md)"}]}