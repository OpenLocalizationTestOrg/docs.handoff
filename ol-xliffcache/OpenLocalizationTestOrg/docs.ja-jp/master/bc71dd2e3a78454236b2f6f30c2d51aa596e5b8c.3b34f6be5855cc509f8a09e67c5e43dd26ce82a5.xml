{"content":"---\ntitle: \"How to: Read a Value from a Registry Key in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry keys [Visual Basic], determining if a value exists in\"\n  - \"My.Computer.Registry object, examples\"\n  - \"registry [Visual Basic], determining if values exist\"\n  - \"registry keys [Visual Basic], reading from\"\n  - \"registry [Visual Basic], reading\"\nms.assetid: 775d0a57-68c9-464e-8949-9a39bd29cc64\n---\n# How to: Read a Value from a Registry Key in Visual Basic\nThe `GetValue` method of the `My.Computer.Registry` object can be used to read values in the Windows registry.  \n  \n If the key, \"Software\\MyApp\" in the following example, does not exist, an exception is thrown. If the `ValueName`,  \"Name\" in the following example, does not exist, `Nothing` is returned.  \n  \n The `GetValue` method can also be used to determine whether a given value exists in a specific registry key.  \n  \n When code reads the registry from a Web application, the current user is determined by the authentication and impersonation that is implemented in the Web application.  \n  \n### To read a value from a registry key  \n  \n-   Use the `GetValue` method, specifying the path and name) to read a value from registry key. The following example reads the value `Name` from `HKEY_CURRENT_USER\\Software\\MyApp` and displays it in a message box.  \n  \n     [!code-vb[VbResourceTasks#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#4)]  \n  \n This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **Windows Operating System > Registry**. For more information, see [Code Snippets](/visualstudio/ide/code-snippets).  \n  \n### To determine whether a value exists in a registry key  \n  \n-   Use the `GetValue` method to retrieve the value. The following code checks whether the value exists and returns a message if it does not.  \n  \n     [!code-vb[VbResourceTasks#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#12)]  \n  \n## Robust Programming  \n The registry holds top-level, or root, keys that are used to store data. For instance, the HKEY_LOCAL_MACHINE root key is used for storing machine-level settings used by all users, while HKEY_CURRENT_USER is used for storing data specific to an individual user.  \n  \n The following conditions may cause an exception:  \n  \n-   The name of the key is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The user does not have permissions to read from registry keys (<xref:System.Security.SecurityException>).  \n  \n-   The key name exceeds the 255-character limit (<xref:System.ArgumentException>).  \n  \n## .NET Framework Security  \n To run this process, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.RegistryPermission> class. If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges. Similarly, the user must have the correct ACLs for creating or writing to settings. For example, a local application that has the code access security permission might not have operating system permission. For more information, see [Code Access Security Basics](../../../../framework/misc/code-access-security-basics.md).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.MyServices.RegistryProxy>\n- <xref:Microsoft.Win32.RegistryHive>\n- [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)\n","nodes":[{"pos":[4,420],"embed":true,"restype":"x-metadata","content":"title: \"How to: Read a Value from a Registry Key in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry keys [Visual Basic], determining if a value exists in\"\n  - \"My.Computer.Registry object, examples\"\n  - \"registry [Visual Basic], determining if values exist\"\n  - \"registry keys [Visual Basic], reading from\"\n  - \"registry [Visual Basic], reading\"\nms.assetid: 775d0a57-68c9-464e-8949-9a39bd29cc64","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic","nodes":[{"pos":[0,56],"content":"How to: Read a Value from a Registry Key in Visual Basic","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic","pos":[0,56]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[427,483],"content":"How to: Read a Value from a Registry Key in Visual Basic","linkify":"How to: Read a Value from a Registry Key in Visual Basic","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic","pos":[0,56]}]},{"pos":[484,594],"content":"The <ph id=\"ph1\">`GetValue`</ph> method of the <ph id=\"ph2\">`My.Computer.Registry`</ph> object can be used to read values in the Windows registry.","source":"The `GetValue` method of the `My.Computer.Registry` object can be used to read values in the Windows registry."},{"content":"If the key, \"Software\\MyApp\" in the following example, does not exist, an exception is thrown.","pos":[601,695]},{"content":"If the <ph id=\"ph1\">`ValueName`</ph>,  \"Name\" in the following example, does not exist, <ph id=\"ph2\">`Nothing`</ph> is returned.","pos":[696,788],"source":" If the `ValueName`,  \"Name\" in the following example, does not exist, `Nothing` is returned."},{"pos":[795,903],"content":"The <ph id=\"ph1\">`GetValue`</ph> method can also be used to determine whether a given value exists in a specific registry key.","source":"The `GetValue` method can also be used to determine whether a given value exists in a specific registry key."},{"content":"When code reads the registry from a Web application, the current user is determined by the authentication and impersonation that is implemented in the Web application.","pos":[910,1077]},{"pos":[1087,1122],"content":"To read a value from a registry key","linkify":"To read a value from a registry key","nodes":[{"content":"To read a value from a registry key","pos":[0,35]}]},{"content":"Use the <ph id=\"ph1\">`GetValue`</ph> method, specifying the path and name) to read a value from registry key.","pos":[1132,1223],"source":"Use the `GetValue` method, specifying the path and name) to read a value from registry key."},{"content":"The following example reads the value <ph id=\"ph1\">`Name`</ph> from <ph id=\"ph2\">`HKEY_CURRENT_USER\\Software\\MyApp`</ph> and displays it in a message box.","pos":[1224,1342],"source":" The following example reads the value `Name` from `HKEY_CURRENT_USER\\Software\\MyApp` and displays it in a message box."},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[1473,1541]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>Windows Operating System &gt; Registry<ept id=\"p1\">**</ept>.","pos":[1542,1627],"source":" In the code snippet picker, it is located in **Windows Operating System > Registry**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](/visualstudio/ide/code-snippets)</ept>.","pos":[1628,1703],"source":" For more information, see [Code Snippets](/visualstudio/ide/code-snippets)."},{"pos":[1713,1766],"content":"To determine whether a value exists in a registry key","linkify":"To determine whether a value exists in a registry key","nodes":[{"content":"To determine whether a value exists in a registry key","pos":[0,53]}]},{"content":"Use the <ph id=\"ph1\">`GetValue`</ph> method to retrieve the value.","pos":[1776,1824],"source":"Use the `GetValue` method to retrieve the value."},{"content":"The following code checks whether the value exists and returns a message if it does not.","pos":[1825,1913]},{"pos":[2048,2066],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The registry holds top-level, or root, keys that are used to store data.","pos":[2070,2142]},{"content":"For instance, the HKEY_LOCAL_MACHINE root key is used for storing machine-level settings used by all users, while HKEY_CURRENT_USER is used for storing data specific to an individual user.","pos":[2143,2331]},{"content":"The following conditions may cause an exception:","pos":[2338,2386]},{"pos":[2396,2467],"content":"The name of the key is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The name of the key is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[2477,2582],"content":"The user does not have permissions to read from registry keys (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user does not have permissions to read from registry keys (<xref:System.Security.SecurityException>)."},{"pos":[2592,2671],"content":"The key name exceeds the 255-character limit (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The key name exceeds the 255-character limit (<xref:System.ArgumentException>)."},{"pos":[2680,2703],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"To run this process, your assembly requires a privilege level granted by the <ph id=\"ph1\">&lt;xref:System.Security.Permissions.RegistryPermission&gt;</ph> class.","pos":[2707,2844],"source":"To run this process, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.RegistryPermission> class."},{"content":"If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges.","pos":[2845,2960]},{"content":"Similarly, the user must have the correct ACLs for creating or writing to settings.","pos":[2961,3044]},{"content":"For example, a local application that has the code access security permission might not have operating system permission.","pos":[3045,3166]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../../../framework/misc/code-access-security-basics.md)</ept>.","pos":[3167,3282],"source":" For more information, see [Code Access Security Basics](../../../../framework/misc/code-access-security-basics.md)."},{"pos":[3291,3299],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3397,3556],"content":"<bpt id=\"p1\">[</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept>","source":"[Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)"}]}