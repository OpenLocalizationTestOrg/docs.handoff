{"content":"---\ntitle: \"Implementing IEnumerable in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"control flow [Visual Basic]\"\n  - \"enumerable interfaces\"\n  - \"loop structures, optimizing performance\"\n  - \"control flow\"\nms.assetid: c60d7589-51f2-4463-a2d5-22506bbc1554\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Implementing IEnumerable(Of T) in Visual Basic\nThe <xref:System.Collections.Generic.IEnumerable%601> interface is implemented by classes that can return a sequence of values one item at a time. The advantage of returning data one item at a time is that you do not have to load the complete set of data into memory to work with it. You only have to use sufficient memory to load a single item from the data. Classes that implement the `IEnumerable(T)` interface can be used with `For Each` loops or LINQ queries.  \n  \n For example, consider an application that must read a large text file and return each line from the file that matches particular search criteria. The application uses a LINQ query to return lines from the file that match the specified criteria. To query the contents of the file by using a LINQ query, the application could load the contents of the file into an array or a collection. However, loading the whole file into an array or collection would consume far more memory than is required. The LINQ query could instead query the file contents by using an enumerable class, returning only values that match the search criteria. Queries that return only a few matching values would consume far less memory.  \n  \n You can create a class that implements the <xref:System.Collections.Generic.IEnumerable%601> interface to expose source data as enumerable data. Your class that implements the `IEnumerable(T)` interface will require another class that implements the <xref:System.Collections.Generic.IEnumerator%601> interface to iterate through the source data. These two classes enable you to return items of data sequentially as a specific type.  \n  \n In this walkthrough, you will create a class that implements the `IEnumerable(Of String)` interface and a class that implements the `IEnumerator(Of String)` interface to read a text file one line at a time.  \n  \n[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  \n  \n## Creating the Enumerable Class  \n  \n|To create the enumerable class project|  \n|---|  \n|1.  In [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], on the **File** menu, point to **New** and then click **Project**.<br />2.  In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Class Library** in the **Templates** pane. In the **Name** box, type `StreamReaderEnumerable`, and then click **OK**. The new project is displayed.<br />3.  In **Solution Explorer**, right-click the Class1.vb file and click **Rename**. Rename the file to `StreamReaderEnumerable.vb` and press ENTER. Renaming the file will also rename the class to `StreamReaderEnumerable`. This class will implement the `IEnumerable(Of String)` interface.<br />4.  Right-click the StreamReaderEnumerable project, point to **Add**, and then click **New Item**. Select the **Class** template. In the **Name** box, type `StreamReaderEnumerator.vb` and click **OK**.|  \n  \n The first class in this project is the enumerable class and will implement the `IEnumerable(Of String)` interface. This generic interface implements the <xref:System.Collections.IEnumerable> interface and guarantees that consumers of this class can access values typed as `String`.  \n  \n|To add the code to implement IEnumerable|  \n|---|  \n|1.  Open the StreamReaderEnumerable.vb file.<br />2.  On the line after `Public Class StreamReaderEnumerable`, type the following and press ENTER.<br />     [!code-vb[VbVbalrIteratorWalkthrough#1](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_1.vb)]<br />     [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] automatically populates the class with the members that are required by the `IEnumerable(Of String)` interface.<br />3.  This enumerable class will read lines from a text file one line at a time. Add the following code to the class to expose a public constructor that takes a file path as an input parameter.<br />     [!code-vb[VbVbalrIteratorWalkthrough#2](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_2.vb)]<br />4.  Your implementation of the <xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A> method of the `IEnumerable(Of String)` interface will return a new instance of the `StreamReaderEnumerator` class. The implementation of the `GetEnumerator` method of the `IEnumerable` interface can be made `Private`, because you have to expose only members of the `IEnumerable(Of String)` interface. Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `GetEnumerator` methods with the following code.<br />     [!code-vb[VbVbalrIteratorWalkthrough#3](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_3.vb)]|  \n  \n|To add the code to implement IEnumerator|  \n|---|  \n|1.  Open the StreamReaderEnumerator.vb file.<br />2.  On the line after `Public Class StreamReaderEnumerator`, type the following and press ENTER.<br />     [!code-vb[VbVbalrIteratorWalkthrough#4](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_4.vb)]<br />     [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] automatically populates the class with the members that are required by the `IEnumerator(Of String)` interface.<br />3.  The enumerator class opens the text file and performs the file I/O to read the lines from the file. Add the following code to the class to expose a public constructor that takes a file path as an input parameter and open the text file for reading.<br />     [!code-vb[VbVbalrIteratorWalkthrough#5](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_5.vb)]<br />4.  The `Current` properties for both the `IEnumerator(Of String)` and `IEnumerator` interfaces return the current item from the text file as a `String`. The implementation of the `Current` property of the `IEnumerator` interface can be made `Private`, because you have to expose only members of the `IEnumerator(Of String)` interface. Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Current` properties with the following code.<br />     [!code-vb[VbVbalrIteratorWalkthrough#6](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_6.vb)]<br />5.  The `MoveNext` method of the `IEnumerator` interface navigates to the next item in the text file and updates the value that is returned by the `Current` property. If there are no more items to read, the `MoveNext` method returns `False`; otherwise the `MoveNext` method returns `True`. Add the following code to the `MoveNext` method.<br />     [!code-vb[VbVbalrIteratorWalkthrough#7](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_7.vb)]<br />6.  The `Reset` method of the `IEnumerator` interface directs the iterator to point to the start of the text file and clears the current item value. Add the following code to the `Reset` method.<br />     [!code-vb[VbVbalrIteratorWalkthrough#8](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_8.vb)]<br />7.  The `Dispose` method of the `IEnumerator` interface guarantees that all unmanaged resources are released before the iterator is destroyed. The file handle that is used by the `StreamReader` object is an unmanaged resource and must be closed before the iterator instance is destroyed. Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Dispose` method with the following code.<br />     [!code-vb[VbVbalrIteratorWalkthrough#9](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_9.vb)]|  \n  \n## Using the Sample Iterator  \n You can use an enumerable class in your code together with control structures that require an object that implements `IEnumerable`, such as a `For Next` loop or a LINQ query. The following example shows the `StreamReaderEnumerable` in a LINQ query.  \n  \n [!code-vb[VbVbalrIteratorWalkthrough#10](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_10.vb)]  \n  \n## See Also  \n [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)   \n [Control Flow](../../../../visual-basic/programming-guide/language-features/control-flow/index.md)   \n [Loop Structures](../../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)   \n [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)\n","nodes":[{"pos":[4,684],"nodes":[{"content":"Implementing IEnumerable in Visual Basic | Microsoft Docs","nodes":[{"pos":[0,57],"content":"Implementing IEnumerable in Visual Basic | Microsoft Docs","nodes":[{"content":"Implementing IEnumerable in Visual Basic | Microsoft Docs","pos":[0,57]}]}],"pos":[6,66],"yaml":true}],"content":"title: \"Implementing IEnumerable in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"control flow [Visual Basic]\"\n  - \"enumerable interfaces\"\n  - \"loop structures, optimizing performance\"\n  - \"control flow\"\nms.assetid: c60d7589-51f2-4463-a2d5-22506bbc1554\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[691,750],"content":"Walkthrough: Implementing IEnumerable(Of T) in Visual Basic","linkify":"Walkthrough: Implementing IEnumerable(Of T) in Visual Basic","nodes":[{"content":"Walkthrough: Implementing IEnumerable(Of T) in Visual Basic","pos":[0,59]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface is implemented by classes that can return a sequence of values one item at a time.","pos":[751,897],"source":"The <xref:System.Collections.Generic.IEnumerable%601> interface is implemented by classes that can return a sequence of values one item at a time."},{"content":"The advantage of returning data one item at a time is that you do not have to load the complete set of data into memory to work with it.","pos":[898,1034]},{"content":"You only have to use sufficient memory to load a single item from the data.","pos":[1035,1110]},{"content":"Classes that implement the <ph id=\"ph1\">`IEnumerable(T)`</ph> interface can be used with <ph id=\"ph2\">`For Each`</ph> loops or LINQ queries.","pos":[1111,1215],"source":" Classes that implement the `IEnumerable(T)` interface can be used with `For Each` loops or LINQ queries."},{"content":"For example, consider an application that must read a large text file and return each line from the file that matches particular search criteria.","pos":[1222,1367]},{"content":"The application uses a LINQ query to return lines from the file that match the specified criteria.","pos":[1368,1466]},{"content":"To query the contents of the file by using a LINQ query, the application could load the contents of the file into an array or a collection.","pos":[1467,1606]},{"content":"However, loading the whole file into an array or collection would consume far more memory than is required.","pos":[1607,1714]},{"content":"The LINQ query could instead query the file contents by using an enumerable class, returning only values that match the search criteria.","pos":[1715,1851]},{"content":"Queries that return only a few matching values would consume far less memory.","pos":[1852,1929]},{"content":"You can create a class that implements the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface to expose source data as enumerable data.","pos":[1936,2080],"source":"You can create a class that implements the <xref:System.Collections.Generic.IEnumerable%601> interface to expose source data as enumerable data."},{"content":"Your class that implements the <ph id=\"ph1\">`IEnumerable(T)`</ph> interface will require another class that implements the <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerator%601&gt;</ph> interface to iterate through the source data.","pos":[2081,2281],"source":" Your class that implements the `IEnumerable(T)` interface will require another class that implements the <xref:System.Collections.Generic.IEnumerator%601> interface to iterate through the source data."},{"content":"These two classes enable you to return items of data sequentially as a specific type.","pos":[2282,2367]},{"pos":[2374,2580],"content":"In this walkthrough, you will create a class that implements the <ph id=\"ph1\">`IEnumerable(Of String)`</ph> interface and a class that implements the <ph id=\"ph2\">`IEnumerator(Of String)`</ph> interface to read a text file one line at a time.","source":"In this walkthrough, you will create a class that implements the `IEnumerable(Of String)` interface and a class that implements the `IEnumerator(Of String)` interface to read a text file one line at a time."},{"pos":[2722,2751],"content":"Creating the Enumerable Class","linkify":"Creating the Enumerable Class","nodes":[{"content":"Creating the Enumerable Class","pos":[0,29]}]},{"content":"To create the enumerable class project","pos":[2758,2796]},{"content":"1.  In <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[2809,2976],"source":"1.  In [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], on the **File** menu, point to **New** and then click **Project**."},{"content":"2.  In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[2982,3091],"source":"2.  In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Class Library<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[3092,3143],"source":" Select **Class Library** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`StreamReaderEnumerable`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[3144,3218],"source":" In the **Name** box, type `StreamReaderEnumerable`, and then click **OK**."},{"content":"The new project is displayed.","pos":[3219,3248]},{"content":"3.  In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the Class1.vb file and click <bpt id=\"p2\">**</bpt>Rename<ept id=\"p2\">**</ept>.","pos":[3254,3336],"source":"3.  In **Solution Explorer**, right-click the Class1.vb file and click **Rename**."},{"content":"Rename the file to <ph id=\"ph1\">`StreamReaderEnumerable.vb`</ph> and press ENTER.","pos":[3337,3400],"source":" Rename the file to `StreamReaderEnumerable.vb` and press ENTER."},{"content":"Renaming the file will also rename the class to <ph id=\"ph1\">`StreamReaderEnumerable`</ph>.","pos":[3401,3474],"source":" Renaming the file will also rename the class to `StreamReaderEnumerable`."},{"content":"This class will implement the <ph id=\"ph1\">`IEnumerable(Of String)`</ph> interface.","pos":[3475,3540],"source":" This class will implement the `IEnumerable(Of String)` interface."},{"content":"4.  Right-click the StreamReaderEnumerable project, point to <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New Item<ept id=\"p2\">**</ept>.","pos":[3546,3644],"source":"4.  Right-click the StreamReaderEnumerable project, point to **Add**, and then click **New Item**."},{"content":"Select the <bpt id=\"p1\">**</bpt>Class<ept id=\"p1\">**</ept> template.","pos":[3645,3675],"source":" Select the **Class** template."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`StreamReaderEnumerator.vb`</ph> and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[3676,3747],"source":" In the **Name** box, type `StreamReaderEnumerator.vb` and click **OK**."},{"content":"The first class in this project is the enumerable class and will implement the <ph id=\"ph1\">`IEnumerable(Of String)`</ph> interface.","pos":[3755,3869],"source":"The first class in this project is the enumerable class and will implement the `IEnumerable(Of String)` interface."},{"content":"This generic interface implements the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface and guarantees that consumers of this class can access values typed as <ph id=\"ph2\">`String`</ph>.","pos":[3870,4036],"source":" This generic interface implements the <xref:System.Collections.IEnumerable> interface and guarantees that consumers of this class can access values typed as `String`."},{"content":"To add the code to implement IEnumerable","pos":[4043,4083]},{"content":"1.  Open the StreamReaderEnumerable.vb file.","pos":[4096,4140]},{"content":"2.  On the line after <ph id=\"ph1\">`Public Class StreamReaderEnumerable`</ph>, type the following and press ENTER.","pos":[4146,4242],"source":"2.  On the line after `Public Class StreamReaderEnumerable`, type the following and press ENTER."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#1<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_1.vb)</ept><ept id=\"p1\">]</ept>","pos":[4253,4439],"source":"[!code-vb[VbVbalrIteratorWalkthrough#1](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_1.vb)]"},{"content":"<ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> automatically populates the class with the members that are required by the <ph id=\"ph2\">`IEnumerable(Of String)`</ph> interface.","pos":[4450,4654],"source":"[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] automatically populates the class with the members that are required by the `IEnumerable(Of String)` interface."},{"content":"3.  This enumerable class will read lines from a text file one line at a time.","pos":[4660,4738]},{"content":"Add the following code to the class to expose a public constructor that takes a file path as an input parameter.","pos":[4739,4851]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#2<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_2.vb)</ept><ept id=\"p1\">]</ept>","pos":[4862,5048],"source":"[!code-vb[VbVbalrIteratorWalkthrough#2](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_2.vb)]"},{"content":"4.  Your implementation of the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A&gt;</ph> method of the <ph id=\"ph2\">`IEnumerable(Of String)`</ph> interface will return a new instance of the <ph id=\"ph3\">`StreamReaderEnumerator`</ph> class.","pos":[5054,5266],"source":"4.  Your implementation of the <xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A> method of the `IEnumerable(Of String)` interface will return a new instance of the `StreamReaderEnumerator` class."},{"content":"The implementation of the <ph id=\"ph1\">`GetEnumerator`</ph> method of the <ph id=\"ph2\">`IEnumerable`</ph> interface can be made <ph id=\"ph3\">`Private`</ph>, because you have to expose only members of the <ph id=\"ph4\">`IEnumerable(Of String)`</ph> interface.","pos":[5267,5452],"source":" The implementation of the `GetEnumerator` method of the `IEnumerable` interface can be made `Private`, because you have to expose only members of the `IEnumerable(Of String)` interface."},{"content":"Replace the code that <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> generated for the <ph id=\"ph2\">`GetEnumerator`</ph> methods with the following code.","pos":[5453,5634],"source":" Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `GetEnumerator` methods with the following code."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#3<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_3.vb)</ept><ept id=\"p1\">]</ept>","pos":[5645,5831],"source":"[!code-vb[VbVbalrIteratorWalkthrough#3](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_3.vb)]"},{"content":"To add the code to implement IEnumerator","pos":[5839,5879]},{"content":"1.  Open the StreamReaderEnumerator.vb file.","pos":[5892,5936]},{"content":"2.  On the line after <ph id=\"ph1\">`Public Class StreamReaderEnumerator`</ph>, type the following and press ENTER.","pos":[5942,6038],"source":"2.  On the line after `Public Class StreamReaderEnumerator`, type the following and press ENTER."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#4<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_4.vb)</ept><ept id=\"p1\">]</ept>","pos":[6049,6235],"source":"[!code-vb[VbVbalrIteratorWalkthrough#4](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_4.vb)]"},{"content":"<ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> automatically populates the class with the members that are required by the <ph id=\"ph2\">`IEnumerator(Of String)`</ph> interface.","pos":[6246,6450],"source":"[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] automatically populates the class with the members that are required by the `IEnumerator(Of String)` interface."},{"content":"3.  The enumerator class opens the text file and performs the file I/O to read the lines from the file.","pos":[6456,6559]},{"content":"Add the following code to the class to expose a public constructor that takes a file path as an input parameter and open the text file for reading.","pos":[6560,6707]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#5<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_5.vb)</ept><ept id=\"p1\">]</ept>","pos":[6718,6904],"source":"[!code-vb[VbVbalrIteratorWalkthrough#5](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_5.vb)]"},{"content":"4.  The <ph id=\"ph1\">`Current`</ph> properties for both the <ph id=\"ph2\">`IEnumerator(Of String)`</ph> and <ph id=\"ph3\">`IEnumerator`</ph> interfaces return the current item from the text file as a <ph id=\"ph4\">`String`</ph>.","pos":[6910,7063],"source":"4.  The `Current` properties for both the `IEnumerator(Of String)` and `IEnumerator` interfaces return the current item from the text file as a `String`."},{"content":"The implementation of the <ph id=\"ph1\">`Current`</ph> property of the <ph id=\"ph2\">`IEnumerator`</ph> interface can be made <ph id=\"ph3\">`Private`</ph>, because you have to expose only members of the <ph id=\"ph4\">`IEnumerator(Of String)`</ph> interface.","pos":[7064,7245],"source":" The implementation of the `Current` property of the `IEnumerator` interface can be made `Private`, because you have to expose only members of the `IEnumerator(Of String)` interface."},{"content":"Replace the code that <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> generated for the <ph id=\"ph2\">`Current`</ph> properties with the following code.","pos":[7246,7424],"source":" Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Current` properties with the following code."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#6<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_6.vb)</ept><ept id=\"p1\">]</ept>","pos":[7435,7621],"source":"[!code-vb[VbVbalrIteratorWalkthrough#6](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_6.vb)]"},{"content":"5.  The <ph id=\"ph1\">`MoveNext`</ph> method of the <ph id=\"ph2\">`IEnumerator`</ph> interface navigates to the next item in the text file and updates the value that is returned by the <ph id=\"ph3\">`Current`</ph> property.","pos":[7627,7793],"source":"5.  The `MoveNext` method of the `IEnumerator` interface navigates to the next item in the text file and updates the value that is returned by the `Current` property."},{"content":"If there are no more items to read, the <ph id=\"ph1\">`MoveNext`</ph> method returns <ph id=\"ph2\">`False`</ph>; otherwise the <ph id=\"ph3\">`MoveNext`</ph> method returns <ph id=\"ph4\">`True`</ph>.","pos":[7794,7916],"source":" If there are no more items to read, the `MoveNext` method returns `False`; otherwise the `MoveNext` method returns `True`."},{"content":"Add the following code to the <ph id=\"ph1\">`MoveNext`</ph> method.","pos":[7917,7965],"source":" Add the following code to the `MoveNext` method."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#7<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_7.vb)</ept><ept id=\"p1\">]</ept>","pos":[7976,8162],"source":"[!code-vb[VbVbalrIteratorWalkthrough#7](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_7.vb)]"},{"content":"6.  The <ph id=\"ph1\">`Reset`</ph> method of the <ph id=\"ph2\">`IEnumerator`</ph> interface directs the iterator to point to the start of the text file and clears the current item value.","pos":[8168,8316],"source":"6.  The `Reset` method of the `IEnumerator` interface directs the iterator to point to the start of the text file and clears the current item value."},{"content":"Add the following code to the <ph id=\"ph1\">`Reset`</ph> method.","pos":[8317,8362],"source":" Add the following code to the `Reset` method."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#8<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_8.vb)</ept><ept id=\"p1\">]</ept>","pos":[8373,8559],"source":"[!code-vb[VbVbalrIteratorWalkthrough#8](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_8.vb)]"},{"content":"7.  The <ph id=\"ph1\">`Dispose`</ph> method of the <ph id=\"ph2\">`IEnumerator`</ph> interface guarantees that all unmanaged resources are released before the iterator is destroyed.","pos":[8565,8707],"source":"7.  The `Dispose` method of the `IEnumerator` interface guarantees that all unmanaged resources are released before the iterator is destroyed."},{"content":"The file handle that is used by the <ph id=\"ph1\">`StreamReader`</ph> object is an unmanaged resource and must be closed before the iterator instance is destroyed.","pos":[8708,8852],"source":" The file handle that is used by the `StreamReader` object is an unmanaged resource and must be closed before the iterator instance is destroyed."},{"content":"Replace the code that <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> generated for the <ph id=\"ph2\">`Dispose`</ph> method with the following code.","pos":[8853,9027],"source":" Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Dispose` method with the following code."},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#9<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_9.vb)</ept><ept id=\"p1\">]</ept>","pos":[9038,9224],"source":"[!code-vb[VbVbalrIteratorWalkthrough#9](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_9.vb)]"},{"pos":[9234,9259],"content":"Using the Sample Iterator","linkify":"Using the Sample Iterator","nodes":[{"content":"Using the Sample Iterator","pos":[0,25]}]},{"content":"You can use an enumerable class in your code together with control structures that require an object that implements <ph id=\"ph1\">`IEnumerable`</ph>, such as a <ph id=\"ph2\">`For Next`</ph> loop or a LINQ query.","pos":[9263,9437],"source":"You can use an enumerable class in your code together with control structures that require an object that implements `IEnumerable`, such as a `For Next` loop or a LINQ query."},{"content":"The following example shows the <ph id=\"ph1\">`StreamReaderEnumerable`</ph> in a LINQ query.","pos":[9438,9511],"source":" The following example shows the `StreamReaderEnumerable` in a LINQ query."},{"pos":[9518,9706],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrIteratorWalkthrough#10<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_10.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrIteratorWalkthrough#10](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_10.vb)]"},{"pos":[9715,9723],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[9727,9857],"source":"[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>Control Flow<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/control-flow/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[9861,9960],"source":"[Control Flow](../../../../visual-basic/programming-guide/language-features/control-flow/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Loop Structures<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)</ept><ph id=\"ph1\"> </ph>","pos":[9964,10076],"source":"[Loop Structures](../../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md) "},{"content":"<bpt id=\"p1\">[</bpt>For Each...Next Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)</ept>","pos":[10080,10190],"source":"[For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)"}]}