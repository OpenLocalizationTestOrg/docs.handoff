{"content":"---\ntitle: \"The Regular Expression Object Model\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"searching with regular expressions, backreferences\"\n  - \"Regex class\"\n  - \"Match class\"\n  - \"pattern-matching with regular expressions, backreferences\"\n  - \".NET Framework regular expressions, classes\"\n  - \"CaptureCollection class\"\n  - \"Group class\"\n  - \"characters [.NET Framework], backreferences\"\n  - \"substrings\"\n  - \".NET Framework regular expressions, backreferences\"\n  - \"searching with regular expressions, classes\"\n  - \"backreferences\"\n  - \"Capture class\"\n  - \"repeating groups of characters\"\n  - \"MatchCollection class\"\n  - \"parsing text with regular expressions, backreferences\"\n  - \"regular expressions [.NET Framework]\"\n  - \"characters [.NET Framework], regular expressions\"\n  - \"classes [.NET Framework], regular expression\"\n  - \"regular expressions [.NET Framework], classes\"\n  - \"characters [.NET Framework], metacharacters\"\n  - \"metacharacters, regular expression classes\"\n  - \"metacharacters, backreferences\"\n  - \"parsing text with regular expressions, classes\"\n  - \"regular expressions [.NET Framework], backreferences\"\n  - \"strings [.NET Framework], regular expressions\"\n  - \"pattern-matching with regular expressions, classes\"\n  - \"GroupCollection class\"\nms.assetid: 49a21470-64ca-4b5a-a889-8e24e3c0af7e\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# The Regular Expression Object Model\n<a name=\"introduction\"></a> This topic describes the object model used in working with .NET regular expressions. It contains the following sections:  \n  \n-   [The Regular Expression Engine](#Engine)  \n  \n-   [The MatchCollection and Match Objects](#Match_and_MCollection)  \n  \n-   [The Group Collection](#GroupCollection)  \n  \n-   [The Captured Group](#the_captured_group)  \n  \n-   [The Capture Collection](#CaptureCollection)  \n  \n-   [The Individual Capture](#the_individual_capture)  \n  \n<a name=\"Engine\"></a>   \n## The Regular Expression Engine  \n The regular expression engine in .NET is represented by the <xref:System.Text.RegularExpressions.Regex> class. The regular expression engine is responsible for parsing and compiling a regular expression, and for performing operations that match the regular expression pattern with an input string. The engine is the central component in the .NET regular expression object model.  \n  \n You can use the regular expression engine in either of two ways:  \n  \n-   By calling the static methods of the <xref:System.Text.RegularExpressions.Regex> class. The method parameters include the input string and the regular expression pattern. The regular expression engine caches regular expressions that are used in static method calls, so repeated calls to static regular expression methods that use the same regular expression offer relatively good performance.  \n  \n-   By instantiating a <xref:System.Text.RegularExpressions.Regex> object, by passing a regular expression to the class constructor. In this case, the <xref:System.Text.RegularExpressions.Regex> object is immutable (read-only) and represents a regular expression engine that is tightly coupled with a single regular expression. Because regular expressions used by <xref:System.Text.RegularExpressions.Regex> instances are not cached, you should not instantiate a <xref:System.Text.RegularExpressions.Regex> object multiple times with the same regular expression.  \n  \n You can call the methods of the <xref:System.Text.RegularExpressions.Regex> class to perform the following operations:  \n  \n-   Determine whether a string matches a regular expression pattern.  \n  \n-   Extract a single match or the first match.  \n  \n-   Extract all matches.  \n  \n-   Replace a matched substring.  \n  \n-   Split a single string into an array of strings.  \n  \n These operations are described in the following sections.  \n  \n### Matching a Regular Expression Pattern  \n The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> method returns `true` if the string matches the pattern, or `false` if it does not. The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is often used to validate string input. For example, the following code ensures that a string matches a valid social security number in the United States.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/validate1.cs#1)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/validate1.vb#1)]  \n  \n The regular expression pattern `^\\d{3}-\\d{2}-\\d{4}$` is interpreted as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`^`|Match the beginning of the input string.|  \n|`\\d{3}`|Match three decimal digits.|  \n|`-`|Match a hyphen.|  \n|`\\d{2}`|Match two decimal digits.|  \n|`-`|Match a hyphen.|  \n|`\\d{4}`|Match four decimal digits.|  \n|`$`|Match the end of the input string.|  \n  \n### Extracting a Single Match or the First Match  \n The <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.Match> object that contains information about the first substring that matches a regular expression pattern. If the `Match.Success` property returns `true`, indicating that a match was found, you can retrieve information about subsequent matches by calling the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method. These method calls can continue until the `Match.Success` property returns `false`. For example, the following code uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> method to find the first occurrence of a duplicated word in a string. It then calls the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method to find any additional occurrences. The example examines the `Match.Success` property after each method call to determine whether the current match was successful and whether a call to the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method should follow.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match1.cs#2)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match1.vb#2)]  \n  \n The regular expression pattern `\\b(\\w+)\\W+(\\1)\\b` is interpreted as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\b`|Begin the match on a word boundary.|  \n|`(\\w+)`|Match one or more word characters. This is the first capturing group.|  \n|`\\W+`|Match one or more non-word characters.|  \n|`(\\1)`|Match the first captured string. This is the second capturing group.|  \n|`\\b`|End the match on a word boundary.|  \n  \n### Extracting All Matches  \n The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains information about all matches that the regular expression engine found in the input string. For example, the previous example could be rewritten to call the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method instead of the <xref:System.Text.RegularExpressions.Regex.Match%2A> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A> methods.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matches1.cs#3)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matches1.vb#3)]  \n  \n### Replacing a Matched Substring  \n The <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces each substring that matches the regular expression pattern with a specified string or regular expression pattern, and returns the entire input string with replacements. For example, the following code adds a U.S. currency symbol before a decimal number in a string.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/replace1.cs#4)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/replace1.vb#4)]  \n  \n The regular expression pattern `\\b\\d+\\.\\d{2}\\b` is interpreted as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\b`|Begin the match at a word boundary.|  \n|`\\d+`|Match one or more decimal digits.|  \n|`\\.`|Match a period.|  \n|`\\d{2}`|Match two decimal digits.|  \n|`\\b`|End the match at a word boundary.|  \n  \n The replacement pattern `$$$&` is interpreted as shown in the following table.  \n  \n|Pattern|Replacement string|  \n|-------------|------------------------|  \n|`$$`|The dollar sign ($) character.|  \n|`$&`|The entire matched substring.|  \n  \n### Splitting a Single String into an Array of Strings  \n The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> method splits the input string at the positions defined by a regular expression match. For example, the following code places the items in a numbered list into a string array.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/split1.cs#5)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/split1.vb#5)]  \n  \n The regular expression pattern `\\b\\d{1,2}\\.\\s` is interpreted as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\b`|Begin the match at a word boundary.|  \n|`\\d{1,2}`|Match one or two decimal digits.|  \n|`\\.`|Match a period.|  \n|`\\s`|Match a white-space character.|  \n  \n<a name=\"Match_and_MCollection\"></a>   \n## The MatchCollection and Match Objects  \n Regex methods return two objects that are part of the regular expression object model: the <xref:System.Text.RegularExpressions.MatchCollection> object, and the <xref:System.Text.RegularExpressions.Match> object.  \n  \n<a name=\"the_match_collection\"></a>   \n### The Match Collection  \n The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains <xref:System.Text.RegularExpressions.Match> objects that represent all the matches that the regular expression engine found, in the order in which they occur in the input string. If there are no matches, the method returns a <xref:System.Text.RegularExpressions.MatchCollection> object with no members. The <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property lets you access individual members of the collection by index, from zero to one less than the value of the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property. <xref:System.Text.RegularExpressions.MatchCollection.Item%2A> is the collection's indexer (in C#) and default property (in Visual Basic).  \n  \n By default, the call to the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method uses lazy evaluation to populate the <xref:System.Text.RegularExpressions.MatchCollection> object. Access to properties that require a fully populated collection, such as the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> properties, may involve a performance penalty. As a result, we recommend that you access the collection by using the <xref:System.Collections.IEnumerator> object that is returned by the <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType> method. Individual languages provide constructs, such as `For Each` in Visual Basic and `foreach` in C#, that wrap the collection's <xref:System.Collections.IEnumerator> interface.  \n  \n The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method to populate a <xref:System.Text.RegularExpressions.MatchCollection> object with all the matches found in an input string. The example enumerates the collection, copies the matches to a string array, and records the character positions in an integer array.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matchcollection1.cs#6)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matchcollection1.vb#6)]  \n  \n<a name=\"the_match\"></a>   \n### The Match  \n The <xref:System.Text.RegularExpressions.Match> class represents the result of a single regular expression match. You can access <xref:System.Text.RegularExpressions.Match> objects in two ways:  \n  \n-   By retrieving them from the <xref:System.Text.RegularExpressions.MatchCollection> object that is returned by the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method. To retrieve individual <xref:System.Text.RegularExpressions.Match> objects, iterate the collection by using a `foreach` (in C#) or `For Each`...`Next` (in Visual Basic) construct, or use the <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific <xref:System.Text.RegularExpressions.Match> object either by index or by name. You can also retrieve individual <xref:System.Text.RegularExpressions.Match> objects from the collection by iterating the collection by index, from zero to one less that the number of objects in the collection. However, this method does not take advantage of lazy evaluation, because it accesses the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property.  \n  \n     The following example retrieves individual <xref:System.Text.RegularExpressions.Match> objects from a <xref:System.Text.RegularExpressions.MatchCollection> object by iterating the collection using the `foreach` or `For Each`...`Next` construct. The regular expression simply matches the string \"abc\" in the input string.  \n  \n     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match2.cs#7)]\n     [!code-vb[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match2.vb#7)]  \n  \n-   By calling the <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method, which returns a <xref:System.Text.RegularExpressions.Match> object that represents the first match in a string or a portion of a string. You can determine whether the match has been found by retrieving the value of the `Match.Success` property. To retrieve <xref:System.Text.RegularExpressions.Match> objects that represent subsequent matches, call the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method repeatedly, until the `Success` property of the returned <xref:System.Text.RegularExpressions.Match> object is `false`.  \n  \n     The following example uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> methods to match the string \"abc\" in the input string.  \n  \n     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match3.cs#8)]\n     [!code-vb[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match3.vb#8)]  \n  \n Two properties of the <xref:System.Text.RegularExpressions.Match> class return collection objects:  \n  \n-   The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains information about the substrings that match capturing groups in the regular expression pattern.  \n  \n-   The `Match.Captures` property returns a <xref:System.Text.RegularExpressions.CaptureCollection> object that is of limited use. The collection is not populated for a <xref:System.Text.RegularExpressions.Match> object whose `Success` property is `false`. Otherwise, it contains a single <xref:System.Text.RegularExpressions.Capture> object that has the same information as the <xref:System.Text.RegularExpressions.Match> object.  \n  \n For more information about these objects, see [The Group Collection](#GroupCollection) and [The Capture Collection](#CaptureCollection) sections later in this topic.  \n  \n Two additional properties of the <xref:System.Text.RegularExpressions.Match> class provide information about the match. The `Match.Value` property returns the substring in the input string that matches the regular expression pattern. The `Match.Index` property returns the zero-based starting position of the matched string in the input string.  \n  \n The <xref:System.Text.RegularExpressions.Match> class also has two pattern-matching methods:  \n  \n-   The <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method finds the match after the match represented by the current <xref:System.Text.RegularExpressions.Match> object, and returns a <xref:System.Text.RegularExpressions.Match> object that represents that match.  \n  \n-   The <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method performs a specified replacement operation on the matched string and returns the result.  \n  \n The following example uses the <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method to prepend a $ symbol and a space before every number that includes two fractional digits.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/result1.cs#9)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/result1.vb#9)]  \n  \n The regular expression pattern `\\b\\d+(,\\d{3})*\\.\\d{2}\\b` is defined as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\b`|Begin the match at a word boundary.|  \n|`\\d+`|Match one or more decimal digits.|  \n|`(,\\d{3})*`|Match zero or more occurrences of a comma followed by three decimal digits.|  \n|`\\.`|Match the decimal point character.|  \n|`\\d{2}`|Match two decimal digits.|  \n|`\\b`|End the match at a word boundary.|  \n  \n The replacement pattern `$$ $&` indicates that the matched substring should be replaced by a dollar sign ($) symbol (the `$$` pattern), a space, and the value of the match (the `$&` pattern).  \n  \n [Back to top](#introduction)  \n  \n<a name=\"GroupCollection\"></a>   \n## The Group Collection  \n The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains <xref:System.Text.RegularExpressions.Group> objects that represent captured groups in a single match. The first <xref:System.Text.RegularExpressions.Group> object in the collection (at index 0) represents the entire match. Each object that follows represents the results of a single capturing group.  \n  \n You can retrieve individual <xref:System.Text.RegularExpressions.Group> objects in the collection by using the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property. You can retrieve unnamed groups by their ordinal position in the collection, and retrieve named groups either by name or by ordinal position. Unnamed captures appear first in the collection, and are indexed from left to right in the order in which they appear in the regular expression pattern. Named captures are indexed after unnamed captures, from left to right in the order in which they appear in the regular expression pattern. To determine what numbered groups are available in the collection returned for a particular regular expression matching method, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> method. To determine what named groups are available in the collection, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> method. Both methods are particularly useful in general-purpose routines that analyze the matches found by any regular expression.  \n  \n The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property is the indexer of the collection in C# and the collection object's default property in Visual Basic. This means that individual <xref:System.Text.RegularExpressions.Group> objects can be accessed by index (or by name, in the case of named groups) as follows:  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupsyntax1.cs#13)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupsyntax1.vb#13)]  \n  \n The following example defines a regular expression that uses grouping constructs to capture the month, day, and year of a date.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupcollection1.cs#10)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupcollection1.vb#10)]  \n  \n The regular expression pattern `\\b(\\w+)\\s(\\d{1,2}),\\s(\\d{4})\\b` is defined as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\b`|Begin the match at a word boundary.|  \n|`(\\w+)`|Match one or more word characters. This is the first capturing group.|  \n|`\\s`|Match a white-space character.|  \n|`(\\d{1,2})`|Match one or two decimal digits. This is the second capturing group.|  \n|`,`|Match a comma.|  \n|`\\s`|Match a white-space character.|  \n|`(\\d{4})`|Match four decimal digits. This is the third capturing group.|  \n|`\\b`|End the match on a word boundary.|  \n  \n [Back to top](#introduction)  \n  \n<a name=\"the_captured_group\"></a>   \n## The Captured Group  \n The <xref:System.Text.RegularExpressions.Group> class represents the result from a single capturing group. Group objects that represent the capturing groups defined in a regular expression are returned by the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property of the <xref:System.Text.RegularExpressions.GroupCollection> object returned by the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property. The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property is the indexer (in C#) and the default property (in Visual Basic) of the <xref:System.Text.RegularExpressions.Group> class. You can also retrieve individual members by iterating the collection using the `foreach` or `For Each` construct. For an example, see the previous section.  \n  \n The following example uses nested grouping constructs to capture substrings into groups. The regular expression pattern `(a(b))c` matches the string \"abc\". It assigns the substring \"ab\" to the first capturing group, and the substring \"b\" to the second capturing group.  \n  \n [!code-csharp[RegularExpressions.Classes#6](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#6)]\n [!code-vb[RegularExpressions.Classes#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#6)]  \n  \n The following example uses named grouping constructs to capture substrings from a string that contains data in the format \"DATANAME:VALUE\", which the regular expression splits at the colon (:).  \n  \n [!code-csharp[RegularExpressions.Classes#8](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#8)]\n [!code-vb[RegularExpressions.Classes#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#8)]  \n  \n The regular expression pattern `^(?<name>\\w+):(?<value>\\w+)` is defined as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`^`|Begin the match at the beginning of the input string.|  \n|`(?<name>\\w+)`|Match one or more word characters. The name of this capturing group is `name`.|  \n|`:`|Match a colon.|  \n|`(?<value>\\w+)`|Match one or more word characters. The name of this capturing group is `value`.|  \n  \n The properties of the <xref:System.Text.RegularExpressions.Group> class provide information about the captured group: The `Group.Value` property contains the captured substring, the `Group.Index` property indicates the starting position of the captured group in the input text, the `Group.Length` property contains the length of the captured text, and the `Group.Success` property indicates whether a substring matched the pattern defined by the capturing group.  \n  \n Applying quantifiers to a group (for more information, see [Quantifiers](../../../docs/standard/base-types/quantifiers-in-regular-expressions.md)) modifies the relationship of one capture per capturing group in two ways:  \n  \n-   If the `*` or `*?` quantifier (which specifies zero or more matches) is applied to a group, a capturing group may not have a match in the input string. When there is no captured text, the properties of the <xref:System.Text.RegularExpressions.Group> object are set as shown in the following table.  \n  \n    |Group property|Value|  \n    |--------------------|-----------|  \n    |`Success`|`false`|  \n    |`Value`|<xref:System.String.Empty?displayProperty=nameWithType>|  \n    |`Length`|0|  \n  \n     The following example provides an illustration. In the regular expression pattern `aaa(bbb)*ccc`, the first capturing group (the substring \"bbb\") can be matched zero or more times. Because the input string \"aaaccc\" matches the pattern, the capturing group does not have a match.  \n  \n     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/nocapture1.cs#11)]\n     [!code-vb[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/nocapture1.vb#11)]  \n  \n-   Quantifiers can match multiple occurrences of a pattern that is defined by a capturing group. In this case, the `Value` and `Length` properties of a <xref:System.Text.RegularExpressions.Group> object contain information only about the last captured substring. For example, the following regular expression matches a single sentence that ends in a period. It uses two grouping constructs: The first captures individual words along with a white-space character; the second captures individual words. As the output from the example shows, although the regular expression succeeds in capturing an entire sentence, the second capturing group captures only the last word.  \n  \n     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/lastcapture1.cs#12)]\n     [!code-vb[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/lastcapture1.vb#12)]  \n  \n [Back to top](#introduction)  \n  \n<a name=\"CaptureCollection\"></a>   \n## The Capture Collection  \n The <xref:System.Text.RegularExpressions.Group> object contains information only about the last capture. However, the entire set of captures made by a capturing group is still available from the <xref:System.Text.RegularExpressions.CaptureCollection> object that is returned by the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property. Each member of the collection is a <xref:System.Text.RegularExpressions.Capture> object that represents a capture made by that capturing group, in the order in which they were captured (and, therefore, in the order in which the captured strings were matched from left to right in the input string). You can retrieve individual <xref:System.Text.RegularExpressions.Capture> objects from the collection in either of two ways:  \n  \n-   By iterating through the collection using a construct such as `foreach` (in C#) or `For Each` (in Visual Basic).  \n  \n-   By using the <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific object by index. The <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> property is the <xref:System.Text.RegularExpressions.CaptureCollection> object's default property (in Visual Basic) or indexer (in C#).  \n  \n If a quantifier is not applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains a single <xref:System.Text.RegularExpressions.Capture> object that is of little interest, because it provides information about the same match as its <xref:System.Text.RegularExpressions.Group> object. If a quantifier is applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains all captures made by the capturing group, and the last member of the collection represents the same capture as the <xref:System.Text.RegularExpressions.Group> object.  \n  \n For example, if you use the regular expression pattern `((a(b))c)+` (where the + quantifier specifies one or more matches) to capture matches from the string \"abcabcabc\", the <xref:System.Text.RegularExpressions.CaptureCollection> object for each <xref:System.Text.RegularExpressions.Group> object contains three members.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capturecollection1.cs#14)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capturecollection1.vb#14)]  \n  \n The following example uses the regular expression `(Abc)+` to find one or more consecutive runs of the string \"Abc\" in the string \"XYZAbcAbcAbcXYZAbcAb\". The example illustrates the use of the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property to return multiple groups of captured substrings.  \n  \n [!code-csharp[RegularExpressions.Classes#5](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#5)]\n [!code-vb[RegularExpressions.Classes#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#5)]  \n  \n [Back to top](#introduction)  \n  \n<a name=\"the_individual_capture\"></a>   \n## The Individual Capture  \n The <xref:System.Text.RegularExpressions.Capture> class contains the results from a single subexpression capture. The <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> property contains the matched text, and the <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> property indicates the zero-based position in the input string at which the matched substring begins.  \n  \n The following example parses an input string for the temperature of selected cities. A comma (\",\") is used to separate a city and its temperature, and a semicolon (\";\") is used to separate each city's data. The entire input string represents a single match. In the regular expression pattern `((\\w+(\\s\\w+)*),(\\d+);)+`, which is used to parse the string, the city name is assigned to the second capturing group, and the temperature is assigned to the fourth capturing group.  \n  \n [!code-csharp[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capture1.cs#16)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capture1.vb#16)]  \n  \n The regular expression is defined as shown in the following table.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`\\w+`|Match one or more word characters.|  \n|`(\\s\\w+)*`|Match zero or more occurrences of a white-space character followed by one or more word characters. This pattern matches multi-word city names. This is the third capturing group.|  \n|`(\\w+(\\s\\w+)*)`|Match one or more word characters followed by zero or more occurrences of a white-space character and one or more word characters. This is the second capturing group.|  \n|`,`|Match a comma.|  \n|`(\\d+)`|Match one or more digits. This is the fourth capturing group.|  \n|`;`|Match a semicolon.|  \n|`((\\w+(\\s\\w+)*),(\\d+);)+`|Match the pattern of a word followed by any additional words followed by a comma, one or more digits, and a semicolon, one or more times. This is the first capturing group.|  \n  \n## See also\n\n- <xref:System.Text.RegularExpressions>\n- [.NET Regular Expressions](../../../docs/standard/base-types/regular-expressions.md)\n- [Regular Expression Language - Quick Reference](../../../docs/standard/base-types/regular-expression-language-quick-reference.md)\n","nodes":[{"pos":[4,1427],"embed":true,"restype":"x-metadata","content":"title: \"The Regular Expression Object Model\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"searching with regular expressions, backreferences\"\n  - \"Regex class\"\n  - \"Match class\"\n  - \"pattern-matching with regular expressions, backreferences\"\n  - \".NET Framework regular expressions, classes\"\n  - \"CaptureCollection class\"\n  - \"Group class\"\n  - \"characters [.NET Framework], backreferences\"\n  - \"substrings\"\n  - \".NET Framework regular expressions, backreferences\"\n  - \"searching with regular expressions, classes\"\n  - \"backreferences\"\n  - \"Capture class\"\n  - \"repeating groups of characters\"\n  - \"MatchCollection class\"\n  - \"parsing text with regular expressions, backreferences\"\n  - \"regular expressions [.NET Framework]\"\n  - \"characters [.NET Framework], regular expressions\"\n  - \"classes [.NET Framework], regular expression\"\n  - \"regular expressions [.NET Framework], classes\"\n  - \"characters [.NET Framework], metacharacters\"\n  - \"metacharacters, regular expression classes\"\n  - \"metacharacters, backreferences\"\n  - \"parsing text with regular expressions, classes\"\n  - \"regular expressions [.NET Framework], backreferences\"\n  - \"strings [.NET Framework], regular expressions\"\n  - \"pattern-matching with regular expressions, classes\"\n  - \"GroupCollection class\"\nms.assetid: 49a21470-64ca-4b5a-a889-8e24e3c0af7e\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"The Regular Expression Object Model","nodes":[{"pos":[0,35],"content":"The Regular Expression Object Model","nodes":[{"content":"The Regular Expression Object Model","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[1434,1469],"content":"The Regular Expression Object Model","linkify":"The Regular Expression Object Model","nodes":[{"content":"The Regular Expression Object Model","pos":[0,35]}]},{"content":"<bpt id=\"p1\">&lt;a name=\"introduction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> This topic describes the object model used in working with .NET regular expressions.","pos":[1470,1582],"source":"<a name=\"introduction\"></a> This topic describes the object model used in working with .NET regular expressions."},{"content":"It contains the following sections:","pos":[1583,1618]},{"pos":[1628,1668],"content":"<bpt id=\"p1\">[</bpt>The Regular Expression Engine<ept id=\"p1\">](#Engine)</ept>","source":"[The Regular Expression Engine](#Engine)"},{"pos":[1678,1741],"content":"<bpt id=\"p1\">[</bpt>The MatchCollection and Match Objects<ept id=\"p1\">](#Match_and_MCollection)</ept>","source":"[The MatchCollection and Match Objects](#Match_and_MCollection)"},{"pos":[1751,1791],"content":"<bpt id=\"p1\">[</bpt>The Group Collection<ept id=\"p1\">](#GroupCollection)</ept>","source":"[The Group Collection](#GroupCollection)"},{"pos":[1801,1842],"content":"<bpt id=\"p1\">[</bpt>The Captured Group<ept id=\"p1\">](#the_captured_group)</ept>","source":"[The Captured Group](#the_captured_group)"},{"pos":[1852,1896],"content":"<bpt id=\"p1\">[</bpt>The Capture Collection<ept id=\"p1\">](#CaptureCollection)</ept>","source":"[The Capture Collection](#CaptureCollection)"},{"pos":[1906,1955],"content":"<bpt id=\"p1\">[</bpt>The Individual Capture<ept id=\"p1\">](#the_individual_capture)</ept>","source":"[The Individual Capture](#the_individual_capture)"},{"pos":[1989,2018],"content":"The Regular Expression Engine","linkify":"The Regular Expression Engine","nodes":[{"content":"The Regular Expression Engine","pos":[0,29]}]},{"content":"The regular expression engine in .NET is represented by the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> class.","pos":[2022,2132],"source":"The regular expression engine in .NET is represented by the <xref:System.Text.RegularExpressions.Regex> class."},{"content":"The regular expression engine is responsible for parsing and compiling a regular expression, and for performing operations that match the regular expression pattern with an input string.","pos":[2133,2319]},{"content":"The engine is the central component in the .NET regular expression object model.","pos":[2320,2400]},{"content":"You can use the regular expression engine in either of two ways:","pos":[2407,2471]},{"content":"By calling the static methods of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> class.","pos":[2481,2568],"source":"By calling the static methods of the <xref:System.Text.RegularExpressions.Regex> class."},{"content":"The method parameters include the input string and the regular expression pattern.","pos":[2569,2651]},{"content":"The regular expression engine caches regular expressions that are used in static method calls, so repeated calls to static regular expression methods that use the same regular expression offer relatively good performance.","pos":[2652,2873]},{"content":"By instantiating a <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> object, by passing a regular expression to the class constructor.","pos":[2883,3011],"source":"By instantiating a <xref:System.Text.RegularExpressions.Regex> object, by passing a regular expression to the class constructor."},{"content":"In this case, the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> object is immutable (read-only) and represents a regular expression engine that is tightly coupled with a single regular expression.","pos":[3012,3206],"source":" In this case, the <xref:System.Text.RegularExpressions.Regex> object is immutable (read-only) and represents a regular expression engine that is tightly coupled with a single regular expression."},{"content":"Because regular expressions used by <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> instances are not cached, you should not instantiate a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> object multiple times with the same regular expression.","pos":[3207,3441],"source":" Because regular expressions used by <xref:System.Text.RegularExpressions.Regex> instances are not cached, you should not instantiate a <xref:System.Text.RegularExpressions.Regex> object multiple times with the same regular expression."},{"pos":[3448,3566],"content":"You can call the methods of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex&gt;</ph> class to perform the following operations:","source":"You can call the methods of the <xref:System.Text.RegularExpressions.Regex> class to perform the following operations:"},{"content":"Determine whether a string matches a regular expression pattern.","pos":[3576,3640]},{"content":"Extract a single match or the first match.","pos":[3650,3692]},{"content":"Extract all matches.","pos":[3702,3722]},{"content":"Replace a matched substring.","pos":[3732,3760]},{"content":"Split a single string into an array of strings.","pos":[3770,3817]},{"content":"These operations are described in the following sections.","pos":[3824,3881]},{"pos":[3891,3928],"content":"Matching a Regular Expression Pattern","linkify":"Matching a Regular Expression Pattern","nodes":[{"content":"Matching a Regular Expression Pattern","pos":[0,37]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType&gt;</ph> method returns <ph id=\"ph2\">`true`</ph> if the string matches the pattern, or <ph id=\"ph3\">`false`</ph> if it does not.","pos":[3932,4103],"source":"The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> method returns `true` if the string matches the pattern, or `false` if it does not."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.IsMatch%2A&gt;</ph> method is often used to validate string input.","pos":[4104,4209],"source":" The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is often used to validate string input."},{"content":"For example, the following code ensures that a string matches a valid social security number in the United States.","pos":[4210,4324]},{"pos":[4679,4779],"content":"The regular expression pattern <ph id=\"ph1\">`^\\d{3}-\\d{2}-\\d{4}$`</ph> is interpreted as shown in the following table.","source":"The regular expression pattern `^\\d{3}-\\d{2}-\\d{4}$` is interpreted as shown in the following table."},{"content":"Pattern","pos":[4786,4793]},{"content":"Description","pos":[4794,4805]},{"content":"Match the beginning of the input string.","pos":[4850,4890]},{"content":"Match three decimal digits.","pos":[4903,4930]},{"content":"Match a hyphen.","pos":[4939,4954]},{"content":"Match two decimal digits.","pos":[4967,4992]},{"content":"Match a hyphen.","pos":[5001,5016]},{"content":"Match four decimal digits.","pos":[5029,5055]},{"content":"Match the end of the input string.","pos":[5064,5098]},{"pos":[5109,5153],"content":"Extracting a Single Match or the First Match","linkify":"Extracting a Single Match or the First Match","nodes":[{"content":"Extracting a Single Match or the First Match","pos":[0,44]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType&gt;</ph> method returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object that contains information about the first substring that matches a regular expression pattern.","pos":[5157,5405],"source":"The <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.Match> object that contains information about the first substring that matches a regular expression pattern."},{"content":"If the <ph id=\"ph1\">`Match.Success`</ph> property returns <ph id=\"ph2\">`true`</ph>, indicating that a match was found, you can retrieve information about subsequent matches by calling the <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[5406,5651],"source":" If the `Match.Success` property returns `true`, indicating that a match was found, you can retrieve information about subsequent matches by calling the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method."},{"content":"These method calls can continue until the <ph id=\"ph1\">`Match.Success`</ph> property returns <ph id=\"ph2\">`false`</ph>.","pos":[5652,5735],"source":" These method calls can continue until the `Match.Success` property returns `false`."},{"content":"For example, the following code uses the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType&gt;</ph> method to find the first occurrence of a duplicated word in a string.","pos":[5736,5960],"source":" For example, the following code uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> method to find the first occurrence of a duplicated word in a string."},{"content":"It then calls the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> method to find any additional occurrences.","pos":[5961,6107],"source":" It then calls the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method to find any additional occurrences."},{"content":"The example examines the <ph id=\"ph1\">`Match.Success`</ph> property after each method call to determine whether the current match was successful and whether a call to the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> method should follow.","pos":[6108,6368],"source":" The example examines the `Match.Success` property after each method call to determine whether the current match was successful and whether a call to the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method should follow."},{"pos":[6717,6814],"content":"The regular expression pattern <ph id=\"ph1\">`\\b(\\w+)\\W+(\\1)\\b`</ph> is interpreted as shown in the following table.","source":"The regular expression pattern `\\b(\\w+)\\W+(\\1)\\b` is interpreted as shown in the following table."},{"content":"Pattern","pos":[6821,6828]},{"content":"Description","pos":[6829,6840]},{"content":"Begin the match on a word boundary.","pos":[6886,6921]},{"content":"Match one or more word characters.","pos":[6934,6968]},{"content":"This is the first capturing group.","pos":[6969,7003]},{"content":"Match one or more non-word characters.","pos":[7014,7052]},{"content":"Match the first captured string.","pos":[7064,7096]},{"content":"This is the second capturing group.","pos":[7097,7132]},{"content":"End the match on a word boundary.","pos":[7142,7175]},{"pos":[7186,7208],"content":"Extracting All Matches","linkify":"Extracting All Matches","nodes":[{"content":"Extracting All Matches","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType&gt;</ph> method returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object that contains information about all matches that the regular expression engine found in the input string.","pos":[7212,7483],"source":"The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains information about all matches that the regular expression engine found in the input string."},{"content":"For example, the previous example could be rewritten to call the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A&gt;</ph> method instead of the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Regex.Match%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A&gt;</ph> methods.","pos":[7484,7748],"source":" For example, the previous example could be rewritten to call the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method instead of the <xref:System.Text.RegularExpressions.Regex.Match%2A> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A> methods."},{"pos":[8104,8133],"content":"Replacing a Matched Substring","linkify":"Replacing a Matched Substring","nodes":[{"content":"Replacing a Matched Substring","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType&gt;</ph> method replaces each substring that matches the regular expression pattern with a specified string or regular expression pattern, and returns the entire input string with replacements.","pos":[8137,8409],"source":"The <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces each substring that matches the regular expression pattern with a specified string or regular expression pattern, and returns the entire input string with replacements."},{"content":"For example, the following code adds a U.S. currency symbol before a decimal number in a string.","pos":[8410,8506]},{"pos":[8859,8954],"content":"The regular expression pattern <ph id=\"ph1\">`\\b\\d+\\.\\d{2}\\b`</ph> is interpreted as shown in the following table.","source":"The regular expression pattern `\\b\\d+\\.\\d{2}\\b` is interpreted as shown in the following table."},{"content":"Pattern","pos":[8961,8968]},{"content":"Description","pos":[8969,8980]},{"content":"Begin the match at a word boundary.","pos":[9026,9061]},{"content":"Match one or more decimal digits.","pos":[9072,9105]},{"content":"Match a period.","pos":[9115,9130]},{"content":"Match two decimal digits.","pos":[9143,9168]},{"content":"End the match at a word boundary.","pos":[9178,9211]},{"pos":[9219,9297],"content":"The replacement pattern <ph id=\"ph1\">`$$$&amp;`</ph> is interpreted as shown in the following table.","source":"The replacement pattern `$$$&` is interpreted as shown in the following table."},{"content":"Pattern","pos":[9304,9311]},{"content":"Replacement string","pos":[9312,9330]},{"content":"The dollar sign ($) character.","pos":[9383,9413]},{"content":"The entire matched substring.","pos":[9423,9452]},{"pos":[9463,9513],"content":"Splitting a Single String into an Array of Strings","linkify":"Splitting a Single String into an Array of Strings","nodes":[{"content":"Splitting a Single String into an Array of Strings","pos":[0,50]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType&gt;</ph> method splits the input string at the positions defined by a regular expression match.","pos":[9517,9689],"source":"The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> method splits the input string at the positions defined by a regular expression match."},{"content":"For example, the following code places the items in a numbered list into a string array.","pos":[9690,9778]},{"pos":[10127,10221],"content":"The regular expression pattern <ph id=\"ph1\">`\\b\\d{1,2}\\.\\s`</ph> is interpreted as shown in the following table.","source":"The regular expression pattern `\\b\\d{1,2}\\.\\s` is interpreted as shown in the following table."},{"content":"Pattern","pos":[10228,10235]},{"content":"Description","pos":[10236,10247]},{"content":"Begin the match at a word boundary.","pos":[10293,10328]},{"content":"Match one or two decimal digits.","pos":[10343,10375]},{"content":"Match a period.","pos":[10385,10400]},{"content":"Match a white-space character.","pos":[10410,10440]},{"pos":[10490,10527],"content":"The MatchCollection and Match Objects","linkify":"The MatchCollection and Match Objects","nodes":[{"content":"The MatchCollection and Match Objects","pos":[0,37]}]},{"pos":[10531,10743],"content":"Regex methods return two objects that are part of the regular expression object model: the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object, and the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object.","source":"Regex methods return two objects that are part of the regular expression object model: the <xref:System.Text.RegularExpressions.MatchCollection> object, and the <xref:System.Text.RegularExpressions.Match> object."},{"pos":[10792,10812],"content":"The Match Collection","linkify":"The Match Collection","nodes":[{"content":"The Match Collection","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType&gt;</ph> method returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object that contains <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects that represent all the matches that the regular expression engine found, in the order in which they occur in the input string.","pos":[10816,11174],"source":"The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains <xref:System.Text.RegularExpressions.Match> objects that represent all the matches that the regular expression engine found, in the order in which they occur in the input string."},{"content":"If there are no matches, the method returns a <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object with no members.","pos":[11175,11298],"source":" If there are no matches, the method returns a <xref:System.Text.RegularExpressions.MatchCollection> object with no members."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType&gt;</ph> property lets you access individual members of the collection by index, from zero to one less than the value of the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[11299,11611],"source":" The <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property lets you access individual members of the collection by index, from zero to one less than the value of the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property."},{"content":"<ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Item%2A&gt;</ph> is the collection's indexer (in C#) and default property (in Visual Basic).","pos":[11612,11749],"source":"<xref:System.Text.RegularExpressions.MatchCollection.Item%2A> is the collection's indexer (in C#) and default property (in Visual Basic)."},{"content":"By default, the call to the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType&gt;</ph> method uses lazy evaluation to populate the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object.","pos":[11756,11973],"source":"By default, the call to the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method uses lazy evaluation to populate the <xref:System.Text.RegularExpressions.MatchCollection> object."},{"content":"Access to properties that require a fully populated collection, such as the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType&gt;</ph> properties, may involve a performance penalty.","pos":[11974,12283],"source":" Access to properties that require a fully populated collection, such as the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> properties, may involve a performance penalty."},{"content":"As a result, we recommend that you access the collection by using the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerator&gt;</ph> object that is returned by the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[12284,12530],"source":" As a result, we recommend that you access the collection by using the <xref:System.Collections.IEnumerator> object that is returned by the <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType> method."},{"content":"Individual languages provide constructs, such as <ph id=\"ph1\">`For Each`</ph> in Visual Basic and <ph id=\"ph2\">`foreach`</ph> in C#, that wrap the collection's <ph id=\"ph3\">&lt;xref:System.Collections.IEnumerator&gt;</ph> interface.","pos":[12531,12703],"source":" Individual languages provide constructs, such as `For Each` in Visual Basic and `foreach` in C#, that wrap the collection's <xref:System.Collections.IEnumerator> interface."},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType&gt;</ph> method to populate a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object with all the matches found in an input string.","pos":[12710,12969],"source":"The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method to populate a <xref:System.Text.RegularExpressions.MatchCollection> object with all the matches found in an input string."},{"content":"The example enumerates the collection, copies the matches to a string array, and records the character positions in an integer array.","pos":[12970,13103]},{"pos":[13503,13512],"content":"The Match","linkify":"The Match","nodes":[{"content":"The Match","pos":[0,9]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> class represents the result of a single regular expression match.","pos":[13516,13629],"source":"The <xref:System.Text.RegularExpressions.Match> class represents the result of a single regular expression match."},{"content":"You can access <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects in two ways:","pos":[13630,13709],"source":" You can access <xref:System.Text.RegularExpressions.Match> objects in two ways:"},{"content":"By retrieving them from the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object that is returned by the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[13719,13923],"source":"By retrieving them from the <xref:System.Text.RegularExpressions.MatchCollection> object that is returned by the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method."},{"content":"To retrieve individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects, iterate the collection by using a <ph id=\"ph2\">`foreach`</ph> (in C#) or <ph id=\"ph3\">`For Each`</ph>...<ph id=\"ph4\">`Next`</ph> (in Visual Basic) construct, or use the <ph id=\"ph5\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType&gt;</ph> property to retrieve a specific <ph id=\"ph6\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object either by index or by name.","pos":[13924,14316],"source":" To retrieve individual <xref:System.Text.RegularExpressions.Match> objects, iterate the collection by using a `foreach` (in C#) or `For Each`...`Next` (in Visual Basic) construct, or use the <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific <xref:System.Text.RegularExpressions.Match> object either by index or by name."},{"content":"You can also retrieve individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects from the collection by iterating the collection by index, from zero to one less that the number of objects in the collection.","pos":[14317,14527],"source":" You can also retrieve individual <xref:System.Text.RegularExpressions.Match> objects from the collection by iterating the collection by index, from zero to one less that the number of objects in the collection."},{"content":"However, this method does not take advantage of lazy evaluation, because it accesses the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[14528,14718],"source":" However, this method does not take advantage of lazy evaluation, because it accesses the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property."},{"content":"The following example retrieves individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects from a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> object by iterating the collection using the <ph id=\"ph3\">`foreach`</ph> or <ph id=\"ph4\">`For Each`</ph>...<ph id=\"ph5\">`Next`</ph> construct.","pos":[14729,14973],"source":"The following example retrieves individual <xref:System.Text.RegularExpressions.Match> objects from a <xref:System.Text.RegularExpressions.MatchCollection> object by iterating the collection using the `foreach` or `For Each`...`Next` construct."},{"content":"The regular expression simply matches the string \"abc\" in the input string.","pos":[14974,15049]},{"pos":[15060,15399],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match2.cs#7)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match2.vb#7)]","leadings":["","    "],"nodes":[]},{"content":"By calling the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType&gt;</ph> method, which returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object that represents the first match in a string or a portion of a string.","pos":[15409,15650],"source":"By calling the <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method, which returns a <xref:System.Text.RegularExpressions.Match> object that represents the first match in a string or a portion of a string."},{"content":"You can determine whether the match has been found by retrieving the value of the <ph id=\"ph1\">`Match.Success`</ph> property.","pos":[15651,15758],"source":" You can determine whether the match has been found by retrieving the value of the `Match.Success` property."},{"content":"To retrieve <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> objects that represent subsequent matches, call the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> method repeatedly, until the <ph id=\"ph3\">`Success`</ph> property of the returned <ph id=\"ph4\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object is <ph id=\"ph5\">`false`</ph>.","pos":[15759,16079],"source":" To retrieve <xref:System.Text.RegularExpressions.Match> objects that represent subsequent matches, call the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method repeatedly, until the `Success` property of the returned <xref:System.Text.RegularExpressions.Match> object is `false`."},{"pos":[16090,16379],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> methods to match the string \"abc\" in the input string.","source":"The following example uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> methods to match the string \"abc\" in the input string."},{"pos":[16390,16729],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match3.cs#8)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match3.vb#8)]","leadings":["","    "],"nodes":[]},{"pos":[16736,16834],"content":"Two properties of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> class return collection objects:","source":"Two properties of the <xref:System.Text.RegularExpressions.Match> class return collection objects:"},{"pos":[16844,17120],"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType&gt;</ph> property returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.GroupCollection&gt;</ph> object that contains information about the substrings that match capturing groups in the regular expression pattern.","source":"The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains information about the substrings that match capturing groups in the regular expression pattern."},{"content":"The <ph id=\"ph1\">`Match.Captures`</ph> property returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object that is of limited use.","pos":[17130,17256],"source":"The `Match.Captures` property returns a <xref:System.Text.RegularExpressions.CaptureCollection> object that is of limited use."},{"content":"The collection is not populated for a <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object whose <ph id=\"ph2\">`Success`</ph> property is <ph id=\"ph3\">`false`</ph>.","pos":[17257,17382],"source":" The collection is not populated for a <xref:System.Text.RegularExpressions.Match> object whose `Success` property is `false`."},{"content":"Otherwise, it contains a single <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Capture&gt;</ph> object that has the same information as the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object.","pos":[17383,17556],"source":" Otherwise, it contains a single <xref:System.Text.RegularExpressions.Capture> object that has the same information as the <xref:System.Text.RegularExpressions.Match> object."},{"pos":[17563,17728],"content":"For more information about these objects, see <bpt id=\"p1\">[</bpt>The Group Collection<ept id=\"p1\">](#GroupCollection)</ept> and <bpt id=\"p2\">[</bpt>The Capture Collection<ept id=\"p2\">](#CaptureCollection)</ept> sections later in this topic.","source":"For more information about these objects, see [The Group Collection](#GroupCollection) and [The Capture Collection](#CaptureCollection) sections later in this topic."},{"content":"Two additional properties of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> class provide information about the match.","pos":[17735,17854],"source":"Two additional properties of the <xref:System.Text.RegularExpressions.Match> class provide information about the match."},{"content":"The <ph id=\"ph1\">`Match.Value`</ph> property returns the substring in the input string that matches the regular expression pattern.","pos":[17855,17968],"source":" The `Match.Value` property returns the substring in the input string that matches the regular expression pattern."},{"content":"The <ph id=\"ph1\">`Match.Index`</ph> property returns the zero-based starting position of the matched string in the input string.","pos":[17969,18079],"source":" The `Match.Index` property returns the zero-based starting position of the matched string in the input string."},{"pos":[18086,18178],"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> class also has two pattern-matching methods:","source":"The <xref:System.Text.RegularExpressions.Match> class also has two pattern-matching methods:"},{"pos":[18188,18488],"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType&gt;</ph> method finds the match after the match represented by the current <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object, and returns a <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Match&gt;</ph> object that represents that match.","source":"The <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method finds the match after the match represented by the current <xref:System.Text.RegularExpressions.Match> object, and returns a <xref:System.Text.RegularExpressions.Match> object that represents that match."},{"pos":[18498,18680],"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType&gt;</ph> method performs a specified replacement operation on the matched string and returns the result.","source":"The <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method performs a specified replacement operation on the matched string and returns the result."},{"pos":[18687,18898],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType&gt;</ph> method to prepend a $ symbol and a space before every number that includes two fractional digits.","source":"The following example uses the <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method to prepend a $ symbol and a space before every number that includes two fractional digits."},{"pos":[18905,19242],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/result1.cs#9)]\n[!code-vb[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/result1.vb#9)]","leadings":[""," "],"nodes":[]},{"pos":[19249,19349],"content":"The regular expression pattern <ph id=\"ph1\">`\\b\\d+(,\\d{3})*\\.\\d{2}\\b`</ph> is defined as shown in the following table.","source":"The regular expression pattern `\\b\\d+(,\\d{3})*\\.\\d{2}\\b` is defined as shown in the following table."},{"content":"Pattern","pos":[19356,19363]},{"content":"Description","pos":[19364,19375]},{"content":"Begin the match at a word boundary.","pos":[19421,19456]},{"content":"Match one or more decimal digits.","pos":[19467,19500]},{"content":"Match zero or more occurrences of a comma followed by three decimal digits.","pos":[19517,19592]},{"content":"Match the decimal point character.","pos":[19602,19636]},{"content":"Match two decimal digits.","pos":[19649,19674]},{"content":"End the match at a word boundary.","pos":[19684,19717]},{"pos":[19725,19916],"content":"The replacement pattern <ph id=\"ph1\">`$$ $&amp;`</ph> indicates that the matched substring should be replaced by a dollar sign ($) symbol (the <ph id=\"ph2\">`$$`</ph> pattern), a space, and the value of the match (the <ph id=\"ph3\">`$&amp;`</ph> pattern).","source":"The replacement pattern `$$ $&` indicates that the matched substring should be replaced by a dollar sign ($) symbol (the `$$` pattern), a space, and the value of the match (the `$&` pattern)."},{"pos":[19923,19951],"content":"<bpt id=\"p1\">[</bpt>Back to top<ept id=\"p1\">](#introduction)</ept>","source":"[Back to top](#introduction)"},{"pos":[19994,20014],"content":"The Group Collection","linkify":"The Group Collection","nodes":[{"content":"The Group Collection","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType&gt;</ph> property returns a <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.GroupCollection&gt;</ph> object that contains <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> objects that represent captured groups in a single match.","pos":[20018,20300],"source":"The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains <xref:System.Text.RegularExpressions.Group> objects that represent captured groups in a single match."},{"content":"The first <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object in the collection (at index 0) represents the entire match.","pos":[20301,20421],"source":" The first <xref:System.Text.RegularExpressions.Group> object in the collection (at index 0) represents the entire match."},{"content":"Each object that follows represents the results of a single capturing group.","pos":[20422,20498]},{"content":"You can retrieve individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> objects in the collection by using the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[20505,20716],"source":"You can retrieve individual <xref:System.Text.RegularExpressions.Group> objects in the collection by using the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property."},{"content":"You can retrieve unnamed groups by their ordinal position in the collection, and retrieve named groups either by name or by ordinal position.","pos":[20717,20858]},{"content":"Unnamed captures appear first in the collection, and are indexed from left to right in the order in which they appear in the regular expression pattern.","pos":[20859,21011]},{"content":"Named captures are indexed after unnamed captures, from left to right in the order in which they appear in the regular expression pattern.","pos":[21012,21150]},{"content":"To determine what numbered groups are available in the collection returned for a particular regular expression matching method, you can call the instance <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[21151,21404],"source":" To determine what numbered groups are available in the collection returned for a particular regular expression matching method, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> method."},{"content":"To determine what named groups are available in the collection, you can call the instance <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[21405,21592],"source":" To determine what named groups are available in the collection, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> method."},{"content":"Both methods are particularly useful in general-purpose routines that analyze the matches found by any regular expression.","pos":[21593,21715]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType&gt;</ph> property is the indexer of the collection in C# and the collection object's default property in Visual Basic.","pos":[21722,21926],"source":"The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property is the indexer of the collection in C# and the collection object's default property in Visual Basic."},{"content":"This means that individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> objects can be accessed by index (or by name, in the case of named groups) as follows:","pos":[21927,22084],"source":" This means that individual <xref:System.Text.RegularExpressions.Group> objects can be accessed by index (or by name, in the case of named groups) as follows:"},{"content":"The following example defines a regular expression that uses grouping constructs to capture the month, day, and year of a date.","pos":[22449,22576]},{"pos":[22949,23056],"content":"The regular expression pattern <ph id=\"ph1\">`\\b(\\w+)\\s(\\d{1,2}),\\s(\\d{4})\\b`</ph> is defined as shown in the following table.","source":"The regular expression pattern `\\b(\\w+)\\s(\\d{1,2}),\\s(\\d{4})\\b` is defined as shown in the following table."},{"content":"Pattern","pos":[23063,23070]},{"content":"Description","pos":[23071,23082]},{"content":"Begin the match at a word boundary.","pos":[23128,23163]},{"content":"Match one or more word characters.","pos":[23176,23210]},{"content":"This is the first capturing group.","pos":[23211,23245]},{"content":"Match a white-space character.","pos":[23255,23285]},{"content":"Match one or two decimal digits.","pos":[23302,23334]},{"content":"This is the second capturing group.","pos":[23335,23370]},{"content":"Match a comma.","pos":[23379,23393]},{"content":"Match a white-space character.","pos":[23403,23433]},{"content":"Match four decimal digits.","pos":[23448,23474]},{"content":"This is the third capturing group.","pos":[23475,23509]},{"content":"End the match on a word boundary.","pos":[23519,23552]},{"pos":[23560,23588],"content":"<bpt id=\"p1\">[</bpt>Back to top<ept id=\"p1\">](#introduction)</ept>","source":"[Back to top](#introduction)"},{"pos":[23634,23652],"content":"The Captured Group","linkify":"The Captured Group","nodes":[{"content":"The Captured Group","pos":[0,18]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> class represents the result from a single capturing group.","pos":[23656,23762],"source":"The <xref:System.Text.RegularExpressions.Group> class represents the result from a single capturing group."},{"content":"Group objects that represent the capturing groups defined in a regular expression are returned by the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.GroupCollection.Item%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.GroupCollection&gt;</ph> object returned by the <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[23763,24112],"source":" Group objects that represent the capturing groups defined in a regular expression are returned by the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property of the <xref:System.Text.RegularExpressions.GroupCollection> object returned by the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.GroupCollection.Item%2A&gt;</ph> property is the indexer (in C#) and the default property (in Visual Basic) of the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> class.","pos":[24113,24311],"source":" The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property is the indexer (in C#) and the default property (in Visual Basic) of the <xref:System.Text.RegularExpressions.Group> class."},{"content":"You can also retrieve individual members by iterating the collection using the <ph id=\"ph1\">`foreach`</ph> or <ph id=\"ph2\">`For Each`</ph> construct.","pos":[24312,24425],"source":" You can also retrieve individual members by iterating the collection using the `foreach` or `For Each` construct."},{"content":"For an example, see the previous section.","pos":[24426,24467]},{"content":"The following example uses nested grouping constructs to capture substrings into groups.","pos":[24474,24562]},{"content":"The regular expression pattern <ph id=\"ph1\">`(a(b))c`</ph> matches the string \"abc\".","pos":[24563,24629],"source":" The regular expression pattern `(a(b))c` matches the string \"abc\"."},{"content":"It assigns the substring \"ab\" to the first capturing group, and the substring \"b\" to the second capturing group.","pos":[24630,24742]},{"content":"The following example uses named grouping constructs to capture substrings from a string that contains data in the format \"DATANAME:VALUE\", which the regular expression splits at the colon (:).","pos":[25033,25226]},{"pos":[25517,25621],"content":"The regular expression pattern <ph id=\"ph1\">`^(?&lt;name&gt;\\w+):(?&lt;value&gt;\\w+)`</ph> is defined as shown in the following table.","source":"The regular expression pattern `^(?<name>\\w+):(?<value>\\w+)` is defined as shown in the following table."},{"content":"Pattern","pos":[25628,25635]},{"content":"Description","pos":[25636,25647]},{"content":"Begin the match at the beginning of the input string.","pos":[25692,25745]},{"content":"Match one or more word characters.","pos":[25765,25799]},{"content":"The name of this capturing group is <ph id=\"ph1\">`name`</ph>.","pos":[25800,25843],"source":" The name of this capturing group is `name`."},{"content":"Match a colon.","pos":[25852,25866]},{"content":"Match one or more word characters.","pos":[25887,25921]},{"content":"The name of this capturing group is <ph id=\"ph1\">`value`</ph>.","pos":[25922,25966],"source":" The name of this capturing group is `value`."},{"pos":[25974,26436],"content":"The properties of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> class provide information about the captured group: The <ph id=\"ph2\">`Group.Value`</ph> property contains the captured substring, the <ph id=\"ph3\">`Group.Index`</ph> property indicates the starting position of the captured group in the input text, the <ph id=\"ph4\">`Group.Length`</ph> property contains the length of the captured text, and the <ph id=\"ph5\">`Group.Success`</ph> property indicates whether a substring matched the pattern defined by the capturing group.","source":"The properties of the <xref:System.Text.RegularExpressions.Group> class provide information about the captured group: The `Group.Value` property contains the captured substring, the `Group.Index` property indicates the starting position of the captured group in the input text, the `Group.Length` property contains the length of the captured text, and the `Group.Success` property indicates whether a substring matched the pattern defined by the capturing group."},{"pos":[26443,26663],"content":"Applying quantifiers to a group (for more information, see <bpt id=\"p1\">[</bpt>Quantifiers<ept id=\"p1\">](../../../docs/standard/base-types/quantifiers-in-regular-expressions.md)</ept>) modifies the relationship of one capture per capturing group in two ways:","source":"Applying quantifiers to a group (for more information, see [Quantifiers](../../../docs/standard/base-types/quantifiers-in-regular-expressions.md)) modifies the relationship of one capture per capturing group in two ways:"},{"content":"If the <ph id=\"ph1\">`*`</ph> or <ph id=\"ph2\">`*?`</ph> quantifier (which specifies zero or more matches) is applied to a group, a capturing group may not have a match in the input string.","pos":[26673,26824],"source":"If the `*` or `*?` quantifier (which specifies zero or more matches) is applied to a group, a capturing group may not have a match in the input string."},{"content":"When there is no captured text, the properties of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object are set as shown in the following table.","pos":[26825,26970],"source":" When there is no captured text, the properties of the <xref:System.Text.RegularExpressions.Group> object are set as shown in the following table."},{"content":"Group property","pos":[26981,26995]},{"content":"Value","pos":[26996,27001]},{"content":"0","pos":[27158,27159]},{"content":"The following example provides an illustration.","pos":[27171,27218]},{"content":"In the regular expression pattern <ph id=\"ph1\">`aaa(bbb)*ccc`</ph>, the first capturing group (the substring \"bbb\") can be matched zero or more times.","pos":[27219,27351],"source":" In the regular expression pattern `aaa(bbb)*ccc`, the first capturing group (the substring \"bbb\") can be matched zero or more times."},{"content":"Because the input string \"aaaccc\" matches the pattern, the capturing group does not have a match.","pos":[27352,27449]},{"pos":[27460,27811],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/nocapture1.cs#11)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/nocapture1.vb#11)]","leadings":["","    "],"nodes":[]},{"content":"Quantifiers can match multiple occurrences of a pattern that is defined by a capturing group.","pos":[27821,27914]},{"content":"In this case, the <ph id=\"ph1\">`Value`</ph> and <ph id=\"ph2\">`Length`</ph> properties of a <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object contain information only about the last captured substring.","pos":[27915,28080],"source":" In this case, the `Value` and `Length` properties of a <xref:System.Text.RegularExpressions.Group> object contain information only about the last captured substring."},{"content":"For example, the following regular expression matches a single sentence that ends in a period.","pos":[28081,28175]},{"content":"It uses two grouping constructs: The first captures individual words along with a white-space character; the second captures individual words.","pos":[28176,28318]},{"content":"As the output from the example shows, although the regular expression succeeds in capturing an entire sentence, the second capturing group captures only the last word.","pos":[28319,28486]},{"pos":[28497,28852],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/lastcapture1.cs#12)]\n [!code-vb[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/lastcapture1.vb#12)]","leadings":["","    "],"nodes":[]},{"pos":[28859,28887],"content":"<bpt id=\"p1\">[</bpt>Back to top<ept id=\"p1\">](#introduction)</ept>","source":"[Back to top](#introduction)"},{"pos":[28932,28954],"content":"The Capture Collection","linkify":"The Capture Collection","nodes":[{"content":"The Capture Collection","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object contains information only about the last capture.","pos":[28958,29062],"source":"The <xref:System.Text.RegularExpressions.Group> object contains information only about the last capture."},{"content":"However, the entire set of captures made by a capturing group is still available from the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object that is returned by the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[29063,29334],"source":" However, the entire set of captures made by a capturing group is still available from the <xref:System.Text.RegularExpressions.CaptureCollection> object that is returned by the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property."},{"content":"Each member of the collection is a <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Capture&gt;</ph> object that represents a capture made by that capturing group, in the order in which they were captured (and, therefore, in the order in which the captured strings were matched from left to right in the input string).","pos":[29335,29633],"source":" Each member of the collection is a <xref:System.Text.RegularExpressions.Capture> object that represents a capture made by that capturing group, in the order in which they were captured (and, therefore, in the order in which the captured strings were matched from left to right in the input string)."},{"content":"You can retrieve individual <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Capture&gt;</ph> objects from the collection in either of two ways:","pos":[29634,29758],"source":" You can retrieve individual <xref:System.Text.RegularExpressions.Capture> objects from the collection in either of two ways:"},{"pos":[29768,29880],"content":"By iterating through the collection using a construct such as <ph id=\"ph1\">`foreach`</ph> (in C#) or <ph id=\"ph2\">`For Each`</ph> (in Visual Basic).","source":"By iterating through the collection using a construct such as `foreach` (in C#) or `For Each` (in Visual Basic)."},{"content":"By using the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType&gt;</ph> property to retrieve a specific object by index.","pos":[29890,30044],"source":"By using the <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific object by index."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.CaptureCollection.Item%2A&gt;</ph> property is the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object's default property (in Visual Basic) or indexer (in C#).","pos":[30045,30248],"source":" The <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> property is the <xref:System.Text.RegularExpressions.CaptureCollection> object's default property (in Visual Basic) or indexer (in C#)."},{"content":"If a quantifier is not applied to a capturing group, the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object contains a single <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Capture&gt;</ph> object that is of little interest, because it provides information about the same match as its <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object.","pos":[30255,30585],"source":"If a quantifier is not applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains a single <xref:System.Text.RegularExpressions.Capture> object that is of little interest, because it provides information about the same match as its <xref:System.Text.RegularExpressions.Group> object."},{"content":"If a quantifier is applied to a capturing group, the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object contains all captures made by the capturing group, and the last member of the collection represents the same capture as the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object.","pos":[30586,30877],"source":" If a quantifier is applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains all captures made by the capturing group, and the last member of the collection represents the same capture as the <xref:System.Text.RegularExpressions.Group> object."},{"pos":[30884,31205],"content":"For example, if you use the regular expression pattern <ph id=\"ph1\">`((a(b))c)+`</ph> (where the + quantifier specifies one or more matches) to capture matches from the string \"abcabcabc\", the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.CaptureCollection&gt;</ph> object for each <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Group&gt;</ph> object contains three members.","source":"For example, if you use the regular expression pattern `((a(b))c)+` (where the + quantifier specifies one or more matches) to capture matches from the string \"abcabcabc\", the <xref:System.Text.RegularExpressions.CaptureCollection> object for each <xref:System.Text.RegularExpressions.Group> object contains three members."},{"pos":[31212,31575],"content":"[!code-csharp[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capturecollection1.cs#14)]\n[!code-vb[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capturecollection1.vb#14)]","leadings":[""," "],"nodes":[]},{"content":"The following example uses the regular expression <ph id=\"ph1\">`(Abc)+`</ph> to find one or more consecutive runs of the string \"Abc\" in the string \"XYZAbcAbcAbcXYZAbcAb\".","pos":[31582,31735],"source":"The following example uses the regular expression `(Abc)+` to find one or more consecutive runs of the string \"Abc\" in the string \"XYZAbcAbcAbcXYZAbcAb\"."},{"content":"The example illustrates the use of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType&gt;</ph> property to return multiple groups of captured substrings.","pos":[31736,31918],"source":" The example illustrates the use of the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property to return multiple groups of captured substrings."},{"pos":[31925,32202],"content":"[!code-csharp[RegularExpressions.Classes#5](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#5)]\n[!code-vb[RegularExpressions.Classes#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#5)]","leadings":[""," "],"nodes":[]},{"pos":[32209,32237],"content":"<bpt id=\"p1\">[</bpt>Back to top<ept id=\"p1\">](#introduction)</ept>","source":"[Back to top](#introduction)"},{"pos":[32287,32309],"content":"The Individual Capture","linkify":"The Individual Capture","nodes":[{"content":"The Individual Capture","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Capture&gt;</ph> class contains the results from a single subexpression capture.","pos":[32313,32426],"source":"The <xref:System.Text.RegularExpressions.Capture> class contains the results from a single subexpression capture."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType&gt;</ph> property contains the matched text, and the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType&gt;</ph> property indicates the zero-based position in the input string at which the matched substring begins.","pos":[32427,32744],"source":" The <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> property contains the matched text, and the <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> property indicates the zero-based position in the input string at which the matched substring begins."},{"content":"The following example parses an input string for the temperature of selected cities.","pos":[32751,32835]},{"content":"A comma (\",\") is used to separate a city and its temperature, and a semicolon (\";\") is used to separate each city's data.","pos":[32836,32957]},{"content":"The entire input string represents a single match.","pos":[32958,33008]},{"content":"In the regular expression pattern <ph id=\"ph1\">`((\\w+(\\s\\w+)*),(\\d+);)+`</ph>, which is used to parse the string, the city name is assigned to the second capturing group, and the temperature is assigned to the fourth capturing group.","pos":[33009,33224],"source":" In the regular expression pattern `((\\w+(\\s\\w+)*),(\\d+);)+`, which is used to parse the string, the city name is assigned to the second capturing group, and the temperature is assigned to the fourth capturing group."},{"content":"The regular expression is defined as shown in the following table.","pos":[33581,33647]},{"content":"Pattern","pos":[33654,33661]},{"content":"Description","pos":[33662,33673]},{"content":"Match one or more word characters.","pos":[33720,33754]},{"content":"Match zero or more occurrences of a white-space character followed by one or more word characters.","pos":[33770,33868]},{"content":"This pattern matches multi-word city names.","pos":[33869,33912]},{"content":"This is the third capturing group.","pos":[33913,33947]},{"content":"Match one or more word characters followed by zero or more occurrences of a white-space character and one or more word characters.","pos":[33968,34098]},{"content":"This is the second capturing group.","pos":[34099,34134]},{"content":"Match a comma.","pos":[34143,34157]},{"content":"Match one or more digits.","pos":[34170,34195]},{"content":"This is the fourth capturing group.","pos":[34196,34231]},{"content":"Match a semicolon.","pos":[34240,34258]},{"content":"Match the pattern of a word followed by any additional words followed by a comma, one or more digits, and a semicolon, one or more times.","pos":[34289,34426]},{"content":"This is the first capturing group.","pos":[34427,34461]},{"pos":[34471,34479],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[34523,34607],"content":"<bpt id=\"p1\">[</bpt>.NET Regular Expressions<ept id=\"p1\">](../../../docs/standard/base-types/regular-expressions.md)</ept>","source":"[.NET Regular Expressions](../../../docs/standard/base-types/regular-expressions.md)"},{"pos":[34610,34739],"content":"<bpt id=\"p1\">[</bpt>Regular Expression Language - Quick Reference<ept id=\"p1\">](../../../docs/standard/base-types/regular-expression-language-quick-reference.md)</ept>","source":"[Regular Expression Language - Quick Reference](../../../docs/standard/base-types/regular-expression-language-quick-reference.md)"}]}