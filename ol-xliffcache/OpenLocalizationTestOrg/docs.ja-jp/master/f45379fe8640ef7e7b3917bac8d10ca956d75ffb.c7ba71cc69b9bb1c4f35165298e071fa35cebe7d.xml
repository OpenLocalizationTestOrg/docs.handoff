{"content":"---\ntitle: \"IHostSecurityManager Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"IHostSecurityManager\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostSecurityManager\"\nhelpviewer_keywords: \n  - \"IHostSecurityManager interface [.NET Framework hosting]\"\nms.assetid: c3be2cbd-2d93-438b-9888-9a0251b63c03\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# IHostSecurityManager Interface\nProvides methods that allow access to and control over the security context of the currently executing thread.  \n  \n## Methods  \n  \n|Method|Description|  \n|------------|-----------------|  \n|[GetSecurityContext Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md)|Gets the requested [IHostSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md) from the host.|  \n|[ImpersonateLoggedOnUser Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-impersonateloggedonuser-method.md)|Requests that code be executed using the credentials of the current user identity.|  \n|[OpenThreadToken Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-openthreadtoken-method.md)|Opens the discretionary access token associated with the current thread.|  \n|[RevertToSelf Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-reverttoself-method.md)|Terminates impersonation of the current user identity and returns the original thread token.|  \n|[SetSecurityContext Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setsecuritycontext-method.md)|Sets the security context for the currently executing thread.|  \n|[SetThreadToken Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setthreadtoken-method.md)|Sets a handle for the currently executing thread.|  \n  \n## Remarks  \n A host can control all code access to thread tokens by both the common language runtime (CLR) and user code. It can also ensure that complete security context information is passed across asynchronous operations or code points with restricted code access. `IHostSecurityContext` encapsulates this security context information, which is opaque to the CLR.  \n  \n The CLR handles managed thread context internally. It queries the process-specific `IHostSecurityManager` in the following situations:  \n  \n-   On the finalizer thread, during finalizer execution.  \n  \n-   During class and module constructor execution.  \n  \n-   At asynchronous points on the worker thread, in calls to the [IHostThreadPoolManager::QueueUserWorkItem](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-queueuserworkitem-method.md) method.  \n  \n-   In servicing of I/O completion ports.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See also\n\n- [IHostSecurityContext Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)\n- [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)\n","nodes":[{"pos":[4,397],"embed":true,"restype":"x-metadata","content":"title: \"IHostSecurityManager Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"IHostSecurityManager\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostSecurityManager\"\nhelpviewer_keywords: \n  - \"IHostSecurityManager interface [.NET Framework hosting]\"\nms.assetid: c3be2cbd-2d93-438b-9888-9a0251b63c03\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"IHostSecurityManager Interface","nodes":[{"pos":[0,30],"content":"IHostSecurityManager Interface","nodes":[{"content":"IHostSecurityManager Interface","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[404,434],"content":"IHostSecurityManager Interface","linkify":"IHostSecurityManager Interface","nodes":[{"content":"IHostSecurityManager Interface","pos":[0,30]}]},{"content":"Provides methods that allow access to and control over the security context of the currently executing thread.","pos":[435,545]},{"pos":[554,561],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"content":"Method","pos":[568,574]},{"content":"Description","pos":[575,586]},{"pos":[626,753],"content":"<bpt id=\"p1\">[</bpt>GetSecurityContext Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md)</ept>","source":"[GetSecurityContext Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md)"},{"pos":[754,894],"content":"Gets the requested <bpt id=\"p1\">[</bpt>IHostSecurityContext<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)</ept> from the host.","source":"Gets the requested [IHostSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md) from the host."},{"pos":[899,1036],"content":"<bpt id=\"p1\">[</bpt>ImpersonateLoggedOnUser Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-impersonateloggedonuser-method.md)</ept>","source":"[ImpersonateLoggedOnUser Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-impersonateloggedonuser-method.md)"},{"content":"Requests that code be executed using the credentials of the current user identity.","pos":[1037,1119]},{"pos":[1124,1245],"content":"<bpt id=\"p1\">[</bpt>OpenThreadToken Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-openthreadtoken-method.md)</ept>","source":"[OpenThreadToken Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-openthreadtoken-method.md)"},{"content":"Opens the discretionary access token associated with the current thread.","pos":[1246,1318]},{"pos":[1323,1438],"content":"<bpt id=\"p1\">[</bpt>RevertToSelf Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-reverttoself-method.md)</ept>","source":"[RevertToSelf Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-reverttoself-method.md)"},{"content":"Terminates impersonation of the current user identity and returns the original thread token.","pos":[1439,1531]},{"pos":[1536,1663],"content":"<bpt id=\"p1\">[</bpt>SetSecurityContext Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setsecuritycontext-method.md)</ept>","source":"[SetSecurityContext Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setsecuritycontext-method.md)"},{"content":"Sets the security context for the currently executing thread.","pos":[1664,1725]},{"pos":[1730,1849],"content":"<bpt id=\"p1\">[</bpt>SetThreadToken Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setthreadtoken-method.md)</ept>","source":"[SetThreadToken Method](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-setthreadtoken-method.md)"},{"content":"Sets a handle for the currently executing thread.","pos":[1850,1899]},{"pos":[1909,1916],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A host can control all code access to thread tokens by both the common language runtime (CLR) and user code.","pos":[1920,2028]},{"content":"It can also ensure that complete security context information is passed across asynchronous operations or code points with restricted code access.","pos":[2029,2175]},{"content":"<ph id=\"ph1\">`IHostSecurityContext`</ph> encapsulates this security context information, which is opaque to the CLR.","pos":[2176,2274],"source":"`IHostSecurityContext` encapsulates this security context information, which is opaque to the CLR."},{"content":"The CLR handles managed thread context internally.","pos":[2281,2331]},{"content":"It queries the process-specific <ph id=\"ph1\">`IHostSecurityManager`</ph> in the following situations:","pos":[2332,2415],"source":" It queries the process-specific `IHostSecurityManager` in the following situations:"},{"content":"On the finalizer thread, during finalizer execution.","pos":[2425,2477]},{"content":"During class and module constructor execution.","pos":[2487,2533]},{"pos":[2543,2756],"content":"At asynchronous points on the worker thread, in calls to the <bpt id=\"p1\">[</bpt>IHostThreadPoolManager::QueueUserWorkItem<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-queueuserworkitem-method.md)</ept> method.","source":"At asynchronous points on the worker thread, in calls to the [IHostThreadPoolManager::QueueUserWorkItem](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-queueuserworkitem-method.md) method."},{"content":"In servicing of I/O completion ports.","pos":[2766,2803]},{"pos":[2812,2824],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2828,2932],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2939,2960],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2967,3017],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3024,3132],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[3141,3149],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3153,3269],"content":"<bpt id=\"p1\">[</bpt>IHostSecurityContext Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)</ept>","source":"[IHostSecurityContext Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)"},{"pos":[3272,3364],"content":"<bpt id=\"p1\">[</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept>","source":"[Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)"}]}