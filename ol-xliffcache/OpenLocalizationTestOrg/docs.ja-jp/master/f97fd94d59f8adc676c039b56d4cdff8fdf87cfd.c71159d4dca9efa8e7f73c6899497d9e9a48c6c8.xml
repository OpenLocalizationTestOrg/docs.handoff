{"content":"---\ntitle: \"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: ec046283-9fe2-4440-b295-860bf700099d\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)\nSometimes you want to find the immediate preceding sibling to a node. Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)], this is one of the more interesting comparisons.  \n  \n## Example  \n In this example, the [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] query uses the <xref:System.Linq.Enumerable.Last%2A> operator to find the last node in the collection returned by <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A>. By contrast, the XPath expression uses a predicate with a value of 1 to find the immediately preceding element.  \n  \n```vb  \nDim root As XElement = _   \n    <Root>  \n        <Child1/>  \n        <Child2/>  \n        <Child3/>  \n        <Child4/>  \n    </Root>  \nDim child4 As XElement = root.Element(\"Child4\")  \n  \n' LINQ to XML query  \nDim el1 As XElement = child4.ElementsBeforeSelf().Last()  \n  \n' XPath expression  \nDim el2 As XElement = _  \n    DirectCast(child4.XPathEvaluate(\"preceding-sibling::*[1]\"),  _  \n    IEnumerable).Cast(Of XElement)().First()  \n  \nIf el1 Is el2 Then  \n    Console.WriteLine(\"Results are identical\")  \nElse  \n    Console.WriteLine(\"Results differ\")  \nEnd If  \nConsole.WriteLine(el1)  \n  \n```  \n  \n This example produces the following output:  \n  \n```  \nResults are identical  \n<Child3 />  \n```  \n  \n## See Also  \n [LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)","nodes":[{"pos":[12,108],"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","pos":[0,96]}]},{"pos":[415,494],"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","linkify":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","pos":[0,79]}]},{"content":"Sometimes you want to find the immediate preceding sibling to a node.","pos":[495,564]},{"content":"Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)]</ph>, this is one of the more interesting comparisons.","pos":[565,835],"source":" Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)], this is one of the more interesting comparisons."},{"pos":[844,851],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In this example, the <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)]</ph> query uses the <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Last%2A&gt;</ph> operator to find the last node in the collection returned by <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A&gt;</ph>.","pos":[855,1144],"source":"In this example, the [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] query uses the <xref:System.Linq.Enumerable.Last%2A> operator to find the last node in the collection returned by <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A>."},{"content":"By contrast, the XPath expression uses a predicate with a value of 1 to find the immediately preceding element.","pos":[1145,1256]},{"content":"This example produces the following output:","pos":[1874,1917]},{"pos":[1978,1986],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[1990,2123],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML for XPath Users (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)</ept>","source":"[LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)"}]}