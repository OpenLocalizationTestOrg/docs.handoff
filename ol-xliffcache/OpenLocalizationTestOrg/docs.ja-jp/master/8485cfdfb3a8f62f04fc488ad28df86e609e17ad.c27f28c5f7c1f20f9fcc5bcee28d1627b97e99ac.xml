{"content":"---\ntitle: \"How to: Configure Persistence with WorkflowServiceHost\"\nms.date: \"03/30/2017\"\nms.assetid: e31cd4df-13a3-4a9a-9be8-5243e0055356\n---\n# How to: Configure Persistence with WorkflowServiceHost\nThis topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> by using a configuration file. Before using the SQL Workflow Instance Store feature you must create a SQL database that is used to persist workflow instances. For more information, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md).  \n  \n### To Configure the SQL Workflow Instance Store in Configuration  \n  \n1.  The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through XML configuration. The following configuration example shows how to configure the SQL workflow instance store by using the <`sqlWorkflowInstanceStore`> behavior element in a configuration file.  \n  \n    ```xml  \n    <serviceBehaviors>  \n        <behavior name=\"\">  \n            <sqlWorkflowInstanceStore   \n                 connectionString=\"provider=System.Data.SqlClient;Data Source=(local);Initial Catalog=DefaultPersistenceProviderDb;Integrated Security=True;Async=true\"  \n                 instanceEncodingOption=\"GZip | None\"  \n                 instanceCompletionAction=\"DeleteAll | DeleteNothing\"  \n                 instanceLockedExceptionAction=\"NoRetry | SimpleRetry | AggressiveRetry\"  \n                 hostLockRenewalPeriod=\"00:00:30\"   \n                 runnableInstancesDetectionPeriod=\"00:00:05\">  \n            <sqlWorkflowInstanceStore/>  \n        </behavior>  \n    </serviceBehaviors>  \n    ```  \n  \n     For more information about how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md). For more information about the individual settings for the <`sqlWorkflowInstanceStore`> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md). Windows Server App Fabric provides its own persistence store. For more information, see [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121).  \n  \n    > [!NOTE]\n    >  The preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)  \n  \n### To Configure the SQL Workflow Instance Store in Code  \n  \n1.  The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through code. The following example shows how to configure the SQL workflow instance store by using the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element in a code  \n  \n    ```csharp  \n    host.Description.Behaviors.Add(new SqlWorkflowInstanceStoreBehavior  \n    {  \n       ConnectionString = \"provider=System.Data.SqlClient;Data Source=(local);Initial Catalog=DefaultPersistenceProviderDb;Integrated Security=True;Async=true\",  \n       InstanceEncodingOption = \"GZip | None\",  \n       InstanceCompletionAction = \"DeleteAll | DeleteNothing\",  \n       InstanceLockedExceptionAction = \"NoRetry | SimpleRetry | AggressiveRetry\",  \n       HostLockRenewalPeriod = new TimeSpan(00, 00, 30),  \n       RunnableInstancesDetectionPeriod = new TimeSpan(00, 00, 05)  \n    });  \n    ```  \n  \n     For more information about how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md). For more information about the individual settings for the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md). Windows Server App Fabric provides its own persistence store. For more information, see [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121).  \n  \n    > [!NOTE]\n    >  The preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)  \n  \n     For an example of how to configure persistence programmatically see [How to: Enable Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md).  \n  \n## See also\n\n- [Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md)\n- [Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)\n- [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121)\n","nodes":[{"pos":[4,138],"embed":true,"restype":"x-metadata","content":"title: \"How to: Configure Persistence with WorkflowServiceHost\"\nms.date: \"03/30/2017\"\nms.assetid: e31cd4df-13a3-4a9a-9be8-5243e0055356","nodes":[{"content":"How to: Configure Persistence with WorkflowServiceHost","nodes":[{"pos":[0,54],"content":"How to: Configure Persistence with WorkflowServiceHost","nodes":[{"content":"How to: Configure Persistence with WorkflowServiceHost","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[145,199],"content":"How to: Configure Persistence with WorkflowServiceHost","linkify":"How to: Configure Persistence with WorkflowServiceHost","nodes":[{"content":"How to: Configure Persistence with WorkflowServiceHost","pos":[0,54]}]},{"content":"This topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> by using a configuration file.","pos":[200,412],"source":"This topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> by using a configuration file."},{"content":"Before using the SQL Workflow Instance Store feature you must create a SQL database that is used to persist workflow instances.","pos":[413,540]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[541,761],"source":" For more information, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"pos":[771,832],"content":"To Configure the SQL Workflow Instance Store in Configuration","linkify":"To Configure the SQL Workflow Instance Store in Configuration","nodes":[{"content":"To Configure the SQL Workflow Instance Store in Configuration","pos":[0,61]}]},{"content":"The properties of the SQL workflow instance store can be configured through the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph>, a service behavior that allows you to change the settings through XML configuration.","pos":[842,1090],"source":"The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through XML configuration."},{"content":"The following configuration example shows how to configure the SQL workflow instance store by using the &lt;<ph id=\"ph1\">`sqlWorkflowInstanceStore`</ph>&gt; behavior element in a configuration file.","pos":[1091,1265],"source":" The following configuration example shows how to configure the SQL workflow instance store by using the <`sqlWorkflowInstanceStore`> behavior element in a configuration file."},{"content":"For more information about how to configure the SQL workflow instance store, see <bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[1993,2268],"source":"For more information about how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"content":"For more information about the individual settings for the &lt;<ph id=\"ph1\">`sqlWorkflowInstanceStore`</ph>&gt; behavior element, see <bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)</ept>.","pos":[2269,2496],"source":" For more information about the individual settings for the <`sqlWorkflowInstanceStore`> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)."},{"content":"Windows Server App Fabric provides its own persistence store.","pos":[2497,2558]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=193121)</ept>.","pos":[2559,2673],"source":" For more information, see [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121)."},{"pos":[2685,2879],"content":"[!NOTE]\nThe preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","leadings":["","    >  "],"nodes":[{"content":"The preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","pos":[8,187],"nodes":[{"content":"The preceding configuration example uses simplified configuration.","pos":[0,66]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Simplified Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/simplified-configuration.md)</ept>","pos":[67,179],"source":" For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)"}]}]},{"pos":[2889,2941],"content":"To Configure the SQL Workflow Instance Store in Code","linkify":"To Configure the SQL Workflow Instance Store in Code","nodes":[{"content":"To Configure the SQL Workflow Instance Store in Code","pos":[0,52]}]},{"content":"The properties of the SQL workflow instance store can be configured through the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph>, a service behavior that allows you to change the settings through code.","pos":[2951,3186],"source":"The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through code."},{"content":"The following example shows how to configure the SQL workflow instance store by using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph> behavior element in a code","pos":[3187,3386],"source":" The following example shows how to configure the SQL workflow instance store by using the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element in a code"},{"content":"For more information about how to configure the SQL workflow instance store, see <bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[4007,4282],"source":"For more information about how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"content":"For more information about the individual settings for the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph> behavior element, see <bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)</ept>.","pos":[4283,4564],"source":" For more information about the individual settings for the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)."},{"content":"Windows Server App Fabric provides its own persistence store.","pos":[4565,4626]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=193121)</ept>.","pos":[4627,4741],"source":" For more information, see [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121)."},{"pos":[4753,4947],"content":"[!NOTE]\nThe preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","leadings":["","    >  "],"nodes":[{"content":"The preceding configuration example uses simplified configuration. For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","pos":[8,187],"nodes":[{"content":"The preceding configuration example uses simplified configuration.","pos":[0,66]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Simplified Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/simplified-configuration.md)</ept>","pos":[67,179],"source":" For more information, see [Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)"}]}]},{"pos":[4958,5212],"content":"For an example of how to configure persistence programmatically see <bpt id=\"p1\">[</bpt>How to: Enable Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md)</ept>.","source":"For an example of how to configure persistence programmatically see [How to: Enable Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md)."},{"pos":[5221,5229],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5233,5321],"content":"<bpt id=\"p1\">[</bpt>Workflow Services<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/workflow-services.md)</ept>","source":"[Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md)"},{"pos":[5324,5426],"content":"<bpt id=\"p1\">[</bpt>Workflow Persistence<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)</ept>","source":"[Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)"},{"pos":[5429,5516],"content":"<bpt id=\"p1\">[</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=193121)</ept>","source":"[Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkId=193121)"}]}