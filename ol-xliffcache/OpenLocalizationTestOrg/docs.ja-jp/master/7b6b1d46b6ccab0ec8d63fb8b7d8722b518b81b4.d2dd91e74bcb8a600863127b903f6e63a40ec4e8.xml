{"content":"---\ntitle: \"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Windows functions, calling\"\n  - \"unsigned data types\"\n  - \"UShort data type, using\"\n  - \"functions [Visual Basic], calling Windows functions\"\n  - \"ULong data type, using\"\n  - \"UInteger data type, using\"\n  - \"data types [Visual Basic], using\"\n  - \"unsigned types\"\n  - \"data types [Visual Basic], unsigned\"\n  - \"data types [Visual Basic], numeric\"\n  - \"unsigned types, using\"\nms.assetid: c2c0e712-8dc2-43b9-b4c6-345fbb02e7ce\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Call a Windows Function that Takes Unsigned Types (Visual Basic)\nIf you are consuming a class, module, or structure that has members of unsigned integer types, you can access these members with [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)].  \n  \n### To call a Windows function that takes an unsigned type  \n  \n1.  Use a [Declare Statement](../../../visual-basic/language-reference/statements/declare-statement.md) to tell [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] which library holds the function, what its name is in that library, what its calling sequence is, and how to convert strings when calling it.  \n  \n2.  In the `Declare` statement, use `UInteger`, `ULong`, `UShort`, or `Byte` as appropriate for each parameter with an unsigned type.  \n  \n3.  Consult the documentation for the Windows function you are calling to find the names and values of the constants it uses. Many of these are defined in the WinUser.h file.  \n  \n4.  Declare the necessary constants in your code. Many Windows constants are 32-bit unsigned values, and you should declare these `As``UInteger`.  \n  \n5.  Call the function in the normal way. The following example calls the Windows function `MessageBox`, which takes an unsigned integer argument.  \n  \n    ```  \n    Public Class windowsMessage  \n        Private Declare Auto Function mb Lib \"user32.dll\" Alias \"MessageBox\" (  \n            ByVal hWnd As Integer,   \n            ByVal lpText As String,   \n            ByVal lpCaption As String,   \n            ByVal uType As UInteger) As Integer  \n        Private Const MB_OK As UInteger = 0  \n        Private Const MB_ICONEXCLAMATION As UInteger = &H30  \n        Private Const IDOK As UInteger = 1  \n        Private Const IDCLOSE As UInteger = 8  \n        Private Const c As UInteger = MB_OK Or MB_ICONEXCLAMATION  \n        Public Function messageThroughWindows() As String  \n            Dim r As Integer = mb(0, \"Click OK if you see this!\",   \n                \"Windows API call\", c)  \n            Dim s As String = \"Windows API MessageBox returned \" &  \n                 CStr(r)& vbCrLf & \"(IDOK = \" & CStr(IDOK) &  \n                 \", IDCLOSE = \" & CStr(IDCLOSE) & \")\"  \n            Return s  \n        End Function  \n    End Class  \n    ```  \n  \n     You can test the function `messageThroughWindows` with the following code.  \n  \n    ```  \n    Public Sub consumeWindowsMessage()  \n        Dim w As New windowsMessage  \n        w.messageThroughWindows()  \n    End Sub  \n    ```  \n  \n    > [!CAUTION]\n    >  The `UInteger`, `ULong`, `UShort`, and `SByte` data types are not part of the [Language Independence and Language-Independent Components](https://msdn.microsoft.com/library/12a7a7h3) (CLS), so CLS-compliant code cannot consume a component that uses them.  \n  \n    > [!IMPORTANT]\n    >  Making a call to unmanaged code, such as the Windows application programming interface (API), exposes your code to potential security risks.  \n  \n    > [!IMPORTANT]\n    >  Calling the Windows API requires unmanaged code permission, which might affect its execution in partial-trust situations. For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/en-us/e5ae402f-6dda-4732-bbe8-77296630f675).  \n  \n## See Also  \n [Data Types](../../../visual-basic/language-reference/data-types/data-type-summary.md)   \n [Integer Data Type](../../../visual-basic/language-reference/data-types/integer-data-type.md)   \n [UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)   \n [Declare Statement](../../../visual-basic/language-reference/statements/declare-statement.md)   \n [Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)","nodes":[{"pos":[4,968],"nodes":[{"content":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,89],"content":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic) | Microsoft Docs","nodes":[{"content":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic) | Microsoft Docs","pos":[0,89]}]}],"pos":[6,98],"yaml":true}],"content":"title: \"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Windows functions, calling\"\n  - \"unsigned data types\"\n  - \"UShort data type, using\"\n  - \"functions [Visual Basic], calling Windows functions\"\n  - \"ULong data type, using\"\n  - \"UInteger data type, using\"\n  - \"data types [Visual Basic], using\"\n  - \"unsigned types\"\n  - \"data types [Visual Basic], unsigned\"\n  - \"data types [Visual Basic], numeric\"\n  - \"unsigned types, using\"\nms.assetid: c2c0e712-8dc2-43b9-b4c6-345fbb02e7ce\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[975,1047],"content":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic)","linkify":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic)","nodes":[{"content":"How to: Call a Windows Function that Takes Unsigned Types (Visual Basic)","pos":[0,72]}]},{"pos":[1048,1267],"content":"If you are consuming a class, module, or structure that has members of unsigned integer types, you can access these members with <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>.","source":"If you are consuming a class, module, or structure that has members of unsigned integer types, you can access these members with [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]."},{"pos":[1277,1331],"content":"To call a Windows function that takes an unsigned type","linkify":"To call a Windows function that takes an unsigned type","nodes":[{"content":"To call a Windows function that takes an unsigned type","pos":[0,54]}]},{"pos":[1341,1680],"content":"Use a <bpt id=\"p1\">[</bpt>Declare Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/declare-statement.md)</ept> to tell <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> which library holds the function, what its name is in that library, what its calling sequence is, and how to convert strings when calling it.","source":"Use a [Declare Statement](../../../visual-basic/language-reference/statements/declare-statement.md) to tell [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] which library holds the function, what its name is in that library, what its calling sequence is, and how to convert strings when calling it."},{"pos":[1690,1819],"content":"In the <ph id=\"ph1\">`Declare`</ph> statement, use <ph id=\"ph2\">`UInteger`</ph>, <ph id=\"ph3\">`ULong`</ph>, <ph id=\"ph4\">`UShort`</ph>, or <ph id=\"ph5\">`Byte`</ph> as appropriate for each parameter with an unsigned type.","source":"In the `Declare` statement, use `UInteger`, `ULong`, `UShort`, or `Byte` as appropriate for each parameter with an unsigned type."},{"content":"Consult the documentation for the Windows function you are calling to find the names and values of the constants it uses.","pos":[1829,1950]},{"content":"Many of these are defined in the WinUser.h file.","pos":[1951,1999]},{"content":"Declare the necessary constants in your code.","pos":[2009,2054]},{"content":"Many Windows constants are 32-bit unsigned values, and you should declare these <ph id=\"ph1\">`As``UInteger`</ph>.","pos":[2055,2150],"source":" Many Windows constants are 32-bit unsigned values, and you should declare these `As``UInteger`."},{"content":"Call the function in the normal way.","pos":[2160,2196]},{"content":"The following example calls the Windows function <ph id=\"ph1\">`MessageBox`</ph>, which takes an unsigned integer argument.","pos":[2197,2301],"source":" The following example calls the Windows function `MessageBox`, which takes an unsigned integer argument."},{"pos":[3308,3382],"content":"You can test the function <ph id=\"ph1\">`messageThroughWindows`</ph> with the following code.","source":"You can test the function `messageThroughWindows` with the following code."},{"pos":[3546,3818],"content":"[!CAUTION]\nThe `UInteger`, `ULong`, `UShort`, and `SByte` data types are not part of the [Language Independence and Language-Independent Components](https://msdn.microsoft.com/library/12a7a7h3) (CLS), so CLS-compliant code cannot consume a component that uses them.","leadings":["","    >  "],"nodes":[{"content":"The <ph id=\"ph1\">`UInteger`</ph>, <ph id=\"ph2\">`ULong`</ph>, <ph id=\"ph3\">`UShort`</ph>, and <ph id=\"ph4\">`SByte`</ph> data types are not part of the <bpt id=\"p1\">[</bpt>Language Independence and Language-Independent Components<ept id=\"p1\">](https://msdn.microsoft.com/library/12a7a7h3)</ept> (CLS), so CLS-compliant code cannot consume a component that uses them.","pos":[11,265],"source":"The `UInteger`, `ULong`, `UShort`, and `SByte` data types are not part of the [Language Independence and Language-Independent Components](https://msdn.microsoft.com/library/12a7a7h3) (CLS), so CLS-compliant code cannot consume a component that uses them."}]},{"pos":[3830,3990],"content":"[!IMPORTANT]\nMaking a call to unmanaged code, such as the Windows application programming interface (API), exposes your code to potential security risks.","leadings":["","    >  "],"nodes":[{"content":"Making a call to unmanaged code, such as the Windows application programming interface (API), exposes your code to potential security risks.","pos":[13,153]}]},{"pos":[4002,4324],"content":"[!IMPORTANT]\nCalling the Windows API requires unmanaged code permission, which might affect its execution in partial-trust situations. For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/en-us/e5ae402f-6dda-4732-bbe8-77296630f675).","leadings":["","    >  "],"nodes":[{"content":"Calling the Windows API requires unmanaged code permission, which might affect its execution in partial-trust situations. For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/en-us/e5ae402f-6dda-4732-bbe8-77296630f675).","pos":[13,315],"nodes":[{"content":"Calling the Windows API requires unmanaged code permission, which might affect its execution in partial-trust situations.","pos":[0,121]},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Security.Permissions.SecurityPermission&gt;</ph> and <bpt id=\"p1\">[</bpt>Code Access Permissions<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e5ae402f-6dda-4732-bbe8-77296630f675)</ept>.","pos":[122,302],"source":" For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/en-us/e5ae402f-6dda-4732-bbe8-77296630f675)."}]}]},{"pos":[4333,4341],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Data Types<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/data-type-summary.md)</ept><ph id=\"ph1\"> </ph>","pos":[4345,4432],"source":"[Data Types](../../../visual-basic/language-reference/data-types/data-type-summary.md) "},{"content":"<bpt id=\"p1\">[</bpt>Integer Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/integer-data-type.md)</ept><ph id=\"ph1\"> </ph>","pos":[4436,4530],"source":"[Integer Data Type](../../../visual-basic/language-reference/data-types/integer-data-type.md) "},{"content":"<bpt id=\"p1\">[</bpt>UInteger Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)</ept><ph id=\"ph1\"> </ph>","pos":[4534,4630],"source":"[UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md) "},{"content":"<bpt id=\"p1\">[</bpt>Declare Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/declare-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[4634,4728],"source":"[Declare Statement](../../../visual-basic/language-reference/statements/declare-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Calling Windows APIs<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)</ept>","pos":[4732,4856],"source":"[Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)"}]}