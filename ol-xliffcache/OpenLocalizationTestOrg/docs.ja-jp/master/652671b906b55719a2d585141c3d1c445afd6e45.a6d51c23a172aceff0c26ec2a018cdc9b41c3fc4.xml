{"content":"---\ntitle: \"How to: Use Finally Blocks | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"exceptions, try/catch blocks\"\n  - \"exceptions, finally blocks\"\n  - \"try/catch blocks\"\n  - \"finally blocks\"\n  - \"ArgumentOutOfRangeException class\"\nms.assetid: 4b9c0137-04af-4468-91d1-b9014df8ddd2\ncaps.latest.revision: 9\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# How to use finally blocks\n\nWhen an exception occurs, execution stops and control is given to the appropriate exception handler. This often means that lines of code you expect to be executed are bypassed. Some resource cleanup, such as closing a file, needs to be done even if an exception is thrown. To do this, you can use a `finally` block. A `finally` block always executes, regardless of whether an exception is thrown.\n\nThe following code example uses a `try`/`catch` block to catch an @System.ArgumentOutOfRangeException. The `Main` method creates two arrays and attempts to copy one to the other. The action generates an @System.ArgumentOutOfRangeException and the error is written to the console. The `finally` block executes regardless of the outcome of the copy action.\n\n[!code-cpp[CodeTryCatchFinallyExample#3](../../../samples/snippets/cpp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CPP/source2.cpp#3)]\n[!code-csharp[CodeTryCatchFinallyExample#3](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CS/source2.cs#3)]\n[!code-vb[CodeTryCatchFinallyExample#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeTryCatchFinallyExample/VB/source2.vb#3)]  \n\n## See Also  \n[Exceptions](index.md)   \n","nodes":[{"pos":[4,510],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use Finally Blocks | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"exceptions, try/catch blocks\"\n  - \"exceptions, finally blocks\"\n  - \"try/catch blocks\"\n  - \"finally blocks\"\n  - \"ArgumentOutOfRangeException class\"\nms.assetid: 4b9c0137-04af-4468-91d1-b9014df8ddd2\ncaps.latest.revision: 9\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Use Finally Blocks | Microsoft Docs","nodes":[{"pos":[0,43],"content":"How to: Use Finally Blocks | Microsoft Docs","nodes":[{"content":"How to: Use Finally Blocks | Microsoft Docs","pos":[0,43]}]}],"path":["title"]}],"yml":true},{"pos":[517,542],"content":"How to use finally blocks","linkify":"How to use finally blocks","nodes":[{"content":"How to use finally blocks","pos":[0,25]}]},{"content":"When an exception occurs, execution stops and control is given to the appropriate exception handler.","pos":[544,644]},{"content":"This often means that lines of code you expect to be executed are bypassed.","pos":[645,720]},{"content":"Some resource cleanup, such as closing a file, needs to be done even if an exception is thrown.","pos":[721,816]},{"content":"To do this, you can use a <ph id=\"ph1\">`finally`</ph> block.","pos":[817,859],"source":" To do this, you can use a `finally` block."},{"content":"A <ph id=\"ph1\">`finally`</ph> block always executes, regardless of whether an exception is thrown.","pos":[860,940],"source":" A `finally` block always executes, regardless of whether an exception is thrown."},{"content":"The following code example uses a <ph id=\"ph1\">`try`</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">`catch`</ph> block to catch an <ph id=\"ph4\">@System.ArgumentOutOfRangeException</ph>.","pos":[942,1044],"source":"The following code example uses a `try`/`catch` block to catch an @System.ArgumentOutOfRangeException."},{"content":"The <ph id=\"ph1\">`Main`</ph> method creates two arrays and attempts to copy one to the other.","pos":[1045,1120],"source":" The `Main` method creates two arrays and attempts to copy one to the other."},{"content":"The action generates an <ph id=\"ph1\">@System.ArgumentOutOfRangeException</ph> and the error is written to the console.","pos":[1121,1221],"source":" The action generates an @System.ArgumentOutOfRangeException and the error is written to the console."},{"content":"The <ph id=\"ph1\">`finally`</ph> block executes regardless of the outcome of the copy action.","pos":[1222,1296],"source":" The `finally` block executes regardless of the outcome of the copy action."},{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>CodeTryCatchFinallyExample#3<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CPP/source2.cpp#3)</ept><ept id=\"p1\">]</ept>","pos":[1298,1431],"source":"[!code-cpp[CodeTryCatchFinallyExample#3](../../../samples/snippets/cpp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CPP/source2.cpp#3)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CodeTryCatchFinallyExample#3<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CS/source2.cs#3)</ept><ept id=\"p1\">]</ept>","pos":[1432,1569],"source":"[!code-csharp[CodeTryCatchFinallyExample#3](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeTryCatchFinallyExample/CS/source2.cs#3)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>CodeTryCatchFinallyExample#3<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeTryCatchFinallyExample/VB/source2.vb#3)</ept><ept id=\"p1\">]</ept>","pos":[1570,1708],"source":"[!code-vb[CodeTryCatchFinallyExample#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeTryCatchFinallyExample/VB/source2.vb#3)]"},{"pos":[1715,1723],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[1726,1748],"content":"<bpt id=\"p1\">[</bpt>Exceptions<ept id=\"p1\">](index.md)</ept>","source":"[Exceptions](index.md)"}]}