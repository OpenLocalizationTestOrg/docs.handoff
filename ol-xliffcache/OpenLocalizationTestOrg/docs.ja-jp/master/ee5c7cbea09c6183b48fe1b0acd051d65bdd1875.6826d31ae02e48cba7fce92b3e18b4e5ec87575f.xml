{"content":"---\ntitle: \"How to: Write Event Information to a Text File (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event logs [Visual Studio], writing event information\"\n  - \"text files [Visual Basic], writing event information to a text file\"\n  - \"events [Visual Basic], writing event information to a text file\"\nms.assetid: 9ca7cc03-bf99-4933-9e5e-61ee28e9a6b4\n---\n# How to: Write Event Information to a Text File (Visual Basic)\nYou can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application. This example shows how to use the `My.Application.Log.WriteEntry` method to log tracing information to a log file.  \n  \n### To add and configure the file log listener  \n  \n1.  Right-click app.config in **Solution Explorer** and choose **Open**.  \n  \n     \\- or -  \n  \n     If there is no app.config file:  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, choose **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Locate the `<listeners>` section in the application configuration file.  \n  \n     You will find the \\<listeners> section in the \\<source> section with the name attribute \"DefaultSource\", which is nested under the \\<system.diagnostics> section, which is nested under the top-level \\<configuration> section.  \n  \n3.  Add this element to that `<listeners>` section:  \n  \n    ```xml  \n    <add name=\"FileLogListener\" />  \n    ```  \n  \n4.  Locate the `<sharedListeners>` section in the `<system.diagnostics>` section, nested under the top-level `<configuration>` section.  \n  \n5.  Add this element to that `<sharedListeners>` section:  \n  \n    ```xml  \n    <add name=\"FileLogListener\"   \n        type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,   \n              Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,   \n              PublicKeyToken=b03f5f7f11d50a3a\"  \n        initializeData=\"FileLogListenerWriter\"  \n        location=\"Custom\"  \n        customlocation=\"c:\\temp\\\" />  \n    ```  \n  \n     Change the value of the `customlocation` attribute to the log directory.  \n  \n    > [!NOTE]\n    >  To set the value of a listener property, use an attribute that has the same name as the property, with all letters in the name lowercase. For example, the `location` and `customlocation` attributes set the values of the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.Location%2A> and <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.CustomLocation%2A> properties.  \n  \n### To write event information to the file log  \n  \n-   Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the file log. For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md).  \n  \n     After you configure the file log listener for an assembly, it receives all messages that `My.Application.Log` writes from that assembly.  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=nameWithType>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A>\n- [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)\n- [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)\n","nodes":[{"pos":[4,369],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write Event Information to a Text File (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event logs [Visual Studio], writing event information\"\n  - \"text files [Visual Basic], writing event information to a text file\"\n  - \"events [Visual Basic], writing event information to a text file\"\nms.assetid: 9ca7cc03-bf99-4933-9e5e-61ee28e9a6b4","nodes":[{"content":"How to: Write Event Information to a Text File (Visual Basic)","nodes":[{"pos":[0,61],"content":"How to: Write Event Information to a Text File (Visual Basic)","nodes":[{"content":"How to: Write Event Information to a Text File (Visual Basic)","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[376,437],"content":"How to: Write Event Information to a Text File (Visual Basic)","linkify":"How to: Write Event Information to a Text File (Visual Basic)","nodes":[{"content":"How to: Write Event Information to a Text File (Visual Basic)","pos":[0,61]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to log information about events that occur in your application.","pos":[438,559],"source":"You can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application."},{"content":"This example shows how to use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method to log tracing information to a log file.","pos":[560,674],"source":" This example shows how to use the `My.Application.Log.WriteEntry` method to log tracing information to a log file."},{"pos":[684,726],"content":"To add and configure the file log listener","linkify":"To add and configure the file log listener","nodes":[{"content":"To add and configure the file log listener","pos":[0,42]}]},{"pos":[736,804],"content":"Right-click app.config in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in **Solution Explorer** and choose **Open**."},{"content":"<ph id=\"ph1\">\\-</ph> or -","pos":[815,822],"source":"\\- or -"},{"content":"If there is no app.config file:","pos":[833,864]},{"pos":[878,927],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[941,1021],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[1035,1049],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"pos":[1059,1130],"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section in the application configuration file.","source":"Locate the `<listeners>` section in the application configuration file."},{"content":"You will find the <ph id=\"ph1\">\\&lt;</ph>listeners&gt; section in the <ph id=\"ph2\">\\&lt;</ph>source&gt; section with the name attribute \"DefaultSource\", which is nested under the <ph id=\"ph3\">\\&lt;</ph>system.diagnostics&gt; section, which is nested under the top-level <ph id=\"ph4\">\\&lt;</ph>configuration&gt; section.","pos":[1141,1364],"source":"You will find the \\<listeners> section in the \\<source> section with the name attribute \"DefaultSource\", which is nested under the \\<system.diagnostics> section, which is nested under the top-level \\<configuration> section."},{"pos":[1374,1421],"content":"Add this element to that <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section:","source":"Add this element to that `<listeners>` section:"},{"pos":[1494,1625],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, nested under the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section in the `<system.diagnostics>` section, nested under the top-level `<configuration>` section."},{"pos":[1635,1688],"content":"Add this element to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section:","source":"Add this element to that `<sharedListeners>` section:"},{"pos":[2068,2140],"content":"Change the value of the <ph id=\"ph1\">`customlocation`</ph> attribute to the log directory.","source":"Change the value of the `customlocation` attribute to the log directory."},{"pos":[2152,2548],"content":"[!NOTE]\nTo set the value of a listener property, use an attribute that has the same name as the property, with all letters in the name lowercase. For example, the `location` and `customlocation` attributes set the values of the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.Location%2A> and <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.CustomLocation%2A> properties.","leadings":["","    >  "],"nodes":[{"content":"To set the value of a listener property, use an attribute that has the same name as the property, with all letters in the name lowercase. For example, the `location` and `customlocation` attributes set the values of the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.Location%2A> and <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.CustomLocation%2A> properties.","pos":[8,389],"nodes":[{"content":"To set the value of a listener property, use an attribute that has the same name as the property, with all letters in the name lowercase.","pos":[0,137]},{"content":"For example, the <ph id=\"ph1\">`location`</ph> and <ph id=\"ph2\">`customlocation`</ph> attributes set the values of the <ph id=\"ph3\">&lt;xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.Location%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.CustomLocation%2A&gt;</ph> properties.","pos":[138,381],"source":" For example, the `location` and `customlocation` attributes set the values of the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.Location%2A> and <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.CustomLocation%2A> properties."}]}]},{"pos":[2558,2600],"content":"To write event information to the file log","linkify":"To write event information to the file log","nodes":[{"content":"To write event information to the file log","pos":[0,42]}]},{"content":"Use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> or <ph id=\"ph2\">`My.Application.Log.WriteException`</ph> method to write information to the file log.","pos":[2610,2733],"source":"Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the file log."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Write Log Messages<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Log Exceptions<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept>.","pos":[2734,2998],"source":" For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)."},{"pos":[3009,3145],"content":"After you configure the file log listener for an assembly, it receives all messages that <ph id=\"ph1\">`My.Application.Log`</ph> writes from that assembly.","source":"After you configure the file log listener for an assembly, it receives all messages that `My.Application.Log` writes from that assembly."},{"pos":[3154,3162],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3356,3483],"content":"<bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept>","source":"[Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)"},{"pos":[3486,3598],"content":"<bpt id=\"p1\">[</bpt>How to: Log Exceptions<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept>","source":"[How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)"}]}