{"content":"---\ntitle: \"Walkthrough: Hosting an ActiveX Control in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"ActiveX controls [WPF interoperability]\"\n  - \"hosting ActiveX controls\"\nms.assetid: 1931d292-0dd1-434f-963c-dcda7638d75a\ncaps.latest.revision: 30\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Hosting an ActiveX Control in WPF\nTo enable improved interaction with browsers, you can use [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] controls in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application. This walkthrough demonstrates how you can host the [!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)] as a control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page.  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Creating the project.  \n  \n-   Creating the ActiveX control.  \n  \n-   Hosting the ActiveX control on a WPF Page.  \n  \n When you have completed this walkthrough, you will understand how to use [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] controls in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application.  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)] installed on the computer where [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] is installed.  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n## Creating the Project  \n  \n#### To create and set up the project  \n  \n1.  Create a WPF Application project named `HostingAxInWpf`.  \n  \n2.  Add a Windows Forms Control Library project to the solution, and name the project `WmpAxLib`.  \n  \n3.  In the WmpAxLib project, add a reference to the Windows Media Player assembly, which is named wmp.dll.  \n  \n4.  Open the **Toolbox**.  \n  \n5.  Right-click in the **Toolbox**, and then click **Choose Items**.  \n  \n6.  Click the **COM Components** tab, select the **Windows Media Player** control, and then click **OK**.  \n  \n     The Windows Media Player control is added to the **Toolbox**.  \n  \n7.  In Solution Explorer, right-click the **UserControl1** file, and then click **Rename**.  \n  \n8.  Change the name to `WmpAxControl.vb` or `WmpAxControl.cs`, depending on the language.  \n  \n9. If you are prompted to rename all references, click **Yes**.  \n  \n## Creating the ActiveX Control  \n [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)] automatically generates an <xref:System.Windows.Forms.AxHost> wrapper class for a [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] control when the control is added to a design surface. The following procedure creates a managed assembly named AxInterop.WMPLib.dll.  \n  \n#### To create the ActiveX control  \n  \n1.  Open WmpAxControl.vb or WmpAxControl.cs in the Windows Forms Designer.  \n  \n2.  From the **Toolbox**, add the Windows Media Player control to the design surface.  \n  \n3.  In the Properties window, set the value of the Windows Media Player control's <xref:System.Windows.Forms.Control.Dock%2A> property to <xref:System.Windows.Forms.DockStyle>.  \n  \n4.  Build the WmpAxLib control library project.  \n  \n## Hosting the ActiveX Control on a WPF Page  \n  \n#### To host the ActiveX control  \n  \n1.  In the HostingAxInWpf project, add a reference to the generated [!INCLUDE[TLA2#tla_actx](../../../../includes/tla2sharptla-actx-md.md)] interoperability assembly.  \n  \n     This assembly is named AxInterop.WMPLib.dll and was added to the Debug folder of the WmpAxLib project when you imported the Windows Media Player control.  \n  \n2.  Add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.  \n  \n3.  Add a reference to the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] assembly, which is named System.Windows.Forms.dll.  \n  \n4.  Open MainWindow.xaml in the WPF Designer.  \n  \n5.  Name the <xref:System.Windows.Controls.Grid> element `grid1`.  \n  \n     [!code-xml[HostingAxInWpf#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingAxInWpf/CSharp/HostingAxInWpf/window1.xaml#1)]  \n  \n6.  In Design view or XAML view, select the <xref:System.Windows.Window> element.  \n  \n7.  In the Properties window, click the **Events** tab.  \n  \n8.  Double-click the <xref:System.Windows.FrameworkElement.Loaded> event.  \n  \n9. Insert the following code to handle the <xref:System.Windows.FrameworkElement.Loaded> event.  \n  \n     This code creates an instance of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control and adds an instance of the `AxWindowsMediaPlayer` control as its child.  \n  \n     [!code-csharp[HostingAxInWpf#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingAxInWpf/CSharp/HostingAxInWpf/window1.xaml.cs#11)]\n     [!code-vb[HostingAxInWpf#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingAxInWpf/VisualBasic/HostingAxInWpf/window1.xaml.vb#11)]  \n  \n10. Press F5 to build and run the application.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)   \n [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)   \n [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)","nodes":[{"pos":[4,475],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting an ActiveX Control in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"ActiveX controls [WPF interoperability]\"\n  - \"hosting ActiveX controls\"\nms.assetid: 1931d292-0dd1-434f-963c-dcda7638d75a\ncaps.latest.revision: 30\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Hosting an ActiveX Control in WPF | Microsoft Docs","nodes":[{"pos":[0,63],"content":"Walkthrough: Hosting an ActiveX Control in WPF | Microsoft Docs","nodes":[{"content":"Walkthrough: Hosting an ActiveX Control in WPF | Microsoft Docs","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[482,528],"content":"Walkthrough: Hosting an ActiveX Control in WPF","linkify":"Walkthrough: Hosting an ActiveX Control in WPF","nodes":[{"content":"Walkthrough: Hosting an ActiveX Control in WPF","pos":[0,46]}]},{"content":"To enable improved interaction with browsers, you can use <ph id=\"ph1\">[!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)]</ph> controls in your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>-based application.","pos":[529,774],"source":"To enable improved interaction with browsers, you can use [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] controls in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application."},{"content":"This walkthrough demonstrates how you can host the <ph id=\"ph1\">[!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)]</ph> as a control on a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page.","pos":[775,999],"source":" This walkthrough demonstrates how you can host the [!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)] as a control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page."},{"content":"Tasks illustrated in this walkthrough include:","pos":[1006,1052]},{"content":"Creating the project.","pos":[1062,1083]},{"content":"Creating the ActiveX control.","pos":[1093,1122]},{"content":"Hosting the ActiveX control on a WPF Page.","pos":[1132,1174]},{"pos":[1181,1441],"content":"When you have completed this walkthrough, you will understand how to use <ph id=\"ph1\">[!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)]</ph> controls in your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>-based application.","source":"When you have completed this walkthrough, you will understand how to use [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] controls in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application."},{"pos":[1450,1463],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1467,1530]},{"pos":[1540,1707],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)]</ph> installed on the computer where <ph id=\"ph2\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> is installed.","source":"[!INCLUDE[TLA#tla_wmp](../../../../includes/tlasharptla-wmp-md.md)] installed on the computer where [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] is installed."},{"pos":[1717,1785],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]."},{"pos":[1794,1814],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"pos":[1825,1857],"content":"To create and set up the project","linkify":"To create and set up the project","nodes":[{"content":"To create and set up the project","pos":[0,32]}]},{"pos":[1867,1923],"content":"Create a WPF Application project named <ph id=\"ph1\">`HostingAxInWpf`</ph>.","source":"Create a WPF Application project named `HostingAxInWpf`."},{"pos":[1933,2026],"content":"Add a Windows Forms Control Library project to the solution, and name the project <ph id=\"ph1\">`WmpAxLib`</ph>.","source":"Add a Windows Forms Control Library project to the solution, and name the project `WmpAxLib`."},{"content":"In the WmpAxLib project, add a reference to the Windows Media Player assembly, which is named wmp.dll.","pos":[2036,2138]},{"pos":[2148,2169],"content":"Open the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","source":"Open the **Toolbox**."},{"pos":[2179,2243],"content":"Right-click in the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Choose Items<ept id=\"p2\">**</ept>.","source":"Right-click in the **Toolbox**, and then click **Choose Items**."},{"pos":[2253,2354],"content":"Click the <bpt id=\"p1\">**</bpt>COM Components<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Windows Media Player<ept id=\"p2\">**</ept> control, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Click the **COM Components** tab, select the **Windows Media Player** control, and then click **OK**."},{"pos":[2365,2426],"content":"The Windows Media Player control is added to the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","source":"The Windows Media Player control is added to the **Toolbox**."},{"pos":[2436,2523],"content":"In Solution Explorer, right-click the <bpt id=\"p1\">**</bpt>UserControl1<ept id=\"p1\">**</ept> file, and then click <bpt id=\"p2\">**</bpt>Rename<ept id=\"p2\">**</ept>.","source":"In Solution Explorer, right-click the **UserControl1** file, and then click **Rename**."},{"pos":[2533,2618],"content":"Change the name to <ph id=\"ph1\">`WmpAxControl.vb`</ph> or <ph id=\"ph2\">`WmpAxControl.cs`</ph>, depending on the language.","source":"Change the name to `WmpAxControl.vb` or `WmpAxControl.cs`, depending on the language."},{"pos":[2627,2687],"content":"If you are prompted to rename all references, click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>.","source":"If you are prompted to rename all references, click **Yes**."},{"pos":[2696,2724],"content":"Creating the ActiveX Control","linkify":"Creating the ActiveX Control","nodes":[{"content":"Creating the ActiveX Control","pos":[0,28]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)]</ph> automatically generates an <ph id=\"ph2\">&lt;xref:System.Windows.Forms.AxHost&gt;</ph> wrapper class for a <ph id=\"ph3\">[!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)]</ph> control when the control is added to a design surface.","pos":[2728,3014],"source":"[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)] automatically generates an <xref:System.Windows.Forms.AxHost> wrapper class for a [!INCLUDE[TLA#tla_actx](../../../../includes/tlasharptla-actx-md.md)] control when the control is added to a design surface."},{"content":"The following procedure creates a managed assembly named AxInterop.WMPLib.dll.","pos":[3015,3093]},{"pos":[3104,3133],"content":"To create the ActiveX control","linkify":"To create the ActiveX control","nodes":[{"content":"To create the ActiveX control","pos":[0,29]}]},{"content":"Open WmpAxControl.vb or WmpAxControl.cs in the Windows Forms Designer.","pos":[3143,3213]},{"pos":[3223,3304],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, add the Windows Media Player control to the design surface.","source":"From the **Toolbox**, add the Windows Media Player control to the design surface."},{"pos":[3314,3486],"content":"In the Properties window, set the value of the Windows Media Player control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Dock%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DockStyle&gt;</ph>.","source":"In the Properties window, set the value of the Windows Media Player control's <xref:System.Windows.Forms.Control.Dock%2A> property to <xref:System.Windows.Forms.DockStyle>."},{"content":"Build the WmpAxLib control library project.","pos":[3496,3539]},{"pos":[3548,3589],"content":"Hosting the ActiveX Control on a WPF Page","linkify":"Hosting the ActiveX Control on a WPF Page","nodes":[{"content":"Hosting the ActiveX Control on a WPF Page","pos":[0,41]}]},{"pos":[3600,3627],"content":"To host the ActiveX control","linkify":"To host the ActiveX control","nodes":[{"content":"To host the ActiveX control","pos":[0,27]}]},{"pos":[3637,3799],"content":"In the HostingAxInWpf project, add a reference to the generated <ph id=\"ph1\">[!INCLUDE[TLA2#tla_actx](../../../../includes/tla2sharptla-actx-md.md)]</ph> interoperability assembly.","source":"In the HostingAxInWpf project, add a reference to the generated [!INCLUDE[TLA2#tla_actx](../../../../includes/tla2sharptla-actx-md.md)] interoperability assembly."},{"content":"This assembly is named AxInterop.WMPLib.dll and was added to the Debug folder of the WmpAxLib project when you imported the Windows Media Player control.","pos":[3810,3963]},{"content":"Add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.","pos":[3973,4073]},{"pos":[4083,4234],"content":"Add a reference to the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> assembly, which is named System.Windows.Forms.dll.","source":"Add a reference to the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] assembly, which is named System.Windows.Forms.dll."},{"content":"Open MainWindow.xaml in the WPF Designer.","pos":[4244,4285]},{"pos":[4295,4356],"content":"Name the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element <ph id=\"ph2\">`grid1`</ph>.","source":"Name the <xref:System.Windows.Controls.Grid> element `grid1`."},{"pos":[4511,4588],"content":"In Design view or XAML view, select the <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element.","source":"In Design view or XAML view, select the <xref:System.Windows.Window> element."},{"pos":[4598,4649],"content":"In the Properties window, click the <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> tab.","source":"In the Properties window, click the **Events** tab."},{"pos":[4659,4728],"content":"Double-click the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","source":"Double-click the <xref:System.Windows.FrameworkElement.Loaded> event."},{"pos":[4737,4829],"content":"Insert the following code to handle the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","source":"Insert the following code to handle the <xref:System.Windows.FrameworkElement.Loaded> event."},{"pos":[4840,5014],"content":"This code creates an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control and adds an instance of the <ph id=\"ph2\">`AxWindowsMediaPlayer`</ph> control as its child.","source":"This code creates an instance of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control and adds an instance of the `AxWindowsMediaPlayer` control as its child."},{"pos":[5025,5321],"content":"[!code-csharp[HostingAxInWpf#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingAxInWpf/CSharp/HostingAxInWpf/window1.xaml.cs#11)]\n  [!code-vb[HostingAxInWpf#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingAxInWpf/VisualBasic/HostingAxInWpf/window1.xaml.vb#11)]","leadings":["","   "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[5331,5373]},{"pos":[5382,5390],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept><ph id=\"ph1\"> </ph>","pos":[5511,5596],"source":"[WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[5600,5769],"source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","pos":[5773,5941],"source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"}]}