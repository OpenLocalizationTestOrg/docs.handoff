{"content":"---\ntitle: \"How to: Register and Configure a Service Moniker\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [WCF], configure service monikers\"\n  - \"COM [WCF], register service monikers\"\nms.assetid: e5e16c80-8a8e-4eef-af53-564933b651ef\n---\n# How to: Register and Configure a Service Moniker\nBefore using the Windows Communication Foundation (WCF) service moniker within a COM application with a typed contract, you must register the required attributed types with COM, and configure the COM application and the moniker with the required binding configuration.  \n  \n### To register the required attributed types with COM  \n  \n1.  Use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) tool to retrieve the metadata contract from the WCF service. This generates the source code for a WCF client assembly and a client application configuration file.  \n  \n2.  Ensure that the types in the assembly are marked as `ComVisible`. To do so, add the following attribute to the AssemblyInfo.cs file in your Visual Studio project.  \n  \n    ```  \n    [assembly: ComVisible(true)]  \n    ```  \n  \n3.  Compile the managed WCF client as a strong-named assembly. This requires signing with a cryptographic key pair. For more information, see [Signing an Assembly with a Strong Name](https://go.microsoft.com/fwlink/?LinkId=94874) in the .NET Developer's Guide.  \n  \n4.  Use the Assembly Registration (Regasm.exe) tool with the `/tlb` option to register the types in the assembly with COM.  \n  \n5.  Use the Global Assembly Cache (Gacutil.exe) tool to add the assembly to the global assembly cache.  \n  \n    > [!NOTE]\n    >  Signing the assembly and adding it to the Global Assembly Cache are optional steps, but they can simplify the process of loading the assembly from the correct location at runtime.  \n  \n### To configure the COM application and the moniker with the required binding configuration  \n  \n-   Place the binding definitions (generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) in the generated client application configuration file) in the client application's configuration file. For example, for a Visual Basic 6.0 executable named CallCenterClient.exe, the configuration should be placed in a file named CallCenterConfig.exe.config within the same directory as the executable. The client application can now use the moniker. Note that the binding configuration is not required if using one of the standard binding types provided by WCF.  \n  \n     The following type is registered.  \n  \n    ```  \n    using System.ServiceModel;  \n  \n    ...  \n  \n    [ServiceContract]   \n    public interface IMathService   \n    {  \n    [OperationContract]  \n    public int Add(int x, int y);  \n    [OperationContract]  \n    public int Subtract(int x, int y);  \n    }  \n    ```  \n  \n     The application is exposed using a `wsHttpBinding` binding. For the given type and application configuration, the following example moniker strings are used.  \n  \n    ```  \n    service4:address=http://localhost/MathService, binding=wsHttpBinding, bindingConfiguration=Binding1  \n    ```  \n  \n     `or`  \n  \n    ```  \n    service4:address=http://localhost/MathService, binding=wsHttpBinding, bindingConfiguration=Binding1, contract={36ADAD5A-A944-4d5c-9B7C-967E4F00A090}  \n    ```  \n  \n     You can use either of these moniker strings from within a Visual Basic 6.0 application, after adding a reference to the assembly that contains the `IMathService` types, as shown in the following sample code.  \n  \n    ```  \n    Dim MathProxy As IMathService  \n    Dim result As Integer  \n  \n    Set MathProxy = GetObject( _  \n            \"service4:address=http://localhost/MathService, _  \n            binding=wsHttpBinding, _  \n            bindingConfiguration=Binding1\")  \n  \n    result = MathProxy.Add(3, 5)  \n    ```  \n  \n     In this example, the definition for the binding configuration `Binding1` is stored in a suitably named configuration file for the client application, such as vb6appname.exe.config.  \n  \n    > [!NOTE]\n    >  You can use similar code in a C#, a C++, or any other .NET Language application.  \n  \n    > [!NOTE]\n    >  : If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error of \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.  \n  \n     Although this topic focuses on using the service moniker from VB 6.0 code, you can use a service moniker from other languages. When using a moniker from C++ code the Svcutil.exe generated assembly should be imported with \"no_namespace named_guids raw_interfaces_only\" as shown in the following code.  \n  \n    ```  \n    #import \"ComTestProxy.tlb\" no_namespace named_guids  \n    ```  \n  \n     This modifies the imported interface definitions so that all methods return an `HResult`. Any other return values are converted into out parameters. The overall execution of the methods remains the same. This allows you to determine the cause of an exception when calling a method on the proxy. This functionality is only available from C++ code.  \n  \n## See also\n\n- [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)\n","nodes":[{"pos":[4,241],"embed":true,"restype":"x-metadata","content":"title: \"How to: Register and Configure a Service Moniker\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [WCF], configure service monikers\"\n  - \"COM [WCF], register service monikers\"\nms.assetid: e5e16c80-8a8e-4eef-af53-564933b651ef","nodes":[{"content":"How to: Register and Configure a Service Moniker","nodes":[{"pos":[0,48],"content":"How to: Register and Configure a Service Moniker","nodes":[{"content":"How to: Register and Configure a Service Moniker","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[248,296],"content":"How to: Register and Configure a Service Moniker","linkify":"How to: Register and Configure a Service Moniker","nodes":[{"content":"How to: Register and Configure a Service Moniker","pos":[0,48]}]},{"content":"Before using the Windows Communication Foundation (WCF) service moniker within a COM application with a typed contract, you must register the required attributed types with COM, and configure the COM application and the moniker with the required binding configuration.","pos":[297,565]},{"pos":[575,625],"content":"To register the required attributed types with COM","linkify":"To register the required attributed types with COM","nodes":[{"content":"To register the required attributed types with COM","pos":[0,50]}]},{"content":"Use the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> tool to retrieve the metadata contract from the WCF service.","pos":[635,836],"source":"Use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) tool to retrieve the metadata contract from the WCF service."},{"content":"This generates the source code for a WCF client assembly and a client application configuration file.","pos":[837,938]},{"content":"Ensure that the types in the assembly are marked as <ph id=\"ph1\">`ComVisible`</ph>.","pos":[948,1013],"source":"Ensure that the types in the assembly are marked as `ComVisible`."},{"content":"To do so, add the following attribute to the AssemblyInfo.cs file in your Visual Studio project.","pos":[1014,1110]},{"content":"Compile the managed WCF client as a strong-named assembly.","pos":[1178,1236]},{"content":"This requires signing with a cryptographic key pair.","pos":[1237,1289]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Signing an Assembly with a Strong Name<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=94874)</ept> in the .NET Developer's Guide.","pos":[1290,1434],"source":" For more information, see [Signing an Assembly with a Strong Name](https://go.microsoft.com/fwlink/?LinkId=94874) in the .NET Developer's Guide."},{"pos":[1444,1562],"content":"Use the Assembly Registration (Regasm.exe) tool with the <ph id=\"ph1\">`/tlb`</ph> option to register the types in the assembly with COM.","source":"Use the Assembly Registration (Regasm.exe) tool with the `/tlb` option to register the types in the assembly with COM."},{"content":"Use the Global Assembly Cache (Gacutil.exe) tool to add the assembly to the global assembly cache.","pos":[1572,1670]},{"pos":[1682,1876],"content":"[!NOTE]\nSigning the assembly and adding it to the Global Assembly Cache are optional steps, but they can simplify the process of loading the assembly from the correct location at runtime.","leadings":["","    >  "],"nodes":[{"content":"Signing the assembly and adding it to the Global Assembly Cache are optional steps, but they can simplify the process of loading the assembly from the correct location at runtime.","pos":[8,187]}]},{"pos":[1886,1974],"content":"To configure the COM application and the moniker with the required binding configuration","linkify":"To configure the COM application and the moniker with the required binding configuration","nodes":[{"content":"To configure the COM application and the moniker with the required binding configuration","pos":[0,88]}]},{"content":"Place the binding definitions (generated by the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> in the generated client application configuration file) in the client application's configuration file.","pos":[1984,2268],"source":"Place the binding definitions (generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) in the generated client application configuration file) in the client application's configuration file."},{"content":"For example, for a Visual Basic 6.0 executable named CallCenterClient.exe, the configuration should be placed in a file named CallCenterConfig.exe.config within the same directory as the executable.","pos":[2269,2467]},{"content":"The client application can now use the moniker.","pos":[2468,2515]},{"content":"Note that the binding configuration is not required if using one of the standard binding types provided by WCF.","pos":[2516,2627]},{"content":"The following type is registered.","pos":[2638,2671]},{"content":"The application is exposed using a <ph id=\"ph1\">`wsHttpBinding`</ph> binding.","pos":[2961,3020],"source":"The application is exposed using a `wsHttpBinding` binding."},{"content":"For the given type and application configuration, the following example moniker strings are used.","pos":[3021,3118]},{"pos":[3451,3658],"content":"You can use either of these moniker strings from within a Visual Basic 6.0 application, after adding a reference to the assembly that contains the <ph id=\"ph1\">`IMathService`</ph> types, as shown in the following sample code.","source":"You can use either of these moniker strings from within a Visual Basic 6.0 application, after adding a reference to the assembly that contains the `IMathService` types, as shown in the following sample code."},{"pos":[3981,4161],"content":"In this example, the definition for the binding configuration <ph id=\"ph1\">`Binding1`</ph> is stored in a suitably named configuration file for the client application, such as vb6appname.exe.config.","source":"In this example, the definition for the binding configuration `Binding1` is stored in a suitably named configuration file for the client application, such as vb6appname.exe.config."},{"pos":[4173,4268],"content":"[!NOTE]\nYou can use similar code in a C#, a C++, or any other .NET Language application.","leadings":["","    >  "],"nodes":[{"content":"You can use similar code in a C#, a C++, or any other .NET Language application.","pos":[8,88]}]},{"pos":[4280,4524],"content":"[!NOTE]\n: If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error of \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.","leadings":["","    >  "],"nodes":[{"content":": If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error of \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[8,237],"nodes":[{"content":": If the moniker is malformed or if the service is unavailable, the call to <ph id=\"ph1\">`GetObject`</ph> returns an error of \"Invalid Syntax\".","pos":[0,125],"source":": If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error of \"Invalid Syntax\"."},{"content":"If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[126,229]}]}]},{"content":"Although this topic focuses on using the service moniker from VB 6.0 code, you can use a service moniker from other languages.","pos":[4535,4661]},{"content":"When using a moniker from C++ code the Svcutil.exe generated assembly should be imported with \"no_namespace named_guids raw_interfaces_only\" as shown in the following code.","pos":[4662,4834]},{"content":"This modifies the imported interface definitions so that all methods return an <ph id=\"ph1\">`HResult`</ph>.","pos":[4926,5015],"source":"This modifies the imported interface definitions so that all methods return an `HResult`."},{"content":"Any other return values are converted into out parameters.","pos":[5016,5074]},{"content":"The overall execution of the methods remains the same.","pos":[5075,5129]},{"content":"This allows you to determine the cause of an exception when calling a method on the proxy.","pos":[5130,5220]},{"content":"This functionality is only available from C++ code.","pos":[5221,5272]},{"pos":[5281,5289],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5293,5425],"content":"<bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept>","source":"[ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)"}]}