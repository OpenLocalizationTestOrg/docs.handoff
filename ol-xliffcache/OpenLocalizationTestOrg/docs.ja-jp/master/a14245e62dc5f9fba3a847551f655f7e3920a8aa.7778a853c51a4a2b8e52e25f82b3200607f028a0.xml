{"content":"---\ntitle: \"How to: Query the Contents of Files in a Folder (LINQ) (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: f5b4dce7-1a34-4eb4-9bf1-60d5bdda264c\ncaps.latest.revision: 4\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Query the Contents of Files in a Folder (LINQ) (C#)\nThis example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents. This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree. A simple string search is performed in this example. However, more complex types of pattern matching can be performed with a regular expression. For more information, see [How to: Combine LINQ Queries with Regular Expressions (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md).  \n  \n## Example  \n  \n```csharp  \nclass QueryContents  \n{  \n    public static void Main()  \n    {  \n        // Modify this path as necessary.  \n        string startFolder = @\"c:\\program files\\Microsoft Visual Studio 9.0\\\";  \n  \n        // Take a snapshot of the file system.  \n        System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(startFolder);  \n  \n        // This method assumes that the application has discovery permissions  \n        // for all folders under the specified path.  \n        IEnumerable<System.IO.FileInfo> fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories);  \n  \n        string searchTerm = @\"Visual Studio\";  \n  \n        // Search the contents of each file.  \n        // A regular expression created with the RegEx class  \n        // could be used instead of the Contains method.  \n        // queryMatchingFiles is an IEnumerable<string>.  \n        var queryMatchingFiles =  \n            from file in fileList  \n            where file.Extension == \".htm\"  \n            let fileText = GetFileText(file.FullName)  \n            where fileText.Contains(searchTerm)  \n            select file.FullName;  \n  \n        // Execute the query.  \n        Console.WriteLine(\"The term \\\"{0}\\\" was found in:\", searchTerm);  \n        foreach (string filename in queryMatchingFiles)  \n        {  \n            Console.WriteLine(filename);  \n        }  \n  \n        // Keep the console window open in debug mode.  \n        Console.WriteLine(\"Press any key to exit\");  \n        Console.ReadKey();  \n    }  \n  \n    // Read the contents of the file.  \n    static string GetFileText(string name)  \n    {  \n        string fileContents = String.Empty;  \n  \n        // If the file has been deleted since we took   \n        // the snapshot, ignore it and return the empty string.  \n        if (System.IO.File.Exists(name))  \n        {  \n            fileContents = System.IO.File.ReadAllText(name);  \n        }  \n        return fileContents;  \n    }  \n}  \n```  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to System.Core.dll and `using` directives for the System.Linq and System.IO namespaces.  \n  \n## See Also  \n [LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)   \n [LINQ to Objects (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)","nodes":[{"pos":[4,440],"nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (C#) | Microsoft Docs","nodes":[{"pos":[0,76],"content":"How to: Query the Contents of Files in a Folder (LINQ) (C#) | Microsoft Docs","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (C#) | Microsoft Docs","pos":[0,76]}]}],"pos":[6,85],"yaml":true}],"content":"title: \"How to: Query the Contents of Files in a Folder (LINQ) (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: f5b4dce7-1a34-4eb4-9bf1-60d5bdda264c\ncaps.latest.revision: 4\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","yamlblock":true},{"pos":[447,506],"content":"How to: Query the Contents of Files in a Folder (LINQ) (C#)","linkify":"How to: Query the Contents of Files in a Folder (LINQ) (C#)","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (C#)","pos":[0,59]}]},{"content":"This example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents.","pos":[507,630]},{"content":"This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree.","pos":[631,741]},{"content":"A simple string search is performed in this example.","pos":[742,794]},{"content":"However, more complex types of pattern matching can be performed with a regular expression.","pos":[795,886]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Combine LINQ Queries with Regular Expressions (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)</ept>.","pos":[887,1082],"source":" For more information, see [How to: Combine LINQ Queries with Regular Expressions (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)."},{"pos":[1091,1098],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3071,3089],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[3093,3270],"content":"Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to System.Core.dll and <ph id=\"ph1\">`using`</ph> directives for the System.Linq and System.IO namespaces.","source":"Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to System.Core.dll and `using` directives for the System.Linq and System.IO namespaces."},{"pos":[3279,3287],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)</ept><ph id=\"ph1\"> </ph>","pos":[3291,3405],"source":"[LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md) "},{"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)</ept>","pos":[3409,3502],"source":"[LINQ to Objects (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)"}]}