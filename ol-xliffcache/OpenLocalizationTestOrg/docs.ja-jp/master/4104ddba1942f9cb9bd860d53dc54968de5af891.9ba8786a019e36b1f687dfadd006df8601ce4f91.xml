{"content":"---\ntitle: \"Importing a Type Library as an Assembly\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"importing type library\"\n  - \"type metadata\"\n  - \"custom wrappers\"\n  - \"metadata\"\n  - \"exposing COM components to .NET Framework\"\n  - \"Type Library Importer\"\n  - \"interoperation with unmanaged code, importing type library\"\n  - \"interoperation with unmanaged code, exposing COM components\"\n  - \"type libraries\"\n  - \"TypeLibConverter class, importing type library as assembly\"\n  - \"COM interop, importing type library\"\n  - \"COM interop, exposing COM components\"\nms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Importing a Type Library as an Assembly\nCOM type definitions usually reside in a type library. In contrast, CLS-compliant compilers produce type metadata in an assembly. The two sources of type information are quite different. This topic describes techniques for generating metadata from a type library. The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.  \n  \n There are two ways to make this type information available to your application:  \n  \n-   Using design-time-only interop assemblies: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from the interop assembly into your executable. The compiler embeds only the type information that your application uses. You do not have to deploy the interop assembly with your application. This is the recommended technique.  \n  \n-   Deploying interop assemblies: You can create a standard reference to the interop assembly. In this case, the interop assembly must be deployed with your application. If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code. For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).  \n  \n When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component. However, you do not have to deploy the primary interop assembly with your application.  \n  \n Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component. The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods. When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type. You do not have to know these rules to use COM objects. However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).  \n  \n## Generating Metadata  \n COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb. Some type libraries are embedded in the resource section of a .dll or .exe file. Other sources of type library information are .olb and .ocx files.  \n  \n After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:  \n  \n-   Visual Studio  \n  \n     Visual Studio automatically converts COM types in a type library to metadata in an assembly. For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md).  \n  \n-   [Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  \n  \n     The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace. For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).  \n  \n-   <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class  \n  \n     This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly. It produces the same metadata output as Tlbimp.exe. However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.  \n  \n-   Custom wrappers  \n  \n     When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code. You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.  \n  \n     To define COM types manually, you must have access to the following items:  \n  \n    -   Precise descriptions of the coclasses and interfaces being defined.  \n  \n    -   A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.  \n  \n    -   Knowledge of the type library-to-assembly conversion rules.  \n  \n     Writing a custom wrapper is an advanced technique. For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).  \n  \n For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).  \n  \n## See also\n\n- <xref:System.Runtime.InteropServices.TypeLibConverter>\n- [Exposing COM Components to the .NET Framework](../../../docs/framework/interop/exposing-com-components.md)\n- [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))\n- [Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)\n- [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))\n- [Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))\n- [Compiling an Interop Project](../../../docs/framework/interop/compiling-an-interop-project.md)\n- [Deploying an Interop Application](../../../docs/framework/interop/deploying-an-interop-application.md)\n- [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)\n- [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)\n","nodes":[{"pos":[4,649],"embed":true,"restype":"x-metadata","content":"title: \"Importing a Type Library as an Assembly\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"importing type library\"\n  - \"type metadata\"\n  - \"custom wrappers\"\n  - \"metadata\"\n  - \"exposing COM components to .NET Framework\"\n  - \"Type Library Importer\"\n  - \"interoperation with unmanaged code, importing type library\"\n  - \"interoperation with unmanaged code, exposing COM components\"\n  - \"type libraries\"\n  - \"TypeLibConverter class, importing type library as assembly\"\n  - \"COM interop, importing type library\"\n  - \"COM interop, exposing COM components\"\nms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Importing a Type Library as an Assembly","nodes":[{"pos":[0,39],"content":"Importing a Type Library as an Assembly","nodes":[{"content":"Importing a Type Library as an Assembly","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[656,695],"content":"Importing a Type Library as an Assembly","linkify":"Importing a Type Library as an Assembly","nodes":[{"content":"Importing a Type Library as an Assembly","pos":[0,39]}]},{"content":"COM type definitions usually reside in a type library.","pos":[696,750]},{"content":"In contrast, CLS-compliant compilers produce type metadata in an assembly.","pos":[751,825]},{"content":"The two sources of type information are quite different.","pos":[826,882]},{"content":"This topic describes techniques for generating metadata from a type library.","pos":[883,959]},{"content":"The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.","pos":[960,1104]},{"content":"There are two ways to make this type information available to your application:","pos":[1111,1190]},{"content":"Using design-time-only interop assemblies: Beginning with the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]</ph>, you can instruct the compiler to embed type information from the interop assembly into your executable.","pos":[1200,1429],"source":"Using design-time-only interop assemblies: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from the interop assembly into your executable."},{"content":"The compiler embeds only the type information that your application uses.","pos":[1430,1503]},{"content":"You do not have to deploy the interop assembly with your application.","pos":[1504,1573]},{"content":"This is the recommended technique.","pos":[1574,1608]},{"content":"Deploying interop assemblies: You can create a standard reference to the interop assembly.","pos":[1618,1708]},{"content":"In this case, the interop assembly must be deployed with your application.","pos":[1709,1783]},{"content":"If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.","pos":[1784,2005]},{"content":"For more information about producing and using primary interop assemblies, see <bpt id=\"p1\">[</bpt>Primary Interop Assemblies<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))</ept>.","pos":[2006,2203],"source":" For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))."},{"content":"When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.","pos":[2210,2370]},{"content":"However, you do not have to deploy the primary interop assembly with your application.","pos":[2371,2457]},{"content":"Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.","pos":[2464,2617]},{"content":"The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.","pos":[2618,2799]},{"content":"When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.","pos":[2800,3101]},{"content":"You do not have to know these rules to use COM objects.","pos":[3102,3157]},{"content":"However, if you are interested in the rules, see <bpt id=\"p1\">[</bpt>Type Equivalence and Embedded Interop Types<ept id=\"p1\">](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md)</ept>.","pos":[3158,3333],"source":" However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md)."},{"pos":[3342,3361],"content":"Generating Metadata","linkify":"Generating Metadata","nodes":[{"content":"Generating Metadata","pos":[0,19]}]},{"content":"COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.","pos":[3365,3457]},{"content":"Some type libraries are embedded in the resource section of a .dll or .exe file.","pos":[3458,3538]},{"content":"Other sources of type library information are .olb and .ocx files.","pos":[3539,3605]},{"content":"After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:","pos":[3612,3795]},{"content":"Visual Studio","pos":[3805,3818]},{"content":"Visual Studio automatically converts COM types in a type library to metadata in an assembly.","pos":[3829,3921]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>How to: Add References to Type Libraries<ept id=\"p1\">](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)</ept>.","pos":[3922,4063],"source":" For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)."},{"pos":[4073,4176],"content":"<bpt id=\"p1\">[</bpt>Type Library Importer (Tlbimp.exe)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept>","source":"[Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)"},{"content":"The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.","pos":[4187,4388]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>How to: Generate Interop Assemblies from Type Libraries<ept id=\"p1\">](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)</ept>.","pos":[4389,4560],"source":" For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)."},{"pos":[4570,4659],"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType&gt;</ph> class","source":"<xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class"},{"content":"This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.","pos":[4670,4783]},{"content":"It produces the same metadata output as Tlbimp.exe.","pos":[4784,4835]},{"content":"However, unlike Tlbimp.exe, the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.TypeLibConverter&gt;</ph> class can convert an in-memory type library to metadata.","pos":[4836,4979],"source":" However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata."},{"content":"Custom wrappers","pos":[4989,5004]},{"content":"When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.","pos":[5015,5160]},{"content":"You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.","pos":[5161,5270]},{"content":"To define COM types manually, you must have access to the following items:","pos":[5281,5355]},{"content":"Precise descriptions of the coclasses and interfaces being defined.","pos":[5369,5436]},{"content":"A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.","pos":[5450,5554]},{"content":"Knowledge of the type library-to-assembly conversion rules.","pos":[5568,5627]},{"content":"Writing a custom wrapper is an advanced technique.","pos":[5638,5688]},{"content":"For additional information about how to generate a custom wrapper, see <bpt id=\"p1\">[</bpt>Customizing Standard Wrappers<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</ept>.","pos":[5689,5881],"source":" For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))."},{"pos":[5888,6086],"content":"For more information about the COM interop import process, see <bpt id=\"p1\">[</bpt>Type Library to Assembly Conversion Summary<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</ept>.","source":"For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))."},{"pos":[6095,6103],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6164,6271],"content":"<bpt id=\"p1\">[</bpt>Exposing COM Components to the .NET Framework<ept id=\"p1\">](../../../docs/framework/interop/exposing-com-components.md)</ept>","source":"[Exposing COM Components to the .NET Framework](../../../docs/framework/interop/exposing-com-components.md)"},{"pos":[6274,6408],"content":"<bpt id=\"p1\">[</bpt>Type Library to Assembly Conversion Summary<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</ept>","source":"[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))"},{"pos":[6411,6514],"content":"<bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept>","source":"[Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)"},{"pos":[6517,6637],"content":"<bpt id=\"p1\">[</bpt>Customizing Standard Wrappers<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</ept>","source":"[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))"},{"pos":[6640,6762],"content":"<bpt id=\"p1\">[</bpt>Using COM Types in Managed Code<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</ept>","source":"[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))"},{"pos":[6765,6860],"content":"<bpt id=\"p1\">[</bpt>Compiling an Interop Project<ept id=\"p1\">](../../../docs/framework/interop/compiling-an-interop-project.md)</ept>","source":"[Compiling an Interop Project](../../../docs/framework/interop/compiling-an-interop-project.md)"},{"pos":[6863,6966],"content":"<bpt id=\"p1\">[</bpt>Deploying an Interop Application<ept id=\"p1\">](../../../docs/framework/interop/deploying-an-interop-application.md)</ept>","source":"[Deploying an Interop Application](../../../docs/framework/interop/deploying-an-interop-application.md)"},{"pos":[6969,7087],"content":"<bpt id=\"p1\">[</bpt>How to: Add References to Type Libraries<ept id=\"p1\">](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)</ept>","source":"[How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)"},{"pos":[7090,7238],"content":"<bpt id=\"p1\">[</bpt>How to: Generate Interop Assemblies from Type Libraries<ept id=\"p1\">](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)</ept>","source":"[How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)"}]}