{"content":"---\ntitle: \"How to: Configure a Port with an SSL Certificate\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"SSL\"\n  - \"WCF, security mode\"\n  - \"WCF, security\"\nms.assetid: b8abcc8e-a5f5-4317-aca5-01e3c40ab24d\n---\n# How to: Configure a Port with an SSL Certificate\nWhen creating a self-hosted Windows Communication Foundation (WCF) service with the <xref:System.ServiceModel.WSHttpBinding> class that uses transport security, you must also configure a port with an X.509 certificate. If you are not creating a self-hosted service, you can host your service on Internet Information Services (IIS). For more information, see [HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md).  \n  \n To configure a port, the tool you use depends on the operating system that is running on your machine.  \n  \n If you are running [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool. With [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] this tool is installed. With [!INCLUDE[wxp](../../../../includes/wxp-md.md)], you can download the tool at [Windows XP Service Pack 2 Support Tools](https://go.microsoft.com/fwlink/?LinkId=88606). For more information, see [Httpcfg Overview](https://go.microsoft.com/fwlink/?LinkId=88605). The [Windows Support Tools documentation](https://go.microsoft.com/fwlink/?LinkId=94840) explains the syntax for the Httpcfg.exe tool.  \n  \n If you are running [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool that is already installed.  \n  \n This topic describes how to accomplish several procedures:  \n  \n-   Determining a computer's current port configuration.  \n  \n-   Getting a certificate's thumbprint (necessary for the following two procedures).  \n  \n-   Binding an SSL certificate to a port configuration.  \n  \n-   Binding an SSL certificate to a port configuration and supporting client certificates.  \n  \n-   Deleting an SSL certificate from a port number.  \n  \n Note that modifying certificates stored on the computer requires administrative privileges.  \n  \n### To determine how ports are configured  \n  \n1.  In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool to view the current port configuration, using the **query** and **ssl** switches, as shown in the following example.  \n  \n    ```  \n    httpcfg query ssl  \n    ```  \n  \n2.  In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool to view the current port configuration, as shown in the following example.  \n  \n    ```  \n    netsh http show sslcert  \n    ```  \n  \n### To get a certificate's thumbprint  \n  \n1.  Use the Certificates MMC snap-in to find an X.509 certificate that has an intended purpose of client authentication. For more information, see [How to: View Certificates with the MMC Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).  \n  \n2.  Access the certificate's thumbprint. For more information, see [How to: Retrieve the Thumbprint of a Certificate](../../../../docs/framework/wcf/feature-details/how-to-retrieve-the-thumbprint-of-a-certificate.md).  \n  \n3.  Copy the thumbprint of the certificate into a text editor, such as Notepad.  \n  \n4.  Remove all spaces between the hexadecimal characters. One way to accomplish this is to use the text editor's find-and-replace feature and replace each space with a null character.  \n  \n### To bind an SSL certificate to a port number  \n  \n1.  In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool in \"set\" mode on the Secure Sockets Layer (SSL) store to bind the certificate to a port number. The tool uses the thumbprint to identify the certificate, as shown in the following example.  \n  \n    ```  \n    httpcfg set ssl -i 0.0.0.0:8012 -h 0000000000003ed9cd0c315bbb6dc1c08da5e6  \n    ```  \n  \n    -   The **-i** switch has the syntax of `IP`:`port` and instructs the tool to set the certificate to port 8012 of the computer. Optionally, the four zeroes that precede the number can also be replaced by the actual IP address of the computer.  \n  \n    -   The **-h** switch specifies the thumbprint of the certificate.  \n  \n2.  In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool, as shown in the following example.  \n  \n    ```  \n    netsh http add sslcert ipport=0.0.0.0:8000 certhash=0000000000003ed9cd0c315bbb6dc1c08da5e6 appid={00112233-4455-6677-8899-AABBCCDDEEFF}   \n    ```  \n  \n    -   The **certhash** parameter specifies the thumbprint of the certificate.  \n  \n    -   The **ipport** parameter specifies the IP address and port, and functions just like the **-i** switch of the Httpcfg.exe tool described.  \n  \n    -   The **appid** parameter is a GUID that can be used to identify the owning application.  \n  \n### To bind an SSL certificate to a port number and support client certificates  \n  \n1.  In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure but pass an additional command-line parameter to HttpCfg.exe, as shown in the following example.  \n  \n    ```  \n    httpcfg set ssl -i 0.0.0.0:8012 -h 0000000000003ed9cd0c315bbb6dc1c08da5e6 -f 2  \n    ```  \n  \n     The **-f** switch has the syntax of `n` where n is a number between 1 and 7. A value of 2, as shown in the preceding example, enables client certificates at the transport layer. A value of 3 enables client certificates and maps those certificates to a Windows account. See HttpCfg.exe Help for the behavior of other values.  \n  \n2.  In [!INCLUDE[wv](../../../../includes/wv-md.md)], to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure, but with an additional parameter, as shown in the following example.  \n  \n    ```  \n    netsh http add sslcert ipport=0.0.0.0:8000 certhash=0000000000003ed9cd0c315bbb6dc1c08da5e6 appid={00112233-4455-6677-8899-AABBCCDDEEFF} clientcertnegotiation=enable  \n    ```  \n  \n### To delete an SSL certificate from a port number  \n  \n1.  Use the HttpCfg.exe or Netsh.exe tool to see the ports and thumbprints of all bindings on the computer. To print the information to disk, use the redirection character \">\", as shown in the following example.  \n  \n    ```  \n    httpcfg query ssl>myMachinePorts.txt  \n    ```  \n  \n2.  In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool with the **delete** and **ssl** keywords. Use the **-i** switch to specify the `IP`:`port` number, and the **-h** switch to specify the thumbprint.  \n  \n    ```  \n    httpcfg delete ssl -i 0.0.0.0:8005 -h 0000000000003ed9cd0c315bbb6dc1c08da5e6  \n    ```  \n  \n3.  In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool, as shown in the following example.  \n  \n    ```  \n    Netsh http delete sslcert ipport=0.0.0.0:8005  \n    ```  \n  \n## Example  \n The following code shows how to create a self-hosted service using the <xref:System.ServiceModel.WSHttpBinding> class set to transport security. When creating an application, specify the port number in the address.  \n  \n [!code-csharp[c_WsHttpService#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wshttpservice/cs/source.cs#3)]\n [!code-vb[c_WsHttpService#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wshttpservice/vb/source.vb#3)]  \n  \n## See also\n\n- [HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md)\n","nodes":[{"pos":[4,243],"embed":true,"restype":"x-metadata","content":"title: \"How to: Configure a Port with an SSL Certificate\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"SSL\"\n  - \"WCF, security mode\"\n  - \"WCF, security\"\nms.assetid: b8abcc8e-a5f5-4317-aca5-01e3c40ab24d","nodes":[{"content":"How to: Configure a Port with an SSL Certificate","nodes":[{"pos":[0,48],"content":"How to: Configure a Port with an SSL Certificate","nodes":[{"content":"How to: Configure a Port with an SSL Certificate","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[250,298],"content":"How to: Configure a Port with an SSL Certificate","linkify":"How to: Configure a Port with an SSL Certificate","nodes":[{"content":"How to: Configure a Port with an SSL Certificate","pos":[0,48]}]},{"content":"When creating a self-hosted Windows Communication Foundation (WCF) service with the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class that uses transport security, you must also configure a port with an X.509 certificate.","pos":[299,517],"source":"When creating a self-hosted Windows Communication Foundation (WCF) service with the <xref:System.ServiceModel.WSHttpBinding> class that uses transport security, you must also configure a port with an X.509 certificate."},{"content":"If you are not creating a self-hosted service, you can host your service on Internet Information Services (IIS).","pos":[518,630]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>HTTP Transport Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/http-transport-security.md)</ept>.","pos":[631,758],"source":" For more information, see [HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md)."},{"content":"To configure a port, the tool you use depends on the operating system that is running on your machine.","pos":[765,867]},{"content":"If you are running <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, use the HttpCfg.exe tool.","pos":[874,1024],"source":"If you are running [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool."},{"content":"With <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> this tool is installed.","pos":[1025,1107],"source":" With [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] this tool is installed."},{"content":"With <ph id=\"ph1\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, you can download the tool at <bpt id=\"p1\">[</bpt>Windows XP Service Pack 2 Support Tools<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=88606)</ept>.","pos":[1108,1280],"source":" With [!INCLUDE[wxp](../../../../includes/wxp-md.md)], you can download the tool at [Windows XP Service Pack 2 Support Tools](https://go.microsoft.com/fwlink/?LinkId=88606)."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Httpcfg Overview<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=88605)</ept>.","pos":[1281,1373],"source":" For more information, see [Httpcfg Overview](https://go.microsoft.com/fwlink/?LinkId=88605)."},{"content":"The <bpt id=\"p1\">[</bpt>Windows Support Tools documentation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=94840)</ept> explains the syntax for the Httpcfg.exe tool.","pos":[1374,1508],"source":" The [Windows Support Tools documentation](https://go.microsoft.com/fwlink/?LinkId=94840) explains the syntax for the Httpcfg.exe tool."},{"pos":[1515,1630],"content":"If you are running <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph>, use the Netsh.exe tool that is already installed.","source":"If you are running [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool that is already installed."},{"content":"This topic describes how to accomplish several procedures:","pos":[1637,1695]},{"content":"Determining a computer's current port configuration.","pos":[1705,1757]},{"content":"Getting a certificate's thumbprint (necessary for the following two procedures).","pos":[1767,1847]},{"content":"Binding an SSL certificate to a port configuration.","pos":[1857,1908]},{"content":"Binding an SSL certificate to a port configuration and supporting client certificates.","pos":[1918,2004]},{"content":"Deleting an SSL certificate from a port number.","pos":[2014,2061]},{"content":"Note that modifying certificates stored on the computer requires administrative privileges.","pos":[2068,2159]},{"pos":[2169,2206],"content":"To determine how ports are configured","linkify":"To determine how ports are configured","nodes":[{"content":"To determine how ports are configured","pos":[0,37]}]},{"pos":[2216,2466],"content":"In <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, use the HttpCfg.exe tool to view the current port configuration, using the <bpt id=\"p1\">**</bpt>query<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ssl<ept id=\"p2\">**</ept> switches, as shown in the following example.","source":"In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool to view the current port configuration, using the **query** and **ssl** switches, as shown in the following example."},{"pos":[2523,2670],"content":"In <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph>, use the Netsh.exe tool to view the current port configuration, as shown in the following example.","source":"In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool to view the current port configuration, as shown in the following example."},{"pos":[2733,2766],"content":"To get a certificate's thumbprint","linkify":"To get a certificate's thumbprint","nodes":[{"content":"To get a certificate's thumbprint","pos":[0,33]}]},{"content":"Use the Certificates MMC snap-in to find an X.509 certificate that has an intended purpose of client authentication.","pos":[2776,2892]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: View Certificates with the MMC Snap-in<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md)</ept>.","pos":[2893,3065],"source":" For more information, see [How to: View Certificates with the MMC Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md)."},{"content":"Access the certificate's thumbprint.","pos":[3075,3111]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Retrieve the Thumbprint of a Certificate<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-retrieve-the-thumbprint-of-a-certificate.md)</ept>.","pos":[3112,3288],"source":" For more information, see [How to: Retrieve the Thumbprint of a Certificate](../../../../docs/framework/wcf/feature-details/how-to-retrieve-the-thumbprint-of-a-certificate.md)."},{"content":"Copy the thumbprint of the certificate into a text editor, such as Notepad.","pos":[3298,3373]},{"content":"Remove all spaces between the hexadecimal characters.","pos":[3383,3436]},{"content":"One way to accomplish this is to use the text editor's find-and-replace feature and replace each space with a null character.","pos":[3437,3562]},{"pos":[3572,3615],"content":"To bind an SSL certificate to a port number","linkify":"To bind an SSL certificate to a port number","nodes":[{"content":"To bind an SSL certificate to a port number","pos":[0,43]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, use the HttpCfg.exe tool in \"set\" mode on the Secure Sockets Layer (SSL) store to bind the certificate to a port number.","pos":[3625,3854],"source":"In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool in \"set\" mode on the Secure Sockets Layer (SSL) store to bind the certificate to a port number."},{"content":"The tool uses the thumbprint to identify the certificate, as shown in the following example.","pos":[3855,3947]},{"content":"The <bpt id=\"p1\">**</bpt>-i<ept id=\"p1\">**</ept> switch has the syntax of <ph id=\"ph1\">`IP`</ph>:<ph id=\"ph2\">`port`</ph> and instructs the tool to set the certificate to port 8012 of the computer.","pos":[4064,4187],"source":"The **-i** switch has the syntax of `IP`:`port` and instructs the tool to set the certificate to port 8012 of the computer."},{"content":"Optionally, the four zeroes that precede the number can also be replaced by the actual IP address of the computer.","pos":[4188,4302]},{"pos":[4316,4378],"content":"The <bpt id=\"p1\">**</bpt>-h<ept id=\"p1\">**</ept> switch specifies the thumbprint of the certificate.","source":"The **-h** switch specifies the thumbprint of the certificate."},{"pos":[4388,4496],"content":"In <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph>, use the Netsh.exe tool, as shown in the following example.","source":"In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool, as shown in the following example."},{"pos":[4676,4747],"content":"The <bpt id=\"p1\">**</bpt>certhash<ept id=\"p1\">**</ept> parameter specifies the thumbprint of the certificate.","source":"The **certhash** parameter specifies the thumbprint of the certificate."},{"pos":[4761,4897],"content":"The <bpt id=\"p1\">**</bpt>ipport<ept id=\"p1\">**</ept> parameter specifies the IP address and port, and functions just like the <bpt id=\"p2\">**</bpt>-i<ept id=\"p2\">**</ept> switch of the Httpcfg.exe tool described.","source":"The **ipport** parameter specifies the IP address and port, and functions just like the **-i** switch of the Httpcfg.exe tool described."},{"pos":[4911,4997],"content":"The <bpt id=\"p1\">**</bpt>appid<ept id=\"p1\">**</ept> parameter is a GUID that can be used to identify the owning application.","source":"The **appid** parameter is a GUID that can be used to identify the owning application."},{"pos":[5007,5082],"content":"To bind an SSL certificate to a port number and support client certificates","linkify":"To bind an SSL certificate to a port number and support client certificates","nodes":[{"content":"To bind an SSL certificate to a port number and support client certificates","pos":[0,75]}]},{"pos":[5092,5413],"content":"In <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure but pass an additional command-line parameter to HttpCfg.exe, as shown in the following example.","source":"In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure but pass an additional command-line parameter to HttpCfg.exe, as shown in the following example."},{"content":"The <bpt id=\"p1\">**</bpt>-f<ept id=\"p1\">**</ept> switch has the syntax of <ph id=\"ph1\">`n`</ph> where n is a number between 1 and 7.","pos":[5532,5608],"source":"The **-f** switch has the syntax of `n` where n is a number between 1 and 7."},{"content":"A value of 2, as shown in the preceding example, enables client certificates at the transport layer.","pos":[5609,5709]},{"content":"A value of 3 enables client certificates and maps those certificates to a Windows account.","pos":[5710,5800]},{"content":"See HttpCfg.exe Help for the behavior of other values.","pos":[5801,5855]},{"pos":[5865,6100],"content":"In <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph>, to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure, but with an additional parameter, as shown in the following example.","source":"In [!INCLUDE[wv](../../../../includes/wv-md.md)], to support clients that authenticate with X.509 certificates at the transport layer, follow the preceding procedure, but with an additional parameter, as shown in the following example."},{"pos":[6304,6351],"content":"To delete an SSL certificate from a port number","linkify":"To delete an SSL certificate from a port number","nodes":[{"content":"To delete an SSL certificate from a port number","pos":[0,47]}]},{"content":"Use the HttpCfg.exe or Netsh.exe tool to see the ports and thumbprints of all bindings on the computer.","pos":[6361,6464]},{"content":"To print the information to disk, use the redirection character \"&gt;\", as shown in the following example.","pos":[6465,6568],"source":" To print the information to disk, use the redirection character \">\", as shown in the following example."},{"content":"In <ph id=\"ph1\">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[wxp](../../../../includes/wxp-md.md)]</ph>, use the HttpCfg.exe tool with the <bpt id=\"p1\">**</bpt>delete<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ssl<ept id=\"p2\">**</ept> keywords.","pos":[6644,6819],"source":"In [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], use the HttpCfg.exe tool with the **delete** and **ssl** keywords."},{"content":"Use the <bpt id=\"p1\">**</bpt>-i<ept id=\"p1\">**</ept> switch to specify the <ph id=\"ph1\">`IP`</ph>:<ph id=\"ph2\">`port`</ph> number, and the <bpt id=\"p2\">**</bpt>-h<ept id=\"p2\">**</ept> switch to specify the thumbprint.","pos":[6820,6925],"source":" Use the **-i** switch to specify the `IP`:`port` number, and the **-h** switch to specify the thumbprint."},{"pos":[7041,7149],"content":"In <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph>, use the Netsh.exe tool, as shown in the following example.","source":"In [!INCLUDE[wv](../../../../includes/wv-md.md)], use the Netsh.exe tool, as shown in the following example."},{"pos":[7233,7240],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code shows how to create a self-hosted service using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class set to transport security.","pos":[7244,7388],"source":"The following code shows how to create a self-hosted service using the <xref:System.ServiceModel.WSHttpBinding> class set to transport security."},{"content":"When creating an application, specify the port number in the address.","pos":[7389,7458]},{"pos":[7711,7719],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7723,7823],"content":"<bpt id=\"p1\">[</bpt>HTTP Transport Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/http-transport-security.md)</ept>","source":"[HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md)"}]}