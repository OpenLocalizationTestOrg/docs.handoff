{"content":"---\ntitle: \"Writing Queries in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], writing\"\n  - \"LINQ [Visual Basic], walkthroughs\"\n  - \"LINQ [Visual Basic], writing queries\"\n  - \"writing LINQ queries [Visual Basic]\"\nms.assetid: f0045808-b9fe-4d31-88d1-473d9957211e\n---\n# Walkthrough: Writing Queries in Visual Basic\nThis walkthrough demonstrates how you can use Visual Basic language features to write [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] query expressions. The walkthrough demonstrates how to create queries on a list of Student objects, how to run the queries, and how to modify them. The queries incorporate several features including object initializers, local type inference, and anonymous types.  \n  \n After completing this walkthrough, you will be ready to move on to the samples and documentation for the specific [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider you are interested in. [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers include [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], [!INCLUDE[linq_dataset](~/includes/linq-dataset-md.md)], and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)].  \n  \n## Create a Project  \n  \n#### To create a console application project  \n  \n1.  Start Visual Studio.  \n  \n2.  On the **File** menu, point to **New**, and then click **Project**.  \n  \n3.  In the **Installed Templates** list, click **Visual Basic**.  \n  \n4.  In the list of project types, click **Console Application**. In the **Name** box, type a name for the project, and then click **OK**.  \n  \n     A project is created. By default, it contains a reference to System.Core.dll. Also, the **Imported namespaces** list on the [References Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/references-page-project-designer-visual-basic) includes the <xref:System.Linq?displayProperty=nameWithType> namespace.  \n  \n5.  On the [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), ensure that **Option infer** is set to **On**.  \n  \n## Add an In-Memory Data Source  \n The data source for the queries in this walkthrough is a list of `Student` objects. Each `Student` object contains a first name, a last name, a class year, and an academic rank in the student body.  \n  \n#### To add the data source  \n  \n-   Define a `Student` class, and create a list of instances of the class.  \n  \n    > [!IMPORTANT]\n    >  The code needed to define the `Student` class and create the list used in the walkthrough examples is provided in [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md). You can copy it from there and paste it into your project. The new code replaces the code that appeared when you created the project.  \n  \n#### To add a new student to the students list  \n  \n-   Follow the pattern in the `getStudents` method to add another instance of the `Student` class to the list. Adding the student will introduce you to object initializers. For more information, see [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md).  \n  \n## Create a Query  \n When executed, the query added in this section produces a list of the students whose academic rank puts them in the top ten. Because the query selects the complete `Student` object each time, the type of the query result is `IEnumerable(Of Student)`. However, the type of the query typically is not specified in query definitions. Instead, the compiler uses local type inference to determine the type. For more information, see [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md). The query's range variable, `currentStudent`, serves as a reference to each `Student` instance in the source, `students`, providing access to the properties of each object in `students`.  \n  \n#### To create a simple query  \n  \n1.  Find the place in the `Main` method of the project that is marked as follows:  \n  \n     [!code-vb[VbLINQWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#1)]  \n  \n     Copy the following code and paste it in.  \n  \n     [!code-vb[VbLINQWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#2)]  \n  \n2.  Rest the mouse pointer over `studentQuery` in your code to verify that the compiler-assigned type is `IEnumerable(Of Student)`.  \n  \n## Run the Query  \n The variable `studentQuery` contains the definition of the query, not the results of running the query. A typical mechanism for running a query is a `For Each` loop. Each element in the returned sequence is accessed through the loop iteration variable. For more information about query execution, see [Writing Your First LINQ Query](../../../../visual-basic/programming-guide/concepts/linq/writing-your-first-linq-query.md).  \n  \n#### To run the query  \n  \n1.  Add the following `For Each` loop below the query in your project.  \n  \n     [!code-vb[VbLINQWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#3)]  \n  \n2.  Rest the mouse pointer over the loop control variable `studentRecord` to see its data type. The type of `studentRecord` is inferred to be `Student`, because `studentQuery` returns a collection of `Student` instances.  \n  \n3.  Build and run the application by pressing CTRL+F5. Note the results in the console window.  \n  \n## Modify the Query  \n It is easier to scan query results if they are in a specified order. You can sort the returned sequence based on any available field.  \n  \n#### To order the results  \n  \n1.  Add the following `Order By` clause between the `Where` statement and the `Select` statement of the query. The `Order By` clause will order the results alphabetically from A to Z, according to the last name of each student.  \n  \n    ```  \n    Order By currentStudent.Last Ascending   \n    ```  \n  \n2.  To order by last name and then first name, add both fields to the query:  \n  \n    ```  \n    Order By currentStudent.Last Ascending, currentStudent.First Ascending   \n    ```  \n  \n     You can also specify `Descending` to order from Z to A.  \n  \n3.  Build and run the application by pressing CTRL+F5. Note the results in the console window.  \n  \n#### To introduce a local identifier  \n  \n1.  Add the code in this section to introduce a local identifier in the query expression. The local identifier will hold an intermediate result. In the following example, `name` is an identifier that holds a concatenation of the student's first and last names. A local identifier can be used for convenience, or it can enhance performance by storing the results of an expression that would otherwise be calculated multiple times.  \n  \n     [!code-vb[VbLINQWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#4)]  \n  \n2.  Build and run the application by pressing CTRL+F5. Note the results in the console window.  \n  \n#### To project one field in the Select clause  \n  \n1.  Add the query and `For Each` loop from this section to create a query that produces a sequence whose elements differ from the elements in the source. In the following example, the source is a collection of `Student` objects, but only one member of each object is returned: the first name of students whose last name is Garcia. Because `currentStudent.First` is a string, the data type of the sequence returned by `studentQuery3` is `IEnumerable(Of String)`, a sequence of strings. As in earlier examples, the assignment of a data type for `studentQuery3` is left for the compiler to determine by using local type inference.  \n  \n     [!code-vb[VbLINQWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#5)]  \n  \n2.  Rest the mouse pointer over `studentQuery3` in your code to verify that the assigned type is `IEnumerable(Of String)`.  \n  \n3.  Build and run the application by pressing CTRL+F5. Note the results in the console window.  \n  \n#### To create an anonymous type in the Select clause  \n  \n1.  Add the code from this section to see how anonymous types are used in queries. You use them in queries when you want to return several fields from the data source rather than complete records (`currentStudent` records in previous examples) or single fields (`First` in the preceding section). Instead of defining a new named type that contains the fields you want to include in the result, you specify the fields in the `Select` clause and the compiler creates an anonymous type with those fields as its properties. For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).  \n  \n     The following example creates a query that returns the name and rank of seniors whose academic rank is between 1 and 10, in order of academic rank. In this example, the type of `studentQuery4` must be inferred because the `Select` clause returns an instance of an anonymous type, and an anonymous type has no usable name.  \n  \n     [!code-vb[VbLINQWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#6)]  \n  \n2.  Build and run the application by pressing CTRL+F5. Note the results in the console window.  \n  \n## Additional Examples  \n Now that you understand the basics, the following is a list of additional examples to illustrate the flexibility and power of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries. Each example is preceded by a brief description of what it does. Rest the mouse pointer over the query result variable for each query to see the inferred type. Use a `For Each` loop to produce the results.  \n  \n [!code-vb[VbLINQWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQWalkthrough/VB/Class1.vb#7)]  \n  \n## Additional Information  \n After you are familiar with the basic concepts of working with queries, you are ready to read the documentation and samples for the specific type of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider that you are interested in:  \n  \n [LINQ to Objects](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)  \n  \n [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)  \n  \n [LINQ to XML](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml.md)  \n  \n [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)  \n  \n## See also\n\n- [Language-Integrated Query (LINQ) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/index.md)\n- [Getting Started with LINQ in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)\n- [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)\n- [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)\n- [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)\n- [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)\n- [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)\n- [Queries](../../../../visual-basic/language-reference/queries/index.md)\n","nodes":[{"pos":[4,306],"embed":true,"restype":"x-metadata","content":"title: \"Writing Queries in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], writing\"\n  - \"LINQ [Visual Basic], walkthroughs\"\n  - \"LINQ [Visual Basic], writing queries\"\n  - \"writing LINQ queries [Visual Basic]\"\nms.assetid: f0045808-b9fe-4d31-88d1-473d9957211e","nodes":[{"content":"Writing Queries in Visual Basic","nodes":[{"pos":[0,31],"content":"Writing Queries in Visual Basic","nodes":[{"content":"Writing Queries in Visual Basic","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[313,357],"content":"Walkthrough: Writing Queries in Visual Basic","linkify":"Walkthrough: Writing Queries in Visual Basic","nodes":[{"content":"Walkthrough: Writing Queries in Visual Basic","pos":[0,44]}]},{"content":"This walkthrough demonstrates how you can use Visual Basic language features to write <ph id=\"ph1\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph> query expressions.","pos":[358,518],"source":"This walkthrough demonstrates how you can use Visual Basic language features to write [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] query expressions."},{"content":"The walkthrough demonstrates how to create queries on a list of Student objects, how to run the queries, and how to modify them.","pos":[519,647]},{"content":"The queries incorporate several features including object initializers, local type inference, and anonymous types.","pos":[648,762]},{"content":"After completing this walkthrough, you will be ready to move on to the samples and documentation for the specific <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> provider you are interested in.","pos":[769,964],"source":"After completing this walkthrough, you will be ready to move on to the samples and documentation for the specific [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider you are interested in."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> providers include <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)]</ph>, <ph id=\"ph3\">[!INCLUDE[linq_dataset](~/includes/linq-dataset-md.md)]</ph>, and <ph id=\"ph4\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>.","pos":[965,1201],"source":"[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers include [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], [!INCLUDE[linq_dataset](~/includes/linq-dataset-md.md)], and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]."},{"pos":[1210,1226],"content":"Create a Project","linkify":"Create a Project","nodes":[{"content":"Create a Project","pos":[0,16]}]},{"pos":[1237,1276],"content":"To create a console application project","linkify":"To create a console application project","nodes":[{"content":"To create a console application project","pos":[0,39]}]},{"content":"Start Visual Studio.","pos":[1286,1306]},{"pos":[1316,1383],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the **File** menu, point to **New**, and then click **Project**."},{"pos":[1393,1453],"content":"In the <bpt id=\"p1\">**</bpt>Installed Templates<ept id=\"p1\">**</ept> list, click <bpt id=\"p2\">**</bpt>Visual Basic<ept id=\"p2\">**</ept>.","source":"In the **Installed Templates** list, click **Visual Basic**."},{"content":"In the list of project types, click <bpt id=\"p1\">**</bpt>Console Application<ept id=\"p1\">**</ept>.","pos":[1463,1523],"source":"In the list of project types, click **Console Application**."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type a name for the project, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[1524,1596],"source":" In the **Name** box, type a name for the project, and then click **OK**."},{"content":"A project is created.","pos":[1607,1628]},{"content":"By default, it contains a reference to System.Core.dll.","pos":[1629,1684]},{"content":"Also, the <bpt id=\"p1\">**</bpt>Imported namespaces<ept id=\"p1\">**</ept> list on the <bpt id=\"p2\">[</bpt>References Page, Project Designer (Visual Basic)<ept id=\"p2\">](/visualstudio/ide/reference/references-page-project-designer-visual-basic)</ept> includes the <ph id=\"ph1\">&lt;xref:System.Linq?displayProperty=nameWithType&gt;</ph> namespace.","pos":[1685,1928],"source":" Also, the **Imported namespaces** list on the [References Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/references-page-project-designer-visual-basic) includes the <xref:System.Linq?displayProperty=nameWithType> namespace."},{"pos":[1938,2112],"content":"On the <bpt id=\"p1\">[</bpt>Compile Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/compile-page-project-designer-visual-basic)</ept>, ensure that <bpt id=\"p2\">**</bpt>Option infer<ept id=\"p2\">**</ept> is set to <bpt id=\"p3\">**</bpt>On<ept id=\"p3\">**</ept>.","source":"On the [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), ensure that **Option infer** is set to **On**."},{"pos":[2121,2149],"content":"Add an In-Memory Data Source","linkify":"Add an In-Memory Data Source","nodes":[{"content":"Add an In-Memory Data Source","pos":[0,28]}]},{"content":"The data source for the queries in this walkthrough is a list of <ph id=\"ph1\">`Student`</ph> objects.","pos":[2153,2236],"source":"The data source for the queries in this walkthrough is a list of `Student` objects."},{"content":"Each <ph id=\"ph1\">`Student`</ph> object contains a first name, a last name, a class year, and an academic rank in the student body.","pos":[2237,2350],"source":" Each `Student` object contains a first name, a last name, a class year, and an academic rank in the student body."},{"pos":[2361,2383],"content":"To add the data source","linkify":"To add the data source","nodes":[{"content":"To add the data source","pos":[0,22]}]},{"pos":[2393,2463],"content":"Define a <ph id=\"ph1\">`Student`</ph> class, and create a list of instances of the class.","source":"Define a `Student` class, and create a list of instances of the class."},{"pos":[2475,2867],"content":"[!IMPORTANT]\nThe code needed to define the `Student` class and create the list used in the walkthrough examples is provided in [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md). You can copy it from there and paste it into your project. The new code replaces the code that appeared when you created the project.","leadings":["","    >  "],"nodes":[{"content":"The code needed to define the `Student` class and create the list used in the walkthrough examples is provided in [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md). You can copy it from there and paste it into your project. The new code replaces the code that appeared when you created the project.","pos":[13,385],"nodes":[{"content":"The code needed to define the <ph id=\"ph1\">`Student`</ph> class and create the list used in the walkthrough examples is provided in <bpt id=\"p1\">[</bpt>How to: Create a List of Items<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)</ept>.","pos":[0,238],"source":"The code needed to define the `Student` class and create the list used in the walkthrough examples is provided in [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)."},{"content":"You can copy it from there and paste it into your project.","pos":[239,297]},{"content":"The new code replaces the code that appeared when you created the project.","pos":[298,372]}]}]},{"pos":[2878,2919],"content":"To add a new student to the students list","linkify":"To add a new student to the students list","nodes":[{"content":"To add a new student to the students list","pos":[0,41]}]},{"content":"Follow the pattern in the <ph id=\"ph1\">`getStudents`</ph> method to add another instance of the <ph id=\"ph2\">`Student`</ph> class to the list.","pos":[2929,3035],"source":"Follow the pattern in the `getStudents` method to add another instance of the `Student` class to the list."},{"content":"Adding the student will introduce you to object initializers.","pos":[3036,3097]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Object Initializers: Named and Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)</ept>.","pos":[3098,3304],"source":" For more information, see [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)."},{"pos":[3313,3327],"content":"Create a Query","linkify":"Create a Query","nodes":[{"content":"Create a Query","pos":[0,14]}]},{"content":"When executed, the query added in this section produces a list of the students whose academic rank puts them in the top ten.","pos":[3331,3455]},{"content":"Because the query selects the complete <ph id=\"ph1\">`Student`</ph> object each time, the type of the query result is <ph id=\"ph2\">`IEnumerable(Of Student)`</ph>.","pos":[3456,3581],"source":" Because the query selects the complete `Student` object each time, the type of the query result is `IEnumerable(Of Student)`."},{"content":"However, the type of the query typically is not specified in query definitions.","pos":[3582,3661]},{"content":"Instead, the compiler uses local type inference to determine the type.","pos":[3662,3732]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Local Type Inference<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept>.","pos":[3733,3878],"source":" For more information, see [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)."},{"content":"The query's range variable, <ph id=\"ph1\">`currentStudent`</ph>, serves as a reference to each <ph id=\"ph2\">`Student`</ph> instance in the source, <ph id=\"ph3\">`students`</ph>, providing access to the properties of each object in <ph id=\"ph4\">`students`</ph>.","pos":[3879,4065],"source":" The query's range variable, `currentStudent`, serves as a reference to each `Student` instance in the source, `students`, providing access to the properties of each object in `students`."},{"pos":[4076,4100],"content":"To create a simple query","linkify":"To create a simple query","nodes":[{"content":"To create a simple query","pos":[0,24]}]},{"pos":[4110,4187],"content":"Find the place in the <ph id=\"ph1\">`Main`</ph> method of the project that is marked as follows:","source":"Find the place in the `Main` method of the project that is marked as follows:"},{"content":"Copy the following code and paste it in.","pos":[4326,4366]},{"pos":[4504,4631],"content":"Rest the mouse pointer over <ph id=\"ph1\">`studentQuery`</ph> in your code to verify that the compiler-assigned type is <ph id=\"ph2\">`IEnumerable(Of Student)`</ph>.","source":"Rest the mouse pointer over `studentQuery` in your code to verify that the compiler-assigned type is `IEnumerable(Of Student)`."},{"pos":[4640,4653],"content":"Run the Query","linkify":"Run the Query","nodes":[{"content":"Run the Query","pos":[0,13]}]},{"content":"The variable <ph id=\"ph1\">`studentQuery`</ph> contains the definition of the query, not the results of running the query.","pos":[4657,4760],"source":"The variable `studentQuery` contains the definition of the query, not the results of running the query."},{"content":"A typical mechanism for running a query is a <ph id=\"ph1\">`For Each`</ph> loop.","pos":[4761,4822],"source":" A typical mechanism for running a query is a `For Each` loop."},{"content":"Each element in the returned sequence is accessed through the loop iteration variable.","pos":[4823,4909]},{"content":"For more information about query execution, see <bpt id=\"p1\">[</bpt>Writing Your First LINQ Query<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/writing-your-first-linq-query.md)</ept>.","pos":[4910,5081],"source":" For more information about query execution, see [Writing Your First LINQ Query](../../../../visual-basic/programming-guide/concepts/linq/writing-your-first-linq-query.md)."},{"pos":[5092,5108],"content":"To run the query","linkify":"To run the query","nodes":[{"content":"To run the query","pos":[0,16]}]},{"pos":[5118,5184],"content":"Add the following <ph id=\"ph1\">`For Each`</ph> loop below the query in your project.","source":"Add the following `For Each` loop below the query in your project."},{"content":"Rest the mouse pointer over the loop control variable <ph id=\"ph1\">`studentRecord`</ph> to see its data type.","pos":[5322,5413],"source":"Rest the mouse pointer over the loop control variable `studentRecord` to see its data type."},{"content":"The type of <ph id=\"ph1\">`studentRecord`</ph> is inferred to be <ph id=\"ph2\">`Student`</ph>, because <ph id=\"ph3\">`studentQuery`</ph> returns a collection of <ph id=\"ph4\">`Student`</ph> instances.","pos":[5414,5538],"source":" The type of `studentRecord` is inferred to be `Student`, because `studentQuery` returns a collection of `Student` instances."},{"content":"Build and run the application by pressing CTRL+F5.","pos":[5548,5598]},{"content":"Note the results in the console window.","pos":[5599,5638]},{"pos":[5647,5663],"content":"Modify the Query","linkify":"Modify the Query","nodes":[{"content":"Modify the Query","pos":[0,16]}]},{"content":"It is easier to scan query results if they are in a specified order.","pos":[5667,5735]},{"content":"You can sort the returned sequence based on any available field.","pos":[5736,5800]},{"pos":[5811,5831],"content":"To order the results","linkify":"To order the results","nodes":[{"content":"To order the results","pos":[0,20]}]},{"content":"Add the following <ph id=\"ph1\">`Order By`</ph> clause between the <ph id=\"ph2\">`Where`</ph> statement and the <ph id=\"ph3\">`Select`</ph> statement of the query.","pos":[5841,5947],"source":"Add the following `Order By` clause between the `Where` statement and the `Select` statement of the query."},{"content":"The <ph id=\"ph1\">`Order By`</ph> clause will order the results alphabetically from A to Z, according to the last name of each student.","pos":[5948,6064],"source":" The `Order By` clause will order the results alphabetically from A to Z, according to the last name of each student."},{"content":"To order by last name and then first name, add both fields to the query:","pos":[6143,6215]},{"pos":[6327,6382],"content":"You can also specify <ph id=\"ph1\">`Descending`</ph> to order from Z to A.","source":"You can also specify `Descending` to order from Z to A."},{"content":"Build and run the application by pressing CTRL+F5.","pos":[6392,6442]},{"content":"Note the results in the console window.","pos":[6443,6482]},{"pos":[6493,6524],"content":"To introduce a local identifier","linkify":"To introduce a local identifier","nodes":[{"content":"To introduce a local identifier","pos":[0,31]}]},{"content":"Add the code in this section to introduce a local identifier in the query expression.","pos":[6534,6619]},{"content":"The local identifier will hold an intermediate result.","pos":[6620,6674]},{"content":"In the following example, <ph id=\"ph1\">`name`</ph> is an identifier that holds a concatenation of the student's first and last names.","pos":[6675,6790],"source":" In the following example, `name` is an identifier that holds a concatenation of the student's first and last names."},{"content":"A local identifier can be used for convenience, or it can enhance performance by storing the results of an expression that would otherwise be calculated multiple times.","pos":[6791,6959]},{"content":"Build and run the application by pressing CTRL+F5.","pos":[7097,7147]},{"content":"Note the results in the console window.","pos":[7148,7187]},{"pos":[7198,7239],"content":"To project one field in the Select clause","linkify":"To project one field in the Select clause","nodes":[{"content":"To project one field in the Select clause","pos":[0,41]}]},{"content":"Add the query and <ph id=\"ph1\">`For Each`</ph> loop from this section to create a query that produces a sequence whose elements differ from the elements in the source.","pos":[7249,7398],"source":"Add the query and `For Each` loop from this section to create a query that produces a sequence whose elements differ from the elements in the source."},{"content":"In the following example, the source is a collection of <ph id=\"ph1\">`Student`</ph> objects, but only one member of each object is returned: the first name of students whose last name is Garcia.","pos":[7399,7575],"source":" In the following example, the source is a collection of `Student` objects, but only one member of each object is returned: the first name of students whose last name is Garcia."},{"content":"Because <ph id=\"ph1\">`currentStudent.First`</ph> is a string, the data type of the sequence returned by <ph id=\"ph2\">`studentQuery3`</ph> is <ph id=\"ph3\">`IEnumerable(Of String)`</ph>, a sequence of strings.","pos":[7576,7729],"source":" Because `currentStudent.First` is a string, the data type of the sequence returned by `studentQuery3` is `IEnumerable(Of String)`, a sequence of strings."},{"content":"As in earlier examples, the assignment of a data type for <ph id=\"ph1\">`studentQuery3`</ph> is left for the compiler to determine by using local type inference.","pos":[7730,7872],"source":" As in earlier examples, the assignment of a data type for `studentQuery3` is left for the compiler to determine by using local type inference."},{"pos":[8010,8128],"content":"Rest the mouse pointer over <ph id=\"ph1\">`studentQuery3`</ph> in your code to verify that the assigned type is <ph id=\"ph2\">`IEnumerable(Of String)`</ph>.","source":"Rest the mouse pointer over `studentQuery3` in your code to verify that the assigned type is `IEnumerable(Of String)`."},{"content":"Build and run the application by pressing CTRL+F5.","pos":[8138,8188]},{"content":"Note the results in the console window.","pos":[8189,8228]},{"pos":[8239,8287],"content":"To create an anonymous type in the Select clause","linkify":"To create an anonymous type in the Select clause","nodes":[{"content":"To create an anonymous type in the Select clause","pos":[0,48]}]},{"content":"Add the code from this section to see how anonymous types are used in queries.","pos":[8297,8375]},{"content":"You use them in queries when you want to return several fields from the data source rather than complete records (<ph id=\"ph1\">`currentStudent`</ph> records in previous examples) or single fields (<ph id=\"ph2\">`First`</ph> in the preceding section).","pos":[8376,8589],"source":" You use them in queries when you want to return several fields from the data source rather than complete records (`currentStudent` records in previous examples) or single fields (`First` in the preceding section)."},{"content":"Instead of defining a new named type that contains the fields you want to include in the result, you specify the fields in the <ph id=\"ph1\">`Select`</ph> clause and the compiler creates an anonymous type with those fields as its properties.","pos":[8590,8812],"source":" Instead of defining a new named type that contains the fields you want to include in the result, you specify the fields in the `Select` clause and the compiler creates an anonymous type with those fields as its properties."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>.","pos":[8813,8958],"source":" For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)."},{"content":"The following example creates a query that returns the name and rank of seniors whose academic rank is between 1 and 10, in order of academic rank.","pos":[8969,9116]},{"content":"In this example, the type of <ph id=\"ph1\">`studentQuery4`</ph> must be inferred because the <ph id=\"ph2\">`Select`</ph> clause returns an instance of an anonymous type, and an anonymous type has no usable name.","pos":[9117,9290],"source":" In this example, the type of `studentQuery4` must be inferred because the `Select` clause returns an instance of an anonymous type, and an anonymous type has no usable name."},{"content":"Build and run the application by pressing CTRL+F5.","pos":[9428,9478]},{"content":"Note the results in the console window.","pos":[9479,9518]},{"pos":[9527,9546],"content":"Additional Examples","linkify":"Additional Examples","nodes":[{"content":"Additional Examples","pos":[0,19]}]},{"content":"Now that you understand the basics, the following is a list of additional examples to illustrate the flexibility and power of <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> queries.","pos":[9550,9734],"source":"Now that you understand the basics, the following is a list of additional examples to illustrate the flexibility and power of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries."},{"content":"Each example is preceded by a brief description of what it does.","pos":[9735,9799]},{"content":"Rest the mouse pointer over the query result variable for each query to see the inferred type.","pos":[9800,9894]},{"content":"Use a <ph id=\"ph1\">`For Each`</ph> loop to produce the results.","pos":[9895,9940],"source":" Use a `For Each` loop to produce the results."},{"pos":[10073,10095],"content":"Additional Information","linkify":"Additional Information","nodes":[{"content":"Additional Information","pos":[0,22]}]},{"pos":[10099,10334],"content":"After you are familiar with the basic concepts of working with queries, you are ready to read the documentation and samples for the specific type of <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> provider that you are interested in:","source":"After you are familiar with the basic concepts of working with queries, you are ready to read the documentation and samples for the specific type of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider that you are interested in:"},{"pos":[10341,10435],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)"},{"pos":[10442,10508],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)"},{"pos":[10515,10601],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml.md)</ept>","source":"[LINQ to XML](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml.md)"},{"pos":[10608,10679],"content":"<bpt id=\"p1\">[</bpt>LINQ to DataSet<ept id=\"p1\">](../../../../framework/data/adonet/linq-to-dataset.md)</ept>","source":"[LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)"},{"pos":[10688,10696],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[10700,10816],"content":"<bpt id=\"p1\">[</bpt>Language-Integrated Query (LINQ) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/index.md)</ept>","source":"[Language-Integrated Query (LINQ) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/index.md)"},{"pos":[10819,10949],"content":"<bpt id=\"p1\">[</bpt>Getting Started with LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)</ept>","source":"[Getting Started with LINQ in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)"},{"pos":[10952,11070],"content":"<bpt id=\"p1\">[</bpt>Local Type Inference<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept>","source":"[Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)"},{"pos":[11073,11252],"content":"<bpt id=\"p1\">[</bpt>Object Initializers: Named and Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)</ept>","source":"[Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)"},{"pos":[11255,11373],"content":"<bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>","source":"[Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)"},{"pos":[11376,11505],"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>","source":"[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)"},{"pos":[11508,11590],"content":"<bpt id=\"p1\">[</bpt>LINQ<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/index.md)</ept>","source":"[LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)"},{"pos":[11593,11664],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../../visual-basic/language-reference/queries/index.md)"}]}