{"content":"---\ntitle: \"How to: Create Application Settings\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"application settings [Windows Forms], Windows Forms\"\n  - \"application settings [Windows Forms], creating\"\nms.assetid: 1e7aa347-af75-41e5-89ca-f53cab704f72\n---\n# How to: Create Application Settings\nUsing managed code, you can create new application settings and bind them to properties on your form or your form's controls, so that these settings are loaded and saved automatically at run time.  \n  \n In the following procedure, you manually create a wrapper class that derives from <xref:System.Configuration.ApplicationSettingsBase>. To this class you add a publicly accessible property for each application setting that you want to expose.  \n  \n You can also perform this procedure using minimal code in the Visual Studio designer.  Also see [How to: Create Application Settings Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/wabtadw6(v=vs.100)).  \n  \n### To create new Application Settings programmatically  \n  \n1.  Add a new class to your project, and rename it. For this procedure, we will call this class `MyUserSettings`. Change the class definition so that the class derives from <xref:System.Configuration.ApplicationSettingsBase>.  \n  \n2.  Define a property on this wrapper class for each application setting you require, and apply that property with either the <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>, depending on the scope of the setting. For more information about settings scope, see [Application Settings Overview](application-settings-overview.md). By now, your code should look like this:  \n  \n     [!code-csharp[ApplicationSettings.Create#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/MyAppSettings.cs#1)]\n     [!code-vb[ApplicationSettings.Create#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/MyAppSettings.vb#1)]  \n  \n3.  Create an instance of this wrapper class in your application. It will commonly be a private member of the main form. Now that you have defined your class, you need to bind it to a property; in this case, the <xref:System.Windows.Forms.Form.BackColor%2A> property of your form. You can accomplish this in your form's `Load` event handler.  \n  \n     [!code-csharp[ApplicationSettings.Create#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/Form1.cs#2)]\n     [!code-vb[ApplicationSettings.Create#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/Form1.vb#2)]  \n  \n4.  If you provide a way to change settings at run time, you will need to save the user's current settings to disk when your form closes, or else these changes will be lost.  \n  \n     [!code-csharp[ApplicationSettings.Create#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/Form1.cs#3)]\n     [!code-vb[ApplicationSettings.Create#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/Form1.vb#3)]  \n  \n     You have now successfully created a new application setting and bound it to the specified property.  \n  \n## .NET Framework Security  \n The default settings provider, <xref:System.Configuration.LocalFileSettingsProvider>, persists information to configuration files as plain text. This limits security to the file access security provided by the operating system for the current user. Because of this, care must be taken with the information stored in configuration files. For example, one common use for application settings is to store connection strings that point to the application's data store. However, because of security concerns, such strings should not include passwords. For more information about connection strings, see <xref:System.Configuration.SpecialSetting>.  \n  \n## See also\n\n- <xref:System.Configuration.SpecialSettingAttribute>\n- <xref:System.Configuration.LocalFileSettingsProvider>\n- [Application Settings Overview](application-settings-overview.md)\n- [How to: Validate Application Settings](how-to-validate-application-settings.md)\n","nodes":[{"pos":[4,286],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create Application Settings\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"application settings [Windows Forms], Windows Forms\"\n  - \"application settings [Windows Forms], creating\"\nms.assetid: 1e7aa347-af75-41e5-89ca-f53cab704f72","nodes":[{"content":"How to: Create Application Settings","nodes":[{"pos":[0,35],"content":"How to: Create Application Settings","nodes":[{"content":"How to: Create Application Settings","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[293,328],"content":"How to: Create Application Settings","linkify":"How to: Create Application Settings","nodes":[{"content":"How to: Create Application Settings","pos":[0,35]}]},{"content":"Using managed code, you can create new application settings and bind them to properties on your form or your form's controls, so that these settings are loaded and saved automatically at run time.","pos":[329,525]},{"content":"In the following procedure, you manually create a wrapper class that derives from <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase&gt;</ph>.","pos":[532,666],"source":"In the following procedure, you manually create a wrapper class that derives from <xref:System.Configuration.ApplicationSettingsBase>."},{"content":"To this class you add a publicly accessible property for each application setting that you want to expose.","pos":[667,773]},{"content":"You can also perform this procedure using minimal code in the Visual Studio designer.","pos":[780,865]},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Create Application Settings Using the Designer<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/wabtadw6(v=vs.100))</ept>.","pos":[867,1030],"source":"  Also see [How to: Create Application Settings Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/wabtadw6(v=vs.100))."},{"pos":[1040,1091],"content":"To create new Application Settings programmatically","linkify":"To create new Application Settings programmatically","nodes":[{"content":"To create new Application Settings programmatically","pos":[0,51]}]},{"content":"Add a new class to your project, and rename it.","pos":[1101,1148]},{"content":"For this procedure, we will call this class <ph id=\"ph1\">`MyUserSettings`</ph>.","pos":[1149,1210],"source":" For this procedure, we will call this class `MyUserSettings`."},{"content":"Change the class definition so that the class derives from <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase&gt;</ph>.","pos":[1211,1322],"source":" Change the class definition so that the class derives from <xref:System.Configuration.ApplicationSettingsBase>."},{"content":"Define a property on this wrapper class for each application setting you require, and apply that property with either the <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationScopedSettingAttribute&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Configuration.UserScopedSettingAttribute&gt;</ph>, depending on the scope of the setting.","pos":[1332,1613],"source":"Define a property on this wrapper class for each application setting you require, and apply that property with either the <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>, depending on the scope of the setting."},{"content":"For more information about settings scope, see <bpt id=\"p1\">[</bpt>Application Settings Overview<ept id=\"p1\">](application-settings-overview.md)</ept>.","pos":[1614,1727],"source":" For more information about settings scope, see [Application Settings Overview](application-settings-overview.md)."},{"content":"By now, your code should look like this:","pos":[1728,1768]},{"pos":[1779,2068],"content":"[!code-csharp[ApplicationSettings.Create#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/MyAppSettings.cs#1)]\n [!code-vb[ApplicationSettings.Create#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/MyAppSettings.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"Create an instance of this wrapper class in your application.","pos":[2078,2139]},{"content":"It will commonly be a private member of the main form.","pos":[2140,2194]},{"content":"Now that you have defined your class, you need to bind it to a property; in this case, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.BackColor%2A&gt;</ph> property of your form.","pos":[2195,2354],"source":" Now that you have defined your class, you need to bind it to a property; in this case, the <xref:System.Windows.Forms.Form.BackColor%2A> property of your form."},{"content":"You can accomplish this in your form's <ph id=\"ph1\">`Load`</ph> event handler.","pos":[2355,2415],"source":" You can accomplish this in your form's `Load` event handler."},{"pos":[2426,2699],"content":"[!code-csharp[ApplicationSettings.Create#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/Form1.cs#2)]\n [!code-vb[ApplicationSettings.Create#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"If you provide a way to change settings at run time, you will need to save the user's current settings to disk when your form closes, or else these changes will be lost.","pos":[2709,2878]},{"pos":[2889,3162],"content":"[!code-csharp[ApplicationSettings.Create#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/Form1.cs#3)]\n [!code-vb[ApplicationSettings.Create#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"content":"You have now successfully created a new application setting and bound it to the specified property.","pos":[3173,3272]},{"pos":[3281,3304],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"The default settings provider, <ph id=\"ph1\">&lt;xref:System.Configuration.LocalFileSettingsProvider&gt;</ph>, persists information to configuration files as plain text.","pos":[3308,3452],"source":"The default settings provider, <xref:System.Configuration.LocalFileSettingsProvider>, persists information to configuration files as plain text."},{"content":"This limits security to the file access security provided by the operating system for the current user.","pos":[3453,3556]},{"content":"Because of this, care must be taken with the information stored in configuration files.","pos":[3557,3644]},{"content":"For example, one common use for application settings is to store connection strings that point to the application's data store.","pos":[3645,3772]},{"content":"However, because of security concerns, such strings should not include passwords.","pos":[3773,3854]},{"content":"For more information about connection strings, see <ph id=\"ph1\">&lt;xref:System.Configuration.SpecialSetting&gt;</ph>.","pos":[3855,3949],"source":" For more information about connection strings, see <xref:System.Configuration.SpecialSetting>."},{"pos":[3958,3966],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4080,4145],"content":"<bpt id=\"p1\">[</bpt>Application Settings Overview<ept id=\"p1\">](application-settings-overview.md)</ept>","source":"[Application Settings Overview](application-settings-overview.md)"},{"pos":[4148,4228],"content":"<bpt id=\"p1\">[</bpt>How to: Validate Application Settings<ept id=\"p1\">](how-to-validate-application-settings.md)</ept>","source":"[How to: Validate Application Settings](how-to-validate-application-settings.md)"}]}