{"content":"---\ntitle: \"How to: Use a Service Moniker with Metadata Exchange Contracts\"\nms.date: \"03/30/2017\"\nms.assetid: c41a07e5-cb9d-45d6-9ea4-34511e227faf\n---\n# How to: Use a Service Moniker with Metadata Exchange Contracts\nAfter developing some new WCF services, you may decide that you want to be able to call these services from a script or a Visual Basic 6.0 application. One method would be to generate a WCF client assembly, register the assembly with COM, install the assembly in the GAC, and then reference the COM types from your Visual Basic code. When you distribute the application, you will have to distribute the WCF Client assembly as well. The user will then have to register the WCF client assembly with COM and place it in the GAC. WCF COM Interop also allows you to make the same service calls without relying on a WCF client assembly. The WCF moniker allows you to call any WCF service from any COM-compatible language (Visual Basic, VBScript, Visual Basic for Applications (VBA), and so on) by specifying a metadata exchange (Mex) endpoint URI that the service moniker uses to extract type information about the service. This topic describes how to call the Getting Started WCF sample using a WCF moniker that specifies a Mex endpoint.  \n  \n> [!NOTE]\n>  The types defined by the WCF client assembly are never actually instantiated. The assembly is used only for metadata.  \n  \n### Using the service moniker with a Mex address  \n  \n1.  Build the Getting Started sample and use Internet Explorer to browse to its URL (http://localhost/ServiceModelSamples/Service.svc) to ensure that the service is working.  \n  \n2.  Create a Visual Basic script or Visual Basic application that contains the following code:  \n  \n    ```  \n    monString = \"service:mexaddress=http://localhost/ServiceModelSamples/Service.svc/MEX\"  \n    monString = monString + \", address=http://localhost/ServiceModelSamples/Service.svc\"  \n    monString = monString + \", contract=ICalculator, contractNamespace=http://Microsoft.ServiceModel.Samples\"  \n    monString = monString + \", binding=WSHttpBinding_ICalculator, bindingNamespace=http://Microsoft.ServiceModel.Samples\"  \n  \n    Set calc = GetObject(monString)  \n    MsgBox calc.Add(3, 4)  \n    ```  \n  \n3.  Run the Visual Basic application or script.  \n  \n    > [!NOTE]\n    >  The service you are calling must expose a Mex endpoint for the moniker to be able to read the metadata from the service. For more information, see [How to: Publish Metadata for a Service Using a Configuration File](../../../../docs/framework/wcf/feature-details/how-to-publish-metadata-for-a-service-using-a-configuration-file.md).  \n  \n    > [!NOTE]\n    >  If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\"  If you receive this error, make sure the moniker you are using is correct and the service is available.  \n  \n## See also\n\n- [How to: Use the Windows Communication Foundation Service Moniker without Registration](../../../../docs/framework/wcf/feature-details/use-the-wcf-service-moniker-without-registration.md)\n- [How to: Use a Service Moniker with WSDL Contracts](../../../../docs/framework/wcf/feature-details/how-to-use-a-service-moniker-with-wsdl-contracts.md)\n","nodes":[{"pos":[4,146],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use a Service Moniker with Metadata Exchange Contracts\"\nms.date: \"03/30/2017\"\nms.assetid: c41a07e5-cb9d-45d6-9ea4-34511e227faf","nodes":[{"content":"How to: Use a Service Moniker with Metadata Exchange Contracts","nodes":[{"pos":[0,62],"content":"How to: Use a Service Moniker with Metadata Exchange Contracts","nodes":[{"content":"How to: Use a Service Moniker with Metadata Exchange Contracts","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[153,215],"content":"How to: Use a Service Moniker with Metadata Exchange Contracts","linkify":"How to: Use a Service Moniker with Metadata Exchange Contracts","nodes":[{"content":"How to: Use a Service Moniker with Metadata Exchange Contracts","pos":[0,62]}]},{"content":"After developing some new WCF services, you may decide that you want to be able to call these services from a script or a Visual Basic 6.0 application.","pos":[216,367]},{"content":"One method would be to generate a WCF client assembly, register the assembly with COM, install the assembly in the GAC, and then reference the COM types from your Visual Basic code.","pos":[368,549]},{"content":"When you distribute the application, you will have to distribute the WCF Client assembly as well.","pos":[550,647]},{"content":"The user will then have to register the WCF client assembly with COM and place it in the GAC.","pos":[648,741]},{"content":"WCF COM Interop also allows you to make the same service calls without relying on a WCF client assembly.","pos":[742,846]},{"content":"The WCF moniker allows you to call any WCF service from any COM-compatible language (Visual Basic, VBScript, Visual Basic for Applications (VBA), and so on) by specifying a metadata exchange (Mex) endpoint URI that the service moniker uses to extract type information about the service.","pos":[847,1133]},{"content":"This topic describes how to call the Getting Started WCF sample using a WCF moniker that specifies a Mex endpoint.","pos":[1134,1248]},{"pos":[1256,1384],"content":"[!NOTE]\n The types defined by the WCF client assembly are never actually instantiated. The assembly is used only for metadata.","leadings":["","> "],"nodes":[{"content":"The types defined by the WCF client assembly are never actually instantiated. The assembly is used only for metadata.","pos":[9,126],"nodes":[{"content":"The types defined by the WCF client assembly are never actually instantiated.","pos":[0,77]},{"content":"The assembly is used only for metadata.","pos":[78,117]}]}]},{"pos":[1394,1438],"content":"Using the service moniker with a Mex address","linkify":"Using the service moniker with a Mex address","nodes":[{"content":"Using the service moniker with a Mex address","pos":[0,44]}]},{"content":"Build the Getting Started sample and use Internet Explorer to browse to its URL (<ph id=\"ph1\">http://localhost/ServiceModelSamples/Service.svc)</ph> to ensure that the service is working.","pos":[1448,1617],"source":"Build the Getting Started sample and use Internet Explorer to browse to its URL (http://localhost/ServiceModelSamples/Service.svc) to ensure that the service is working."},{"content":"Create a Visual Basic script or Visual Basic application that contains the following code:","pos":[1627,1717]},{"content":"Run the Visual Basic application or script.","pos":[2238,2281]},{"pos":[2293,2639],"content":"[!NOTE]\nThe service you are calling must expose a Mex endpoint for the moniker to be able to read the metadata from the service. For more information, see [How to: Publish Metadata for a Service Using a Configuration File](../../../../docs/framework/wcf/feature-details/how-to-publish-metadata-for-a-service-using-a-configuration-file.md).","leadings":["","    >  "],"nodes":[{"content":"The service you are calling must expose a Mex endpoint for the moniker to be able to read the metadata from the service. For more information, see [How to: Publish Metadata for a Service Using a Configuration File](../../../../docs/framework/wcf/feature-details/how-to-publish-metadata-for-a-service-using-a-configuration-file.md).","pos":[8,339],"nodes":[{"content":"The service you are calling must expose a Mex endpoint for the moniker to be able to read the metadata from the service.","pos":[0,120]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Publish Metadata for a Service Using a Configuration File<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-publish-metadata-for-a-service-using-a-configuration-file.md)</ept>.","pos":[121,331],"source":" For more information, see [How to: Publish Metadata for a Service Using a Configuration File](../../../../docs/framework/wcf/feature-details/how-to-publish-metadata-for-a-service-using-a-configuration-file.md)."}]}]},{"pos":[2651,2902],"content":"[!NOTE]\nIf the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\"  If you receive this error, make sure the moniker you are using is correct and the service is available.","leadings":["","    >  "],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\"  If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[8,244],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable, the call to <ph id=\"ph1\">`GetObject`</ph> will return an error saying \"Invalid Syntax.\"","pos":[0,131],"source":"If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\""},{"content":"If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[133,236]}]}]},{"pos":[2911,2919],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2923,3110],"content":"<bpt id=\"p1\">[</bpt>How to: Use the Windows Communication Foundation Service Moniker without Registration<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/use-the-wcf-service-moniker-without-registration.md)</ept>","source":"[How to: Use the Windows Communication Foundation Service Moniker without Registration](../../../../docs/framework/wcf/feature-details/use-the-wcf-service-moniker-without-registration.md)"},{"pos":[3113,3264],"content":"<bpt id=\"p1\">[</bpt>How to: Use a Service Moniker with WSDL Contracts<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-a-service-moniker-with-wsdl-contracts.md)</ept>","source":"[How to: Use a Service Moniker with WSDL Contracts](../../../../docs/framework/wcf/feature-details/how-to-use-a-service-moniker-with-wsdl-contracts.md)"}]}