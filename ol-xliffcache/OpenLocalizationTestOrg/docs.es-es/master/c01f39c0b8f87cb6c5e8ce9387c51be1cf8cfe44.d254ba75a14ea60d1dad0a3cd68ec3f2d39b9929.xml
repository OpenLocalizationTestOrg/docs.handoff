{"content":"---\ntitle: \"Basic Sample | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: c1910bc1-3d0a-4fa6-b12a-4ed6fe759620\ncaps.latest.revision: 17\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Basic Sample\nThis sample shows how to make a service discoverable and how to search for and call a discoverable service. This sample is composed of two projects: service and client.  \n  \n> [!NOTE]\n>  This sample implements discovery in code.  For a sample that implements discovery in configuration, see [Configuration](../../../../docs/framework/wcf/samples/configuration-sample.md).  \n  \n## Service  \n This is a simple calculator service implementation. The discovery related code can be found in `Main` where a <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> is added to the service host and a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> is added as shown in the following code.  \n  \n```  \nusing (ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService), baseAddress))  \n{  \n    serviceHost.AddServiceEndpoint(typeof(ICalculatorService), new   \n      WSHttpBinding(), String.Empty);  \n  \n    // Make the service discoverable over UDP multicast  \n    serviceHost.Description.Behaviors.Add(new ServiceDiscoveryBehavior());                  \n    serviceHost.AddServiceEndpoint(new UdpDiscoveryEndpoint());  \n  \n    serviceHost.Open();  \n    // ...  \n}  \n```  \n  \n## Client  \n The client uses a <xref:System.ServiceModel.Discovery.DynamicEndpoint> to locate the service. The <xref:System.ServiceModel.Discovery.DynamicEndpoint>, a standard endpoint, resolves the endpoint of the service when the client is opened. In this case, the <xref:System.ServiceModel.Discovery.DynamicEndpoint> looks for the service based on the service contract. The <xref:System.ServiceModel.Discovery.DynamicEndpoint> conducts the search over a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> by default. Once it locates a service endpoint, the client connects to that service over the specified binding.  \n  \n```csharp  \npublic static void Main()  \n{  \n   DynamicEndpoint dynamicEndpoint = new DynamicEndpoint( ContractDescription.GetContract(typeof(ICalculatorService)), new WSHttpBinding());  \n   // ...  \n}              \n```  \n  \n The client defines a method called `InvokeCalculatorService` that uses the <xref:System.ServiceModel.Discovery.DiscoveryClient> class to search for services. The <xref:System.ServiceModel.Discovery.DynamicEndpoint> inherits from <xref:System.ServiceModel.Description.ServiceEndpoint>, so it can be passed to the `InvokeCalculatorService` method. The example then uses the <xref:System.ServiceModel.Discovery.DynamicEndpoint> to create an instance of `CalculatorServiceClient` and calls the various operations of the calculator service.  \n  \n```csharp  \nstatic void InvokeCalculatorService(ServiceEndpoint serviceEndpoint)  \n{  \n   // Create a client  \n   CalculatorServiceClient client = new CalculatorServiceClient(serviceEndpoint);  \n  \n   Console.WriteLine(\"Invoking CalculatorService\");  \n   Console.WriteLine();  \n  \n   double value1 = 100.00D;  \n   double value2 = 15.99D;  \n  \n   // Call the Add service operation.  \n   double result = client.Add(value1, value2);  \n   Console.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n  \n   // Call the Subtract service operation.  \n   result = client.Subtract(value1, value2);  \n   Console.WriteLine(\"Subtract({0},{1}) = {2}\", value1, value2, result);  \n  \n   // Call the Multiply service operation.  \n   result = client.Multiply(value1, value2);  \n   Console.WriteLine(\"Multiply({0},{1}) = {2}\", value1, value2, result);  \n  \n   // Call the Divide service operation.  \n   result = client.Divide(value1, value2);  \n   Console.WriteLine(\"Divide({0},{1}) = {2}\", value1, value2, result);  \n   Console.WriteLine();  \n  \n   //Closing the client gracefully closes the connection and cleans up resources  \n   client.Close();  \n}  \n  \n```  \n  \n#### To use this sample  \n  \n1.  This sample uses HTTP endpoints and to run this sample, proper URL ACLs must be added. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Configuring HTTP and HTTPS](http://go.microsoft.com/fwlink/?LinkId=70353). Executing the following command at an elevated privilege should add the appropriate ACLs. You may want to substitute your Domain and Username for the following arguments if the command does not work as is. `netsh http add urlacl url=http://+:8000/ user=%DOMAIN%\\%UserName%`  \n  \n2.  Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open the Basic.sln and build the sample.  \n  \n3.  Run the service.exe application.  \n  \n4.  After the service has started, run the client.exe.  \n  \n5.  Observe that the client was able to find the service without knowing its address.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Discovery\\Basic`  \n  \n## See Also","nodes":[{"pos":[12,41],"content":"Basic Sample | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Basic Sample | Microsoft Docs","pos":[0,29]}]},{"pos":[340,352],"content":"Basic Sample","linkify":"Basic Sample","nodes":[{"content":"Basic Sample","pos":[0,12]}]},{"content":"This sample shows how to make a service discoverable and how to search for and call a discoverable service.","pos":[353,460]},{"content":"This sample is composed of two projects: service and client.","pos":[461,521]},{"pos":[529,724],"content":"[!NOTE]\n This sample implements discovery in code.  For a sample that implements discovery in configuration, see [Configuration](../../../../docs/framework/wcf/samples/configuration-sample.md).","leadings":["","> "],"nodes":[{"content":" This sample implements discovery in code.  For a sample that implements discovery in configuration, see [Configuration](../../../../docs/framework/wcf/samples/configuration-sample.md).","pos":[8,193],"nodes":[{"content":"This sample implements discovery in code.","pos":[1,42]},{"content":"For a sample that implements discovery in configuration, see <bpt id=\"p1\">[</bpt>Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/samples/configuration-sample.md)</ept>.","pos":[44,185],"source":"  For a sample that implements discovery in configuration, see [Configuration](../../../../docs/framework/wcf/samples/configuration-sample.md)."}]}]},{"pos":[733,740],"content":"Service","linkify":"Service","nodes":[{"content":"Service","pos":[0,7]}]},{"content":"This is a simple calculator service implementation.","pos":[744,795]},{"content":"The discovery related code can be found in <ph id=\"ph1\">`Main`</ph> where a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior&gt;</ph> is added to the service host and a <ph id=\"ph3\">&lt;xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint&gt;</ph> is added as shown in the following code.","pos":[796,1049],"source":" The discovery related code can be found in `Main` where a <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> is added to the service host and a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> is added as shown in the following code."},{"pos":[1545,1551],"content":"Client","linkify":"Client","nodes":[{"content":"Client","pos":[0,6]}]},{"content":"The client uses a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> to locate the service.","pos":[1555,1648],"source":"The client uses a <xref:System.ServiceModel.Discovery.DynamicEndpoint> to locate the service."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph>, a standard endpoint, resolves the endpoint of the service when the client is opened.","pos":[1649,1791],"source":" The <xref:System.ServiceModel.Discovery.DynamicEndpoint>, a standard endpoint, resolves the endpoint of the service when the client is opened."},{"content":"In this case, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> looks for the service based on the service contract.","pos":[1792,1915],"source":" In this case, the <xref:System.ServiceModel.Discovery.DynamicEndpoint> looks for the service based on the service contract."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> conducts the search over a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint&gt;</ph> by default.","pos":[1916,2069],"source":" The <xref:System.ServiceModel.Discovery.DynamicEndpoint> conducts the search over a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> by default."},{"content":"Once it locates a service endpoint, the client connects to that service over the specified binding.","pos":[2070,2169]},{"content":"The client defines a method called <ph id=\"ph1\">`InvokeCalculatorService`</ph> that uses the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> class to search for services.","pos":[2400,2557],"source":"The client defines a method called `InvokeCalculatorService` that uses the <xref:System.ServiceModel.Discovery.DiscoveryClient> class to search for services."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> inherits from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ServiceEndpoint&gt;</ph>, so it can be passed to the <ph id=\"ph3\">`InvokeCalculatorService`</ph> method.","pos":[2558,2745],"source":" The <xref:System.ServiceModel.Discovery.DynamicEndpoint> inherits from <xref:System.ServiceModel.Description.ServiceEndpoint>, so it can be passed to the `InvokeCalculatorService` method."},{"content":"The example then uses the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> to create an instance of <ph id=\"ph2\">`CalculatorServiceClient`</ph> and calls the various operations of the calculator service.","pos":[2746,2935],"source":" The example then uses the <xref:System.ServiceModel.Discovery.DynamicEndpoint> to create an instance of `CalculatorServiceClient` and calls the various operations of the calculator service."},{"pos":[4101,4119],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"content":"This sample uses HTTP endpoints and to run this sample, proper URL ACLs must be added.","pos":[4129,4215]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Configuring HTTP and HTTPS<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=70353)</ept>.","pos":[4216,4350],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Configuring HTTP and HTTPS](http://go.microsoft.com/fwlink/?LinkId=70353)."},{"content":"Executing the following command at an elevated privilege should add the appropriate ACLs.","pos":[4351,4440]},{"content":"You may want to substitute your Domain and Username for the following arguments if the command does not work as is.","pos":[4441,4556]},{"pos":[4634,4753],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]</ph>, open the Basic.sln and build the sample.","source":"Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open the Basic.sln and build the sample."},{"content":"Run the service.exe application.","pos":[4763,4795]},{"content":"After the service has started, run the client.exe.","pos":[4805,4855]},{"content":"Observe that the client was able to find the service without knowing its address.","pos":[4865,4946]},{"pos":[4954,5086],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[5140,5466],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[5467,5517]},{"pos":[5595,5603],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}