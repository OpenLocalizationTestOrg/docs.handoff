{"content":"---\ntitle: \"Application Settings Overview\"\nms.date: \"03/30/2017\"\nf1_keywords: \n  - \"ApplicationsSettingsOverview\"\nhelpviewer_keywords: \n  - \"application settings [Windows Forms], about application settings\"\n  - \"dynamic properties\"\n  - \"user preferences [Windows Forms], tracking\"\nms.assetid: 0dd8bca5-a6bf-4ac4-8eec-5725d08b38dc\n---\n# Application Settings Overview\nThis topic discusses how to create and store settings data on behalf of your application and your users.  \n  \n The Application Settings feature of Windows Forms makes it easy to create, store, and maintain custom application and user preferences on the client computer. With Windows Forms application settings, you can store not only application data such as database connection strings, but also user-specific data, such as user application preferences. Using Visual Studio or custom managed code, you can create new settings, read them from and write them to disk, bind them to properties on your forms, and validate settings data prior to loading and saving.  \n  \n Application settings enables developers to save state in their application using very little custom code, and is a replacement for dynamic properties in previous versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. Application settings contains many improvements over dynamic properties, which are read-only, late-bound, and require more custom programming. The dynamic property classes have been retained in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)], but they are just shell classes that thinly wrap the application settings classes.  \n  \n## What Are Application Settings?  \n Your Windows Forms applications will often require data that is critical to running the application, but which you do not want to include directly in the application's code. If your application uses a Web Service or a database server, you may want to store this information in a separate file, so that you can change it in the future without re-compiling. Similarly, your applications may require storing data that is specific to the current user. Most applications, for example, have user preferences that customize the application's appearance and behavior.  \n  \n Application settings addresses both needs by providing an easy way to store both application-scoped and user-scoped settings on the client computer. Using Visual Studio or a code editor, you define a setting for a given property by specifying its name, data type, and scope (application or user). You can even place related settings into named groups for easier use and readability. Once defined, these settings are persisted and read back into memory automatically at run time. A pluggable architecture enables the persistence mechanism to be changed, but by default, the local file system is used.  \n  \n Application settings works by persisting data as XML to different configuration (.config) files, corresponding to whether the setting is application-scoped or user-scoped. In most cases, the application-scoped settings are read-only; because they are program information, you will typically not need to overwrite them. By contrast, user-scoped settings can be read and written safely at run time, even if your application runs under partial trust. For more information about partial trust, see [Security in Windows Forms Overview](../security-in-windows-forms-overview.md).  \n  \n Settings are stored as XML fragments in configuration files. Application-scoped settings are represented by the `<application.Settings>` element, and generally are placed in *app*.exe.config, where *app* is the name of your main executable file. User-scoped settings are represented by the `<userSettings>` element and are placed in *user*.config, where *user* is the user name of the person currently running the application. You must deploy the *app*.exe.config file with your application; the settings architecture will create the *user*.config files on demand the first time the application saves settings for that user. You can also define a `<userSettings>` block within *app*.exe.config to provide default values for user-scoped settings.  \n  \n Custom controls can also save their own settings by implementing the <xref:System.Configuration.IPersistComponentSettings> interface, which exposes the <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> method. The Windows Forms <xref:System.Windows.Forms.ToolStrip> control implements this interface to save the position of toolbars and toolbar items between application sessions. For more information about custom controls and application settings, see [Application Settings for Custom Controls](application-settings-for-custom-controls.md).  \n  \n## Limitations of Application Settings  \n You cannot use application settings in an unmanaged application that hosts the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. Settings will not work in such environments as Visual Studio add-ins, C++ for Microsoft Office, control hosting in Internet Explorer, or Microsoft Outlook add-ins and projects.  \n  \n You currently cannot bind to some properties in Windows Forms. The most notable example is the <xref:System.Windows.Forms.Form.ClientSize%2A> property, as binding to this property would cause unpredictable behavior at run time. You can usually work around these issues by saving and loading these settings programmatically.  \n  \n Application settings has no built-in facility for encrypting information automatically. You should never store security-related information, such as database passwords, in clear text. If you want to store such sensitive information, you as the application developer are responsible for making sure it is secure. If you want to store connection strings, we recommend that you use Windows Integrated Security and not resort to hard-coding passwords into the URL. For more information, see [Code Access Security and ADO.NET](../../data/adonet/code-access-security.md).  \n  \n## Getting Started with Application Settings  \n If you use Visual Studio, you can define settings within the Windows Forms Designer using the **(ApplicationSettings)** property in the **Properties** window. When you define settings this way, Visual Studio automatically creates a custom managed wrapper class which associates each setting with a class property. Visual Studio also takes care of binding the setting to a property on a form or control so that the control's settings are restored automatically when its form is displayed, and saved automatically when the form is closed.  \n  \n If you want more detailed control over your settings, you can define your own custom applications settings wrapper class. This is accomplished by deriving a class from <xref:System.Configuration.ApplicationSettingsBase>, adding a property that corresponds to each setting, and applying special attributes to these properties. For details about creating wrapper classes, see [Application Settings Architecture](application-settings-architecture.md).  \n  \n You can also use the <xref:System.Windows.Forms.Binding> class to bind settings programmatically to properties on forms and controls.  \n  \n## See also\n\n- <xref:System.Configuration.ApplicationSettingsBase>\n- <xref:System.Configuration.SettingsProvider>\n- <xref:System.Configuration.LocalFileSettingsProvider>\n- <xref:System.Configuration.IPersistComponentSettings>\n- [How to: Validate Application Settings](how-to-validate-application-settings.md)\n- [Managing Application Settings (.NET)](/visualstudio/ide/managing-application-settings-dotnet)\n- [How To: Read Settings at Run Time With C#](how-to-read-settings-at-run-time-with-csharp.md)\n- [Using Application Settings and User Settings](using-application-settings-and-user-settings.md)\n- [Application Settings Architecture](application-settings-architecture.md)\n- [Application Settings for Custom Controls](application-settings-for-custom-controls.md)\n","nodes":[{"pos":[4,329],"embed":true,"restype":"x-metadata","content":"title: \"Application Settings Overview\"\nms.date: \"03/30/2017\"\nf1_keywords: \n  - \"ApplicationsSettingsOverview\"\nhelpviewer_keywords: \n  - \"application settings [Windows Forms], about application settings\"\n  - \"dynamic properties\"\n  - \"user preferences [Windows Forms], tracking\"\nms.assetid: 0dd8bca5-a6bf-4ac4-8eec-5725d08b38dc","nodes":[{"content":"Application Settings Overview","nodes":[{"pos":[0,29],"content":"Application Settings Overview","nodes":[{"content":"Application Settings Overview","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[336,365],"content":"Application Settings Overview","linkify":"Application Settings Overview","nodes":[{"content":"Application Settings Overview","pos":[0,29]}]},{"content":"This topic discusses how to create and store settings data on behalf of your application and your users.","pos":[366,470]},{"content":"The Application Settings feature of Windows Forms makes it easy to create, store, and maintain custom application and user preferences on the client computer.","pos":[477,635]},{"content":"With Windows Forms application settings, you can store not only application data such as database connection strings, but also user-specific data, such as user application preferences.","pos":[636,820]},{"content":"Using Visual Studio or custom managed code, you can create new settings, read them from and write them to disk, bind them to properties on your forms, and validate settings data prior to loading and saving.","pos":[821,1027]},{"content":"Application settings enables developers to save state in their application using very little custom code, and is a replacement for dynamic properties in previous versions of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[1034,1276],"source":"Application settings enables developers to save state in their application using very little custom code, and is a replacement for dynamic properties in previous versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"Application settings contains many improvements over dynamic properties, which are read-only, late-bound, and require more custom programming.","pos":[1277,1419]},{"content":"The dynamic property classes have been retained in <ph id=\"ph1\">[!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]</ph>, but they are just shell classes that thinly wrap the application settings classes.","pos":[1420,1614],"source":" The dynamic property classes have been retained in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)], but they are just shell classes that thinly wrap the application settings classes."},{"pos":[1623,1653],"content":"What Are Application Settings?","linkify":"What Are Application Settings?","nodes":[{"content":"What Are Application Settings?","pos":[0,30]}]},{"content":"Your Windows Forms applications will often require data that is critical to running the application, but which you do not want to include directly in the application's code.","pos":[1657,1830]},{"content":"If your application uses a Web Service or a database server, you may want to store this information in a separate file, so that you can change it in the future without re-compiling.","pos":[1831,2012]},{"content":"Similarly, your applications may require storing data that is specific to the current user.","pos":[2013,2104]},{"content":"Most applications, for example, have user preferences that customize the application's appearance and behavior.","pos":[2105,2216]},{"content":"Application settings addresses both needs by providing an easy way to store both application-scoped and user-scoped settings on the client computer.","pos":[2223,2371]},{"content":"Using Visual Studio or a code editor, you define a setting for a given property by specifying its name, data type, and scope (application or user).","pos":[2372,2519]},{"content":"You can even place related settings into named groups for easier use and readability.","pos":[2520,2605]},{"content":"Once defined, these settings are persisted and read back into memory automatically at run time.","pos":[2606,2701]},{"content":"A pluggable architecture enables the persistence mechanism to be changed, but by default, the local file system is used.","pos":[2702,2822]},{"content":"Application settings works by persisting data as XML to different configuration (.config) files, corresponding to whether the setting is application-scoped or user-scoped.","pos":[2829,3000]},{"content":"In most cases, the application-scoped settings are read-only; because they are program information, you will typically not need to overwrite them.","pos":[3001,3147]},{"content":"By contrast, user-scoped settings can be read and written safely at run time, even if your application runs under partial trust.","pos":[3148,3276]},{"content":"For more information about partial trust, see <bpt id=\"p1\">[</bpt>Security in Windows Forms Overview<ept id=\"p1\">](../security-in-windows-forms-overview.md)</ept>.","pos":[3277,3402],"source":" For more information about partial trust, see [Security in Windows Forms Overview](../security-in-windows-forms-overview.md)."},{"content":"Settings are stored as XML fragments in configuration files.","pos":[3409,3469]},{"content":"Application-scoped settings are represented by the <ph id=\"ph1\">`&lt;application.Settings&gt;`</ph> element, and generally are placed in <bpt id=\"p1\">*</bpt>app<ept id=\"p1\">*</ept>.exe.config, where <bpt id=\"p2\">*</bpt>app<ept id=\"p2\">*</ept> is the name of your main executable file.","pos":[3470,3654],"source":" Application-scoped settings are represented by the `<application.Settings>` element, and generally are placed in *app*.exe.config, where *app* is the name of your main executable file."},{"content":"User-scoped settings are represented by the <ph id=\"ph1\">`&lt;userSettings&gt;`</ph> element and are placed in <bpt id=\"p1\">*</bpt>user<ept id=\"p1\">*</ept>.config, where <bpt id=\"p2\">*</bpt>user<ept id=\"p2\">*</ept> is the user name of the person currently running the application.","pos":[3655,3835],"source":" User-scoped settings are represented by the `<userSettings>` element and are placed in *user*.config, where *user* is the user name of the person currently running the application."},{"content":"You must deploy the <bpt id=\"p1\">*</bpt>app<ept id=\"p1\">*</ept>.exe.config file with your application; the settings architecture will create the <bpt id=\"p2\">*</bpt>user<ept id=\"p2\">*</ept>.config files on demand the first time the application saves settings for that user.","pos":[3836,4033],"source":" You must deploy the *app*.exe.config file with your application; the settings architecture will create the *user*.config files on demand the first time the application saves settings for that user."},{"content":"You can also define a <ph id=\"ph1\">`&lt;userSettings&gt;`</ph> block within <bpt id=\"p1\">*</bpt>app<ept id=\"p1\">*</ept>.exe.config to provide default values for user-scoped settings.","pos":[4034,4154],"source":" You can also define a `<userSettings>` block within *app*.exe.config to provide default values for user-scoped settings."},{"content":"Custom controls can also save their own settings by implementing the <ph id=\"ph1\">&lt;xref:System.Configuration.IPersistComponentSettings&gt;</ph> interface, which exposes the <ph id=\"ph2\">&lt;xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A&gt;</ph> method.","pos":[4161,4390],"source":"Custom controls can also save their own settings by implementing the <xref:System.Configuration.IPersistComponentSettings> interface, which exposes the <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> method."},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control implements this interface to save the position of toolbars and toolbar items between application sessions.","pos":[4391,4561],"source":" The Windows Forms <xref:System.Windows.Forms.ToolStrip> control implements this interface to save the position of toolbars and toolbar items between application sessions."},{"content":"For more information about custom controls and application settings, see <bpt id=\"p1\">[</bpt>Application Settings for Custom Controls<ept id=\"p1\">](application-settings-for-custom-controls.md)</ept>.","pos":[4562,4723],"source":" For more information about custom controls and application settings, see [Application Settings for Custom Controls](application-settings-for-custom-controls.md)."},{"pos":[4732,4767],"content":"Limitations of Application Settings","linkify":"Limitations of Application Settings","nodes":[{"content":"Limitations of Application Settings","pos":[0,35]}]},{"content":"You cannot use application settings in an unmanaged application that hosts the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[4771,4914],"source":"You cannot use application settings in an unmanaged application that hosts the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"Settings will not work in such environments as Visual Studio add-ins, C++ for Microsoft Office, control hosting in Internet Explorer, or Microsoft Outlook add-ins and projects.","pos":[4915,5091]},{"content":"You currently cannot bind to some properties in Windows Forms.","pos":[5098,5160]},{"content":"The most notable example is the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ClientSize%2A&gt;</ph> property, as binding to this property would cause unpredictable behavior at run time.","pos":[5161,5325],"source":" The most notable example is the <xref:System.Windows.Forms.Form.ClientSize%2A> property, as binding to this property would cause unpredictable behavior at run time."},{"content":"You can usually work around these issues by saving and loading these settings programmatically.","pos":[5326,5421]},{"content":"Application settings has no built-in facility for encrypting information automatically.","pos":[5428,5515]},{"content":"You should never store security-related information, such as database passwords, in clear text.","pos":[5516,5611]},{"content":"If you want to store such sensitive information, you as the application developer are responsible for making sure it is secure.","pos":[5612,5739]},{"content":"If you want to store connection strings, we recommend that you use Windows Integrated Security and not resort to hard-coding passwords into the URL.","pos":[5740,5888]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security and ADO.NET<ept id=\"p1\">](../../data/adonet/code-access-security.md)</ept>.","pos":[5889,5993],"source":" For more information, see [Code Access Security and ADO.NET](../../data/adonet/code-access-security.md)."},{"pos":[6002,6043],"content":"Getting Started with Application Settings","linkify":"Getting Started with Application Settings","nodes":[{"content":"Getting Started with Application Settings","pos":[0,41]}]},{"content":"If you use Visual Studio, you can define settings within the Windows Forms Designer using the <bpt id=\"p1\">**</bpt>(ApplicationSettings)<ept id=\"p1\">**</ept> property in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> window.","pos":[6047,6205],"source":"If you use Visual Studio, you can define settings within the Windows Forms Designer using the **(ApplicationSettings)** property in the **Properties** window."},{"content":"When you define settings this way, Visual Studio automatically creates a custom managed wrapper class which associates each setting with a class property.","pos":[6206,6360]},{"content":"Visual Studio also takes care of binding the setting to a property on a form or control so that the control's settings are restored automatically when its form is displayed, and saved automatically when the form is closed.","pos":[6361,6583]},{"content":"If you want more detailed control over your settings, you can define your own custom applications settings wrapper class.","pos":[6590,6711]},{"content":"This is accomplished by deriving a class from <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase&gt;</ph>, adding a property that corresponds to each setting, and applying special attributes to these properties.","pos":[6712,6915],"source":" This is accomplished by deriving a class from <xref:System.Configuration.ApplicationSettingsBase>, adding a property that corresponds to each setting, and applying special attributes to these properties."},{"content":"For details about creating wrapper classes, see <bpt id=\"p1\">[</bpt>Application Settings Architecture<ept id=\"p1\">](application-settings-architecture.md)</ept>.","pos":[6916,7038],"source":" For details about creating wrapper classes, see [Application Settings Architecture](application-settings-architecture.md)."},{"pos":[7045,7178],"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Binding&gt;</ph> class to bind settings programmatically to properties on forms and controls.","source":"You can also use the <xref:System.Windows.Forms.Binding> class to bind settings programmatically to properties on forms and controls."},{"pos":[7187,7195],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7412,7492],"content":"<bpt id=\"p1\">[</bpt>How to: Validate Application Settings<ept id=\"p1\">](how-to-validate-application-settings.md)</ept>","source":"[How to: Validate Application Settings](how-to-validate-application-settings.md)"},{"pos":[7495,7589],"content":"<bpt id=\"p1\">[</bpt>Managing Application Settings (.NET)<ept id=\"p1\">](/visualstudio/ide/managing-application-settings-dotnet)</ept>","source":"[Managing Application Settings (.NET)](/visualstudio/ide/managing-application-settings-dotnet)"},{"pos":[7592,7684],"content":"<bpt id=\"p1\">[</bpt>How To: Read Settings at Run Time With C#<ept id=\"p1\">](how-to-read-settings-at-run-time-with-csharp.md)</ept>","source":"[How To: Read Settings at Run Time With C#](how-to-read-settings-at-run-time-with-csharp.md)"},{"pos":[7687,7782],"content":"<bpt id=\"p1\">[</bpt>Using Application Settings and User Settings<ept id=\"p1\">](using-application-settings-and-user-settings.md)</ept>","source":"[Using Application Settings and User Settings](using-application-settings-and-user-settings.md)"},{"pos":[7785,7858],"content":"<bpt id=\"p1\">[</bpt>Application Settings Architecture<ept id=\"p1\">](application-settings-architecture.md)</ept>","source":"[Application Settings Architecture](application-settings-architecture.md)"},{"pos":[7861,7948],"content":"<bpt id=\"p1\">[</bpt>Application Settings for Custom Controls<ept id=\"p1\">](application-settings-for-custom-controls.md)</ept>","source":"[Application Settings for Custom Controls](application-settings-for-custom-controls.md)"}]}