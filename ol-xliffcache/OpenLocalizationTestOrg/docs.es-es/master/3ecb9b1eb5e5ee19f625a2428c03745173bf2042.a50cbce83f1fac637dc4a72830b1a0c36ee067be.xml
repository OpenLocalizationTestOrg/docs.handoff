{"content":"---\ntitle: \"Runtime Profiling | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"performance counters\"\n  - \"common language runtime, profiling\"\n  - \"Perfmon.exe\"\n  - \"System Monitor\"\n  - \"profiling\"\n  - \"runtime, profiling\"\n  - \"profiling applications\"\n  - \"Performance Console\"\nms.assetid: ccd68284-f3a8-47b8-bc3f-92e5fe3a1640\ncaps.latest.revision: 22\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Runtime Profiling\nProfiling is a method of gathering performance data in any development or deployment scenario. This section is for developers and system administrators who want to gather information about application performance.  \n  \n## Tracking Performance Using the Performance Monitor (Perfmon.exe)  \n The Performance Monitor is the easiest tool to use to profile your [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] application. The Performance Monitor graphically represents data found in the .NET Framework performance counters that are installed with the common language runtime and the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]. These counters can be used to monitor everything from memory management to just-in-time (JIT) compiler performance. They tell you about the resources your application uses, which is an indirect measure of your application's performance. Use these counters to understand how your application works internally.  \n  \n#### To run Perfmon.exe on Windows Vista and later versions  \n  \n1.  At the command prompt, type **perfmon**. The **Performance Monitor** console appears.  \n  \n2.  In the **Monitoring Tools** folder, click **Performance Monitor**.  \n  \n3.  In the Performance Monitor toolbar, click the **Add** icon (the plus sign), if it is present. If it is not present, right-click in the monitor window and select the **Add Counters** option.  \n  \n     This opens the **Add Counters** dialog box. The **Available counters** list box displays the available performance objects. There are a number of predefined objects for .NET Framework applications, including those for memory management (**.NET CLR Memory**), interoperability (**.NET CLR Interop**), exception handling (**.NET CLR Exceptions**), and multithreading (**.NET CLR LocksAndThreads**). Each performance object includes a number of individual performance counters. For a list of the performance counters available in Performance Monitor, see [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md).  \n  \n4.  Select the check box next to a performance object's name to view the list of individual performance counters that it supports.  \n  \n5.  Click the performance counter you want to view.  \n  \n6.  In the **Instances of selected object** list box, click **\\<All instances>** to specify that you want to monitor the performance counter for the common language runtime globally (that is, on a system-wide basis).  \n  \n     -or-  \n  \n     In the **Instances of selected object** list box, click an application name to monitor the performance counter for that application.  \n  \n     To differentiate multiple versions of the runtime, or to disambiguate multiple applications with the same name, you must also modify a registry key. For more information, see [Performance Counters and In-Process Side-By-Side Applications](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md).  \n  \n> [!NOTE]\n>  When new performance counters are installed while the Performance console is running, stop and restart the Performance console to make the new counters visible.  \n  \n If you want to profile an assembly that exists in a zone or on a remote share, make sure that the remote assembly has full trust on the computer that runs the performance counters. If the assembly does not have sufficient trust, the performance counters will not work. For information about granting trust to different zones, see [Caspol.exe (Code Access Security Policy Tool)](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).  \n  \n> [!NOTE]\n>  On systems on which the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the Performance Monitor may not display data for performance counters in some categories, such as **.NET CLR Data** and **.NET CLR Networking**, for applications that were developed using the [!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]. If this is the case, you can configure Performance Monitor to display this data by adding the [\\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) element to the application's configuration file.  \n  \n## Reading and Creating Performance Counters Programmatically  \n The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] provides classes you can use to programmatically access the same performance information that is available in the Performance console. You can also use these classes to create custom performance counters. The following table describes some of the performance monitoring classes that are provided in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].  \n  \n|Class|Description|  \n|-----------|-----------------|  \n|<xref:System.Diagnostics.PerformanceCounter?displayProperty=fullName>|Represents a Windows NT performance counter component. Use this class to read existing predefined or custom counters and publish (write) performance data to custom counters.|  \n|<xref:System.Diagnostics.PerformanceCounterCategory?displayProperty=fullName>|Provides several methods for interacting with counters and categories of counters on the computer.|  \n|<xref:System.Diagnostics.PerformanceCounterInstaller?displayProperty=fullName>|Specifies an installer for the `PerformanceCounter` component.|  \n|<xref:System.Diagnostics.PerformanceCounterType?displayProperty=fullName>|Specifies the formula to calculate the `NextValue` method for a `PerformanceCounter`.|  \n  \n## See Also  \n [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md)","nodes":[{"pos":[12,46],"content":"Runtime Profiling | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Runtime Profiling | Microsoft Docs","pos":[0,34]}]},{"pos":[632,649],"content":"Runtime Profiling","linkify":"Runtime Profiling","nodes":[{"content":"Runtime Profiling","pos":[0,17]}]},{"content":"Profiling is a method of gathering performance data in any development or deployment scenario.","pos":[650,744]},{"content":"This section is for developers and system administrators who want to gather information about application performance.","pos":[745,863]},{"pos":[872,936],"content":"Tracking Performance Using the Performance Monitor (Perfmon.exe)","linkify":"Tracking Performance Using the Performance Monitor (Perfmon.exe)","nodes":[{"content":"Tracking Performance Using the Performance Monitor (Perfmon.exe)","pos":[0,64]}]},{"content":"The Performance Monitor is the easiest tool to use to profile your <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> application.","pos":[940,1080],"source":"The Performance Monitor is the easiest tool to use to profile your [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] application."},{"content":"The Performance Monitor graphically represents data found in the .NET Framework performance counters that are installed with the common language runtime and the <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]</ph>.","pos":[1081,1301],"source":" The Performance Monitor graphically represents data found in the .NET Framework performance counters that are installed with the common language runtime and the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]."},{"content":"These counters can be used to monitor everything from memory management to just-in-time (JIT) compiler performance.","pos":[1302,1417]},{"content":"They tell you about the resources your application uses, which is an indirect measure of your application's performance.","pos":[1418,1538]},{"content":"Use these counters to understand how your application works internally.","pos":[1539,1610]},{"pos":[1621,1675],"content":"To run Perfmon.exe on Windows Vista and later versions","linkify":"To run Perfmon.exe on Windows Vista and later versions","nodes":[{"content":"To run Perfmon.exe on Windows Vista and later versions","pos":[0,54]}]},{"content":"At the command prompt, type <bpt id=\"p1\">**</bpt>perfmon<ept id=\"p1\">**</ept>.","pos":[1685,1725],"source":"At the command prompt, type **perfmon**."},{"content":"The <bpt id=\"p1\">**</bpt>Performance Monitor<ept id=\"p1\">**</ept> console appears.","pos":[1726,1770],"source":" The **Performance Monitor** console appears."},{"pos":[1780,1846],"content":"In the <bpt id=\"p1\">**</bpt>Monitoring Tools<ept id=\"p1\">**</ept> folder, click <bpt id=\"p2\">**</bpt>Performance Monitor<ept id=\"p2\">**</ept>.","source":"In the **Monitoring Tools** folder, click **Performance Monitor**."},{"content":"In the Performance Monitor toolbar, click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> icon (the plus sign), if it is present.","pos":[1856,1949],"source":"In the Performance Monitor toolbar, click the **Add** icon (the plus sign), if it is present."},{"content":"If it is not present, right-click in the monitor window and select the <bpt id=\"p1\">**</bpt>Add Counters<ept id=\"p1\">**</ept> option.","pos":[1950,2045],"source":" If it is not present, right-click in the monitor window and select the **Add Counters** option."},{"content":"This opens the <bpt id=\"p1\">**</bpt>Add Counters<ept id=\"p1\">**</ept> dialog box.","pos":[2056,2099],"source":"This opens the **Add Counters** dialog box."},{"content":"The <bpt id=\"p1\">**</bpt>Available counters<ept id=\"p1\">**</ept> list box displays the available performance objects.","pos":[2100,2179],"source":" The **Available counters** list box displays the available performance objects."},{"content":"There are a number of predefined objects for .NET Framework applications, including those for memory management (<bpt id=\"p1\">**</bpt>.NET CLR Memory<ept id=\"p1\">**</ept>), interoperability (<bpt id=\"p2\">**</bpt>.NET CLR Interop<ept id=\"p2\">**</ept>), exception handling (<bpt id=\"p3\">**</bpt>.NET CLR Exceptions<ept id=\"p3\">**</ept>), and multithreading (<bpt id=\"p4\">**</bpt>.NET CLR LocksAndThreads<ept id=\"p4\">**</ept>).","pos":[2180,2452],"source":" There are a number of predefined objects for .NET Framework applications, including those for memory management (**.NET CLR Memory**), interoperability (**.NET CLR Interop**), exception handling (**.NET CLR Exceptions**), and multithreading (**.NET CLR LocksAndThreads**)."},{"content":"Each performance object includes a number of individual performance counters.","pos":[2453,2530]},{"content":"For a list of the performance counters available in Performance Monitor, see <bpt id=\"p1\">[</bpt>Performance Counters<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/performance-counters.md)</ept>.","pos":[2531,2700],"source":" For a list of the performance counters available in Performance Monitor, see [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md)."},{"content":"Select the check box next to a performance object's name to view the list of individual performance counters that it supports.","pos":[2710,2836]},{"content":"Click the performance counter you want to view.","pos":[2846,2893]},{"pos":[2903,3115],"content":"In the <bpt id=\"p1\">**</bpt>Instances of selected object<ept id=\"p1\">**</ept> list box, click <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\&lt;</ph>All instances&gt;<ept id=\"p2\">**</ept> to specify that you want to monitor the performance counter for the common language runtime globally (that is, on a system-wide basis).","source":"In the **Instances of selected object** list box, click **\\<All instances>** to specify that you want to monitor the performance counter for the common language runtime globally (that is, on a system-wide basis)."},{"content":"-or-","pos":[3126,3130]},{"pos":[3141,3273],"content":"In the <bpt id=\"p1\">**</bpt>Instances of selected object<ept id=\"p1\">**</ept> list box, click an application name to monitor the performance counter for that application.","source":"In the **Instances of selected object** list box, click an application name to monitor the performance counter for that application."},{"content":"To differentiate multiple versions of the runtime, or to disambiguate multiple applications with the same name, you must also modify a registry key.","pos":[3284,3432]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Performance Counters and In-Process Side-By-Side Applications<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md)</ept>.","pos":[3433,3633],"source":" For more information, see [Performance Counters and In-Process Side-By-Side Applications](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md)."},{"pos":[3641,3812],"content":"[!NOTE]\n When new performance counters are installed while the Performance console is running, stop and restart the Performance console to make the new counters visible.","leadings":["","> "],"nodes":[{"content":"When new performance counters are installed while the Performance console is running, stop and restart the Performance console to make the new counters visible.","pos":[9,169]}]},{"content":"If you want to profile an assembly that exists in a zone or on a remote share, make sure that the remote assembly has full trust on the computer that runs the performance counters.","pos":[3819,3999]},{"content":"If the assembly does not have sufficient trust, the performance counters will not work.","pos":[4000,4087]},{"content":"For information about granting trust to different zones, see <bpt id=\"p1\">[</bpt>Caspol.exe (Code Access Security Policy Tool)<ept id=\"p1\">](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)</ept>.","pos":[4088,4275],"source":" For information about granting trust to different zones, see [Caspol.exe (Code Access Security Policy Tool)](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)."},{"pos":[4283,4967],"content":"[!NOTE]\n On systems on which the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the Performance Monitor may not display data for performance counters in some categories, such as **.NET CLR Data** and **.NET CLR Networking**, for applications that were developed using the [!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]. If this is the case, you can configure Performance Monitor to display this data by adding the [\\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) element to the application's configuration file.","leadings":["","> "],"nodes":[{"content":" On systems on which the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the Performance Monitor may not display data for performance counters in some categories, such as **.NET CLR Data** and **.NET CLR Networking**, for applications that were developed using the [!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]. If this is the case, you can configure Performance Monitor to display this data by adding the [\\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) element to the application's configuration file.","pos":[8,682],"nodes":[{"content":"On systems on which the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]</ph> is installed, the Performance Monitor may not display data for performance counters in some categories, such as <bpt id=\"p1\">**</bpt>.NET CLR Data<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>.NET CLR Networking<ept id=\"p2\">**</ept>, for applications that were developed using the <ph id=\"ph2\">[!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]</ph>.","pos":[1,361],"source":" On systems on which the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the Performance Monitor may not display data for performance counters in some categories, such as **.NET CLR Data** and **.NET CLR Networking**, for applications that were developed using the [!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]."},{"content":"If this is the case, you can configure Performance Monitor to display this data by adding the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>forcePerformanceCounterUniqueSharedMemoryReads&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md)</ept> element to the application's configuration file.","pos":[362,674],"source":" If this is the case, you can configure Performance Monitor to display this data by adding the [\\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) element to the application's configuration file."}]}]},{"pos":[4976,5034],"content":"Reading and Creating Performance Counters Programmatically","linkify":"Reading and Creating Performance Counters Programmatically","nodes":[{"content":"Reading and Creating Performance Counters Programmatically","pos":[0,58]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> provides classes you can use to programmatically access the same performance information that is available in the Performance console.","pos":[5038,5237],"source":"The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] provides classes you can use to programmatically access the same performance information that is available in the Performance console."},{"content":"You can also use these classes to create custom performance counters.","pos":[5238,5307]},{"content":"The following table describes some of the performance monitoring classes that are provided in the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph>.","pos":[5308,5467],"source":" The following table describes some of the performance monitoring classes that are provided in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]."},{"content":"Class","pos":[5474,5479]},{"content":"Description","pos":[5480,5491]},{"content":"Represents a Windows NT performance counter component.","pos":[5600,5654]},{"content":"Use this class to read existing predefined or custom counters and publish (write) performance data to custom counters.","pos":[5655,5773]},{"content":"Provides several methods for interacting with counters and categories of counters on the computer.","pos":[5856,5954]},{"pos":[6038,6100],"content":"Specifies an installer for the <ph id=\"ph1\">`PerformanceCounter`</ph> component.","source":"Specifies an installer for the `PerformanceCounter` component."},{"pos":[6179,6264],"content":"Specifies the formula to calculate the <ph id=\"ph1\">`NextValue`</ph> method for a <ph id=\"ph2\">`PerformanceCounter`</ph>.","source":"Specifies the formula to calculate the `NextValue` method for a `PerformanceCounter`."},{"pos":[6274,6282],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[6286,6377],"content":"<bpt id=\"p1\">[</bpt>Performance Counters<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/performance-counters.md)</ept>","source":"[Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md)"}]}