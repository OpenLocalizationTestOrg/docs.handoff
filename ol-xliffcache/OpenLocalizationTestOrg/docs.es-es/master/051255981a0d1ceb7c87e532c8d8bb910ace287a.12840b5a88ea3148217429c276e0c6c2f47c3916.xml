{"content":"---\ntitle: \"How to: Validate and Merge PrintTickets | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"merging PrintTickets\"\n  - \"PrintTicket, merging\"\n  - \"validation of PrintTickets\"\n  - \"PrintTicket, validation\"\nms.assetid: 4fe2d501-d0b0-4fef-86af-6ffe6c162532\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Validate and Merge PrintTickets\nThe [!INCLUDE[TLA#tla_win](../../../../includes/tlasharptla-win-md.md)] [Print Schema](http://go.microsoft.com/fwlink/?LinkId=186397) includes the flexible and extensible <xref:System.Printing.PrintCapabilities> and <xref:System.Printing.PrintTicket> elements. The former itemizes the capabilities of a print device and the latter specifies how the device should use those capabilities with respect to a particular sequence of documents, individual document, or individual page.  \n  \n A typical sequence of tasks for an application that supports printing would be as follows.  \n  \n1.  Determine a printer's capabilities.  \n  \n2.  Configure a <xref:System.Printing.PrintTicket> to use those capabilities.  \n  \n3.  Validate the <xref:System.Printing.PrintTicket>.  \n  \n This article shows how to do this.  \n  \n## Example  \n In the simple example below, we are interested only in whether a printer can support duplexing — two-sided printing. The major steps are as follows.  \n  \n1.  Get a <xref:System.Printing.PrintCapabilities> object with the <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A> method.  \n  \n2.  Test for the presence of the capability you want. In the example below, we test the <xref:System.Printing.PrintCapabilities.DuplexingCapability%2A> property of the <xref:System.Printing.PrintCapabilities> object for the presence of the capability of printing on both sides of a sheet of paper with the \"page turning\" along the long side of the sheet. Since <xref:System.Printing.PrintCapabilities.DuplexingCapability%2A> is a collection, we use the `Contains` method of <xref:System.Collections.ObjectModel.ReadOnlyCollection%601>.  \n  \n    > [!NOTE]\n    >  This step is not strictly necessary. The <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method used below will check each request in the <xref:System.Printing.PrintTicket> against the capabilities of the printer. If the requested capability is not supported by printer, the printer driver will substitute an alternative request in the <xref:System.Printing.PrintTicket> returned by the method.  \n  \n3.  If the printer supports duplexing, the sample code creates a <xref:System.Printing.PrintTicket> that asks for duplexing. But the application does not specify every possible printer setting available in the <xref:System.Printing.PrintTicket> element. That would be wasteful of both programmer and program time. Instead, the code sets only the duplexing request and then merges this <xref:System.Printing.PrintTicket> with an existing, fully configured and validated, <xref:System.Printing.PrintTicket>, in this case, the user's default <xref:System.Printing.PrintTicket>.  \n  \n4.  Accordingly, the sample calls the <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method to merge the new, minimal, <xref:System.Printing.PrintTicket> with the user's default <xref:System.Printing.PrintTicket>. This returns a <xref:System.Printing.ValidationResult> that includes the new <xref:System.Printing.PrintTicket> as one of its properties.  \n  \n5.  The sample then tests that the new <xref:System.Printing.PrintTicket> requests duplexing. If it does, then the sample makes it the new default print ticket for the user. If step 2 above had been left out and the printer did not support duplexing along the long side, then the test would have resulted in `false`. (See the note above.)  \n  \n6.  The last significant step is to commit the change to the <xref:System.Printing.PrintQueue.UserPrintTicket%2A> property of the <xref:System.Printing.PrintQueue> with the <xref:System.Printing.PrintQueue.Commit%2A> method.  \n  \n [!code-csharp[PrintTicketManagment#UsingMergeAndValidate](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#usingmergeandvalidate)]\n [!code-vb[PrintTicketManagment#UsingMergeAndValidate](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#usingmergeandvalidate)]  \n  \n So that you can quickly test this example, the remainder of it is presented below. Create a project and a namespace and then paste both the code snippets in this article into the namespace block.  \n  \n [!code-csharp[PrintTicketManagment#UIForMergeAndValidatePTUtility](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#uiformergeandvalidateptutility)]\n [!code-vb[PrintTicketManagment#UIForMergeAndValidatePTUtility](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#uiformergeandvalidateptutility)]  \n  \n## See Also  \n <xref:System.Printing.PrintCapabilities>   \n <xref:System.Printing.PrintTicket>   \n <xref:System.Printing.PrintServer.GetPrintQueues%2A>   \n <xref:System.Printing.PrintServer>   \n <xref:System.Printing.EnumeratedPrintQueueTypes>   \n <xref:System.Printing.PrintQueue>   \n <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A>   \n [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)   \n [Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md)   \n [Print Schema](http://go.microsoft.com/fwlink/?LinkId=186397)","nodes":[{"pos":[12,68],"content":"How to: Validate and Merge PrintTickets | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Validate and Merge PrintTickets | Microsoft Docs","pos":[0,56]}]},{"pos":[515,554],"content":"How to: Validate and Merge PrintTickets","linkify":"How to: Validate and Merge PrintTickets","nodes":[{"content":"How to: Validate and Merge PrintTickets","pos":[0,39]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_win](../../../../includes/tlasharptla-win-md.md)]</ph> <bpt id=\"p1\">[</bpt>Print Schema<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=186397)</ept> includes the flexible and extensible <ph id=\"ph2\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Printing.PrintTicket&gt;</ph> elements.","pos":[555,815],"source":"The [!INCLUDE[TLA#tla_win](../../../../includes/tlasharptla-win-md.md)] [Print Schema](http://go.microsoft.com/fwlink/?LinkId=186397) includes the flexible and extensible <xref:System.Printing.PrintCapabilities> and <xref:System.Printing.PrintTicket> elements."},{"content":"The former itemizes the capabilities of a print device and the latter specifies how the device should use those capabilities with respect to a particular sequence of documents, individual document, or individual page.","pos":[816,1033]},{"content":"A typical sequence of tasks for an application that supports printing would be as follows.","pos":[1040,1130]},{"content":"Determine a printer's capabilities.","pos":[1140,1175]},{"content":"Configure a <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> to use those capabilities.","pos":[1185,1258],"source":"Configure a <xref:System.Printing.PrintTicket> to use those capabilities."},{"content":"Validate the <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph>.","pos":[1268,1316],"source":"Validate the <xref:System.Printing.PrintTicket>."},{"content":"This article shows how to do this.","pos":[1323,1357]},{"pos":[1366,1373],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the simple example below, we are interested only in whether a printer can support duplexing — two-sided printing.","pos":[1377,1493]},{"content":"The major steps are as follows.","pos":[1494,1525]},{"content":"Get a <ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> object with the <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue.GetPrintCapabilities%2A&gt;</ph> method.","pos":[1535,1663],"source":"Get a <xref:System.Printing.PrintCapabilities> object with the <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A> method."},{"content":"Test for the presence of the capability you want.","pos":[1673,1722]},{"content":"In the example below, we test the <ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities.DuplexingCapability%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> object for the presence of the capability of printing on both sides of a sheet of paper with the \"page turning\" along the long side of the sheet.","pos":[1723,2023],"source":" In the example below, we test the <xref:System.Printing.PrintCapabilities.DuplexingCapability%2A> property of the <xref:System.Printing.PrintCapabilities> object for the presence of the capability of printing on both sides of a sheet of paper with the \"page turning\" along the long side of the sheet."},{"content":"Since <ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities.DuplexingCapability%2A&gt;</ph> is a collection, we use the <ph id=\"ph2\">`Contains`</ph> method of <ph id=\"ph3\">&lt;xref:System.Collections.ObjectModel.ReadOnlyCollection%601&gt;</ph>.","pos":[2024,2204],"source":" Since <xref:System.Printing.PrintCapabilities.DuplexingCapability%2A> is a collection, we use the `Contains` method of <xref:System.Collections.ObjectModel.ReadOnlyCollection%601>."},{"pos":[2216,2642],"content":"[!NOTE]\nThis step is not strictly necessary. The <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method used below will check each request in the <xref:System.Printing.PrintTicket> against the capabilities of the printer. If the requested capability is not supported by printer, the printer driver will substitute an alternative request in the <xref:System.Printing.PrintTicket> returned by the method.","leadings":["","    >  "],"nodes":[{"content":"This step is not strictly necessary. The <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method used below will check each request in the <xref:System.Printing.PrintTicket> against the capabilities of the printer. If the requested capability is not supported by printer, the printer driver will substitute an alternative request in the <xref:System.Printing.PrintTicket> returned by the method.","pos":[8,419],"nodes":[{"content":"This step is not strictly necessary.","pos":[0,36]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A&gt;</ph> method used below will check each request in the <ph id=\"ph2\">&lt;xref:System.Printing.PrintTicket&gt;</ph> against the capabilities of the printer.","pos":[37,230],"source":" The <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method used below will check each request in the <xref:System.Printing.PrintTicket> against the capabilities of the printer."},{"content":"If the requested capability is not supported by printer, the printer driver will substitute an alternative request in the <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> returned by the method.","pos":[231,411],"source":" If the requested capability is not supported by printer, the printer driver will substitute an alternative request in the <xref:System.Printing.PrintTicket> returned by the method."}]}]},{"content":"If the printer supports duplexing, the sample code creates a <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> that asks for duplexing.","pos":[2652,2772],"source":"If the printer supports duplexing, the sample code creates a <xref:System.Printing.PrintTicket> that asks for duplexing."},{"content":"But the application does not specify every possible printer setting available in the <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> element.","pos":[2773,2901],"source":" But the application does not specify every possible printer setting available in the <xref:System.Printing.PrintTicket> element."},{"content":"That would be wasteful of both programmer and program time.","pos":[2902,2961]},{"content":"Instead, the code sets only the duplexing request and then merges this <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> with an existing, fully configured and validated, <ph id=\"ph2\">&lt;xref:System.Printing.PrintTicket&gt;</ph>, in this case, the user's default <ph id=\"ph3\">&lt;xref:System.Printing.PrintTicket&gt;</ph>.","pos":[2962,3222],"source":" Instead, the code sets only the duplexing request and then merges this <xref:System.Printing.PrintTicket> with an existing, fully configured and validated, <xref:System.Printing.PrintTicket>, in this case, the user's default <xref:System.Printing.PrintTicket>."},{"content":"Accordingly, the sample calls the <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A&gt;</ph> method to merge the new, minimal, <ph id=\"ph2\">&lt;xref:System.Printing.PrintTicket&gt;</ph> with the user's default <ph id=\"ph3\">&lt;xref:System.Printing.PrintTicket&gt;</ph>.","pos":[3232,3459],"source":"Accordingly, the sample calls the <xref:System.Printing.PrintQueue.MergeAndValidatePrintTicket%2A> method to merge the new, minimal, <xref:System.Printing.PrintTicket> with the user's default <xref:System.Printing.PrintTicket>."},{"content":"This returns a <ph id=\"ph1\">&lt;xref:System.Printing.ValidationResult&gt;</ph> that includes the new <ph id=\"ph2\">&lt;xref:System.Printing.PrintTicket&gt;</ph> as one of its properties.","pos":[3460,3597],"source":" This returns a <xref:System.Printing.ValidationResult> that includes the new <xref:System.Printing.PrintTicket> as one of its properties."},{"content":"The sample then tests that the new <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> requests duplexing.","pos":[3607,3696],"source":"The sample then tests that the new <xref:System.Printing.PrintTicket> requests duplexing."},{"content":"If it does, then the sample makes it the new default print ticket for the user.","pos":[3697,3776]},{"content":"If step 2 above had been left out and the printer did not support duplexing along the long side, then the test would have resulted in <ph id=\"ph1\">`false`</ph>.","pos":[3777,3919],"source":" If step 2 above had been left out and the printer did not support duplexing along the long side, then the test would have resulted in `false`."},{"content":"(See the note above.)","pos":[3920,3941]},{"content":"The last significant step is to commit the change to the <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.UserPrintTicket%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue&gt;</ph> with the <ph id=\"ph3\">&lt;xref:System.Printing.PrintQueue.Commit%2A&gt;</ph> method.","pos":[3951,4171],"source":"The last significant step is to commit the change to the <xref:System.Printing.PrintQueue.UserPrintTicket%2A> property of the <xref:System.Printing.PrintQueue> with the <xref:System.Printing.PrintQueue.Commit%2A> method."},{"pos":[4178,4538],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PrintTicketManagment#UsingMergeAndValidate<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#usingmergeandvalidate)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>PrintTicketManagment#UsingMergeAndValidate<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#usingmergeandvalidate)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[PrintTicketManagment#UsingMergeAndValidate](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#usingmergeandvalidate)]\n[!code-vb[PrintTicketManagment#UsingMergeAndValidate](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#usingmergeandvalidate)]"},{"content":"So that you can quickly test this example, the remainder of it is presented below.","pos":[4545,4627]},{"content":"Create a project and a namespace and then paste both the code snippets in this article into the namespace block.","pos":[4628,4740]},{"pos":[4747,5143],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PrintTicketManagment#UIForMergeAndValidatePTUtility<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#uiformergeandvalidateptutility)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>PrintTicketManagment#UIForMergeAndValidatePTUtility<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#uiformergeandvalidateptutility)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[PrintTicketManagment#UIForMergeAndValidatePTUtility](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PrintTicketManagment/CSharp/printticket.cs#uiformergeandvalidateptutility)]\n[!code-vb[PrintTicketManagment#UIForMergeAndValidatePTUtility](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PrintTicketManagment/visualbasic/printticket.vb#uiformergeandvalidateptutility)]"},{"pos":[5152,5160],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Documents in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[5496,5577],"source":" [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Printing Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/printing-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5580,5663],"source":" [Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Print Schema<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=186397)</ept>","pos":[5666,5728],"source":" [Print Schema](http://go.microsoft.com/fwlink/?LinkId=186397)"}]}