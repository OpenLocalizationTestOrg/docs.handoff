{"content":"---\ntitle: \"-refout (Visual Basic)\"\nms.date: 03/16/2018\nf1_keywords: \n  - \"/refout\"\nhelpviewer_keywords: \n  - \"refout compiler option [Visual Basic]\"\n  - \"/refout compiler option [Visual Basic]\"\n  - \"-refout compiler option [Visual Basic]\"\n---\n\n# -refout (Visual Basic)\n\nThe **-refout** option specifies a file path where the reference assembly should be output.\n\n[!INCLUDE[compiler-options](~/includes/compiler-options.md)]\n\n## Syntax\n\n```console\n-refout:filepath\n```\n\n## Arguments\n\n `filepath`\nThe path and filename of the reference assembly. It should generally be in a sub-folder of the primary assembly. The recommended convention (used by MSBuild) is to place the reference assembly in a \"ref/\" sub-folder relative to the primary assembly. All folders in `filepath` must exist; the compiler does not create them. \n\n## Remarks\n\nVisual Basic supports the `-refout` switch starting with version 15.3.\n\nReference assemblies are metadata-only assemblies that contain metadata but no implementation code. They include type and member information for everything except anonymous types. Their method bodies are replaced with a single `throw null` statement. The reason for using `throw null` method bodies (as opposed to no bodies) is so that PEVerify can run and pass (thus validating the completeness of the metadata).\n\nReference assemblies include an assembly-level [ReferenceAssembly](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute) attribute. This attribute may be specified in source (then the compiler won't need to synthesize it). Because of this attribute, runtimes refuse to load reference assemblies for execution (but they can still be loaded in a reflection-only context). Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <xref:System.BadImageFormatException>.\n\nThe `-refout` and [`-refonly`](refonly-compiler-option.md) options are mutually exclusive.\n\n## See also\n\n- [-refonly](refonly-compiler-option.md)\n- [Visual Basic Command-Line Compiler](index.md)\n- [Sample Compilation Command Lines](sample-compilation-command-lines.md)\n","nodes":[{"pos":[4,239],"embed":true,"restype":"x-metadata","content":"title: \"-refout (Visual Basic)\"\nms.date: 03/16/2018\nf1_keywords: \n  - \"/refout\"\nhelpviewer_keywords: \n  - \"refout compiler option [Visual Basic]\"\n  - \"/refout compiler option [Visual Basic]\"\n  - \"-refout compiler option [Visual Basic]\"","nodes":[{"content":"-refout (Visual Basic)","nodes":[{"pos":[0,22],"content":"-refout (Visual Basic)","nodes":[{"content":"-refout (Visual Basic)","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[247,269],"content":"-refout (Visual Basic)","linkify":"-refout (Visual Basic)","nodes":[{"content":"-refout (Visual Basic)","pos":[0,22]}]},{"pos":[271,362],"content":"The <bpt id=\"p1\">**</bpt>-refout<ept id=\"p1\">**</ept> option specifies a file path where the reference assembly should be output.","source":"The **-refout** option specifies a file path where the reference assembly should be output."},{"pos":[429,435],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[473,482],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"<ph id=\"ph1\">`filepath`</ph> The path and filename of the reference assembly.","pos":[485,544],"source":"`filepath`\nThe path and filename of the reference assembly."},{"content":"It should generally be in a sub-folder of the primary assembly.","pos":[545,608]},{"content":"The recommended convention (used by MSBuild) is to place the reference assembly in a \"ref/\" sub-folder relative to the primary assembly.","pos":[609,745]},{"content":"All folders in <ph id=\"ph1\">`filepath`</ph> must exist; the compiler does not create them.","pos":[746,818],"source":" All folders in `filepath` must exist; the compiler does not create them."},{"pos":[824,831],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[833,903],"content":"Visual Basic supports the <ph id=\"ph1\">`-refout`</ph> switch starting with version 15.3.","source":"Visual Basic supports the `-refout` switch starting with version 15.3."},{"content":"Reference assemblies are metadata-only assemblies that contain metadata but no implementation code.","pos":[905,1004]},{"content":"They include type and member information for everything except anonymous types.","pos":[1005,1084]},{"content":"Their method bodies are replaced with a single <ph id=\"ph1\">`throw null`</ph> statement.","pos":[1085,1155],"source":" Their method bodies are replaced with a single `throw null` statement."},{"content":"The reason for using <ph id=\"ph1\">`throw null`</ph> method bodies (as opposed to no bodies) is so that PEVerify can run and pass (thus validating the completeness of the metadata).","pos":[1156,1318],"source":" The reason for using `throw null` method bodies (as opposed to no bodies) is so that PEVerify can run and pass (thus validating the completeness of the metadata)."},{"content":"Reference assemblies include an assembly-level <bpt id=\"p1\">[</bpt>ReferenceAssembly<ept id=\"p1\">](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute)</ept> attribute.","pos":[1320,1462],"source":"Reference assemblies include an assembly-level [ReferenceAssembly](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute) attribute."},{"content":"This attribute may be specified in source (then the compiler won't need to synthesize it).","pos":[1463,1553]},{"content":"Because of this attribute, runtimes refuse to load reference assemblies for execution (but they can still be loaded in a reflection-only context).","pos":[1554,1700]},{"content":"Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <ph id=\"ph1\">&lt;xref:System.BadImageFormatException&gt;</ph>.","pos":[1701,1870],"source":" Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <xref:System.BadImageFormatException>."},{"pos":[1872,1962],"content":"The <ph id=\"ph1\">`-refout`</ph> and <bpt id=\"p1\">[</bpt><ph id=\"ph2\">`-refonly`</ph><ept id=\"p1\">](refonly-compiler-option.md)</ept> options are mutually exclusive.","source":"The `-refout` and [`-refonly`](refonly-compiler-option.md) options are mutually exclusive."},{"pos":[1967,1975],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1979,2017],"content":"<bpt id=\"p1\">[</bpt>-refonly<ept id=\"p1\">](refonly-compiler-option.md)</ept>","source":"[-refonly](refonly-compiler-option.md)"},{"pos":[2020,2066],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Command-Line Compiler<ept id=\"p1\">](index.md)</ept>","source":"[Visual Basic Command-Line Compiler](index.md)"},{"pos":[2069,2140],"content":"<bpt id=\"p1\">[</bpt>Sample Compilation Command Lines<ept id=\"p1\">](sample-compilation-command-lines.md)</ept>","source":"[Sample Compilation Command Lines](sample-compilation-command-lines.md)"}]}