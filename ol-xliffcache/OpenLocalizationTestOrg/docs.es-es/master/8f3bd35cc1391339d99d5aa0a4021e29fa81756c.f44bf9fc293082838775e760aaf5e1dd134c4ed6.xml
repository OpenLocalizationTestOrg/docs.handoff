{"content":"---\ntitle: \"Optimistic Concurrency: Overview\"\nms.date: \"03/30/2017\"\nms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694\n---\n# Optimistic Concurrency: Overview\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports optimistic concurrency control. The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:  \n  \n|Terms|Description|  \n|-----------|-----------------|  \n|concurrency|The situation in which two or more users at the same time try to update the same database row.|  \n|concurrency conflict|The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.|  \n|concurrency control|The technique used to resolve concurrency conflicts.|  \n|optimistic concurrency control|The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.<br /><br /> Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.<br /><br /> *Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.|  \n|conflict resolution|The process of refreshing a conflicting item by querying the database again and then reconciling differences.<br /><br /> When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:<br /><br /> -   The values originally taken from the database and used for the update check.<br />-   The new database values from the subsequent query.<br /><br /> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] then determines whether the object is in conflict (that is, whether one or more of its member values has changed). If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.<br /><br /> Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.|  \n  \n In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:  \n  \n-   The client tries to submit changes to the database.  \n  \n-   One or more update-check values have been updated in the database since the client last read them.  \n  \n Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.  \n  \n> [!NOTE]\n>  Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks. No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>. For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.  \n  \n## Example  \n For example, in the following scenario, User1 starts to prepare an update by querying the database for a row. User1 receives a row with values of Alfreds, Maria, and Sales.  \n  \n User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing. Before User1 can submit those changes, User2 has submitted changes to the database. So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.  \n  \n When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown. This result occurs because the database values for the Assistant column and the Department column are not those that were expected. Members representing the Assistant and Department columns are in conflict. The following table summarizes the situation.  \n  \n||Manager|Assistant|Department|  \n|------|-------------|---------------|----------------|  \n|Original state|Alfreds|Maria|Sales|  \n|User1|Alfred||Marketing|  \n|User2||Mary|Service|  \n  \n You can resolve conflicts such as this in different ways. For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).  \n  \n## Conflict Detection and Resolution Checklist  \n You can detect and resolve conflicts at any level of detail. At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration. At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.  \n  \n-   Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.  \n  \n     For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).  \n  \n-   In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.  \n  \n     For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).  \n  \n-   Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.  \n  \n     For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).  \n  \n-   Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.  \n  \n     For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).  \n  \n## LINQ to SQL Types That Support Conflict Discovery and Resolution  \n Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:  \n  \n-   <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  \n  \n-   <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  \n  \n## See also\n\n- [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)\n","nodes":[{"pos":[4,116],"embed":true,"restype":"x-metadata","content":"title: \"Optimistic Concurrency: Overview\"\nms.date: \"03/30/2017\"\nms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694","nodes":[{"content":"Optimistic Concurrency: Overview","nodes":[{"pos":[0,32],"content":"Optimistic Concurrency: Overview","nodes":[{"content":"Optimistic Concurrency: Overview","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[123,155],"content":"Optimistic Concurrency: Overview","linkify":"Optimistic Concurrency: Overview","nodes":[{"content":"Optimistic Concurrency: Overview","pos":[0,32]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> supports optimistic concurrency control.","pos":[156,264],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports optimistic concurrency control."},{"content":"The following table describes terms that apply to optimistic concurrency in <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> documentation:","pos":[265,423],"source":" The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:"},{"content":"Terms","pos":[430,435]},{"content":"Description","pos":[436,447]},{"content":"concurrency","pos":[486,497]},{"content":"The situation in which two or more users at the same time try to update the same database row.","pos":[498,592]},{"content":"concurrency conflict","pos":[597,617]},{"content":"The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.","pos":[618,741]},{"content":"concurrency control","pos":[746,765]},{"content":"The technique used to resolve concurrency conflicts.","pos":[766,818]},{"content":"optimistic concurrency control","pos":[823,853]},{"content":"The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.","pos":[854,990]},{"content":"Contrast with <bpt id=\"p1\">*</bpt>pessimistic concurrency control<ept id=\"p1\">*</ept>, which locks the record to avoid concurrency conflicts.","pos":[1003,1106],"source":"Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts."},{"content":"<bpt id=\"p1\">*</bpt>Optimistic<ept id=\"p1\">*</ept> control is so termed because it considers the chances of one transaction interfering with another to be unlikely.","pos":[1119,1245],"source":"*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely."},{"content":"conflict resolution","pos":[1250,1269]},{"content":"The process of refreshing a conflicting item by querying the database again and then reconciling differences.","pos":[1270,1379]},{"content":"When an object is refreshed, the <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> change tracker holds the following data:","pos":[1392,1533],"source":"When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:"},{"content":"-   The values originally taken from the database and used for the update check.","pos":[1546,1626]},{"content":"-   The new database values from the subsequent query.","pos":[1632,1686]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> then determines whether the object is in conflict (that is, whether one or more of its member values has changed).","pos":[1699,1881],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] then determines whether the object is in conflict (that is, whether one or more of its member values has changed)."},{"content":"If the object is in conflict, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> next determines which of its members are in conflict.","pos":[1882,2033],"source":" If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict."},{"content":"Any member conflict that <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> discovers is added to a conflict list.","pos":[2046,2177],"source":"Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list."},{"pos":[2185,2365],"content":"In the <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> object model, an <bpt id=\"p1\">*</bpt>optimistic concurrency conflict<ept id=\"p1\">*</ept> occurs when both of the following conditions are true:","source":"In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:"},{"content":"The client tries to submit changes to the database.","pos":[2375,2426]},{"content":"One or more update-check values have been updated in the database since the client last read them.","pos":[2436,2534]},{"content":"Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.","pos":[2541,2682]},{"pos":[2690,3042],"content":"[!NOTE]\n Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks. No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>. For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.","leadings":["","> "],"nodes":[{"content":"Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks. No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>. For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.","pos":[9,350],"nodes":[{"content":"Only members mapped as <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.UpdateCheck.Always&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged&gt;</ph> participate in optimistic concurrency checks.","pos":[0,178],"source":"Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks."},{"content":"No check is performed for members marked <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.UpdateCheck.Never&gt;</ph>.","pos":[179,270],"source":" No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.UpdateCheck&gt;</ph>.","pos":[271,341],"source":" For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>."}]}]},{"pos":[3051,3058],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.","pos":[3062,3171]},{"content":"User1 receives a row with values of Alfreds, Maria, and Sales.","pos":[3172,3234]},{"content":"User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.","pos":[3241,3357]},{"content":"Before User1 can submit those changes, User2 has submitted changes to the database.","pos":[3358,3441]},{"content":"So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.","pos":[3442,3558]},{"content":"When User1 now tries to submit changes, the submission fails and a <ph id=\"ph1\">&lt;xref:System.Data.Linq.ChangeConflictException&gt;</ph> exception is thrown.","pos":[3565,3700],"source":"When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown."},{"content":"This result occurs because the database values for the Assistant column and the Department column are not those that were expected.","pos":[3701,3832]},{"content":"Members representing the Assistant and Department columns are in conflict.","pos":[3833,3907]},{"content":"The following table summarizes the situation.","pos":[3908,3953]},{"content":"Manager","pos":[3961,3968]},{"content":"Assistant","pos":[3969,3978]},{"content":"Department","pos":[3979,3989]},{"content":"Original state","pos":[4052,4066]},{"content":"Alfreds","pos":[4067,4074]},{"content":"Maria","pos":[4075,4080]},{"content":"Sales","pos":[4081,4086]},{"content":"User1","pos":[4091,4096]},{"content":"Alfred","pos":[4097,4103]},{"content":"Marketing","pos":[4105,4114]},{"content":"User2","pos":[4119,4124]},{"content":"Mary","pos":[4126,4130]},{"content":"Service","pos":[4131,4138]},{"content":"You can resolve conflicts such as this in different ways.","pos":[4146,4203]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Manage Change Conflicts<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)</ept>.","pos":[4204,4353],"source":" For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)."},{"pos":[4362,4405],"content":"Conflict Detection and Resolution Checklist","linkify":"Conflict Detection and Resolution Checklist","nodes":[{"content":"Conflict Detection and Resolution Checklist","pos":[0,43]}]},{"content":"You can detect and resolve conflicts at any level of detail.","pos":[4409,4469]},{"content":"At one extreme, you can resolve all conflicts in one of three ways (see <ph id=\"ph1\">&lt;xref:System.Data.Linq.RefreshMode&gt;</ph>) without additional consideration.","pos":[4470,4612],"source":" At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration."},{"content":"At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.","pos":[4613,4725]},{"pos":[4735,4826],"content":"Specify or revise <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.UpdateCheck&gt;</ph> options in your object model.","source":"Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model."},{"pos":[4837,5056],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Specify Which Members are Tested for Concurrency Conflicts<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md)</ept>.","source":"For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md)."},{"pos":[5066,5214],"content":"In the try/catch block of your call to <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph>, specify at what point you want exceptions to be thrown.","source":"In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown."},{"pos":[5225,5420],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Specify When Concurrency Exceptions are Thrown<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md)</ept>.","source":"For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md)."},{"content":"Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.","pos":[5430,5540]},{"pos":[5551,5879],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Retrieve Entity Conflict Information<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Retrieve Member Conflict Information<ept id=\"p2\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md)</ept>.","source":"For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md)."},{"pos":[5889,5983],"content":"Include in your <ph id=\"ph1\">`try`</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">`catch`</ph> code how you want to resolve the various conflicts you discover.","source":"Include in your `try`/`catch` code how you want to resolve the various conflicts you discover."},{"pos":[5994,6543],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Resolve Conflicts by Retaining Database Values<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)</ept>, <bpt id=\"p2\">[</bpt>How to: Resolve Conflicts by Overwriting Database Values<ept id=\"p2\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)</ept>, and <bpt id=\"p3\">[</bpt>How to: Resolve Conflicts by Merging with Database Values<ept id=\"p3\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md)</ept>.","source":"For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md)."},{"pos":[6552,6616],"content":"LINQ to SQL Types That Support Conflict Discovery and Resolution","linkify":"LINQ to SQL Types That Support Conflict Discovery and Resolution","nodes":[{"content":"LINQ to SQL Types That Support Conflict Discovery and Resolution","pos":[0,64]}]},{"pos":[6620,6799],"content":"Classes and features to support the resolution of conflicts in optimistic concurrency in <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> include the following:","source":"Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:"},{"pos":[7673,7681],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7685,7807],"content":"<bpt id=\"p1\">[</bpt>How to: Manage Change Conflicts<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)</ept>","source":"[How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)"}]}