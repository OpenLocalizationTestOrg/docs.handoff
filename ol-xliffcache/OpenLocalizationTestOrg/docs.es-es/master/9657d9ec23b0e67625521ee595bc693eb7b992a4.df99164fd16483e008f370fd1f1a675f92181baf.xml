{"content":"---\ntitle: \"-platform (Visual Basic)\"\nms.date: 03/13/2018\nhelpviewer_keywords: \n  - \"platform compiler option [Visual Basic]\"\n  - \"/platform compiler option [Visual Basic]\"\n  - \"-platform compiler option [Visual Basic]\"\nms.assetid: f9bc61e6-e854-4ae1-87b9-d6244de23fd1\n---\n# -platform (Visual Basic)\nSpecifies which platform version of common language runtime (CLR) can run the output file.  \n  \n## Syntax  \n  \n```  \n-platform:{ x86 | x64 | Itanium | arm | anycpu | anycpu32bitpreferred }  \n```  \n  \n## Arguments  \n  \n|Term|Definition|  \n|---|---|  \n|`x86`|Compiles your assembly to be run by the 32-bit, x86-compatible CLR.|  \n|`x64`|Compiles your assembly to be run by the 64-bit CLR on a computer that supports the AMD64 or EM64T instruction set.|  \n|`Itanium`|Compiles your assembly to be run by the 64-bit CLR on a computer with an Itanium processor.|  \n|`arm`|Compiles your assembly to be run on a computer with an ARM (Advanced RISC Machine) processor.|  \n|`anycpu`|Compiles your assembly to run on any platform. The application will run as a 32-bit application on 32-bit versions of Windows and as a 64-bit application on 64-bit versions of Windows. This flag is the default value.|  \n|`anycpu32bitpreferred`|Compiles your assembly to run on any platform. The application will run as a 32-bit application on both 32-bit and 64-bit versions of Windows. This flag is valid only for executables (.EXE) and requires [!INCLUDE[net_v45](~/includes/net-v45-md.md)].|  \n  \n## Remarks  \n Use the `-platform` option to specify the type of processor targeted by the output file.  \n  \n In general, .NET Framework assemblies written in Visual Basic will run the same regardless of the platform. However, there are some cases that behave differently on different platforms. These common cases are:  \n  \n-   Structures that contain members that change size depending on the platform, such as any pointer type.  \n  \n-   Pointer arithmetic that includes constant sizes.  \n  \n-   Incorrect platform invoke or COM declarations that use `Integer` for handles instead of <xref:System.IntPtr>.  \n  \n-   Casting <xref:System.IntPtr> to `Integer`.  \n  \n-   Using platform invoke or COM interop with components that do not exist on all platforms.  \n  \n The **-platform** option will mitigate some issues if you know you have made assumptions about the architecture your code will run on. Specifically:  \n  \n-   If you decide to target a 64-bit platform, and the application is run on a 32-bit machine, the error message comes much earlier and is more targeted at the problem than the error that occurs without using this switch.  \n  \n-   If you set the `x86` flag on the option and the application is subsequently run on a 64-bit machine, the application will run in the WOW subsystem instead of running natively.  \n  \n On a 64-bit Windows operating system:  \n  \n-   Assemblies compiled with `-platform:x86` will execute on the 32-bit CLR running under WOW64.  \n  \n-   Executables compiled with the `-platform:anycpu` will execute on the 64-bit CLR.  \n  \n-   A DLL compiled with the `-platform:anycpu` will execute on the same CLR as the process into which it loaded.  \n  \n-   Executables that are compiled with `-platform:anycpu32bitpreferred` will execute on the 32-bit CLR.  \n  \n For more information about how to develop an application to run on a 64-bit version of Windows, see [64-bit Applications](../../../framework/64-bit-apps.md).  \n  \n### To set -platform in the Visual Studio IDE  \n  \n1.  In **Solution Explorer**, choose the project, open the **Project** menu, and then click **Properties**.  \n  \n2.  On the **Compile** tab, select or clear the **Prefer 32-bit** check box, or, in the **Target CPU** list, choose a value.  \n  \n     For more information, see [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic).  \n  \n## Example  \n The following example illustrates how to use the `-platform` compiler option.  \n  \n```console\nvbc -platform:x86 myFile.vb  \n```  \n  \n## See also\n\n- [/target (Visual Basic)](target.md)\n- [Visual Basic Command-Line Compiler](index.md)\n- [Sample Compilation Command Lines](sample-compilation-command-lines.md)\n","nodes":[{"pos":[4,268],"embed":true,"restype":"x-metadata","content":"title: \"-platform (Visual Basic)\"\nms.date: 03/13/2018\nhelpviewer_keywords: \n  - \"platform compiler option [Visual Basic]\"\n  - \"/platform compiler option [Visual Basic]\"\n  - \"-platform compiler option [Visual Basic]\"\nms.assetid: f9bc61e6-e854-4ae1-87b9-d6244de23fd1","nodes":[{"content":"-platform (Visual Basic)","nodes":[{"pos":[0,24],"content":"-platform (Visual Basic)","nodes":[{"content":"-platform (Visual Basic)","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[275,299],"content":"-platform (Visual Basic)","linkify":"-platform (Visual Basic)","nodes":[{"content":"-platform (Visual Basic)","pos":[0,24]}]},{"content":"Specifies which platform version of common language runtime (CLR) can run the output file.","pos":[300,390]},{"pos":[399,405],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[503,512],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"Term","pos":[519,523]},{"content":"Definition","pos":[524,534]},{"content":"Compiles your assembly to be run by the 32-bit, x86-compatible CLR.","pos":[557,624]},{"content":"Compiles your assembly to be run by the 64-bit CLR on a computer that supports the AMD64 or EM64T instruction set.","pos":[635,749]},{"content":"Compiles your assembly to be run by the 64-bit CLR on a computer with an Itanium processor.","pos":[764,855]},{"content":"Compiles your assembly to be run on a computer with an ARM (Advanced RISC Machine) processor.","pos":[866,959]},{"content":"Compiles your assembly to run on any platform.","pos":[973,1019]},{"content":"The application will run as a 32-bit application on 32-bit versions of Windows and as a 64-bit application on 64-bit versions of Windows.","pos":[1020,1157]},{"content":"This flag is the default value.","pos":[1158,1189]},{"content":"Compiles your assembly to run on any platform.","pos":[1217,1263]},{"content":"The application will run as a 32-bit application on both 32-bit and 64-bit versions of Windows.","pos":[1264,1359]},{"content":"This flag is valid only for executables (.EXE) and requires <ph id=\"ph1\">[!INCLUDE[net_v45](~/includes/net-v45-md.md)]</ph>.","pos":[1360,1466],"source":" This flag is valid only for executables (.EXE) and requires [!INCLUDE[net_v45](~/includes/net-v45-md.md)]."},{"pos":[1476,1483],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1487,1575],"content":"Use the <ph id=\"ph1\">`-platform`</ph> option to specify the type of processor targeted by the output file.","source":"Use the `-platform` option to specify the type of processor targeted by the output file."},{"content":"In general, .NET Framework assemblies written in Visual Basic will run the same regardless of the platform.","pos":[1582,1689]},{"content":"However, there are some cases that behave differently on different platforms.","pos":[1690,1767]},{"content":"These common cases are:","pos":[1768,1791]},{"content":"Structures that contain members that change size depending on the platform, such as any pointer type.","pos":[1801,1902]},{"content":"Pointer arithmetic that includes constant sizes.","pos":[1912,1960]},{"pos":[1970,2079],"content":"Incorrect platform invoke or COM declarations that use <ph id=\"ph1\">`Integer`</ph> for handles instead of <ph id=\"ph2\">&lt;xref:System.IntPtr&gt;</ph>.","source":"Incorrect platform invoke or COM declarations that use `Integer` for handles instead of <xref:System.IntPtr>."},{"pos":[2089,2131],"content":"Casting <ph id=\"ph1\">&lt;xref:System.IntPtr&gt;</ph> to <ph id=\"ph2\">`Integer`</ph>.","source":"Casting <xref:System.IntPtr> to `Integer`."},{"content":"Using platform invoke or COM interop with components that do not exist on all platforms.","pos":[2141,2229]},{"content":"The <bpt id=\"p1\">**</bpt>-platform<ept id=\"p1\">**</ept> option will mitigate some issues if you know you have made assumptions about the architecture your code will run on.","pos":[2236,2370],"source":"The **-platform** option will mitigate some issues if you know you have made assumptions about the architecture your code will run on."},{"content":"Specifically:","pos":[2371,2384]},{"content":"If you decide to target a 64-bit platform, and the application is run on a 32-bit machine, the error message comes much earlier and is more targeted at the problem than the error that occurs without using this switch.","pos":[2394,2611]},{"pos":[2621,2796],"content":"If you set the <ph id=\"ph1\">`x86`</ph> flag on the option and the application is subsequently run on a 64-bit machine, the application will run in the WOW subsystem instead of running natively.","source":"If you set the `x86` flag on the option and the application is subsequently run on a 64-bit machine, the application will run in the WOW subsystem instead of running natively."},{"content":"On a 64-bit Windows operating system:","pos":[2803,2840]},{"pos":[2850,2942],"content":"Assemblies compiled with <ph id=\"ph1\">`-platform:x86`</ph> will execute on the 32-bit CLR running under WOW64.","source":"Assemblies compiled with `-platform:x86` will execute on the 32-bit CLR running under WOW64."},{"pos":[2952,3032],"content":"Executables compiled with the <ph id=\"ph1\">`-platform:anycpu`</ph> will execute on the 64-bit CLR.","source":"Executables compiled with the `-platform:anycpu` will execute on the 64-bit CLR."},{"pos":[3042,3150],"content":"A DLL compiled with the <ph id=\"ph1\">`-platform:anycpu`</ph> will execute on the same CLR as the process into which it loaded.","source":"A DLL compiled with the `-platform:anycpu` will execute on the same CLR as the process into which it loaded."},{"pos":[3160,3259],"content":"Executables that are compiled with <ph id=\"ph1\">`-platform:anycpu32bitpreferred`</ph> will execute on the 32-bit CLR.","source":"Executables that are compiled with `-platform:anycpu32bitpreferred` will execute on the 32-bit CLR."},{"pos":[3266,3423],"content":"For more information about how to develop an application to run on a 64-bit version of Windows, see <bpt id=\"p1\">[</bpt>64-bit Applications<ept id=\"p1\">](../../../framework/64-bit-apps.md)</ept>.","source":"For more information about how to develop an application to run on a 64-bit version of Windows, see [64-bit Applications](../../../framework/64-bit-apps.md)."},{"pos":[3433,3474],"content":"To set -platform in the Visual Studio IDE","linkify":"To set -platform in the Visual Studio IDE","nodes":[{"content":"To set -platform in the Visual Studio IDE","pos":[0,41]}]},{"pos":[3484,3587],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, choose the project, open the <bpt id=\"p2\">**</bpt>Project<ept id=\"p2\">**</ept> menu, and then click <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, choose the project, open the **Project** menu, and then click **Properties**."},{"pos":[3597,3717],"content":"On the <bpt id=\"p1\">**</bpt>Compile<ept id=\"p1\">**</ept> tab, select or clear the <bpt id=\"p2\">**</bpt>Prefer 32-bit<ept id=\"p2\">**</ept> check box, or, in the <bpt id=\"p3\">**</bpt>Target CPU<ept id=\"p3\">**</ept> list, choose a value.","source":"On the **Compile** tab, select or clear the **Prefer 32-bit** check box, or, in the **Target CPU** list, choose a value."},{"pos":[3728,3874],"content":"For more information, see <bpt id=\"p1\">[</bpt>Compile Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/compile-page-project-designer-visual-basic)</ept>.","source":"For more information, see [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic)."},{"pos":[3883,3890],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3894,3971],"content":"The following example illustrates how to use the <ph id=\"ph1\">`-platform`</ph> compiler option.","source":"The following example illustrates how to use the `-platform` compiler option."},{"pos":[4030,4038],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4042,4077],"content":"<bpt id=\"p1\">[</bpt>/target (Visual Basic)<ept id=\"p1\">](target.md)</ept>","source":"[/target (Visual Basic)](target.md)"},{"pos":[4080,4126],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Command-Line Compiler<ept id=\"p1\">](index.md)</ept>","source":"[Visual Basic Command-Line Compiler](index.md)"},{"pos":[4129,4200],"content":"<bpt id=\"p1\">[</bpt>Sample Compilation Command Lines<ept id=\"p1\">](sample-compilation-command-lines.md)</ept>","source":"[Sample Compilation Command Lines](sample-compilation-command-lines.md)"}]}