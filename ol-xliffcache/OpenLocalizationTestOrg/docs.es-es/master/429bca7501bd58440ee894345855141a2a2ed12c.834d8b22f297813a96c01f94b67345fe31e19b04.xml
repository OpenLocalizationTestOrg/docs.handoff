{"content":"---\ntitle: \"How to: Resolve Conflicts by Merging with Database Values\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1988b79c-3bfc-4c5c-a08a-86cf638bbe17\n---\n# How to: Resolve Conflicts by Merging with Database Values\nTo reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <xref:System.Data.Linq.RefreshMode.KeepChanges> to merge database values with the current client member values. For more information, see [Optimistic Concurrency: Overview](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md).  \n  \n> [!NOTE]\n>  In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.  \n  \n## Example  \n In this scenario, a <xref:System.Data.Linq.ChangeConflictException> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns. The following table shows the situation.  \n  \n||Manager|Assistant|Department|  \n|------|-------------|---------------|----------------|  \n|Original database state when queried by User1 and User2.|Alfreds|Maria|Sales|  \n|User1 prepares to submit these changes.|Alfred||Marketing|  \n|User2 has already submitted these changes.||Mary|Service|  \n  \n User1 decides to resolve this conflict by merging database values with the current client member values. The result will be that database values are overwritten only when the current changeset has also modified that value.  \n  \n When User1 resolves the conflict by using <xref:System.Data.Linq.RefreshMode.KeepChanges>, the result in the database is as in the following table:  \n  \n||Manager|Assistant|Department|  \n|------|-------------|---------------|----------------|  \n|New state after conflict resolution.|Alfred<br /><br /> (from User1)|Mary<br /><br /> (from User2)|Marketing<br /><br /> (from User1)|  \n  \n The following example shows how to merge database values with the current client member values (unless the client has also changed that value). No inspection or custom handling of individual member conflicts occurs.  \n  \n [!code-csharp[System.Data.Linq.RefreshMode#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/system.data.linq.refreshmode/cs/program.cs#3)]\n [!code-vb[System.Data.Linq.RefreshMode#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/system.data.linq.refreshmode/vb/module1.vb#3)]  \n  \n## See also\n\n- [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)\n- [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)\n- [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)\n","nodes":[{"pos":[4,175],"embed":true,"restype":"x-metadata","content":"title: \"How to: Resolve Conflicts by Merging with Database Values\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1988b79c-3bfc-4c5c-a08a-86cf638bbe17","nodes":[{"content":"How to: Resolve Conflicts by Merging with Database Values","nodes":[{"pos":[0,57],"content":"How to: Resolve Conflicts by Merging with Database Values","nodes":[{"content":"How to: Resolve Conflicts by Merging with Database Values","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[182,239],"content":"How to: Resolve Conflicts by Merging with Database Values","linkify":"How to: Resolve Conflicts by Merging with Database Values","nodes":[{"content":"How to: Resolve Conflicts by Merging with Database Values","pos":[0,57]}]},{"content":"To reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <ph id=\"ph1\">&lt;xref:System.Data.Linq.RefreshMode.KeepChanges&gt;</ph> to merge database values with the current client member values.","pos":[240,473],"source":"To reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <xref:System.Data.Linq.RefreshMode.KeepChanges> to merge database values with the current client member values."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Optimistic Concurrency: Overview<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md)</ept>.","pos":[474,625],"source":" For more information, see [Optimistic Concurrency: Overview](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md)."},{"pos":[633,845],"content":"[!NOTE]\n In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.","leadings":["","> "],"nodes":[{"content":"In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.","pos":[9,210],"nodes":[{"content":"In all cases, the record on the client is first refreshed by retrieving the updated data from the database.","pos":[0,107]},{"content":"This action makes sure that the next update try will not fail on the same concurrency checks.","pos":[108,201]}]}]},{"pos":[854,861],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In this scenario, a <ph id=\"ph1\">&lt;xref:System.Data.Linq.ChangeConflictException&gt;</ph> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns.","pos":[865,1068],"source":"In this scenario, a <xref:System.Data.Linq.ChangeConflictException> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns."},{"content":"The following table shows the situation.","pos":[1069,1109]},{"content":"Manager","pos":[1117,1124]},{"content":"Assistant","pos":[1125,1134]},{"content":"Department","pos":[1135,1145]},{"content":"Original database state when queried by User1 and User2.","pos":[1208,1264]},{"content":"Alfreds","pos":[1265,1272]},{"content":"Maria","pos":[1273,1278]},{"content":"Sales","pos":[1279,1284]},{"content":"User1 prepares to submit these changes.","pos":[1289,1328]},{"content":"Alfred","pos":[1329,1335]},{"content":"Marketing","pos":[1337,1346]},{"content":"User2 has already submitted these changes.","pos":[1351,1393]},{"content":"Mary","pos":[1395,1399]},{"content":"Service","pos":[1400,1407]},{"content":"User1 decides to resolve this conflict by merging database values with the current client member values.","pos":[1415,1519]},{"content":"The result will be that database values are overwritten only when the current changeset has also modified that value.","pos":[1520,1637]},{"pos":[1644,1791],"content":"When User1 resolves the conflict by using <ph id=\"ph1\">&lt;xref:System.Data.Linq.RefreshMode.KeepChanges&gt;</ph>, the result in the database is as in the following table:","source":"When User1 resolves the conflict by using <xref:System.Data.Linq.RefreshMode.KeepChanges>, the result in the database is as in the following table:"},{"content":"Manager","pos":[1799,1806]},{"content":"Assistant","pos":[1807,1816]},{"content":"Department","pos":[1817,1827]},{"content":"New state after conflict resolution.","pos":[1890,1926]},{"content":"Alfred","pos":[1927,1933]},{"content":"(from User1)","pos":[1946,1958]},{"content":"Mary","pos":[1959,1963]},{"content":"(from User2)","pos":[1976,1988]},{"content":"Marketing","pos":[1989,1998]},{"content":"(from User1)","pos":[2011,2023]},{"content":"The following example shows how to merge database values with the current client member values (unless the client has also changed that value).","pos":[2031,2174]},{"content":"No inspection or custom handling of individual member conflicts occurs.","pos":[2175,2246]},{"pos":[2567,2575],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2579,2751],"content":"<bpt id=\"p1\">[</bpt>How to: Resolve Conflicts by Overwriting Database Values<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)</ept>","source":"[How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)"},{"pos":[2754,2922],"content":"<bpt id=\"p1\">[</bpt>How to: Resolve Conflicts by Retaining Database Values<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)</ept>","source":"[How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)"},{"pos":[2925,3047],"content":"<bpt id=\"p1\">[</bpt>How to: Manage Change Conflicts<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)</ept>","source":"[How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)"}]}