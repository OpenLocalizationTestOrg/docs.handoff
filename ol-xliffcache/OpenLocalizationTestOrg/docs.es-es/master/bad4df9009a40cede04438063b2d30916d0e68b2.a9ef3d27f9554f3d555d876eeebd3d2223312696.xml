{"content":"---\ntitle: \"How to: Group Files by Extension (LINQ) (C#)\"\nms.date: 07/20/2015\nms.assetid: 21a98320-a5a1-4981-82d8-6a637e7d9018\n---\n# How to: Group Files by Extension (LINQ) (C#)\nThis example shows how LINQ can be used to perform advanced grouping and sorting operations on lists of files or folders. It also shows how to page output in the console window by using the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> methods.  \n  \n## Example  \n The following query shows how to group the contents of a specified directory tree by the file name extension.  \n  \n```csharp  \nclass GroupByExtension  \n{  \n    // This query will sort all the files under the specified folder  \n    //  and subfolder into groups keyed by the file extension.  \n    private static void Main()  \n    {  \n        // Take a snapshot of the file system.  \n        string startFolder = @\"c:\\program files\\Microsoft Visual Studio 9.0\\Common7\";  \n  \n        // Used in WriteLine to trim output lines.  \n        int trimLength = startFolder.Length;  \n  \n        // Take a snapshot of the file system.  \n        System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(startFolder);  \n  \n        // This method assumes that the application has discovery permissions  \n        // for all folders under the specified path.  \n        IEnumerable<System.IO.FileInfo> fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories);  \n  \n        // Create the query.  \n        var queryGroupByExt =  \n            from file in fileList  \n            group file by file.Extension.ToLower() into fileGroup  \n            orderby fileGroup.Key  \n            select fileGroup;  \n  \n        // Display one group at a time. If the number of   \n        // entries is greater than the number of lines  \n        // in the console window, then page the output.  \n        PageOutput(trimLength, queryGroupByExt);  \n    }  \n  \n    // This method specifically handles group queries of FileInfo objects with string keys.  \n    // It can be modified to work for any long listings of data. Note that explicit typing  \n    // must be used in method signatures. The groupbyExtList parameter is a query that produces  \n    // groups of FileInfo objects with string keys.  \n    private static void PageOutput(int rootLength,  \n                                    IEnumerable<System.Linq.IGrouping<string, System.IO.FileInfo>> groupByExtList)  \n    {  \n        // Flag to break out of paging loop.  \n        bool goAgain = true;  \n  \n        // \"3\" = 1 line for extension + 1 for \"Press any key\" + 1 for input cursor.  \n        int numLines = Console.WindowHeight - 3;  \n  \n        // Iterate through the outer collection of groups.  \n        foreach (var filegroup in groupByExtList)  \n        {  \n            // Start a new extension at the top of a page.  \n            int currentLine = 0;  \n  \n            // Output only as many lines of the current group as will fit in the window.  \n            do  \n            {  \n                Console.Clear();  \n                Console.WriteLine(filegroup.Key == String.Empty ? \"[none]\" : filegroup.Key);  \n  \n                // Get 'numLines' number of items starting at number 'currentLine'.  \n                var resultPage = filegroup.Skip(currentLine).Take(numLines);  \n  \n                //Execute the resultPage query  \n                foreach (var f in resultPage)  \n                {  \n                    Console.WriteLine(\"\\t{0}\", f.FullName.Substring(rootLength));  \n                }  \n  \n                // Increment the line counter.  \n                currentLine += numLines;  \n  \n                // Give the user a chance to escape.  \n                Console.WriteLine(\"Press any key to continue or the 'End' key to break...\");  \n                ConsoleKey key = Console.ReadKey().Key;  \n                if (key == ConsoleKey.End)  \n                {  \n                    goAgain = false;  \n                    break;  \n                }  \n            } while (currentLine < filegroup.Count());  \n  \n            if (goAgain == false)  \n                break;  \n        }  \n    }  \n}  \n```  \n  \n The output from this program can be long, depending on the details of the local file system and what the `startFolder` is set to. To enable viewing of all results, this example shows how to page through results. The same techniques can be applied to Windows and Web applications. Notice that because the code pages the items in a group, a nested `foreach` loop is required. There is also some additional logic to compute the current position in the list, and to enable the user to stop paging and exit the program. In this particular case, the paging query is run against the cached results from the original query. In other contexts, such as LINQ to SQL, such caching is not required.  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to   System.Core.dll and `using` directives for the System.Linq and System.IO namespaces.  \n  \n## See also\n\n- [LINQ to Objects (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)\n- [LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)\n","nodes":[{"pos":[4,126],"embed":true,"restype":"x-metadata","content":"title: \"How to: Group Files by Extension (LINQ) (C#)\"\nms.date: 07/20/2015\nms.assetid: 21a98320-a5a1-4981-82d8-6a637e7d9018","nodes":[{"content":"How to: Group Files by Extension (LINQ) (C#)","nodes":[{"pos":[0,44],"content":"How to: Group Files by Extension (LINQ) (C#)","nodes":[{"content":"How to: Group Files by Extension (LINQ) (C#)","pos":[0,44]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[133,177],"content":"How to: Group Files by Extension (LINQ) (C#)","linkify":"How to: Group Files by Extension (LINQ) (C#)","nodes":[{"content":"How to: Group Files by Extension (LINQ) (C#)","pos":[0,44]}]},{"content":"This example shows how LINQ can be used to perform advanced grouping and sorting operations on lists of files or folders.","pos":[178,299]},{"content":"It also shows how to page output in the console window by using the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Skip%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Take%2A&gt;</ph> methods.","pos":[300,456],"source":" It also shows how to page output in the console window by using the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> methods."},{"pos":[465,472],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following query shows how to group the contents of a specified directory tree by the file name extension.","pos":[476,585]},{"content":"The output from this program can be long, depending on the details of the local file system and what the <ph id=\"ph1\">`startFolder`</ph> is set to.","pos":[4134,4263],"source":"The output from this program can be long, depending on the details of the local file system and what the `startFolder` is set to."},{"content":"To enable viewing of all results, this example shows how to page through results.","pos":[4264,4345]},{"content":"The same techniques can be applied to Windows and Web applications.","pos":[4346,4413]},{"content":"Notice that because the code pages the items in a group, a nested <ph id=\"ph1\">`foreach`</ph> loop is required.","pos":[4414,4507],"source":" Notice that because the code pages the items in a group, a nested `foreach` loop is required."},{"content":"There is also some additional logic to compute the current position in the list, and to enable the user to stop paging and exit the program.","pos":[4508,4648]},{"content":"In this particular case, the paging query is run against the cached results from the original query.","pos":[4649,4749]},{"content":"In other contexts, such as LINQ to SQL, such caching is not required.","pos":[4750,4819]},{"pos":[4828,4846],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[4850,5029],"content":"Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to   System.Core.dll and <ph id=\"ph1\">`using`</ph> directives for the System.Linq and System.IO namespaces.","source":"Create a project that targets the .NET Framework  version 3.5 or higher, with a reference to   System.Core.dll and `using` directives for the System.Linq and System.IO namespaces."},{"pos":[5038,5046],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5050,5143],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-objects.md)"},{"pos":[5146,5259],"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","source":"[LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}