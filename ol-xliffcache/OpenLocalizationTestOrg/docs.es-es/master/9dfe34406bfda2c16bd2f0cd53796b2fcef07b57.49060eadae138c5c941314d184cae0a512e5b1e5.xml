{"content":"---\ntitle: \"Services and Transactions\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"service contracts [WCF], designing services and transactions\"\nms.assetid: 864813ff-2709-4376-912d-f5c8d318c460\n---\n# Services and Transactions\nWindows Communication Foundation (WCF) applications can initiate a transaction from within a client and coordinate the transaction within the service operation. Clients can initiate a transaction and invoke several service operations and ensure that the service operations are either committed or rolled back as a single unit.  \n  \n You can enable the transaction behavior in the service contract by specifying a <xref:System.ServiceModel.ServiceBehaviorAttribute> and setting its <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> and <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> properties for service operations that require client transactions. The <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> parameter specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown. For more information about these attributes, see [ServiceModel Transaction Attributes](../../../docs/framework/wcf/feature-details/servicemodel-transaction-attributes.md).  \n  \n The work that is performed in the service operations and managed by a resource manager, such as logging database updates, is part of the client’s transaction.  \n  \n The following sample demonstrates usage of the <xref:System.ServiceModel.ServiceBehaviorAttribute> and <xref:System.ServiceModel.OperationBehaviorAttribute> attributes to control service-side transaction behavior.  \n  \n```csharp\n[ServiceBehavior(TransactionIsolationLevel = System.Transactions.IsolationLevel.Serializable)]  \npublic class CalculatorService: ICalculatorLog  \n{  \n    [OperationBehavior(TransactionScopeRequired = true,  \n                           TransactionAutoComplete = true)]  \n    public double Add(double n1, double n2)  \n    {  \n        recordToLog($\"Added {n1} to {n2}\");\n        return n1 + n2;  \n    }  \n  \n    [OperationBehavior(TransactionScopeRequired = true,   \n                               TransactionAutoComplete = true)]  \n    public double Subtract(double n1, double n2)  \n    {  \n        recordToLog($\"Subtracted {n1} from {n2}\");\n        return n1 - n2;  \n    }  \n  \n    [OperationBehavior(TransactionScopeRequired = true,   \n                                       TransactionAutoComplete = true)]  \n    public double Multiply(double n1, double n2)  \n    {  \n        recordToLog($\"Multiplied {n1} by {n2}\");\n        return n1 * n2;  \n    }  \n  \n    [OperationBehavior(TransactionScopeRequired = true,   \n                                       TransactionAutoComplete = true)]  \n    public double Divide(double n1, double n2)  \n    {  \n        recordToLog($\"Divided {n1} by {n2}\", n1, n2);\n        return n1 / n2;  \n    }  \n  \n}  \n```  \n  \n You can enable transactions and transaction flow by configuring the client and service bindings to use the WS-AtomicTransaction protocol, and setting the [\\<transactionFlow>](../../../docs/framework/configure-apps/file-schema/wcf/transactionflow.md) element to `true`, as shown in the following sample configuration.  \n  \n```xml  \n<client>  \n    <endpoint address=\"net.tcp://localhost/ServiceModelSamples/service\"   \n          binding=\"netTcpBinding\"   \n          bindingConfiguration=\"netTcpBindingWSAT\"   \n          contract=\"Microsoft.ServiceModel.Samples.ICalculatorLog\" />  \n</client>  \n  \n<bindings>  \n    <netTcpBinding>  \n        <binding name=\"netTcpBindingWSAT\"  \n                transactionFlow=\"true\"  \n                transactionProtocol=\"WSAtomicTransactionOctober2004\" />  \n     </netTcpBinding>  \n</bindings>  \n```  \n  \n Clients can begin a transaction by creating a <xref:System.Transactions.TransactionScope> and invoking service operations within the scope of the transaction.  \n  \n```csharp\nusing (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew))  \n{  \n    //Do work here  \n    ts.Complete();  \n}  \n```  \n  \n## See also\n\n- [Transactional Support in System.ServiceModel](../../../docs/framework/wcf/feature-details/transactional-support-in-system-servicemodel.md)\n- [Transaction Models](../../../docs/framework/wcf/feature-details/transaction-models.md)\n- [WS Transaction Flow](../../../docs/framework/wcf/samples/ws-transaction-flow.md)\n","nodes":[{"pos":[4,198],"embed":true,"restype":"x-metadata","content":"title: \"Services and Transactions\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"service contracts [WCF], designing services and transactions\"\nms.assetid: 864813ff-2709-4376-912d-f5c8d318c460","nodes":[{"content":"Services and Transactions","nodes":[{"pos":[0,25],"content":"Services and Transactions","nodes":[{"content":"Services and Transactions","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[205,230],"content":"Services and Transactions","linkify":"Services and Transactions","nodes":[{"content":"Services and Transactions","pos":[0,25]}]},{"content":"Windows Communication Foundation (WCF) applications can initiate a transaction from within a client and coordinate the transaction within the service operation.","pos":[231,391]},{"content":"Clients can initiate a transaction and invoke several service operations and ensure that the service operations are either committed or rolled back as a single unit.","pos":[392,557]},{"content":"You can enable the transaction behavior in the service contract by specifying a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute&gt;</ph> and setting its <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A&gt;</ph> properties for service operations that require client transactions.","pos":[564,946],"source":"You can enable the transaction behavior in the service contract by specifying a <xref:System.ServiceModel.ServiceBehaviorAttribute> and setting its <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> and <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> properties for service operations that require client transactions."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A&gt;</ph> parameter specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown.","pos":[947,1170],"source":" The <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> parameter specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown."},{"content":"For more information about these attributes, see <bpt id=\"p1\">[</bpt>ServiceModel Transaction Attributes<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/servicemodel-transaction-attributes.md)</ept>.","pos":[1171,1342],"source":" For more information about these attributes, see [ServiceModel Transaction Attributes](../../../docs/framework/wcf/feature-details/servicemodel-transaction-attributes.md)."},{"content":"The work that is performed in the service operations and managed by a resource manager, such as logging database updates, is part of the client’s transaction.","pos":[1349,1507]},{"pos":[1514,1727],"content":"The following sample demonstrates usage of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute&gt;</ph> attributes to control service-side transaction behavior.","source":"The following sample demonstrates usage of the <xref:System.ServiceModel.ServiceBehaviorAttribute> and <xref:System.ServiceModel.OperationBehaviorAttribute> attributes to control service-side transaction behavior."},{"pos":[2993,3309],"content":"You can enable transactions and transaction flow by configuring the client and service bindings to use the WS-AtomicTransaction protocol, and setting the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>transactionFlow&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/wcf/transactionflow.md)</ept> element to <ph id=\"ph2\">`true`</ph>, as shown in the following sample configuration.","source":"You can enable transactions and transaction flow by configuring the client and service bindings to use the WS-AtomicTransaction protocol, and setting the [\\<transactionFlow>](../../../docs/framework/configure-apps/file-schema/wcf/transactionflow.md) element to `true`, as shown in the following sample configuration."},{"pos":[3830,3988],"content":"Clients can begin a transaction by creating a <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> and invoking service operations within the scope of the transaction.","source":"Clients can begin a transaction by creating a <xref:System.Transactions.TransactionScope> and invoking service operations within the scope of the transaction."},{"pos":[4155,4163],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4167,4306],"content":"<bpt id=\"p1\">[</bpt>Transactional Support in System.ServiceModel<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/transactional-support-in-system-servicemodel.md)</ept>","source":"[Transactional Support in System.ServiceModel](../../../docs/framework/wcf/feature-details/transactional-support-in-system-servicemodel.md)"},{"pos":[4309,4396],"content":"<bpt id=\"p1\">[</bpt>Transaction Models<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/transaction-models.md)</ept>","source":"[Transaction Models](../../../docs/framework/wcf/feature-details/transaction-models.md)"},{"pos":[4399,4480],"content":"<bpt id=\"p1\">[</bpt>WS Transaction Flow<ept id=\"p1\">](../../../docs/framework/wcf/samples/ws-transaction-flow.md)</ept>","source":"[WS Transaction Flow](../../../docs/framework/wcf/samples/ws-transaction-flow.md)"}]}