{"content":"---\ntitle: \"How to: Use Platform Invoke to Play a Wave File - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"platform invoke, sound files\"\n  - \"interoperability [C#], playing WAV files using pinvoke\"\n  - \"wav files\"\n  - \".wav files\"\nms.assetid: f7f62f53-e026-4c40-b221-3a26adb0c2c5\n---\n# How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)\nThe following C# code example illustrates how to use platform invoke services to play a wave sound file on the Windows operating system.  \n  \n## Example  \n This example code uses `DllImport` to import `winmm.dll`'s `PlaySound` method entry point as `Form1 PlaySound()`. The example has a simple Windows Form with a button. Clicking the button opens a standard windows <xref:System.Windows.Forms.OpenFileDialog> dialog box so that you can open a file to play. When a wave file is selected, it is played by using the `PlaySound()` method of the `winmm.dll` library. For more information about this method, see [Using the PlaySound function with Waveform-Audio Files](https://docs.microsoft.com/windows/desktop/multimedia/using-playsound-to-play-waveform-audio-files). Browse and select a file that has a .wav extension, and then click **Open** to play the wave file by using platform invoke. A text box shows the full path of the file selected.  \n  \n The **Open Files** dialog box is filtered to show only files that have a .wav extension through the filter settings:  \n  \n [!code-csharp[csProgGuideInterop#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideInterop/CS/WinSound.cs#5)]  \n  \n [!code-csharp[csProgGuideInterop#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideInterop/CS/WinSound.cs#3)]  \n  \n## Compiling the Code  \n  \n### To compile the code  \n  \n1.  Create a new C# Windows Application project in Visual Studio and name it **WinSound**.  \n  \n2.  Copy the code above, and paste it over the contents of the `Form1.cs` file.  \n  \n3.  Copy the following code, and paste it in the `Form1.Designer.cs` file, in the `InitializeComponent()` method, after any existing code.  \n  \n     [!code-csharp[csProgGuideInterop#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideInterop/CS/WinSound.cs#4)]  \n  \n4.  Compile and run the code.  \n  \n## .NET Framework Security  \n For more information, see [Security in .NET](../../../standard/security/index.md).  \n  \n## See also\n\n- [C# Programming Guide](../../../csharp/programming-guide/index.md)\n- [Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md)\n- [A Closer Look at Platform Invoke](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)\n- [Marshaling Data with Platform Invoke](../../../framework/interop/marshaling-data-with-platform-invoke.md)\n","nodes":[{"pos":[4,323],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use Platform Invoke to Play a Wave File - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"platform invoke, sound files\"\n  - \"interoperability [C#], playing WAV files using pinvoke\"\n  - \"wav files\"\n  - \".wav files\"\nms.assetid: f7f62f53-e026-4c40-b221-3a26adb0c2c5","nodes":[{"content":"How to: Use Platform Invoke to Play a Wave File - C# Programming Guide","nodes":[{"pos":[0,70],"content":"How to: Use Platform Invoke to Play a Wave File - C# Programming Guide","nodes":[{"content":"How to: Use Platform Invoke to Play a Wave File - C# Programming Guide","pos":[0,70]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[330,400],"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","linkify":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","nodes":[{"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","pos":[0,70]}]},{"content":"The following C# code example illustrates how to use platform invoke services to play a wave sound file on the Windows operating system.","pos":[401,537]},{"pos":[546,553],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example code uses <ph id=\"ph1\">`DllImport`</ph> to import <ph id=\"ph2\">`winmm.dll`</ph>'s <ph id=\"ph3\">`PlaySound`</ph> method entry point as <ph id=\"ph4\">`Form1 PlaySound()`</ph>.","pos":[557,670],"source":"This example code uses `DllImport` to import `winmm.dll`'s `PlaySound` method entry point as `Form1 PlaySound()`."},{"content":"The example has a simple Windows Form with a button.","pos":[671,723]},{"content":"Clicking the button opens a standard windows <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> dialog box so that you can open a file to play.","pos":[724,859],"source":" Clicking the button opens a standard windows <xref:System.Windows.Forms.OpenFileDialog> dialog box so that you can open a file to play."},{"content":"When a wave file is selected, it is played by using the <ph id=\"ph1\">`PlaySound()`</ph> method of the <ph id=\"ph2\">`winmm.dll`</ph> library.","pos":[860,964],"source":" When a wave file is selected, it is played by using the `PlaySound()` method of the `winmm.dll` library."},{"content":"For more information about this method, see <bpt id=\"p1\">[</bpt>Using the PlaySound function with Waveform-Audio Files<ept id=\"p1\">](https://docs.microsoft.com/windows/desktop/multimedia/using-playsound-to-play-waveform-audio-files)</ept>.","pos":[965,1166],"source":" For more information about this method, see [Using the PlaySound function with Waveform-Audio Files](https://docs.microsoft.com/windows/desktop/multimedia/using-playsound-to-play-waveform-audio-files)."},{"content":"Browse and select a file that has a .wav extension, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> to play the wave file by using platform invoke.","pos":[1167,1290],"source":" Browse and select a file that has a .wav extension, and then click **Open** to play the wave file by using platform invoke."},{"content":"A text box shows the full path of the file selected.","pos":[1291,1343]},{"pos":[1350,1466],"content":"The <bpt id=\"p1\">**</bpt>Open Files<ept id=\"p1\">**</ept> dialog box is filtered to show only files that have a .wav extension through the filter settings:","source":"The **Open Files** dialog box is filtered to show only files that have a .wav extension through the filter settings:"},{"pos":[1729,1747],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[1757,1776],"content":"To compile the code","linkify":"To compile the code","nodes":[{"content":"To compile the code","pos":[0,19]}]},{"pos":[1786,1872],"content":"Create a new C# Windows Application project in Visual Studio and name it <bpt id=\"p1\">**</bpt>WinSound<ept id=\"p1\">**</ept>.","source":"Create a new C# Windows Application project in Visual Studio and name it **WinSound**."},{"pos":[1882,1957],"content":"Copy the code above, and paste it over the contents of the <ph id=\"ph1\">`Form1.cs`</ph> file.","source":"Copy the code above, and paste it over the contents of the `Form1.cs` file."},{"pos":[1967,2101],"content":"Copy the following code, and paste it in the <ph id=\"ph1\">`Form1.Designer.cs`</ph> file, in the <ph id=\"ph2\">`InitializeComponent()`</ph> method, after any existing code.","source":"Copy the following code, and paste it in the `Form1.Designer.cs` file, in the `InitializeComponent()` method, after any existing code."},{"content":"Compile and run the code.","pos":[2242,2267]},{"pos":[2276,2299],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"pos":[2303,2385],"content":"For more information, see <bpt id=\"p1\">[</bpt>Security in .NET<ept id=\"p1\">](../../../standard/security/index.md)</ept>.","source":"For more information, see [Security in .NET](../../../standard/security/index.md)."},{"pos":[2394,2402],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2406,2472],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"},{"pos":[2475,2574],"content":"<bpt id=\"p1\">[</bpt>Interoperability Overview<ept id=\"p1\">](../../../csharp/programming-guide/interop/interoperability-overview.md)</ept>","source":"[Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md)"},{"pos":[2577,2709],"content":"<bpt id=\"p1\">[</bpt>A Closer Look at Platform Invoke<ept id=\"p1\">](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)</ept>","source":"[A Closer Look at Platform Invoke](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)"},{"pos":[2712,2818],"content":"<bpt id=\"p1\">[</bpt>Marshaling Data with Platform Invoke<ept id=\"p1\">](../../../framework/interop/marshaling-data-with-platform-invoke.md)</ept>","source":"[Marshaling Data with Platform Invoke](../../../framework/interop/marshaling-data-with-platform-invoke.md)"}]}