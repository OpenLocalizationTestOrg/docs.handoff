{"content":"---\ntitle: \"ICorProfilerAssemblyReferenceProvider Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\ndev_langs: \n  - \"C++\"\nms.assetid: 17205116-66e1-4acc-8f01-532fb3867028\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 5\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICorProfilerAssemblyReferenceProvider Interface\n[Supported in the .NET Framework 4.5.2 and later versions]  \n  \n Enables the profiler to inform the common language runtime (CLR) of assembly references that the profiler will add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback.  \n  \n## Methods  \n  \n|Method|Description|  \n|------------|-----------------|  \n|[AddAssemblyReference Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-addassemblyreference-method.md)|Informs the CLR of an assembly reference that the profiler plans to add in the [ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback.|  \n  \n## Remarks  \n The CLR passes the profiler an `ICorProfilerAssemblyReferenceProvider` interface object in the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback. This enables the profiler to inform the CLR of assembly references that the profiler plans to add later in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md). callback. This improves the accuracy of the CLR's assembly reference closure walker and its algorithms for determining whether assemblies may be shared.  \n  \n This interface can be used only in the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback that passes this interface object to the profiler.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorProf.idl, CorProf.h  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]  \n  \n## See Also  \n [Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)","nodes":[{"pos":[4,532],"embed":true,"restype":"x-metadata","content":"title: \"ICorProfilerAssemblyReferenceProvider Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\ndev_langs: \n  - \"C++\"\nms.assetid: 17205116-66e1-4acc-8f01-532fb3867028\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 5\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider Interface | Microsoft Docs","nodes":[{"pos":[0,64],"content":"ICorProfilerAssemblyReferenceProvider Interface | Microsoft Docs","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider Interface | Microsoft Docs","pos":[0,64]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[539,586],"content":"ICorProfilerAssemblyReferenceProvider Interface","linkify":"ICorProfilerAssemblyReferenceProvider Interface","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider Interface","pos":[0,47]}]},{"content":"[Supported in the .NET Framework 4.5.2 and later versions]","pos":[587,645]},{"pos":[652,928],"content":"Enables the profiler to inform the common language runtime (CLR) of assembly references that the profiler will add in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::ModuleLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept> callback.","source":"Enables the profiler to inform the common language runtime (CLR) of assembly references that the profiler will add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback."},{"pos":[937,944],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"content":"Method","pos":[951,957]},{"content":"Description","pos":[958,969]},{"pos":[1009,1159],"content":"<bpt id=\"p1\">[</bpt>AddAssemblyReference Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-addassemblyreference-method.md)</ept>","source":"[AddAssemblyReference Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-addassemblyreference-method.md)"},{"pos":[1160,1371],"content":"Informs the CLR of an assembly reference that the profiler plans to add in the <bpt id=\"p1\">[</bpt>ModuleLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept> callback.","source":"Informs the CLR of an assembly reference that the profiler plans to add in the [ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback."},{"pos":[1381,1388],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The CLR passes the profiler an <ph id=\"ph1\">`ICorProfilerAssemblyReferenceProvider`</ph> interface object in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback.","pos":[1392,1649],"source":"The CLR passes the profiler an `ICorProfilerAssemblyReferenceProvider` interface object in the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback."},{"content":"This enables the profiler to inform the CLR of assembly references that the profiler plans to add later in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::ModuleLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept>.","pos":[1650,1906],"source":" This enables the profiler to inform the CLR of assembly references that the profiler plans to add later in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)."},{"content":"callback.","pos":[1907,1916]},{"content":"This improves the accuracy of the CLR's assembly reference closure walker and its algorithms for determining whether assemblies may be shared.","pos":[1917,2059]},{"pos":[2066,2317],"content":"This interface can be used only in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback that passes this interface object to the profiler.","source":"This interface can be used only in the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback that passes this interface object to the profiler."},{"pos":[2326,2338],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2342,2446],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2453,2487],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorProf.idl, CorProf.h","source":"**Header:** CorProf.idl, CorProf.h"},{"pos":[2494,2604],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]"},{"pos":[2613,2621],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2625,2723],"content":"<bpt id=\"p1\">[</bpt>Profiling Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)</ept>","source":"[Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)"}]}