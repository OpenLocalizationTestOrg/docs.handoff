{"content":"---\ntitle: \"Main Procedure in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Main\"\nhelpviewer_keywords: \n  - \"Main procedure\"\n  - \"Main method [Visual Basic]\"\n  - \"main function\"\nms.assetid: f0db283e-f283-4464-b521-b90858cc1b44\n---\n# Main Procedure in Visual Basic\nEvery Visual Basic application must contain a procedure called `Main`. This procedure serves as the starting point and overall control for your application. The .NET Framework calls your `Main` procedure when it has loaded your application and is ready to pass control to it. Unless you are creating a Windows Forms application, you must write the `Main` procedure for applications that run on their own.  \n  \n `Main` contains the code that runs first. In `Main`, you can determine which form is to be loaded first when the program starts, find out if a copy of your application is already running on the system, establish a set of variables for your application, or open a database that the application requires.  \n  \n## Requirements for the Main Procedure  \n A file that runs on its own (usually with extension .exe) must contain a `Main` procedure. A library (for example with extension .dll) does not run on its own and does not require a `Main` procedure. The requirements for the different types of projects you can create are as follows:  \n  \n-   Console applications run on their own, and you must supply at least one `Main` procedure. .  \n  \n-   Windows Forms applications run on their own. However, the Visual Basic compiler automatically generates a `Main` procedure in such an application, and you do not need to write one.  \n  \n-   Class libraries do not require a `Main` procedure. These include Windows Control Libraries and Web Control Libraries. Web applications are deployed as class libraries.  \n  \n## Declaring the Main Procedure  \n There are four ways to declare the `Main` procedure. It can take arguments or not, and it can return a value or not.  \n  \n> [!NOTE]\n>  If you declare `Main` in a class, you must use the `Shared` keyword. In a module, `Main` does not need to be `Shared`.  \n  \n-   The simplest way is to declare a `Sub` procedure that does not take arguments or return a value.  \n  \n    ```  \n    Module mainModule  \n        Sub Main()  \n            MsgBox(\"The Main procedure is starting the application.\")  \n            ' Insert call to appropriate starting place in your code.  \n            MsgBox(\"The application is terminating.\")  \n        End Sub  \n    End Module  \n    ```  \n  \n-   `Main` can also return an `Integer` value, which the operating system uses as the exit code for your program. Other programs can test this code by examining the Windows ERRORLEVEL value. To return an exit code, you must declare `Main` as a `Function` procedure instead of a `Sub` procedure.  \n  \n    ```  \n    Module mainModule  \n        Function Main() As Integer  \n            MsgBox(\"The Main procedure is starting the application.\")  \n            Dim returnValue As Integer = 0  \n            ' Insert call to appropriate starting place in your code.  \n            ' On return, assign appropriate value to returnValue.  \n            ' 0 usually means successful completion.  \n            MsgBox(\"The application is terminating with error level \" &  \n                 CStr(returnValue) & \".\")  \n            Return returnValue  \n        End Function  \n    End Module  \n    ```  \n  \n-   `Main` can also take a `String` array as an argument. Each string in the array contains one of the command-line arguments used to invoke your program. You can take different actions depending on their values.  \n  \n    ```  \n    Module mainModule  \n        Function Main(ByVal cmdArgs() As String) As Integer  \n            MsgBox(\"The Main procedure is starting the application.\")  \n            Dim returnValue As Integer = 0  \n            ' See if there are any arguments.  \n            If cmdArgs.Length > 0 Then  \n                For argNum As Integer = 0 To UBound(cmdArgs, 1)  \n                    ' Insert code to examine cmdArgs(argNum) and take  \n                    ' appropriate action based on its value.  \n                Next argNum  \n            End If  \n            ' Insert call to appropriate starting place in your code.  \n            ' On return, assign appropriate value to returnValue.  \n            ' 0 usually means successful completion.  \n            MsgBox(\"The application is terminating with error level \" &  \n                 CStr(returnValue) & \".\")  \n            Return returnValue  \n        End Function  \n    End Module  \n    ```  \n  \n-   You can declare `Main` to examine the command-line arguments but not return an exit code, as follows.  \n  \n    ```  \n    Module mainModule  \n        Sub Main(ByVal cmdArgs() As String)  \n            MsgBox(\"The Main procedure is starting the application.\")  \n            Dim returnValue As Integer = 0  \n            ' See if there are any arguments.  \n            If cmdArgs.Length > 0 Then  \n                For argNum As Integer = 0 To UBound(cmdArgs, 1)  \n                    ' Insert code to examine cmdArgs(argNum) and take  \n                    ' appropriate action based on its value.  \n                Next argNum  \n            End If  \n            ' Insert call to appropriate starting place in your code.  \n            MsgBox(\"The application is terminating.\")  \n        End Sub  \n    End Module  \n    ```  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.Interaction.MsgBox%2A>\n- <xref:System.Array.Length%2A>\n- <xref:Microsoft.VisualBasic.Information.UBound%2A>\n- [Structure of a Visual Basic Program](../../../visual-basic/programming-guide/program-structure/structure-of-a-visual-basic-program.md)\n- [/main](../../../visual-basic/reference/command-line-compiler/main.md)\n- [Shared](../../../visual-basic/language-reference/modifiers/shared.md)\n- [Sub Statement](../../../visual-basic/language-reference/statements/sub-statement.md)\n- [Function Statement](../../../visual-basic/language-reference/statements/function-statement.md)\n- [Integer Data Type](../../../visual-basic/language-reference/data-types/integer-data-type.md)\n- [String Data Type](../../../visual-basic/language-reference/data-types/string-data-type.md)\n","nodes":[{"pos":[4,236],"embed":true,"restype":"x-metadata","content":"title: \"Main Procedure in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Main\"\nhelpviewer_keywords: \n  - \"Main procedure\"\n  - \"Main method [Visual Basic]\"\n  - \"main function\"\nms.assetid: f0db283e-f283-4464-b521-b90858cc1b44","nodes":[{"content":"Main Procedure in Visual Basic","nodes":[{"pos":[0,30],"content":"Main Procedure in Visual Basic","nodes":[{"content":"Main Procedure in Visual Basic","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[243,273],"content":"Main Procedure in Visual Basic","linkify":"Main Procedure in Visual Basic","nodes":[{"content":"Main Procedure in Visual Basic","pos":[0,30]}]},{"content":"Every Visual Basic application must contain a procedure called <ph id=\"ph1\">`Main`</ph>.","pos":[274,344],"source":"Every Visual Basic application must contain a procedure called `Main`."},{"content":"This procedure serves as the starting point and overall control for your application.","pos":[345,430]},{"content":"The .NET Framework calls your <ph id=\"ph1\">`Main`</ph> procedure when it has loaded your application and is ready to pass control to it.","pos":[431,549],"source":" The .NET Framework calls your `Main` procedure when it has loaded your application and is ready to pass control to it."},{"content":"Unless you are creating a Windows Forms application, you must write the <ph id=\"ph1\">`Main`</ph> procedure for applications that run on their own.","pos":[550,678],"source":" Unless you are creating a Windows Forms application, you must write the `Main` procedure for applications that run on their own."},{"content":"<ph id=\"ph1\">`Main`</ph> contains the code that runs first.","pos":[685,726],"source":"`Main` contains the code that runs first."},{"content":"In <ph id=\"ph1\">`Main`</ph>, you can determine which form is to be loaded first when the program starts, find out if a copy of your application is already running on the system, establish a set of variables for your application, or open a database that the application requires.","pos":[727,987],"source":" In `Main`, you can determine which form is to be loaded first when the program starts, find out if a copy of your application is already running on the system, establish a set of variables for your application, or open a database that the application requires."},{"pos":[996,1031],"content":"Requirements for the Main Procedure","linkify":"Requirements for the Main Procedure","nodes":[{"content":"Requirements for the Main Procedure","pos":[0,35]}]},{"content":"A file that runs on its own (usually with extension .exe) must contain a <ph id=\"ph1\">`Main`</ph> procedure.","pos":[1035,1125],"source":"A file that runs on its own (usually with extension .exe) must contain a `Main` procedure."},{"content":"A library (for example with extension .dll) does not run on its own and does not require a <ph id=\"ph1\">`Main`</ph> procedure.","pos":[1126,1234],"source":" A library (for example with extension .dll) does not run on its own and does not require a `Main` procedure."},{"content":"The requirements for the different types of projects you can create are as follows:","pos":[1235,1318]},{"content":"Console applications run on their own, and you must supply at least one <ph id=\"ph1\">`Main`</ph> procedure.","pos":[1328,1417],"source":"Console applications run on their own, and you must supply at least one `Main` procedure."},{"content":".","pos":[1418,1419]},{"content":"Windows Forms applications run on their own.","pos":[1429,1473]},{"content":"However, the Visual Basic compiler automatically generates a <ph id=\"ph1\">`Main`</ph> procedure in such an application, and you do not need to write one.","pos":[1474,1609],"source":" However, the Visual Basic compiler automatically generates a `Main` procedure in such an application, and you do not need to write one."},{"content":"Class libraries do not require a <ph id=\"ph1\">`Main`</ph> procedure.","pos":[1619,1669],"source":"Class libraries do not require a `Main` procedure."},{"content":"These include Windows Control Libraries and Web Control Libraries.","pos":[1670,1736]},{"content":"Web applications are deployed as class libraries.","pos":[1737,1786]},{"pos":[1795,1823],"content":"Declaring the Main Procedure","linkify":"Declaring the Main Procedure","nodes":[{"content":"Declaring the Main Procedure","pos":[0,28]}]},{"content":"There are four ways to declare the <ph id=\"ph1\">`Main`</ph> procedure.","pos":[1827,1879],"source":"There are four ways to declare the `Main` procedure."},{"content":"It can take arguments or not, and it can return a value or not.","pos":[1880,1943]},{"pos":[1951,2080],"content":"[!NOTE]\n If you declare `Main` in a class, you must use the `Shared` keyword. In a module, `Main` does not need to be `Shared`.","leadings":["","> "],"nodes":[{"content":"If you declare `Main` in a class, you must use the `Shared` keyword. In a module, `Main` does not need to be `Shared`.","pos":[9,127],"nodes":[{"content":"If you declare <ph id=\"ph1\">`Main`</ph> in a class, you must use the <ph id=\"ph2\">`Shared`</ph> keyword.","pos":[0,68],"source":"If you declare `Main` in a class, you must use the `Shared` keyword."},{"content":"In a module, <ph id=\"ph1\">`Main`</ph> does not need to be <ph id=\"ph2\">`Shared`</ph>.","pos":[69,118],"source":" In a module, `Main` does not need to be `Shared`."}]}]},{"pos":[2090,2186],"content":"The simplest way is to declare a <ph id=\"ph1\">`Sub`</ph> procedure that does not take arguments or return a value.","source":"The simplest way is to declare a `Sub` procedure that does not take arguments or return a value."},{"content":"<ph id=\"ph1\">`Main`</ph> can also return an <ph id=\"ph2\">`Integer`</ph> value, which the operating system uses as the exit code for your program.","pos":[2499,2608],"source":"`Main` can also return an `Integer` value, which the operating system uses as the exit code for your program."},{"content":"Other programs can test this code by examining the Windows ERRORLEVEL value.","pos":[2609,2685]},{"content":"To return an exit code, you must declare <ph id=\"ph1\">`Main`</ph> as a <ph id=\"ph2\">`Function`</ph> procedure instead of a <ph id=\"ph3\">`Sub`</ph> procedure.","pos":[2686,2789],"source":" To return an exit code, you must declare `Main` as a `Function` procedure instead of a `Sub` procedure."},{"content":"<ph id=\"ph1\">`Main`</ph> can also take a <ph id=\"ph2\">`String`</ph> array as an argument.","pos":[3386,3439],"source":"`Main` can also take a `String` array as an argument."},{"content":"Each string in the array contains one of the command-line arguments used to invoke your program.","pos":[3440,3536]},{"content":"You can take different actions depending on their values.","pos":[3537,3594]},{"pos":[4557,4658],"content":"You can declare <ph id=\"ph1\">`Main`</ph> to examine the command-line arguments but not return an exit code, as follows.","source":"You can declare `Main` to examine the command-line arguments but not return an exit code, as follows."},{"pos":[5381,5389],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5531,5666],"content":"<bpt id=\"p1\">[</bpt>Structure of a Visual Basic Program<ept id=\"p1\">](../../../visual-basic/programming-guide/program-structure/structure-of-a-visual-basic-program.md)</ept>","source":"[Structure of a Visual Basic Program](../../../visual-basic/programming-guide/program-structure/structure-of-a-visual-basic-program.md)"},{"pos":[5669,5739],"content":"<bpt id=\"p1\">[</bpt>/main<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/main.md)</ept>","source":"[/main](../../../visual-basic/reference/command-line-compiler/main.md)"},{"pos":[5742,5812],"content":"<bpt id=\"p1\">[</bpt>Shared<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/shared.md)</ept>","source":"[Shared](../../../visual-basic/language-reference/modifiers/shared.md)"},{"pos":[5815,5900],"content":"<bpt id=\"p1\">[</bpt>Sub Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/sub-statement.md)</ept>","source":"[Sub Statement](../../../visual-basic/language-reference/statements/sub-statement.md)"},{"pos":[5903,5998],"content":"<bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/function-statement.md)</ept>","source":"[Function Statement](../../../visual-basic/language-reference/statements/function-statement.md)"},{"pos":[6001,6094],"content":"<bpt id=\"p1\">[</bpt>Integer Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/integer-data-type.md)</ept>","source":"[Integer Data Type](../../../visual-basic/language-reference/data-types/integer-data-type.md)"},{"pos":[6097,6188],"content":"<bpt id=\"p1\">[</bpt>String Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/string-data-type.md)</ept>","source":"[String Data Type](../../../visual-basic/language-reference/data-types/string-data-type.md)"}]}