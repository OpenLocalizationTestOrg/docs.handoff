{"content":"---\ntitle: \"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"examples [Windows Forms], just-in-time data loading\"\n  - \"data [Windows Forms], managing large data sets\"\n  - \"DataGridView control [Windows Forms], virtual mode\"\n  - \"just-in-time data loading\"\n  - \"DataGridView control [Windows Forms], large data sets\"\n  - \"virtual mode, just-in-time data loading\"\nms.assetid: c2a052b9-423c-4ff7-91dc-d8c7c79345f6\ncaps.latest.revision: 13\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control\nOne reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed. This is called *just-in-time data loading*.  \n  \n If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view. If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.  \n  \n The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache.  \n  \n To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).  \n  \n## The Form  \n The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler. The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database. The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns.  \n  \n The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic.  \n  \n> [!NOTE]\n>  Storing sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).  \n  \n [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]  \n  \n## The IDataPageRetriever Interface  \n The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class. The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data. These values are used by the implementer to retrieve a subset of data from a data source.  \n  \n A `Cache` object uses an implementation of this interface during construction to load two initial pages of data. Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`.  \n  \n [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]  \n  \n## The DataRetriever Class  \n The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server. The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection. Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table. This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table. The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view.  \n  \n [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]  \n  \n## The Cache Class  \n The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation. The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.  \n  \n The `Cache` class loads two pages of data at construction time. Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it. If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.  \n  \n Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.  \n  \n [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]  \n  \n## Additional Considerations  \n The previous code examples are provided as a demonstration of just-in-time data loading. You will need to modify the code for your own needs to achieve maximum efficiency. At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache. This value is passed into the `Cache` constructor. The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control.  \n  \n For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users. Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used. The bandwidth and latency should be determined at times of peak usage.  \n  \n To improve the scrolling performance of your application, you can increase the amount of data stored locally. To improve startup time, however, you must avoid loading too much data initially. You may want to modify the `Cache` class to increase the number of data pages it can store. Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency. With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data. If latency is more of an issue than bandwidth, you may want to use larger data pages.  \n  \n## See Also  \n <xref:System.Windows.Forms.DataGridView>   \n <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>   \n [Performance Tuning in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)   \n [Best Practices for Scaling the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)   \n [Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)   \n [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)   \n [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)","nodes":[{"pos":[12,127],"content":"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control | Microsoft Docs","pos":[0,115]}]},{"pos":[793,891],"content":"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control","linkify":"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control","nodes":[{"content":"Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control","pos":[0,98]}]},{"content":"One reason to implement virtual mode in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control is to retrieve data only as it is needed.","pos":[892,1026],"source":"One reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed."},{"content":"This is called <bpt id=\"p1\">*</bpt>just-in-time data loading<ept id=\"p1\">*</ept>.","pos":[1027,1070],"source":" This is called *just-in-time data loading*."},{"content":"If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view.","pos":[1077,1329]},{"content":"If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.","pos":[1330,1527]},{"content":"The following sections describe how to use a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control with a just-in-time cache.","pos":[1534,1654],"source":"The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache."},{"pos":[1661,1932],"content":"To copy the code in this topic as a single listing, see <bpt id=\"p1\">[</bpt>How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)</ept>.","source":"To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)."},{"pos":[1941,1949],"content":"The Form","linkify":"The Form","nodes":[{"content":"The Form","pos":[0,8]}]},{"content":"The following code example defines a form containing a read-only <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control that interacts with a <ph id=\"ph2\">`Cache`</ph> object through a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridView.CellValueNeeded&gt;</ph> event handler.","pos":[1953,2185],"source":"The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler."},{"content":"The <ph id=\"ph1\">`Cache`</ph> object manages the locally stored values and uses a <ph id=\"ph2\">`DataRetriever`</ph> object to retrieve values from the Orders table of the sample Northwind database.","pos":[2186,2347],"source":" The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database."},{"content":"The <ph id=\"ph1\">`DataRetriever`</ph> object, which implements the <ph id=\"ph2\">`IDataPageRetriever`</ph> interface required by the <ph id=\"ph3\">`Cache`</ph> class, is also used to initialize the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control rows and columns.","pos":[2348,2556],"source":" The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns."},{"pos":[2563,2658],"content":"The <ph id=\"ph1\">`IDataPageRetriever`</ph>, <ph id=\"ph2\">`DataRetriever`</ph>, and <ph id=\"ph3\">`Cache`</ph> types are described later in this topic.","source":"The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic."},{"pos":[2666,3060],"content":"[!NOTE]\n Storing sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).","leadings":["","> "],"nodes":[{"content":" Storing sensitive information, such as a password, within the connection string can affect the security of your application. Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database. For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).","pos":[8,392],"nodes":[{"content":"Storing sensitive information, such as a password, within the connection string can affect the security of your application.","pos":[1,125]},{"content":"Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.","pos":[126,244]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Protecting Connection Information<ept id=\"p1\">](../../../../docs/framework/data/adonet/protecting-connection-information.md)</ept>.","pos":[245,384],"source":" For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md)."}]}]},{"pos":[3067,3484],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#100<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#100<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]"},{"pos":[3493,3525],"content":"The IDataPageRetriever Interface","linkify":"The IDataPageRetriever Interface","nodes":[{"content":"The IDataPageRetriever Interface","pos":[0,32]}]},{"content":"The following code example defines the <ph id=\"ph1\">`IDataPageRetriever`</ph> interface, which is implemented by the <ph id=\"ph2\">`DataRetriever`</ph> class.","pos":[3529,3650],"source":"The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class."},{"content":"The only method declared in this interface is the <ph id=\"ph1\">`SupplyPageOfData`</ph> method, which requires an initial row index and a count of the number of rows in a single page of data.","pos":[3651,3823],"source":" The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data."},{"content":"These values are used by the implementer to retrieve a subset of data from a data source.","pos":[3824,3913]},{"content":"A <ph id=\"ph1\">`Cache`</ph> object uses an implementation of this interface during construction to load two initial pages of data.","pos":[3920,4032],"source":"A `Cache` object uses an implementation of this interface during construction to load two initial pages of data."},{"content":"Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the <ph id=\"ph1\">`IDataPageRetriever`</ph>.","pos":[4033,4184],"source":" Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`."},{"pos":[4191,4608],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#201<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#201<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]"},{"pos":[4617,4640],"content":"The DataRetriever Class","linkify":"The DataRetriever Class","nodes":[{"content":"The DataRetriever Class","pos":[0,23]}]},{"content":"The following code example defines the <ph id=\"ph1\">`DataRetriever`</ph> class, which implements the <ph id=\"ph2\">`IDataPageRetriever`</ph> interface to retrieve pages of data from a server.","pos":[4644,4798],"source":"The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server."},{"content":"The <ph id=\"ph1\">`DataRetriever`</ph> class also provides <ph id=\"ph2\">`Columns`</ph> and <ph id=\"ph3\">`RowCount`</ph> properties, which the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control uses to create the necessary columns and to add the appropriate number of empty rows to the <ph id=\"ph5\">&lt;xref:System.Windows.Forms.DataGridView.Rows%2A&gt;</ph> collection.","pos":[4799,5087],"source":" The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection."},{"content":"Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table.","pos":[5088,5203]},{"content":"This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table.","pos":[5204,5342]},{"content":"The rows are filled by the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellValueNeeded&gt;</ph> event handler only when they are scrolled into view.","pos":[5343,5479],"source":" The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view."},{"pos":[5486,5903],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#200<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#200<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]"},{"pos":[5912,5927],"content":"The Cache Class","linkify":"The Cache Class","nodes":[{"content":"The Cache Class","pos":[0,15]}]},{"content":"The following code example defines the <ph id=\"ph1\">`Cache`</ph> class, which manages two pages of data populated through an <ph id=\"ph2\">`IDataPageRetriever`</ph> implementation.","pos":[5931,6074],"source":"The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation."},{"content":"The <ph id=\"ph1\">`Cache`</ph> class defines an inner <ph id=\"ph2\">`DataPage`</ph> structure, which contains a <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.","pos":[6075,6316],"source":" The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page."},{"content":"The <ph id=\"ph1\">`Cache`</ph> class loads two pages of data at construction time.","pos":[6323,6386],"source":"The `Cache` class loads two pages of data at construction time."},{"content":"Whenever the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.CellValueNeeded&gt;</ph> event requests a value, the <ph id=\"ph2\">`Cache`</ph> object determines if the value is available in one of its two pages and, if so, returns it.","pos":[6387,6584],"source":" Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it."},{"content":"If the value is not available locally, the <ph id=\"ph1\">`Cache`</ph> object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.","pos":[6585,6814],"source":" If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns."},{"content":"Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.","pos":[6821,7048]},{"pos":[7055,7472],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#300<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridView.Virtual_lazyloading#300<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]\n [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]"},{"pos":[7481,7506],"content":"Additional Considerations","linkify":"Additional Considerations","nodes":[{"content":"Additional Considerations","pos":[0,25]}]},{"content":"The previous code examples are provided as a demonstration of just-in-time data loading.","pos":[7510,7598]},{"content":"You will need to modify the code for your own needs to achieve maximum efficiency.","pos":[7599,7681]},{"content":"At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache.","pos":[7682,7792]},{"content":"This value is passed into the <ph id=\"ph1\">`Cache`</ph> constructor.","pos":[7793,7843],"source":" This value is passed into the `Cache` constructor."},{"content":"The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control.","pos":[7844,8008],"source":" The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control."},{"content":"For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users.","pos":[8015,8160]},{"content":"Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used.","pos":[8161,8392]},{"content":"The bandwidth and latency should be determined at times of peak usage.","pos":[8393,8463]},{"content":"To improve the scrolling performance of your application, you can increase the amount of data stored locally.","pos":[8470,8579]},{"content":"To improve startup time, however, you must avoid loading too much data initially.","pos":[8580,8661]},{"content":"You may want to modify the <ph id=\"ph1\">`Cache`</ph> class to increase the number of data pages it can store.","pos":[8662,8753],"source":" You may want to modify the `Cache` class to increase the number of data pages it can store."},{"content":"Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency.","pos":[8754,8942]},{"content":"With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data.","pos":[8943,9061]},{"content":"If latency is more of an issue than bandwidth, you may want to use larger data pages.","pos":[9062,9147]},{"pos":[9156,9164],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph>","pos":[9168,9208],"source":"<xref:System.Windows.Forms.DataGridView> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.VirtualMode%2A&gt;</ph>","pos":[9213,9268],"source":" <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> "},{"content":"<bpt id=\"p1\"> [</bpt>Performance Tuning in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9272,9446],"source":" [Performance Tuning in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Best Practices for Scaling the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9449,9633],"source":" [Best Practices for Scaling the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Virtual Mode in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9636,9798],"source":" [Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[9801,9984],"source":" [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)</ept>","pos":[9987,10202],"source":" [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)"}]}