{"content":"---\ntitle: \"How to: Delete a Registry Key in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.DeleteSetting\"\nhelpviewer_keywords: \n  - \"GetSetting function [Visual Basic]\"\n  - \"registry [Visual Basic], deleting values\"\n  - \"GetAllSettings function\"\n  - \"registry keys [Visual Basic], deleting\"\n  - \"registry [Visual Basic], deleting keys\"\n  - \"examples [Visual Basic], registry\"\nms.assetid: ab9aca0e-42b0-4ff7-8ff9-845a4bfdf9f2\n---\n# How to: Delete a Registry Key in Visual Basic\nThe <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29> and <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29> methods can be used to delete registry keys.  \n  \n## Procedure  \n  \n#### To delete a registry key  \n  \n-   Use the `DeleteSubKey` method to delete a registry key. This example deletes the key Software/TestApp in the CurrentUser hive. You can change this in the code to the appropriate string, or have it rely on user-supplied information.  \n  \n     [!code-vb[VbResourceTasks#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#19)]  \n  \n## Robust Programming  \n The `DeleteSubKey` method returns an empty string if the key/value pair does not exist.  \n  \n The following conditions may cause an exception:  \n  \n-   The name of the key is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The user does not have permissions to delete registry keys (<xref:System.Security.SecurityException>).  \n  \n-   The key name exceeds the 255-character limit (<xref:System.ArgumentException>).  \n  \n-   The registry key is read-only (<xref:System.UnauthorizedAccessException>).  \n  \n## .NET Framework Security  \n Registry calls fail if either sufficient run-time permissions are not granted (<xref:System.Security.Permissions.RegistryPermission>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings. For example, a local application that has the code access security permission might not have operating system permission.  \n  \n## See also\n\n- <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%2A>\n- <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%2A>\n- <xref:Microsoft.Win32.RegistryKey>\n- [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)\n- [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)\n","nodes":[{"pos":[4,434],"embed":true,"restype":"x-metadata","content":"title: \"How to: Delete a Registry Key in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.DeleteSetting\"\nhelpviewer_keywords: \n  - \"GetSetting function [Visual Basic]\"\n  - \"registry [Visual Basic], deleting values\"\n  - \"GetAllSettings function\"\n  - \"registry keys [Visual Basic], deleting\"\n  - \"registry [Visual Basic], deleting keys\"\n  - \"examples [Visual Basic], registry\"\nms.assetid: ab9aca0e-42b0-4ff7-8ff9-845a4bfdf9f2","nodes":[{"content":"How to: Delete a Registry Key in Visual Basic","nodes":[{"pos":[0,45],"content":"How to: Delete a Registry Key in Visual Basic","nodes":[{"content":"How to: Delete a Registry Key in Visual Basic","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[441,486],"content":"How to: Delete a Registry Key in Visual Basic","linkify":"How to: Delete a Registry Key in Visual Basic","nodes":[{"content":"How to: Delete a Registry Key in Visual Basic","pos":[0,45]}]},{"pos":[487,690],"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29&gt;</ph> and <ph id=\"ph2\">&lt;xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29&gt;</ph> methods can be used to delete registry keys.","source":"The <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29> and <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29> methods can be used to delete registry keys."},{"pos":[699,708],"content":"Procedure","linkify":"Procedure","nodes":[{"content":"Procedure","pos":[0,9]}]},{"pos":[719,743],"content":"To delete a registry key","linkify":"To delete a registry key","nodes":[{"content":"To delete a registry key","pos":[0,24]}]},{"content":"Use the <ph id=\"ph1\">`DeleteSubKey`</ph> method to delete a registry key.","pos":[753,808],"source":"Use the `DeleteSubKey` method to delete a registry key."},{"content":"This example deletes the key Software/TestApp in the CurrentUser hive.","pos":[809,879]},{"content":"You can change this in the code to the appropriate string, or have it rely on user-supplied information.","pos":[880,984]},{"pos":[1119,1137],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"pos":[1141,1228],"content":"The <ph id=\"ph1\">`DeleteSubKey`</ph> method returns an empty string if the key/value pair does not exist.","source":"The `DeleteSubKey` method returns an empty string if the key/value pair does not exist."},{"content":"The following conditions may cause an exception:","pos":[1235,1283]},{"pos":[1293,1364],"content":"The name of the key is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The name of the key is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[1374,1476],"content":"The user does not have permissions to delete registry keys (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user does not have permissions to delete registry keys (<xref:System.Security.SecurityException>)."},{"pos":[1486,1565],"content":"The key name exceeds the 255-character limit (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The key name exceeds the 255-character limit (<xref:System.ArgumentException>)."},{"pos":[1575,1649],"content":"The registry key is read-only (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"The registry key is read-only (<xref:System.UnauthorizedAccessException>)."},{"pos":[1658,1681],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"Registry calls fail if either sufficient run-time permissions are not granted (<ph id=\"ph1\">&lt;xref:System.Security.Permissions.RegistryPermission&gt;</ph>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings.","pos":[1685,1931],"source":"Registry calls fail if either sufficient run-time permissions are not granted (<xref:System.Security.Permissions.RegistryPermission>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings."},{"content":"For example, a local application that has the code access security permission might not have operating system permission.","pos":[1932,2053]},{"pos":[2062,2070],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2217,2346],"content":"<bpt id=\"p1\">[</bpt>Security and the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)</ept>","source":"[Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)"},{"pos":[2349,2508],"content":"<bpt id=\"p1\">[</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept>","source":"[Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)"}]}