{"content":"---\ntitle: \"WebContentTypeMapper Sample\"\nms.date: \"03/30/2017\"\nms.assetid: a4fe59e7-44d8-43c6-a1f8-40c45223adca\n---\n# WebContentTypeMapper Sample\nThis sample demonstrates how to map new content types to Windows Communication Foundation (WCF) message body formats.  \n  \n The <xref:System.ServiceModel.Description.WebHttpEndpoint> element plugs in the Web message encoder, which allows WCF to receive JSON, XML, or raw binary messages at the same endpoint. The encoder determines the body format of the message by looking at the HTTP content-type of the request. This sample introduces the <xref:System.ServiceModel.Channels.WebContentTypeMapper> class, which allows the user to control the mapping between content type and body format.  \n  \n WCF provides a set of default mappings for content types. For example, `application/json` maps to JSON and `text/xml` maps to XML. Any content type that is not mapped to JSON or XML is mapped to raw binary format.  \n  \n In some scenarios (for example, push-style APIs), the service developer does not control the content type returned by the client. For example, clients might return JSON as `text/javascript` instead of `application/json`. In this case, the service developer must provide a type that derives from <xref:System.ServiceModel.Channels.WebContentTypeMapper> to handle the given content type correctly, as shown in the following sample code.  \n  \n```  \npublic class JsonContentTypeMapper : WebContentTypeMapper  \n{  \n    public override WebContentFormat  \n               GetMessageFormatForContentType(string contentType)  \n    {  \n        if (contentType == \"text/javascript\")  \n        {  \n            return WebContentFormat.Json;  \n        }  \n        else  \n        {  \n            return WebContentFormat.Default;  \n        }  \n    }  \n}  \n```  \n  \n The type must override the <xref:System.ServiceModel.Channels.WebContentTypeMapper.GetMessageFormatForContentType%28System.String%29> method. The method must evaluate the `contentType` argument and return one of the following values: <xref:System.ServiceModel.Channels.WebContentFormat.Json>, <xref:System.ServiceModel.Channels.WebContentFormat.Xml>, <xref:System.ServiceModel.Channels.WebContentFormat.Raw>, or <xref:System.ServiceModel.Channels.WebContentFormat.Default>. Returning <xref:System.ServiceModel.Channels.WebContentFormat.Default> defers to the default Web message encoder mappings. In the previous sample code, the `text/javascript` content type is mapped to JSON, and all other mappings remain unchanged.  \n  \n To use the `JsonContentTypeMapper` class, use the following in your Web.config:  \n  \n```xml  \n<system.serviceModel>  \n  <standardEndpoints>  \n    <webHttpEndpoint>  \n      <standardEndpoint name=\"\" contentTypeMapper=\"Microsoft.Samples.WebContentTypeMapper.JsonContentTypeMapper, JsonContentTypeMapper, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" />  \n    </webHttpEndpoint>  \n  </standardEndpoints>  \n</system.serviceModel>  \n```  \n  \n To verify the requirement for using the JsonContentTypeMapper, remove the contentTypeMapper attribute from the above configuration file. The client page fails to load when attempting to use `text/javascript` to send JSON content.  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  Build the solution WebContentTypeMapperSample.sln as described in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  Navigate to `http://localhost/ServiceModelSamples/JCTMClientPage.htm` (do not open JCTMClientPage.htm in the browser from within the project directory).  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Extensibility\\Ajax\\WebContentTypeMapper`  \n","nodes":[{"pos":[4,111],"embed":true,"restype":"x-metadata","content":"title: \"WebContentTypeMapper Sample\"\nms.date: \"03/30/2017\"\nms.assetid: a4fe59e7-44d8-43c6-a1f8-40c45223adca","nodes":[{"content":"WebContentTypeMapper Sample","nodes":[{"pos":[0,27],"content":"WebContentTypeMapper Sample","nodes":[{"content":"WebContentTypeMapper Sample","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[118,145],"content":"WebContentTypeMapper Sample","linkify":"WebContentTypeMapper Sample","nodes":[{"content":"WebContentTypeMapper Sample","pos":[0,27]}]},{"content":"This sample demonstrates how to map new content types to Windows Communication Foundation (WCF) message body formats.","pos":[146,263]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.WebHttpEndpoint&gt;</ph> element plugs in the Web message encoder, which allows WCF to receive JSON, XML, or raw binary messages at the same endpoint.","pos":[270,454],"source":"The <xref:System.ServiceModel.Description.WebHttpEndpoint> element plugs in the Web message encoder, which allows WCF to receive JSON, XML, or raw binary messages at the same endpoint."},{"content":"The encoder determines the body format of the message by looking at the HTTP content-type of the request.","pos":[455,560]},{"content":"This sample introduces the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.WebContentTypeMapper&gt;</ph> class, which allows the user to control the mapping between content type and body format.","pos":[561,734],"source":" This sample introduces the <xref:System.ServiceModel.Channels.WebContentTypeMapper> class, which allows the user to control the mapping between content type and body format."},{"content":"WCF provides a set of default mappings for content types.","pos":[741,798]},{"content":"For example, <ph id=\"ph1\">`application/json`</ph> maps to JSON and <ph id=\"ph2\">`text/xml`</ph> maps to XML.","pos":[799,871],"source":" For example, `application/json` maps to JSON and `text/xml` maps to XML."},{"content":"Any content type that is not mapped to JSON or XML is mapped to raw binary format.","pos":[872,954]},{"content":"In some scenarios (for example, push-style APIs), the service developer does not control the content type returned by the client.","pos":[961,1090]},{"content":"For example, clients might return JSON as <ph id=\"ph1\">`text/javascript`</ph> instead of <ph id=\"ph2\">`application/json`</ph>.","pos":[1091,1181],"source":" For example, clients might return JSON as `text/javascript` instead of `application/json`."},{"content":"In this case, the service developer must provide a type that derives from <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.WebContentTypeMapper&gt;</ph> to handle the given content type correctly, as shown in the following sample code.","pos":[1182,1395],"source":" In this case, the service developer must provide a type that derives from <xref:System.ServiceModel.Channels.WebContentTypeMapper> to handle the given content type correctly, as shown in the following sample code."},{"content":"The type must override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.WebContentTypeMapper.GetMessageFormatForContentType%28System.String%29&gt;</ph> method.","pos":[1810,1951],"source":"The type must override the <xref:System.ServiceModel.Channels.WebContentTypeMapper.GetMessageFormatForContentType%28System.String%29> method."},{"content":"The method must evaluate the <ph id=\"ph1\">`contentType`</ph> argument and return one of the following values: <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.WebContentFormat.Json&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.WebContentFormat.Xml&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.ServiceModel.Channels.WebContentFormat.Raw&gt;</ph>, or <ph id=\"ph5\">&lt;xref:System.ServiceModel.Channels.WebContentFormat.Default&gt;</ph>.","pos":[1952,2283],"source":" The method must evaluate the `contentType` argument and return one of the following values: <xref:System.ServiceModel.Channels.WebContentFormat.Json>, <xref:System.ServiceModel.Channels.WebContentFormat.Xml>, <xref:System.ServiceModel.Channels.WebContentFormat.Raw>, or <xref:System.ServiceModel.Channels.WebContentFormat.Default>."},{"content":"Returning <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.WebContentFormat.Default&gt;</ph> defers to the default Web message encoder mappings.","pos":[2284,2406],"source":" Returning <xref:System.ServiceModel.Channels.WebContentFormat.Default> defers to the default Web message encoder mappings."},{"content":"In the previous sample code, the <ph id=\"ph1\">`text/javascript`</ph> content type is mapped to JSON, and all other mappings remain unchanged.","pos":[2407,2530],"source":" In the previous sample code, the `text/javascript` content type is mapped to JSON, and all other mappings remain unchanged."},{"pos":[2537,2616],"content":"To use the <ph id=\"ph1\">`JsonContentTypeMapper`</ph> class, use the following in your Web.config:","source":"To use the `JsonContentTypeMapper` class, use the following in your Web.config:"},{"content":"To verify the requirement for using the JsonContentTypeMapper, remove the contentTypeMapper attribute from the above configuration file.","pos":[2984,3120]},{"content":"The client page fails to load when attempting to use <ph id=\"ph1\">`text/javascript`</ph> to send JSON content.","pos":[3121,3213],"source":" The client page fails to load when attempting to use `text/javascript` to send JSON content."},{"pos":[3223,3259],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[3269,3468],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[3478,3664],"content":"Build the solution WebContentTypeMapperSample.sln as described in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"Build the solution WebContentTypeMapperSample.sln as described in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[3674,3826],"content":"Navigate to <ph id=\"ph1\">`http://localhost/ServiceModelSamples/JCTMClientPage.htm`</ph> (do not open JCTMClientPage.htm in the browser from within the project directory).","source":"Navigate to `http://localhost/ServiceModelSamples/JCTMClientPage.htm` (do not open JCTMClientPage.htm in the browser from within the project directory)."},{"pos":[3834,3966],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4020,4330],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4331,4381]}]}