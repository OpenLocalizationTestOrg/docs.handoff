{"content":"---\ntitle: \"Use the AutomationID Property\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"AutomationId property\"\n  - \"UI Automation, AutomationId property\"\n  - \"properties, AutomationId\"\nms.assetid: a24e807b-d7c3-4e93-ac48-80094c4e1c90\n---\n# Use the AutomationID Property\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic contains scenarios and sample code that show how and when the <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be used to locate an element within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.  \n  \n <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> uniquely identifies a UI Automation element from its siblings. For more information on property identifiers related to control identification, see [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).  \n  \n> [!NOTE]\n>  <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the tree; it typically needs container and scope information to be useful. For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items. These secondary menu items may be identified by a generic scheme such as \"Item1\", \"Item 2\", and so on, allowing duplicate identifiers for children across top-level menu items.  \n  \n## Scenarios  \n Three primary UI Automation client application scenarios have been identified that require the use of <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> to achieve accurate and consistent results when searching for elements.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is supported by all UI Automation elements in the control view except top-level application windows, UI Automation elements derived from [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] controls that do not have an ID or x:Uid, and UI Automation elements derived from [!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)] controls that do not have a control ID.  \n  \n#### Use a unique and discoverable AutomationID to locate a specific element in the UI Automation tree  \n  \n-   Use a tool such as [!INCLUDE[TLA#tla_uispy](../../../includes/tlasharptla-uispy-md.md)] to report the <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> of a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element of interest. This value can then be copied and pasted into a client application such as a test script for subsequent automated testing. This approach reduces and simplifies the code necessary to identify and locate an element at runtime.  \n  \n> [!CAUTION]\n>  In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.  \n  \n [!code-csharp[UIAAutomationID_snip#100](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAAutomationID_snip/CSharp/FindByAutomationID.xaml.cs#100)]\n [!code-vb[UIAAutomationID_snip#100](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAAutomationID_snip/VisualBasic/FindByAutomationID.xaml.vb#100)]  \n  \n#### Use a persistent path to return to a previously identified AutomationElement  \n  \n-   Client applications, from simple test scripts to robust record and playback utilities, may require access to elements that are not currently instantiated, such as a file open dialog or a menu item and therefore do not exist in the UI Automation tree. These elements can only be instantiated by reproducing, or \"playing back\", a specific sequence of UI actions through the use of UI Automation properties such as AutomationID, control patterns, and event listeners.\n  \n [!code-csharp[UIAAutomationID_snip#UIAWorkerThread](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAAutomationID_snip/CSharp/FindByAutomationID.xaml.cs#uiaworkerthread)]\n [!code-vb[UIAAutomationID_snip#UIAWorkerThread](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAAutomationID_snip/VisualBasic/FindByAutomationID.xaml.vb#uiaworkerthread)]  \n[!code-csharp[UIAAutomationID_snip#Playback](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAAutomationID_snip/CSharp/FindByAutomationID.xaml.cs#playback)]\n[!code-vb[UIAAutomationID_snip#Playback](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAAutomationID_snip/VisualBasic/FindByAutomationID.xaml.vb#playback)]  \n  \n#### Use a relative path to return to a previously identified AutomationElement  \n  \n-   In certain circumstances, since AutomationID is only guaranteed to be unique amongst siblings, multiple elements in the UI Automation tree may have identical AutomationID property values. In these situations the elements can be uniquely identified based on a parent and, if necessary, a grandparent. For example, a developer may provide a menu bar with multiple menu items each with multiple child menu items where the children are identified with sequential AutomationID's such as \"Item1\", \"Item2\", and so on. Each menu item could then be uniquely identified by its AutomationID along with the AutomationID of its parent and, if necessary, its grandparent.  \n  \n## See also\n\n- <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty>\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Find a UI Automation Element Based on a Property Condition](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)\n","nodes":[{"pos":[4,271],"embed":true,"restype":"x-metadata","content":"title: \"Use the AutomationID Property\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"AutomationId property\"\n  - \"UI Automation, AutomationId property\"\n  - \"properties, AutomationId\"\nms.assetid: a24e807b-d7c3-4e93-ac48-80094c4e1c90","nodes":[{"content":"Use the AutomationID Property","nodes":[{"pos":[0,29],"content":"Use the AutomationID Property","nodes":[{"content":"Use the AutomationID Property","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[278,307],"content":"Use the AutomationID Property","linkify":"Use the AutomationID Property","nodes":[{"content":"Use the AutomationID Property","pos":[0,29]}]},{"pos":[310,773],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[780,1059],"content":"This topic contains scenarios and sample code that show how and when the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> can be used to locate an element within the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree.","source":"This topic contains scenarios and sample code that show how and when the <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be used to locate an element within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> uniquely identifies a UI Automation element from its siblings.","pos":[1066,1200],"source":"<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> uniquely identifies a UI Automation element from its siblings."},{"content":"For more information on property identifiers related to control identification, see <bpt id=\"p1\">[</bpt>UI Automation Properties Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)</ept>.","pos":[1201,1397],"source":" For more information on property identifiers related to control identification, see [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)."},{"pos":[1405,1923],"content":"[!NOTE]\n <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the tree; it typically needs container and scope information to be useful. For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items. These secondary menu items may be identified by a generic scheme such as \"Item1\", \"Item 2\", and so on, allowing duplicate identifiers for children across top-level menu items.","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the tree; it typically needs container and scope information to be useful. For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items. These secondary menu items may be identified by a generic scheme such as \"Item1\", \"Item 2\", and so on, allowing duplicate identifiers for children across top-level menu items.","pos":[9,516],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> does not guarantee a unique identity throughout the tree; it typically needs container and scope information to be useful.","pos":[0,194],"source":"<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the tree; it typically needs container and scope information to be useful."},{"content":"For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items.","pos":[195,331]},{"content":"These secondary menu items may be identified by a generic scheme such as \"Item1\", \"Item 2\", and so on, allowing duplicate identifiers for children across top-level menu items.","pos":[332,507]}]}]},{"pos":[1932,1941],"content":"Scenarios","linkify":"Scenarios","nodes":[{"content":"Scenarios","pos":[0,9]}]},{"pos":[1945,2190],"content":"Three primary UI Automation client application scenarios have been identified that require the use of <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> to achieve accurate and consistent results when searching for elements.","source":"Three primary UI Automation client application scenarios have been identified that require the use of <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> to achieve accurate and consistent results when searching for elements."},{"pos":[2198,2685],"content":"[!NOTE]\n <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is supported by all UI Automation elements in the control view except top-level application windows, UI Automation elements derived from [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] controls that do not have an ID or x:Uid, and UI Automation elements derived from [!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)] controls that do not have a control ID.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> is supported by all UI Automation elements in the control view except top-level application windows, UI Automation elements derived from <ph id=\"ph2\">[!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)]</ph> controls that do not have an ID or x:Uid, and UI Automation elements derived from <ph id=\"ph3\">[!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)]</ph> controls that do not have a control ID.","pos":[9,485],"source":"<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is supported by all UI Automation elements in the control view except top-level application windows, UI Automation elements derived from [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] controls that do not have an ID or x:Uid, and UI Automation elements derived from [!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)] controls that do not have a control ID."}]},{"pos":[2696,2793],"content":"Use a unique and discoverable AutomationID to locate a specific element in the UI Automation tree","linkify":"Use a unique and discoverable AutomationID to locate a specific element in the UI Automation tree","nodes":[{"content":"Use a unique and discoverable AutomationID to locate a specific element in the UI Automation tree","pos":[0,97]}]},{"content":"Use a tool such as <ph id=\"ph1\">[!INCLUDE[TLA#tla_uispy](../../../includes/tlasharptla-uispy-md.md)]</ph> to report the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationIdProperty&gt;</ph> of a <ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> element of interest.","pos":[2803,3067],"source":"Use a tool such as [!INCLUDE[TLA#tla_uispy](../../../includes/tlasharptla-uispy-md.md)] to report the <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> of a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element of interest."},{"content":"This value can then be copied and pasted into a client application such as a test script for subsequent automated testing.","pos":[3068,3190]},{"content":"This approach reduces and simplifies the code necessary to identify and locate an element at runtime.","pos":[3191,3292]},{"pos":[3300,3734],"content":"[!CAUTION]\n In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","leadings":["","> "],"nodes":[{"content":"In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","pos":[12,432],"nodes":[{"content":"In general, you should try to obtain only direct children of the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.RootElement%2A&gt;</ph>.","pos":[0,131],"source":"In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>."},{"content":"A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.","pos":[132,256]},{"content":"If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","pos":[257,420]}]}]},{"pos":[4058,4134],"content":"Use a persistent path to return to a previously identified AutomationElement","linkify":"Use a persistent path to return to a previously identified AutomationElement","nodes":[{"content":"Use a persistent path to return to a previously identified AutomationElement","pos":[0,76]}]},{"content":"Client applications, from simple test scripts to robust record and playback utilities, may require access to elements that are not currently instantiated, such as a file open dialog or a menu item and therefore do not exist in the UI Automation tree.","pos":[4144,4394]},{"content":"These elements can only be instantiated by reproducing, or \"playing back\", a specific sequence of UI actions through the use of UI Automation properties such as AutomationID, control patterns, and event listeners.","pos":[4395,4608]},{"pos":[4613,5295],"content":"[!code-csharp[UIAAutomationID_snip#UIAWorkerThread](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAAutomationID_snip/CSharp/FindByAutomationID.xaml.cs#uiaworkerthread)]\n[!code-vb[UIAAutomationID_snip#UIAWorkerThread](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAAutomationID_snip/VisualBasic/FindByAutomationID.xaml.vb#uiaworkerthread)]  \n[!code-csharp[UIAAutomationID_snip#Playback](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAAutomationID_snip/CSharp/FindByAutomationID.xaml.cs#playback)]\n[!code-vb[UIAAutomationID_snip#Playback](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAAutomationID_snip/VisualBasic/FindByAutomationID.xaml.vb#playback)]","leadings":[""," ","",""],"nodes":[]},{"pos":[5306,5380],"content":"Use a relative path to return to a previously identified AutomationElement","linkify":"Use a relative path to return to a previously identified AutomationElement","nodes":[{"content":"Use a relative path to return to a previously identified AutomationElement","pos":[0,74]}]},{"content":"In certain circumstances, since AutomationID is only guaranteed to be unique amongst siblings, multiple elements in the UI Automation tree may have identical AutomationID property values.","pos":[5390,5577]},{"content":"In these situations the elements can be uniquely identified based on a parent and, if necessary, a grandparent.","pos":[5578,5689]},{"content":"For example, a developer may provide a menu bar with multiple menu items each with multiple child menu items where the children are identified with sequential AutomationID's such as \"Item1\", \"Item2\", and so on.","pos":[5690,5900]},{"content":"Each menu item could then be uniquely identified by its AutomationID along with the AutomationID of its parent and, if necessary, its grandparent.","pos":[5901,6047]},{"pos":[6056,6064],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6142,6241],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[6244,6405],"content":"<bpt id=\"p1\">[</bpt>Find a UI Automation Element Based on a Property Condition<ept id=\"p1\">](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)</ept>","source":"[Find a UI Automation Element Based on a Property Condition](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)"}]}