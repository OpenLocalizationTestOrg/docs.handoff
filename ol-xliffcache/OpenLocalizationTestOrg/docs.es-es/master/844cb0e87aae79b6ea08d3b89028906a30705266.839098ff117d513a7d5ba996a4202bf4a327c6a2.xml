{"content":"---\ntitle: \"Walkthrough: Creating a Professionally Styled ToolStrip Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"ToolStripProfessionalRenderer class [Windows Forms]\"\n  - \"ToolStripRenderer class [Windows Forms]\"\n  - \"toolbars [Windows Forms], walkthroughs\"\n  - \"ToolStrip control [Windows Forms], creating professionally styled controls\"\nms.assetid: b52339ae-f1d3-494e-996e-eb455614098a\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Creating a Professionally Styled ToolStrip Control\nYou can give your application’s <xref:System.Windows.Forms.ToolStrip> controls a professional appearance and behavior by writing your own class derived from the <xref:System.Windows.Forms.ToolStripProfessionalRenderer> type.  \n  \n This walkthrough demonstrates how to use <xref:System.Windows.Forms.ToolStrip> controls to create a composite control that resembles the **Navigation Pane** provided by Microsoft® Outlook®. The following tasks are illustrated in this walkthrough:  \n  \n-   Creating a Windows Control Library project.  \n  \n-   Designing the StackView Control.  \n  \n-   Implementing a Custom Renderer.  \n  \n When you are finished, you will have a reusable custom client control with the professional appearance of a Microsoft Office® XP control.  \n  \n To copy the code in this topic as a single listing, see [How to: Create a Professionally Styled ToolStrip Control](../../../../docs/framework/winforms/controls/how-to-create-a-professionally-styled-toolstrip-control.md).  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  \n  \n## Prerequisites  \n In order to complete this walkthrough, you will need:  \n  \n-   Sufficient permissions to be able to create and run Windows Forms application projects on the computer where [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] is installed.  \n  \n## Creating a Windows Control Library Project  \n The first step is to create the control library project.  \n  \n#### To create the control library project  \n  \n1.  Create a new Windows Control Library project named `StackViewLibrary`.  \n  \n2.  In **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice.  \n  \n     For more information, see [NIB:How to: Remove, Delete, and Exclude Items](http://msdn.microsoft.com/en-us/6dffdc86-29c8-4eff-bcd8-e3a0dd9e9a73).  \n  \n3.  Add a new <xref:System.Windows.Forms.UserControl> item to the **StackViewLibrary** project. Give the new source file a base name of `StackView`.  \n  \n## Designing the StackView Control  \n The `StackView` control is a composite control with one child <xref:System.Windows.Forms.ToolStrip> control. For more information about composite controls, see [Varieties of Custom Controls](../../../../docs/framework/winforms/controls/varieties-of-custom-controls.md).  \n  \n#### To design the StackView control  \n  \n1.  From the **Toolbox**, drag a <xref:System.Windows.Forms.ToolStrip> control to the design surface.  \n  \n2.  In the **Properties** window, set the <xref:System.Windows.Forms.ToolStrip> control's properties according to the following table.  \n  \n    |Property|Value|  \n    |--------------|-----------|  \n    |Name|`stackStrip`|  \n    |CanOverflow|`false`|  \n    |Dock|<xref:System.Windows.Forms.DockStyle>|  \n    |Font|`Tahoma, 10pt, style=Bold`|  \n    |GripStyle|<xref:System.Windows.Forms.ToolStripGripStyle>|  \n    |LayoutStyle|<xref:System.Windows.Forms.ToolStripLayoutStyle>|  \n    |Padding|`0, 7, 0, 0`|  \n    |RenderMode|<xref:System.Windows.Forms.ToolStripRenderMode>|  \n  \n3.  In the Windows Forms Designer, click the <xref:System.Windows.Forms.ToolStrip> control's **Add** button and add a <xref:System.Windows.Forms.ToolStripButton> to the `stackStrip` control.  \n  \n4.  In the **Properties** window, set the <xref:System.Windows.Forms.ToolStripButton> control's properties according to the following table.  \n  \n    |Property|Value|  \n    |--------------|-----------|  \n    |Name|`mailStackButton`|  \n    |CheckOnClick|true|  \n    |CheckState|<xref:System.Windows.Forms.CheckState>|  \n    |DisplayStyle|<xref:System.Windows.Forms.ToolStripItemDisplayStyle>|  \n    |ImageAlign|<xref:System.Drawing.ContentAlignment>|  \n    |ImageScaling|<xref:System.Windows.Forms.ToolStripItemImageScaling>|  \n    |ImageTransparentColor|`238, 238, 238`|  \n    |Margin|`0, 0, 0, 0`|  \n    |Padding|`3, 3, 3, 3`|  \n    |Text|**Mail**|  \n    |TextAlign|<xref:System.Drawing.ContentAlignment>|  \n  \n5.  Repeat step 7 for three more <xref:System.Windows.Forms.ToolStripButton> controls.  \n  \n     Name the controls `calendarStackButton`, `contactsStackButton`, and `tasksStackButton`. Set the value of the <xref:System.Windows.Forms.Control.Text%2A> property to **Calendar**, **Contacts**, and **Tasks**, respectively.  \n  \n## Handling Events  \n Two events are important to make the `StackView` control behave correctly. Handle the <xref:System.Windows.Forms.UserControl.Load> event to position the control correctly. Handle the <xref:System.Windows.Forms.ToolStripItem.Click> event for each <xref:System.Windows.Forms.ToolStripButton> to give the `StackView` control state behavior similar to the <xref:System.Windows.Forms.RadioButton> control.  \n  \n#### To handle events  \n  \n1.  In the Windows Forms Designer, select the `StackView` control.  \n  \n2.  In the **Properties** window, click **Events**.  \n  \n3.  Double-click the Load event to generate the `StackView_Load` event handler.  \n  \n4.  In the `StackView_Load` event handler, copy and paste the following code.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#3)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#3)]  \n  \n5.  In the Windows Forms Designer, select the `mailStackButton` control.  \n  \n6.  In the **Properties** window, click **Events**.  \n  \n7.  Double-click the Click event.  \n  \n     The Windows Forms Designer generates the `mailStackButton_Click` event handler.  \n  \n8.  Rename the `mailStackButton_Click` event handler to `stackButton_Click`.  \n  \n     For more information, see [How to: Rename an Identifier (Visual Basic)](http://msdn.microsoft.com/en-us/e5a5edf8-3dba-4119-81f4-fc2aba180e0c).  \n  \n9. Insert the following code into the `stackButton_Click` event handler.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#4)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#4)]  \n  \n10. In the Windows Forms Designer, select the `calendarStackButton` control.  \n  \n11. In the **Properties** window, set the Click event to the `stackButton_Click` event handler.  \n  \n12. Repeat steps 10 and 11 for the `contactsStackButton` and `tasksStackButton` controls.  \n  \n## Defining Icons  \n Each `StackView` button has an associated icon. For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <xref:System.Drawing.Bitmap> is created from it. In a production environment, you store bitmap data as a resource, and your icons appear in the Windows Forms Designer. For more information, see [How to: Add Background Images to Windows Forms](http://msdn.microsoft.com/en-us/7a509ba2-055c-4ae6-b88a-54625c6d9aff).  \n  \n#### To define icons  \n  \n1.  In the Code Editor, insert the following code into the `StackView` class definition. This code initializes the bitmaps for the <xref:System.Windows.Forms.ToolStripButton> icons.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#2)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#2)]  \n  \n2.  Add a call to the `InitializeImages` method in the `StackView` class constructor.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]  \n  \n## Implementing a Custom Renderer  \n You can customize most elements of the `StackView` control my implementing a class that derives from the <xref:System.Windows.Forms.ToolStripRenderer> class. In this procedure, you will implement a <xref:System.Windows.Forms.ToolStripProfessionalRenderer> class that customizes the grip and draws gradient backgrounds for the <xref:System.Windows.Forms.ToolStripButton> controls.  \n  \n#### To implement a custom renderer  \n  \n1.  Insert the following code into the `StackView` control definition.  \n  \n     This is the definition for the `StackRenderer` class, which overrides the <xref:System.Windows.Forms.ToolStripRenderer.RenderGrip>, <xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder>, and <xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground> methods to produce a custom appearance.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#10)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#10)]  \n  \n2.  In the `StackView` control's constructor, create a new instance of the `StackRenderer` class and assign this instance to the `stackStrip` control's <xref:System.Windows.Forms.ToolStrip.Renderer%2A> property.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]  \n  \n## Testing the StackView Control  \n The `StackView` control derives from the <xref:System.Windows.Forms.UserControl> class. Therefore, you can test the control with the **UserControl Test Container**. For more information, see [How to: Test the Run-Time Behavior of a UserControl](../../../../docs/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol.md).  \n  \n#### To test the StackView control  \n  \n1.  Press F5 to build the project and start the **UserControl Test Container**.  \n  \n2.  Move the pointer over the buttons of the `StackView` control, and then click a button to see the appearance of its selected state.  \n  \n## Next Steps  \n In this walkthrough, you have created a reusable custom client control with the professional appearance of an Office XP control. You can use the <xref:System.Windows.Forms.ToolStrip> family of controls for many other purposes:  \n  \n-   Create shortcut menus for your controls with <xref:System.Windows.Forms.ContextMenuStrip>. For more information, see [ContextMenu Component Overview](../../../../docs/framework/winforms/controls/contextmenu-component-overview-windows-forms.md).  \n  \n-   Create a form with an automatically populated standard menu. For more information, see [Walkthrough: Providing Standard Menu Items to a Form](../../../../docs/framework/winforms/controls/walkthrough-providing-standard-menu-items-to-a-form.md).  \n  \n-   Create a multiple document interface (MDI) form with docking <xref:System.Windows.Forms.ToolStrip> controls. For more information, see [How to: Create an MDI Form with Menu Merging and ToolStrip Controls](../../../../docs/framework/winforms/controls/how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md).  \n  \n## See Also  \n <xref:System.Windows.Forms.MenuStrip>   \n <xref:System.Windows.Forms.ToolStrip>   \n <xref:System.Windows.Forms.StatusStrip>   \n [ToolStrip Control](../../../../docs/framework/winforms/controls/toolstrip-control-windows-forms.md)   \n [How to: Provide Standard Menu Items to a Form](../../../../docs/framework/winforms/controls/how-to-provide-standard-menu-items-to-a-form.md)","nodes":[{"pos":[4,674],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating a Professionally Styled ToolStrip Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"ToolStripProfessionalRenderer class [Windows Forms]\"\n  - \"ToolStripRenderer class [Windows Forms]\"\n  - \"toolbars [Windows Forms], walkthroughs\"\n  - \"ToolStrip control [Windows Forms], creating professionally styled controls\"\nms.assetid: b52339ae-f1d3-494e-996e-eb455614098a\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control | Microsoft Docs","nodes":[{"pos":[0,80],"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control | Microsoft Docs","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control | Microsoft Docs","pos":[0,80]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[681,744],"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","linkify":"Walkthrough: Creating a Professionally Styled ToolStrip Control","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","pos":[0,63]}]},{"pos":[745,969],"content":"You can give your application’s <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls a professional appearance and behavior by writing your own class derived from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripProfessionalRenderer&gt;</ph> type.","source":"You can give your application’s <xref:System.Windows.Forms.ToolStrip> controls a professional appearance and behavior by writing your own class derived from the <xref:System.Windows.Forms.ToolStripProfessionalRenderer> type."},{"content":"This walkthrough demonstrates how to use <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls to create a composite control that resembles the <bpt id=\"p1\">**</bpt>Navigation Pane<ept id=\"p1\">**</ept> provided by Microsoft® Outlook®.","pos":[976,1165],"source":"This walkthrough demonstrates how to use <xref:System.Windows.Forms.ToolStrip> controls to create a composite control that resembles the **Navigation Pane** provided by Microsoft® Outlook®."},{"content":"The following tasks are illustrated in this walkthrough:","pos":[1166,1222]},{"content":"Creating a Windows Control Library project.","pos":[1232,1275]},{"content":"Designing the StackView Control.","pos":[1285,1317]},{"content":"Implementing a Custom Renderer.","pos":[1327,1358]},{"content":"When you are finished, you will have a reusable custom client control with the professional appearance of a Microsoft Office® XP control.","pos":[1365,1502]},{"pos":[1509,1729],"content":"To copy the code in this topic as a single listing, see <bpt id=\"p1\">[</bpt>How to: Create a Professionally Styled ToolStrip Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-create-a-professionally-styled-toolstrip-control.md)</ept>.","source":"To copy the code in this topic as a single listing, see [How to: Create a Professionally Styled ToolStrip Control](../../../../docs/framework/winforms/controls/how-to-create-a-professionally-styled-toolstrip-control.md)."},{"pos":[1737,2113],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","pos":[9,374],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Customizing Development Settings in Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)</ept>.","pos":[217,365],"source":" For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)."}]}]},{"pos":[2122,2135],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"In order to complete this walkthrough, you will need:","pos":[2139,2192]},{"pos":[2202,2378],"content":"Sufficient permissions to be able to create and run Windows Forms application projects on the computer where <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> is installed.","source":"Sufficient permissions to be able to create and run Windows Forms application projects on the computer where [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] is installed."},{"pos":[2387,2429],"content":"Creating a Windows Control Library Project","linkify":"Creating a Windows Control Library Project","nodes":[{"content":"Creating a Windows Control Library Project","pos":[0,42]}]},{"content":"The first step is to create the control library project.","pos":[2433,2489]},{"pos":[2500,2537],"content":"To create the control library project","linkify":"To create the control library project","nodes":[{"content":"To create the control library project","pos":[0,37]}]},{"pos":[2547,2617],"content":"Create a new Windows Control Library project named <ph id=\"ph1\">`StackViewLibrary`</ph>.","source":"Create a new Windows Control Library project named `StackViewLibrary`."},{"pos":[2627,2801],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice.","source":"In **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice."},{"pos":[2812,2956],"content":"For more information, see <bpt id=\"p1\">[</bpt>NIB:How to: Remove, Delete, and Exclude Items<ept id=\"p1\">](http://msdn.microsoft.com/en-us/6dffdc86-29c8-4eff-bcd8-e3a0dd9e9a73)</ept>.","source":"For more information, see [NIB:How to: Remove, Delete, and Exclude Items](http://msdn.microsoft.com/en-us/6dffdc86-29c8-4eff-bcd8-e3a0dd9e9a73)."},{"content":"Add a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> item to the <bpt id=\"p1\">**</bpt>StackViewLibrary<ept id=\"p1\">**</ept> project.","pos":[2966,3057],"source":"Add a new <xref:System.Windows.Forms.UserControl> item to the **StackViewLibrary** project."},{"content":"Give the new source file a base name of <ph id=\"ph1\">`StackView`</ph>.","pos":[3058,3110],"source":" Give the new source file a base name of `StackView`."},{"pos":[3119,3150],"content":"Designing the StackView Control","linkify":"Designing the StackView Control","nodes":[{"content":"Designing the StackView Control","pos":[0,31]}]},{"content":"The <ph id=\"ph1\">`StackView`</ph> control is a composite control with one child <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control.","pos":[3154,3262],"source":"The `StackView` control is a composite control with one child <xref:System.Windows.Forms.ToolStrip> control."},{"content":"For more information about composite controls, see <bpt id=\"p1\">[</bpt>Varieties of Custom Controls<ept id=\"p1\">](../../../../docs/framework/winforms/controls/varieties-of-custom-controls.md)</ept>.","pos":[3263,3423],"source":" For more information about composite controls, see [Varieties of Custom Controls](../../../../docs/framework/winforms/controls/varieties-of-custom-controls.md)."},{"pos":[3434,3465],"content":"To design the StackView control","linkify":"To design the StackView control","nodes":[{"content":"To design the StackView control","pos":[0,31]}]},{"pos":[3475,3572],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control to the design surface.","source":"From the **Toolbox**, drag a <xref:System.Windows.Forms.ToolStrip> control to the design surface."},{"pos":[3582,3712],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control's properties according to the following table.","source":"In the **Properties** window, set the <xref:System.Windows.Forms.ToolStrip> control's properties according to the following table."},{"content":"Property","pos":[3723,3731]},{"content":"Value","pos":[3732,3737]},{"content":"Name","pos":[3781,3785]},{"content":"CanOverflow","pos":[3807,3818]},{"content":"Dock","pos":[3835,3839]},{"content":"Font","pos":[3886,3890]},{"content":"GripStyle","pos":[3926,3935]},{"content":"LayoutStyle","pos":[3991,4002]},{"content":"Padding","pos":[4060,4067]},{"content":"RenderMode","pos":[4089,4099]},{"pos":[4158,4344],"content":"In the Windows Forms Designer, click the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control's <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button and add a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> to the <ph id=\"ph3\">`stackStrip`</ph> control.","source":"In the Windows Forms Designer, click the <xref:System.Windows.Forms.ToolStrip> control's **Add** button and add a <xref:System.Windows.Forms.ToolStripButton> to the `stackStrip` control."},{"pos":[4354,4490],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> control's properties according to the following table.","source":"In the **Properties** window, set the <xref:System.Windows.Forms.ToolStripButton> control's properties according to the following table."},{"content":"Property","pos":[4501,4509]},{"content":"Value","pos":[4510,4515]},{"content":"Name","pos":[4559,4563]},{"content":"CheckOnClick","pos":[4590,4602]},{"content":"true","pos":[4603,4607]},{"content":"CheckState","pos":[4616,4626]},{"content":"DisplayStyle","pos":[4674,4686]},{"content":"ImageAlign","pos":[4749,4759]},{"content":"ImageScaling","pos":[4807,4819]},{"content":"ImageTransparentColor","pos":[4882,4903]},{"content":"Margin","pos":[4928,4934]},{"content":"Padding","pos":[4956,4963]},{"content":"Text","pos":[4985,4989]},{"pos":[4990,4998],"content":"<bpt id=\"p1\">**</bpt>Mail<ept id=\"p1\">**</ept>","source":"**Mail**"},{"content":"TextAlign","pos":[5007,5016]},{"pos":[5066,5148],"content":"Repeat step 7 for three more <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> controls.","source":"Repeat step 7 for three more <xref:System.Windows.Forms.ToolStripButton> controls."},{"content":"Name the controls <ph id=\"ph1\">`calendarStackButton`</ph>, <ph id=\"ph2\">`contactsStackButton`</ph>, and <ph id=\"ph3\">`tasksStackButton`</ph>.","pos":[5159,5246],"source":"Name the controls `calendarStackButton`, `contactsStackButton`, and `tasksStackButton`."},{"content":"Set the value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <bpt id=\"p1\">**</bpt>Calendar<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Contacts<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Tasks<ept id=\"p3\">**</ept>, respectively.","pos":[5247,5380],"source":" Set the value of the <xref:System.Windows.Forms.Control.Text%2A> property to **Calendar**, **Contacts**, and **Tasks**, respectively."},{"pos":[5389,5404],"content":"Handling Events","linkify":"Handling Events","nodes":[{"content":"Handling Events","pos":[0,15]}]},{"content":"Two events are important to make the <ph id=\"ph1\">`StackView`</ph> control behave correctly.","pos":[5408,5482],"source":"Two events are important to make the `StackView` control behave correctly."},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl.Load&gt;</ph> event to position the control correctly.","pos":[5483,5579],"source":" Handle the <xref:System.Windows.Forms.UserControl.Load> event to position the control correctly."},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripItem.Click&gt;</ph> event for each <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> to give the <ph id=\"ph3\">`StackView`</ph> control state behavior similar to the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.RadioButton&gt;</ph> control.","pos":[5580,5808],"source":" Handle the <xref:System.Windows.Forms.ToolStripItem.Click> event for each <xref:System.Windows.Forms.ToolStripButton> to give the `StackView` control state behavior similar to the <xref:System.Windows.Forms.RadioButton> control."},{"pos":[5819,5835],"content":"To handle events","linkify":"To handle events","nodes":[{"content":"To handle events","pos":[0,16]}]},{"pos":[5845,5907],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`StackView`</ph> control.","source":"In the Windows Forms Designer, select the `StackView` control."},{"pos":[5917,5964],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, click **Events**."},{"pos":[5974,6049],"content":"Double-click the Load event to generate the <ph id=\"ph1\">`StackView_Load`</ph> event handler.","source":"Double-click the Load event to generate the `StackView_Load` event handler."},{"pos":[6059,6132],"content":"In the <ph id=\"ph1\">`StackView_Load`</ph> event handler, copy and paste the following code.","source":"In the `StackView_Load` event handler, copy and paste the following code."},{"pos":[6143,6500],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#3)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[6510,6578],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`mailStackButton`</ph> control.","source":"In the Windows Forms Designer, select the `mailStackButton` control."},{"pos":[6588,6635],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, click **Events**."},{"content":"Double-click the Click event.","pos":[6645,6674]},{"pos":[6685,6764],"content":"The Windows Forms Designer generates the <ph id=\"ph1\">`mailStackButton_Click`</ph> event handler.","source":"The Windows Forms Designer generates the `mailStackButton_Click` event handler."},{"pos":[6774,6846],"content":"Rename the <ph id=\"ph1\">`mailStackButton_Click`</ph> event handler to <ph id=\"ph2\">`stackButton_Click`</ph>.","source":"Rename the `mailStackButton_Click` event handler to `stackButton_Click`."},{"pos":[6857,6999],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Rename an Identifier (Visual Basic)<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e5a5edf8-3dba-4119-81f4-fc2aba180e0c)</ept>.","source":"For more information, see [How to: Rename an Identifier (Visual Basic)](http://msdn.microsoft.com/en-us/e5a5edf8-3dba-4119-81f4-fc2aba180e0c)."},{"pos":[7008,7077],"content":"Insert the following code into the <ph id=\"ph1\">`stackButton_Click`</ph> event handler.","source":"Insert the following code into the `stackButton_Click` event handler."},{"pos":[7088,7445],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#4)]\n  [!code-vb[System.Windows.Forms.ToolStrip.StackView#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#4)]","leadings":["","   "],"nodes":[]},{"pos":[7455,7527],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`calendarStackButton`</ph> control.","source":"In the Windows Forms Designer, select the `calendarStackButton` control."},{"pos":[7537,7628],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the Click event to the <ph id=\"ph1\">`stackButton_Click`</ph> event handler.","source":"In the **Properties** window, set the Click event to the `stackButton_Click` event handler."},{"pos":[7638,7723],"content":"Repeat steps 10 and 11 for the <ph id=\"ph1\">`contactsStackButton`</ph> and <ph id=\"ph2\">`tasksStackButton`</ph> controls.","source":"Repeat steps 10 and 11 for the `contactsStackButton` and `tasksStackButton` controls."},{"pos":[7732,7746],"content":"Defining Icons","linkify":"Defining Icons","nodes":[{"content":"Defining Icons","pos":[0,14]}]},{"content":"Each <ph id=\"ph1\">`StackView`</ph> button has an associated icon.","pos":[7750,7797],"source":"Each `StackView` button has an associated icon."},{"content":"For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <ph id=\"ph1\">&lt;xref:System.Drawing.Bitmap&gt;</ph> is created from it.","pos":[7798,7947],"source":" For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <xref:System.Drawing.Bitmap> is created from it."},{"content":"In a production environment, you store bitmap data as a resource, and your icons appear in the Windows Forms Designer.","pos":[7948,8066]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Background Images to Windows Forms<ept id=\"p1\">](http://msdn.microsoft.com/en-us/7a509ba2-055c-4ae6-b88a-54625c6d9aff)</ept>.","pos":[8067,8212],"source":" For more information, see [How to: Add Background Images to Windows Forms](http://msdn.microsoft.com/en-us/7a509ba2-055c-4ae6-b88a-54625c6d9aff)."},{"pos":[8223,8238],"content":"To define icons","linkify":"To define icons","nodes":[{"content":"To define icons","pos":[0,15]}]},{"content":"In the Code Editor, insert the following code into the <ph id=\"ph1\">`StackView`</ph> class definition.","pos":[8248,8332],"source":"In the Code Editor, insert the following code into the `StackView` class definition."},{"content":"This code initializes the bitmaps for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> icons.","pos":[8333,8425],"source":" This code initializes the bitmaps for the <xref:System.Windows.Forms.ToolStripButton> icons."},{"pos":[8436,8793],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#2)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[8803,8884],"content":"Add a call to the <ph id=\"ph1\">`InitializeImages`</ph> method in the <ph id=\"ph2\">`StackView`</ph> class constructor.","source":"Add a call to the `InitializeImages` method in the `StackView` class constructor."},{"pos":[8895,9252],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[9261,9291],"content":"Implementing a Custom Renderer","linkify":"Implementing a Custom Renderer","nodes":[{"content":"Implementing a Custom Renderer","pos":[0,30]}]},{"content":"You can customize most elements of the <ph id=\"ph1\">`StackView`</ph> control my implementing a class that derives from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripRenderer&gt;</ph> class.","pos":[9295,9452],"source":"You can customize most elements of the `StackView` control my implementing a class that derives from the <xref:System.Windows.Forms.ToolStripRenderer> class."},{"content":"In this procedure, you will implement a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripProfessionalRenderer&gt;</ph> class that customizes the grip and draws gradient backgrounds for the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> controls.","pos":[9453,9674],"source":" In this procedure, you will implement a <xref:System.Windows.Forms.ToolStripProfessionalRenderer> class that customizes the grip and draws gradient backgrounds for the <xref:System.Windows.Forms.ToolStripButton> controls."},{"pos":[9685,9715],"content":"To implement a custom renderer","linkify":"To implement a custom renderer","nodes":[{"content":"To implement a custom renderer","pos":[0,30]}]},{"pos":[9725,9791],"content":"Insert the following code into the <ph id=\"ph1\">`StackView`</ph> control definition.","source":"Insert the following code into the `StackView` control definition."},{"pos":[9802,10115],"content":"This is the definition for the <ph id=\"ph1\">`StackRenderer`</ph> class, which overrides the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderGrip&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground&gt;</ph> methods to produce a custom appearance.","source":"This is the definition for the `StackRenderer` class, which overrides the <xref:System.Windows.Forms.ToolStripRenderer.RenderGrip>, <xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder>, and <xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground> methods to produce a custom appearance."},{"pos":[10126,10487],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#10)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#10)]","leadings":["","    "],"nodes":[]},{"pos":[10497,10704],"content":"In the <ph id=\"ph1\">`StackView`</ph> control's constructor, create a new instance of the <ph id=\"ph2\">`StackRenderer`</ph> class and assign this instance to the <ph id=\"ph3\">`stackStrip`</ph> control's <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStrip.Renderer%2A&gt;</ph> property.","source":"In the `StackView` control's constructor, create a new instance of the `StackRenderer` class and assign this instance to the `stackStrip` control's <xref:System.Windows.Forms.ToolStrip.Renderer%2A> property."},{"pos":[10715,11072],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[11081,11110],"content":"Testing the StackView Control","linkify":"Testing the StackView Control","nodes":[{"content":"Testing the StackView Control","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">`StackView`</ph> control derives from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> class.","pos":[11114,11201],"source":"The `StackView` control derives from the <xref:System.Windows.Forms.UserControl> class."},{"content":"Therefore, you can test the control with the <bpt id=\"p1\">**</bpt>UserControl Test Container<ept id=\"p1\">**</ept>.","pos":[11202,11278],"source":" Therefore, you can test the control with the **UserControl Test Container**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Test the Run-Time Behavior of a UserControl<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol.md)</ept>.","pos":[11279,11459],"source":" For more information, see [How to: Test the Run-Time Behavior of a UserControl](../../../../docs/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol.md)."},{"pos":[11470,11499],"content":"To test the StackView control","linkify":"To test the StackView control","nodes":[{"content":"To test the StackView control","pos":[0,29]}]},{"pos":[11509,11584],"content":"Press F5 to build the project and start the <bpt id=\"p1\">**</bpt>UserControl Test Container<ept id=\"p1\">**</ept>.","source":"Press F5 to build the project and start the **UserControl Test Container**."},{"pos":[11594,11724],"content":"Move the pointer over the buttons of the <ph id=\"ph1\">`StackView`</ph> control, and then click a button to see the appearance of its selected state.","source":"Move the pointer over the buttons of the `StackView` control, and then click a button to see the appearance of its selected state."},{"pos":[11733,11743],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"In this walkthrough, you have created a reusable custom client control with the professional appearance of an Office XP control.","pos":[11747,11875]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> family of controls for many other purposes:","pos":[11876,11973],"source":" You can use the <xref:System.Windows.Forms.ToolStrip> family of controls for many other purposes:"},{"content":"Create shortcut menus for your controls with <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ContextMenuStrip&gt;</ph>.","pos":[11983,12073],"source":"Create shortcut menus for your controls with <xref:System.Windows.Forms.ContextMenuStrip>."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ContextMenu Component Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/contextmenu-component-overview-windows-forms.md)</ept>.","pos":[12074,12227],"source":" For more information, see [ContextMenu Component Overview](../../../../docs/framework/winforms/controls/contextmenu-component-overview-windows-forms.md)."},{"content":"Create a form with an automatically populated standard menu.","pos":[12237,12297]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Providing Standard Menu Items to a Form<ept id=\"p1\">](../../../../docs/framework/winforms/controls/walkthrough-providing-standard-menu-items-to-a-form.md)</ept>.","pos":[12298,12480],"source":" For more information, see [Walkthrough: Providing Standard Menu Items to a Form](../../../../docs/framework/winforms/controls/walkthrough-providing-standard-menu-items-to-a-form.md)."},{"content":"Create a multiple document interface (MDI) form with docking <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls.","pos":[12490,12598],"source":"Create a multiple document interface (MDI) form with docking <xref:System.Windows.Forms.ToolStrip> controls."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create an MDI Form with Menu Merging and ToolStrip Controls<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md)</ept>.","pos":[12599,12811],"source":" For more information, see [How to: Create an MDI Form with Menu Merging and ToolStrip Controls](../../../../docs/framework/winforms/controls/how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md)."},{"pos":[12820,12828],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/toolstrip-control-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[12960,13061],"source":"[ToolStrip Control](../../../../docs/framework/winforms/controls/toolstrip-control-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Provide Standard Menu Items to a Form<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-provide-standard-menu-items-to-a-form.md)</ept>","pos":[13065,13206],"source":"[How to: Provide Standard Menu Items to a Form](../../../../docs/framework/winforms/controls/how-to-provide-standard-menu-items-to-a-form.md)"}]}