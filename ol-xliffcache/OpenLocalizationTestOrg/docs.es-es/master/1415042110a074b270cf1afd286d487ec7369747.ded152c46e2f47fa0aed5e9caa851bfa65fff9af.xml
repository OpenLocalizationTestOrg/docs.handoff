{"content":"---\ntitle: \"WPF Security Strategy - Platform Security\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"platform security model [WPF]\"\n  - \"Common Language Runtime (CLR) security features\"\n  - \"operating system security model [WPF]\"\n  - \"Internet Explorer security features [WPF]\"\n  - \"Security-Critical method\"\n  - \"CLR security features [WPF]\"\n  - \"security model [WPF]\"\n  - \"security model [WPF], platform\"\n  - \"WPF [WPF], about security model\"\n  - \"Windows Presentation Foundation [WPF], about security model\"\n  - \"security model [WPF], operating system\"\nms.assetid: 2a39a054-3e2a-4659-bcb7-8bcea490ba31\n---\n# WPF Security Strategy - Platform Security\nWhile Windows Presentation Foundation (WPF) provides a variety of security services, it also leverages the security features of the underlying platform, which includes the operating system, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)], and [!INCLUDE[TLA2#tla_ie](../../../includes/tla2sharptla-ie-md.md)]. These layers combine to provide [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] a strong, defense-in-depth security model that attempts to avoid any single point of failure, as shown in the following figure:  \n  \n ![WPF security illustration](./media/windowplatformsecurity.PNG \"windowplatformsecurity\")  \n  \n The remainder of this topic discusses the features in each of these layers that pertain to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] specifically.  \n\n<a name=\"Operating_System_Security\"></a>   \n## Operating System Security  \n The minimum level of operating system that is required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]. The core of [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] provides several security features that form the security foundation for all Windows applications, including those built with [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]. [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] incorporates the security features of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] and extends them further. This topic discusses the breadth of these security features that are important to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)], as well as how [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] integrates with them to provide further defense-in-depth.  \n  \n<a name=\"Microsoft_Windows_XP_Service_Pack_2__SP2_\"></a>   \n### Microsoft Windows XP Service Pack 2 (SP2)  \n In addition to a general review and strengthening of Windows, there are three key features from [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] that we will discuss in this topic:  \n  \n-   /GS compilation  \n  \n-   [!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)].  \n  \n#### /GS Compilation  \n [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] provides protection by recompiling many core system libraries, including all of the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] dependencies such as the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)], to help mitigate buffer overruns. This is achieved by using the /GS parameter with the C/C++ command-line compiler. Although buffer overruns should be explicitly avoided, /GS compilation provides an example of a defense-in-depth against potential vulnerabilities that are inadvertently or maliciously created by them.  \n  \n Historically, buffer overruns have been the cause of many high-impact security exploits. A buffer overrun occurs when an attacker takes advantage of a code vulnerability that allows the injection of malicious code that writes past the boundaries of a buffer. This then allows an attacker to hijack the process in which the code is executing by overwriting the return address of a function to cause the execution of the attacker's code. The result is malicious code that executes arbitrary code with the same privileges as the hijacked process.  \n  \n At a high level, the /GS compiler flag protects against some potential buffer overruns by injecting a special security cookie to protect the return address of a function that has local string buffers. After a function returns, the security cookie is compared with its previous value. If the value has changed, a buffer overrun may have occurred and the process is stopped with an error condition. Stopping the process prevents the execution of potentially malicious code. See [/GS (Buffer Security Check)](/cpp/build/reference/gs-buffer-security-check) for more details.  \n  \n [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is compiled with the /GS flag to add yet another layer of defense to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications.  \n  \n#### Microsoft Windows Update Enhancements  \n [!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)] was also improved in [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] to simplify the process for downloading and installing updates. These changes significantly enhance security for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] customers by helping to ensure that their systems are up-to-date, particularly with respect to security updates.  \n  \n<a name=\"Windows_Vista\"></a>   \n### Windows Vista  \n [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] users on [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] will benefit from the operating system's additional security enhancements, including \"Least-Privilege User Access\", code integrity checks, and privilege isolation.  \n  \n#### User Account Control (UAC)  \n Today, Windows users tend to run with administrator privileges because many applications require them for either installation or execution, or both. Being able to write default application settings to the Registry is one example.  \n  \n Running with administrator privileges really means that applications execute from processes that are granted administrator privileges. The security impact of this is that any malicious code that hijacks a process running with administrator privileges will automatically inherit those privileges, including access to critical system resources.  \n  \n One way to protect against this security threat is to run applications with the least amount of privileges that are required. This is known as the principle of least privilege, and is a core feature of the [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] operating system. This feature is called User Account Control (UAC), and is used by [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] UAC in two key ways:  \n  \n-   To run most applications with UAC privileges by default, even if the user is an administrator; only applications that need administrator privileges will run with administrator privileges. To run with administrative privileges, applications must be explicitly marked in either their application manifest or as an entry in security policy.  \n  \n-   To provide compatibility solutions like virtualization. For example, many applications try to write to restricted locations like C:\\Program Files. For applications executing under UAC, an alternative per-user location exists that does not require administrator privileges to write to. For applications running under UAC, UAC virtualizes C:\\Program Files so that applications who think they are writing to it are actually writing to the alternative, per-user location. This kind of compatibility work enables the operating system to run many applications that couldn't previously run in UAC.  \n  \n#### Code Integrity Checks  \n [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] incorporates deeper code integrity checks to help prevent malicious code from being injected into system files or into the kernel at load/run time. This goes beyond system file protection.  \n  \n<a name=\"Limited_Rights_Process_for_Browser_Hosted_Applications\"></a>   \n### Limited Rights Process for Browser-Hosted Applications  \n Browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications execute within the Internet zone sandbox. [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] integration with [!INCLUDE[TLA#tla_ie](../../../includes/tlasharptla-ie-md.md)] extends this protection with additional support.  \n  \n#### Internet Explorer 6 Service Pack 2 and Internet Explorer 7 for XP  \n [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] leverages operating system security by limiting process privileges for [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] for further protection. Before a browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] application is launched, the operating system creates a host process that removes unnecessary privileges from the process token. Some examples of privileges that are removed include the ability to shut down the user's machine, load drivers, and read access to all files on the machine.  \n  \n#### Internet Explorer 7 for Vista  \n In [!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications run in protected mode. Specifically, [!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] run with medium-level integrity.  \n  \n#### Defense-In-Depth Layer  \n Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] are generally sandboxed by the Internet zone permission set, removing these privileges does not harm [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] from a compatibility perspective. Instead, an additional defense-in-depth layer is created; if a sandboxed application is able to exploit other layers and hijack the process, the process will still only have limited privileges.  \n  \n See [Using a Least-Privileged User Account](https://docs.microsoft.com/previous-versions/tn-archive/cc700846%28v=technet.10%29).  \n  \n<a name=\"Common_Language_Runtime_Security\"></a>   \n## Common Language Runtime Security  \n The [!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)] offers a number of key security benefits that include validation and verification, [!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)], and the Security Critical Methodology.  \n  \n<a name=\"Validation_and_Verification\"></a>   \n### Validation and Verification  \n To provide assembly isolation and integrity, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] uses a process of validation. [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] validation ensures that assemblies are isolated by validating their Portable Executable (PE) file format for addresses that point outside the assembly. [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] validation also validates the integrity of the metadata that is embedded within an assembly.  \n  \n To ensure type safety, help prevent common security issues (e.g. buffer overruns), and enable sandboxing through sub-process isolation, [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] security uses the concept of verification.  \n  \n Managed applications are compiled into Microsoft Intermediate Language (MSIL). When methods in a managed application are executed, its MSIL is compiled into native code through Just-In-Time (JIT) compilation. JIT compilation includes a verification process that applies many safety and robustness rules that ensure code does not:  \n  \n-   Violate type contracts  \n  \n-   Introduce buffer overruns  \n  \n-   Wildly access memory.  \n  \n Managed code that does not conform to verification rules is not allowed to execute, unless it is considered trusted code.  \n  \n The advantage of verifiable code is a key reason why [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] builds on the .NET Framework. To the extent that verifiable code is used, the possibility of exploiting possible vulnerabilities is greatly lowered.  \n  \n<a name=\"Code_Access_Security\"></a>   \n### Code Access Security  \n A client machine exposes a wide variety of resources that a managed application can have access to, including the file system, the Registry, printing services, the user interface, reflection, and environment variables. Before a managed application can access any of the resources on a client machine, it must have .NET Framework permission to do so. A permission in [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] is a subclass of the <xref:System.Security.CodeAccessPermission>; [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] implements one subclass for each resource that managed applications can access.  \n  \n The set of permissions that a managed application is granted by [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] when it starts executing is known as a permission set and is determined by evidence provided by the application. For [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications, the evidence that is provided is the location, or zone, from which the applications are launched. [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] identifies the following zones:  \n  \n-   **My Computer**. Applications launched from the client machine (Fully Trusted).  \n  \n-   **Local Intranet**. Applications launched from the intranet. (Somewhat Trusted).  \n  \n-   **Internet**. Applications launched from the Internet. (Least Trusted).  \n  \n-   **Trusted Sites**. Applications identified by a user as being trusted. (Least Trusted).  \n  \n-   **Untrusted Sites**. Applications identified by a user as being untrusted. (Untrusted).  \n  \n For each of these zones, [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] provides a predefined permission set that includes the permissions which matches the level of trust associated with each. These include:  \n  \n-   **FullTrust**. For applications launched from the **My Computer** zone. All possible permissions are granted.  \n  \n-   **LocalIntranet**. For applications launched from the **Local Intranet** zone. A subset of permissions are granted to provide moderate access to a client machine’s resources, including isolated storage, unrestricted UI access, unrestricted file dialogs, limited reflection, limited access to environment variables. Permissions for critical resources like the Registry are not provided.  \n  \n-   **Internet**. For applications launched from the **Internet** or **Trusted Sites** zone. A subset of permissions are granted to provided limited access to a client machine’s resources, including isolated storage, file open only, and limited UI. Essentially, this permission sets isolates applications from the client machine.  \n  \n Applications identified as being from the **Untrusted Sites** zone are granted no permissions by [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] at all. Consequently, a predefined permission set does not exist for them.  \n  \n The following figure illustrates the relationship between zones, permission sets, permissions, and resources.  \n  \n ![CAS permission sets](./media/caspermissionsets.png \"CASPermissionSets\")  \n  \n The restrictions of the Internet zone security sandbox apply equally to any code that a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] imports from a system library, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]. This ensures that every bit of the code is locked down, even [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]. Unfortunately, to be able to execute, a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] needs to execute functionality that requires more permissions than those enabled by the Internet zone security sandbox.  \n  \n Consider a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] application that includes the following page:  \n  \n [!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]\n [!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]  \n  \n To execute this [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], the underlying [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code must execute more functionality than is available to the calling [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], including:  \n  \n-   Creating a window handle (hWnd) for rendering  \n  \n-   Dispatching messages  \n  \n-   Loading the Tahoma font  \n  \n From a security point of view, allowing direct access to any of these operations from the sandboxed application would be catastrophic.  \n  \n Fortunately, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] caters to this situation by allowing these operations to execute with elevated privileges on behalf of the sandboxed application. While all [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] operations are checked against the limited Internet zone security permissions of the application domain of the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] (as with other system libraries) is granted a permission set that includes all possible permissions  \n  \n This requires that [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] receives elevated privileges while preventing those privileges from being governed by the Internet zone permission set of the host application domain.  \n  \n [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] does this by using the **Assert** method of a permission. The following code shows how this happens.  \n  \n [!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]\n [!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]  \n  \n The **Assert** essentially prevents the unlimited permissions required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] from being restricted by the Internet zone permissions of the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)].  \n  \n From a platform perspective, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is responsible for using **Assert** correctly; an incorrect use of **Assert** could enable malicious code to elevate privileges. Consequently, it is important then to only call **Assert** when needed, and to ensure that sandbox restrictions remain intact. For example, sandboxed code is not allowed to open random files, but it is allowed to use fonts. [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] enables sandboxed applications to use font functionality by calling **Assert**, and for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] to read files known to contain those fonts on behalf of the sandboxed application.  \n  \n<a name=\"ClickOnce_Deployment\"></a>   \n### ClickOnce Deployment  \n [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] is a comprehensive deployment technology that is included with .NET Framework, and integrates with [!INCLUDE[TLA#tla_visualstu](../../../includes/tlasharptla-visualstu-md.md)] (see [ClickOnce security and deployment](/visualstudio/deployment/clickonce-security-and-deployment) for detailed information). Standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications can be deployed using [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)], while browser-hosted applications must be deployed with [!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)].  \n  \n Applications deployed using [!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)] are given an additional security layer over [!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)]; essentially, [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] deployed applications request the permissions that they need. They are granted only those permissions if they do not exceed the set of permissions for the zone from which the application is deployed. By reducing the set of permissions to only those that are needed, even if they are less than those provided by the launch zone's permission set, the number of resources that the application has access to is reduce to a bare minimum. Consequently, if the application is hijacked, the potential for damage to the client machine is reduced.  \n  \n<a name=\"Security_Critical_Methodology\"></a>   \n### Security-Critical Methodology  \n The [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that uses permissions to enable the Internet zone sandbox for [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] applications must be held to highest possible degree of security audit and control. To facilitate this requirement, .NET Framework provides new support for managing code that elevates privilege. Specifically, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] enables you to identify code that elevates privilege and mark it with the <xref:System.Security.SecurityCriticalAttribute>; any code not marked with <xref:System.Security.SecurityCriticalAttribute> becomes *transparent* using this methodology. Conversely, managed code that is not marked with <xref:System.Security.SecurityCriticalAttribute> is prevented from elevating privilege.  \n  \n The Security-Critical Methodology allows the organization of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that elevates privilege into *security-critical kernel*, with the remainder being transparent. Isolating the security-critical code enables the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] engineering team focus an additional security analysis and source control on the security-critical kernel above and beyond standard security practices (see [WPF Security Strategy - Security Engineering](wpf-security-strategy-security-engineering.md)).  \n  \n Note that .NET Framework permits trusted code to extend the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] Internet zone sandbox by allowing developers to write managed assemblies that are marked with <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) and deployed to the user's Global Assembly Cache (GAC). Marking an assembly with APTCA is a highly sensitive security operation as it allows any code to call that assembly, including malicious code from the Internet. Extreme caution and best practices must be used when doing this and users must choose to trust that software in order for it to be installed.  \n  \n<a name=\"Microsoft_Internet_Explorer_Security\"></a>   \n## Microsoft Internet Explorer Security  \n Beyond reducing security issues and simplifying security configuration, [!INCLUDE[TLA#tla_ie6sp2](../../../includes/tlasharptla-ie6sp2-md.md)] contains several features that security improvements that enhance security for users of [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]. The thrust of these features attempts to allow users greater control over their browsing experience.  \n  \n Prior to [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)], users could be subject to any of the following:  \n  \n-   Random popup windows.  \n  \n-   Confusing script redirection.  \n  \n-   Numerous security dialogs on some Web sites.  \n  \n In some cases, untrustworthy Web sites would try to trick users by spoofing installation [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] or repeatedly showing a [!INCLUDE[TLA#tla_actx](../../../includes/tlasharptla-actx-md.md)] installation dialog box, even though the user may have canceled it. Using these techniques, it is possible that a significant number of users have been tricked into making poor decisions that resulted with the installation of spyware applications.  \n  \n [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] includes several features to mitigate these types of issues, which revolve around the concept of user initiation. [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] detects when a user has clicked on a link or page element prior to an action, which is known as *user initiation*, and treats it differently than when a similar action is instead triggered by the script on a page. As an example, [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] incorporates a **Pop-Up Blocker** that detects when a user clicks a button prior to the page creating a pop-up. This enables [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to allow most innocuous pop-ups while preventing pop-ups that users neither ask for nor want. Blocked pop-ups are trapped under the new **Information Bar**, which allows the user to manually override the block and view the pop-up.  \n  \n The same user-initiation logic is also applied to **Open**/**Save** security prompts. [!INCLUDE[TLA2#tla_actx](../../../includes/tla2sharptla-actx-md.md)] installation dialog boxes are always trapped under the Information Bar unless they represent an upgrade from a previously installed control. These measures combine to give users a safer, more controlled user experience since they are protected against sites which harass them to install either unwanted or malicious software.  \n  \n These features also protect customers who use [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to browse to web sites that allow them to download and install [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications. In particular, this is because [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] offers a better user experience that reduces the chance for users to install malicious or devious applications irrespective of what technology was used to build it, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]. [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] adds to these protections by using [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] to facilitate downloading of its applications over the Internet. Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] execute within an Internet zone security sandbox, they can be seamlessly launched. On the other hand, standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications require full trust to execute. For these applications, [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] will display a security dialog box during the launch process to notify the use of the application's additional security requirements. However, this must be user-initiated, will also be governed by user initiated logic, and can be canceled.  \n  \n [!INCLUDE[TLA2#tla_ie7](../../../includes/tla2sharptla-ie7-md.md)] incorporates and extends the security capabilities of [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] as part of an ongoing commitment to security.  \n  \n## See also\n\n- [Understanding Security in Microsoft Internet Explorer 6 in Windows XP SP2](https://www.microsoft.com/downloads/details.aspx?FamilyId=E550F940-37A0-4541-B5E2-704AB386C3ED&displaylang=en)\n- [Code Access Security](../misc/code-access-security.md)\n- [Security](security-wpf.md)\n- [WPF Partial Trust Security](wpf-partial-trust-security.md)\n- [WPF Security Strategy - Security Engineering](wpf-security-strategy-security-engineering.md)\n","nodes":[{"pos":[4,641],"embed":true,"restype":"x-metadata","content":"title: \"WPF Security Strategy - Platform Security\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"platform security model [WPF]\"\n  - \"Common Language Runtime (CLR) security features\"\n  - \"operating system security model [WPF]\"\n  - \"Internet Explorer security features [WPF]\"\n  - \"Security-Critical method\"\n  - \"CLR security features [WPF]\"\n  - \"security model [WPF]\"\n  - \"security model [WPF], platform\"\n  - \"WPF [WPF], about security model\"\n  - \"Windows Presentation Foundation [WPF], about security model\"\n  - \"security model [WPF], operating system\"\nms.assetid: 2a39a054-3e2a-4659-bcb7-8bcea490ba31","nodes":[{"content":"WPF Security Strategy - Platform Security","nodes":[{"pos":[0,41],"content":"WPF Security Strategy - Platform Security","nodes":[{"content":"WPF Security Strategy - Platform Security","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[648,689],"content":"WPF Security Strategy - Platform Security","linkify":"WPF Security Strategy - Platform Security","nodes":[{"content":"WPF Security Strategy - Platform Security","pos":[0,41]}]},{"content":"While Windows Presentation Foundation (WPF) provides a variety of security services, it also leverages the security features of the underlying platform, which includes the operating system, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph>, and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ie](../../../includes/tla2sharptla-ie-md.md)]</ph>.","pos":[690,1021],"source":"While Windows Presentation Foundation (WPF) provides a variety of security services, it also leverages the security features of the underlying platform, which includes the operating system, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)], and [!INCLUDE[TLA2#tla_ie](../../../includes/tla2sharptla-ie-md.md)]."},{"content":"These layers combine to provide <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> a strong, defense-in-depth security model that attempts to avoid any single point of failure, as shown in the following figure:","pos":[1022,1248],"source":" These layers combine to provide [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] a strong, defense-in-depth security model that attempts to avoid any single point of failure, as shown in the following figure:"},{"pos":[1255,1344],"content":"<bpt id=\"p1\">![</bpt>WPF security illustration<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/windowplatformsecurity.PNG \"</bpt>windowplatformsecurity<ept id=\"p2\">\")</ept>","source":"![WPF security illustration](./media/windowplatformsecurity.PNG \"windowplatformsecurity\")"},{"pos":[1351,1522],"content":"The remainder of this topic discusses the features in each of these layers that pertain to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> specifically.","source":"The remainder of this topic discusses the features in each of these layers that pertain to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] specifically."},{"pos":[1573,1598],"content":"Operating System Security","linkify":"Operating System Security","nodes":[{"content":"Operating System Security","pos":[0,25]}]},{"content":"The minimum level of operating system that is required by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> is <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]</ph>.","pos":[1602,1807],"source":"The minimum level of operating system that is required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]."},{"content":"The core of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]</ph> provides several security features that form the security foundation for all Windows applications, including those built with <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph>.","pos":[1808,2090],"source":" The core of [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] provides several security features that form the security foundation for all Windows applications, including those built with [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]</ph> incorporates the security features of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> and extends them further.","pos":[2091,2296],"source":"[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] incorporates the security features of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] and extends them further."},{"content":"This topic discusses the breadth of these security features that are important to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph>, as well as how <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> integrates with them to provide further defense-in-depth.","pos":[2297,2586],"source":" This topic discusses the breadth of these security features that are important to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)], as well as how [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] integrates with them to provide further defense-in-depth."},{"pos":[2656,2697],"content":"Microsoft Windows XP Service Pack 2 (SP2)","linkify":"Microsoft Windows XP Service Pack 2 (SP2)","nodes":[{"content":"Microsoft Windows XP Service Pack 2 (SP2)","pos":[0,41]}]},{"pos":[2701,2909],"content":"In addition to a general review and strengthening of Windows, there are three key features from <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]</ph> that we will discuss in this topic:","source":"In addition to a general review and strengthening of Windows, there are three key features from [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] that we will discuss in this topic:"},{"content":"/GS compilation","pos":[2919,2934]},{"pos":[2944,3023],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)]</ph>.","source":"[!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)]."},{"pos":[3034,3049],"content":"/GS Compilation","linkify":"/GS Compilation","nodes":[{"content":"/GS Compilation","pos":[0,15]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]</ph> provides protection by recompiling many core system libraries, including all of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> dependencies such as the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph>, to help mitigate buffer overruns.","pos":[3053,3407],"source":"[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] provides protection by recompiling many core system libraries, including all of the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] dependencies such as the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)], to help mitigate buffer overruns."},{"content":"This is achieved by using the /GS parameter with the C/C++ command-line compiler.","pos":[3408,3489]},{"content":"Although buffer overruns should be explicitly avoided, /GS compilation provides an example of a defense-in-depth against potential vulnerabilities that are inadvertently or maliciously created by them.","pos":[3490,3691]},{"content":"Historically, buffer overruns have been the cause of many high-impact security exploits.","pos":[3698,3786]},{"content":"A buffer overrun occurs when an attacker takes advantage of a code vulnerability that allows the injection of malicious code that writes past the boundaries of a buffer.","pos":[3787,3956]},{"content":"This then allows an attacker to hijack the process in which the code is executing by overwriting the return address of a function to cause the execution of the attacker's code.","pos":[3957,4133]},{"content":"The result is malicious code that executes arbitrary code with the same privileges as the hijacked process.","pos":[4134,4241]},{"content":"At a high level, the /GS compiler flag protects against some potential buffer overruns by injecting a special security cookie to protect the return address of a function that has local string buffers.","pos":[4248,4448]},{"content":"After a function returns, the security cookie is compared with its previous value.","pos":[4449,4531]},{"content":"If the value has changed, a buffer overrun may have occurred and the process is stopped with an error condition.","pos":[4532,4644]},{"content":"Stopping the process prevents the execution of potentially malicious code.","pos":[4645,4719]},{"content":"See <bpt id=\"p1\">[</bpt>/GS (Buffer Security Check)<ept id=\"p1\">](/cpp/build/reference/gs-buffer-security-check)</ept> for more details.","pos":[4720,4818],"source":" See [/GS (Buffer Security Check)](/cpp/build/reference/gs-buffer-security-check) for more details."},{"pos":[4825,5041],"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> is compiled with the /GS flag to add yet another layer of defense to <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications.","source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is compiled with the /GS flag to add yet another layer of defense to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications."},{"pos":[5052,5089],"content":"Microsoft Windows Update Enhancements","linkify":"Microsoft Windows Update Enhancements","nodes":[{"content":"Microsoft Windows Update Enhancements","pos":[0,37]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)]</ph> was also improved in <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]</ph> to simplify the process for downloading and installing updates.","pos":[5093,5333],"source":"[!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)] was also improved in [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] to simplify the process for downloading and installing updates."},{"content":"These changes significantly enhance security for <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> customers by helping to ensure that their systems are up-to-date, particularly with respect to security updates.","pos":[5334,5562],"source":" These changes significantly enhance security for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] customers by helping to ensure that their systems are up-to-date, particularly with respect to security updates."},{"pos":[5604,5617],"content":"Windows Vista","linkify":"Windows Vista","nodes":[{"content":"Windows Vista","pos":[0,13]}]},{"pos":[5621,5935],"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> users on <ph id=\"ph2\">[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]</ph> will benefit from the operating system's additional security enhancements, including \"Least-Privilege User Access\", code integrity checks, and privilege isolation.","source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] users on [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] will benefit from the operating system's additional security enhancements, including \"Least-Privilege User Access\", code integrity checks, and privilege isolation."},{"pos":[5946,5972],"content":"User Account Control (UAC)","linkify":"User Account Control (UAC)","nodes":[{"content":"User Account Control (UAC)","pos":[0,26]}]},{"content":"Today, Windows users tend to run with administrator privileges because many applications require them for either installation or execution, or both.","pos":[5976,6124]},{"content":"Being able to write default application settings to the Registry is one example.","pos":[6125,6205]},{"content":"Running with administrator privileges really means that applications execute from processes that are granted administrator privileges.","pos":[6212,6346]},{"content":"The security impact of this is that any malicious code that hijacks a process running with administrator privileges will automatically inherit those privileges, including access to critical system resources.","pos":[6347,6554]},{"content":"One way to protect against this security threat is to run applications with the least amount of privileges that are required.","pos":[6561,6686]},{"content":"This is known as the principle of least privilege, and is a core feature of the <ph id=\"ph1\">[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]</ph> operating system.","pos":[6687,6859],"source":" This is known as the principle of least privilege, and is a core feature of the [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] operating system."},{"content":"This feature is called User Account Control (UAC), and is used by <ph id=\"ph1\">[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]</ph> UAC in two key ways:","pos":[6860,7021],"source":" This feature is called User Account Control (UAC), and is used by [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] UAC in two key ways:"},{"content":"To run most applications with UAC privileges by default, even if the user is an administrator; only applications that need administrator privileges will run with administrator privileges.","pos":[7031,7218]},{"content":"To run with administrative privileges, applications must be explicitly marked in either their application manifest or as an entry in security policy.","pos":[7219,7368]},{"content":"To provide compatibility solutions like virtualization.","pos":[7378,7433]},{"content":"For example, many applications try to write to restricted locations like C:\\Program Files.","pos":[7434,7524]},{"content":"For applications executing under UAC, an alternative per-user location exists that does not require administrator privileges to write to.","pos":[7525,7662]},{"content":"For applications running under UAC, UAC virtualizes C:\\Program Files so that applications who think they are writing to it are actually writing to the alternative, per-user location.","pos":[7663,7845]},{"content":"This kind of compatibility work enables the operating system to run many applications that couldn't previously run in UAC.","pos":[7846,7968]},{"pos":[7979,8000],"content":"Code Integrity Checks","linkify":"Code Integrity Checks","nodes":[{"content":"Code Integrity Checks","pos":[0,21]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]</ph> incorporates deeper code integrity checks to help prevent malicious code from being injected into system files or into the kernel at load/run time.","pos":[8004,8226],"source":"[!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] incorporates deeper code integrity checks to help prevent malicious code from being injected into system files or into the kernel at load/run time."},{"content":"This goes beyond system file protection.","pos":[8227,8267]},{"pos":[8350,8404],"content":"Limited Rights Process for Browser-Hosted Applications","linkify":"Limited Rights Process for Browser-Hosted Applications","nodes":[{"content":"Limited Rights Process for Browser-Hosted Applications","pos":[0,54]}]},{"content":"Browser-hosted <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications execute within the Internet zone sandbox.","pos":[8408,8544],"source":"Browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications execute within the Internet zone sandbox."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> integration with <ph id=\"ph2\">[!INCLUDE[TLA#tla_ie](../../../includes/tlasharptla-ie-md.md)]</ph> extends this protection with additional support.","pos":[8545,8740],"source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] integration with [!INCLUDE[TLA#tla_ie](../../../includes/tlasharptla-ie-md.md)] extends this protection with additional support."},{"pos":[8751,8816],"content":"Internet Explorer 6 Service Pack 2 and Internet Explorer 7 for XP","linkify":"Internet Explorer 6 Service Pack 2 and Internet Explorer 7 for XP","nodes":[{"content":"Internet Explorer 6 Service Pack 2 and Internet Explorer 7 for XP","pos":[0,65]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> leverages operating system security by limiting process privileges for <ph id=\"ph2\">[!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]</ph> for further protection.","pos":[8820,9080],"source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] leverages operating system security by limiting process privileges for [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] for further protection."},{"content":"Before a browser-hosted <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> application is launched, the operating system creates a host process that removes unnecessary privileges from the process token.","pos":[9081,9300],"source":" Before a browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] application is launched, the operating system creates a host process that removes unnecessary privileges from the process token."},{"content":"Some examples of privileges that are removed include the ability to shut down the user's machine, load drivers, and read access to all files on the machine.","pos":[9301,9457]},{"pos":[9468,9497],"content":"Internet Explorer 7 for Vista","linkify":"Internet Explorer 7 for Vista","nodes":[{"content":"Internet Explorer 7 for Vista","pos":[0,29]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)]</ph>, <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications run in protected mode.","pos":[9501,9672],"source":"In [!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications run in protected mode."},{"content":"Specifically, <ph id=\"ph1\">[!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)]</ph> run with medium-level integrity.","pos":[9673,9804],"source":" Specifically, [!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] run with medium-level integrity."},{"pos":[9815,9837],"content":"Defense-In-Depth Layer","linkify":"Defense-In-Depth Layer","nodes":[{"content":"Defense-In-Depth Layer","pos":[0,22]}]},{"content":"Since <ph id=\"ph1\">[!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]</ph> are generally sandboxed by the Internet zone permission set, removing these privileges does not harm <ph id=\"ph2\">[!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]</ph> from a compatibility perspective.","pos":[9841,10179],"source":"Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] are generally sandboxed by the Internet zone permission set, removing these privileges does not harm [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] from a compatibility perspective."},{"content":"Instead, an additional defense-in-depth layer is created; if a sandboxed application is able to exploit other layers and hijack the process, the process will still only have limited privileges.","pos":[10180,10373]},{"pos":[10380,10508],"content":"See <bpt id=\"p1\">[</bpt>Using a Least-Privileged User Account<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/tn-archive/cc700846%28v=technet.10%29)</ept>.","source":"See [Using a Least-Privileged User Account](https://docs.microsoft.com/previous-versions/tn-archive/cc700846%28v=technet.10%29)."},{"pos":[10568,10600],"content":"Common Language Runtime Security","linkify":"Common Language Runtime Security","nodes":[{"content":"Common Language Runtime Security","pos":[0,32]}]},{"pos":[10604,10860],"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)]</ph> offers a number of key security benefits that include validation and verification, <ph id=\"ph2\">[!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)]</ph>, and the Security Critical Methodology.","source":"The [!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)] offers a number of key security benefits that include validation and verification, [!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)], and the Security Critical Methodology."},{"pos":[10916,10943],"content":"Validation and Verification","linkify":"Validation and Verification","nodes":[{"content":"Validation and Verification","pos":[0,27]}]},{"content":"To provide assembly isolation and integrity, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph> uses a process of validation.","pos":[10947,11092],"source":"To provide assembly isolation and integrity, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] uses a process of validation."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph> validation ensures that assemblies are isolated by validating their Portable Executable (PE) file format for addresses that point outside the assembly.","pos":[11093,11311],"source":"[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] validation ensures that assemblies are isolated by validating their Portable Executable (PE) file format for addresses that point outside the assembly."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph> validation also validates the integrity of the metadata that is embedded within an assembly.","pos":[11312,11471],"source":"[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] validation also validates the integrity of the metadata that is embedded within an assembly."},{"pos":[11478,11723],"content":"To ensure type safety, help prevent common security issues (e.g. buffer overruns), and enable sandboxing through sub-process isolation, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph> security uses the concept of verification.","source":"To ensure type safety, help prevent common security issues (e.g. buffer overruns), and enable sandboxing through sub-process isolation, [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] security uses the concept of verification."},{"content":"Managed applications are compiled into Microsoft Intermediate Language (MSIL).","pos":[11730,11808]},{"content":"When methods in a managed application are executed, its MSIL is compiled into native code through Just-In-Time (JIT) compilation.","pos":[11809,11938]},{"content":"JIT compilation includes a verification process that applies many safety and robustness rules that ensure code does not:","pos":[11939,12059]},{"content":"Violate type contracts","pos":[12069,12091]},{"content":"Introduce buffer overruns","pos":[12101,12126]},{"content":"Wildly access memory.","pos":[12136,12157]},{"content":"Managed code that does not conform to verification rules is not allowed to execute, unless it is considered trusted code.","pos":[12164,12285]},{"content":"The advantage of verifiable code is a key reason why <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> builds on the .NET Framework.","pos":[12292,12441],"source":"The advantage of verifiable code is a key reason why [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] builds on the .NET Framework."},{"content":"To the extent that verifiable code is used, the possibility of exploiting possible vulnerabilities is greatly lowered.","pos":[12442,12560]},{"pos":[12609,12629],"content":"Code Access Security","linkify":"Code Access Security","nodes":[{"content":"Code Access Security","pos":[0,20]}]},{"content":"A client machine exposes a wide variety of resources that a managed application can have access to, including the file system, the Registry, printing services, the user interface, reflection, and environment variables.","pos":[12633,12851]},{"content":"Before a managed application can access any of the resources on a client machine, it must have .NET Framework permission to do so.","pos":[12852,12982]},{"content":"A permission in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> is a subclass of the <ph id=\"ph2\">&lt;xref:System.Security.CodeAccessPermission&gt;</ph>; <ph id=\"ph3\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> implements one subclass for each resource that managed applications can access.","pos":[12983,13278],"source":" A permission in [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] is a subclass of the <xref:System.Security.CodeAccessPermission>; [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] implements one subclass for each resource that managed applications can access."},{"content":"The set of permissions that a managed application is granted by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> when it starts executing is known as a permission set and is determined by evidence provided by the application.","pos":[13285,13528],"source":"The set of permissions that a managed application is granted by [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] when it starts executing is known as a permission set and is determined by evidence provided by the application."},{"content":"For <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications, the evidence that is provided is the location, or zone, from which the applications are launched.","pos":[13529,13711],"source":" For [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications, the evidence that is provided is the location, or zone, from which the applications are launched."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> identifies the following zones:","pos":[13712,13810],"source":"[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] identifies the following zones:"},{"content":"<bpt id=\"p1\">**</bpt>My Computer<ept id=\"p1\">**</ept>.","pos":[13820,13836],"source":"**My Computer**."},{"content":"Applications launched from the client machine (Fully Trusted).","pos":[13837,13899]},{"content":"<bpt id=\"p1\">**</bpt>Local Intranet<ept id=\"p1\">**</ept>.","pos":[13909,13928],"source":"**Local Intranet**."},{"content":"Applications launched from the intranet.","pos":[13929,13969]},{"content":"(Somewhat Trusted).","pos":[13970,13989]},{"content":"<bpt id=\"p1\">**</bpt>Internet<ept id=\"p1\">**</ept>.","pos":[13999,14012],"source":"**Internet**."},{"content":"Applications launched from the Internet.","pos":[14013,14053]},{"content":"(Least Trusted).","pos":[14054,14070]},{"content":"<bpt id=\"p1\">**</bpt>Trusted Sites<ept id=\"p1\">**</ept>.","pos":[14080,14098],"source":"**Trusted Sites**."},{"content":"Applications identified by a user as being trusted.","pos":[14099,14150]},{"content":"(Least Trusted).","pos":[14151,14167]},{"content":"<bpt id=\"p1\">**</bpt>Untrusted Sites<ept id=\"p1\">**</ept>.","pos":[14177,14197],"source":"**Untrusted Sites**."},{"content":"Applications identified by a user as being untrusted.","pos":[14198,14251]},{"content":"(Untrusted).","pos":[14252,14264]},{"content":"For each of these zones, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> provides a predefined permission set that includes the permissions which matches the level of trust associated with each.","pos":[14271,14484],"source":"For each of these zones, [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] provides a predefined permission set that includes the permissions which matches the level of trust associated with each."},{"content":"These include:","pos":[14485,14499]},{"content":"<bpt id=\"p1\">**</bpt>FullTrust<ept id=\"p1\">**</ept>.","pos":[14509,14523],"source":"**FullTrust**."},{"content":"For applications launched from the <bpt id=\"p1\">**</bpt>My Computer<ept id=\"p1\">**</ept> zone.","pos":[14524,14580],"source":" For applications launched from the **My Computer** zone."},{"content":"All possible permissions are granted.","pos":[14581,14618]},{"content":"<bpt id=\"p1\">**</bpt>LocalIntranet<ept id=\"p1\">**</ept>.","pos":[14628,14646],"source":"**LocalIntranet**."},{"content":"For applications launched from the <bpt id=\"p1\">**</bpt>Local Intranet<ept id=\"p1\">**</ept> zone.","pos":[14647,14706],"source":" For applications launched from the **Local Intranet** zone."},{"content":"A subset of permissions are granted to provide moderate access to a client machine’s resources, including isolated storage, unrestricted UI access, unrestricted file dialogs, limited reflection, limited access to environment variables.","pos":[14707,14942]},{"content":"Permissions for critical resources like the Registry are not provided.","pos":[14943,15013]},{"content":"<bpt id=\"p1\">**</bpt>Internet<ept id=\"p1\">**</ept>.","pos":[15023,15036],"source":"**Internet**."},{"content":"For applications launched from the <bpt id=\"p1\">**</bpt>Internet<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Trusted Sites<ept id=\"p2\">**</ept> zone.","pos":[15037,15111],"source":" For applications launched from the **Internet** or **Trusted Sites** zone."},{"content":"A subset of permissions are granted to provided limited access to a client machine’s resources, including isolated storage, file open only, and limited UI.","pos":[15112,15267]},{"content":"Essentially, this permission sets isolates applications from the client machine.","pos":[15268,15348]},{"content":"Applications identified as being from the <bpt id=\"p1\">**</bpt>Untrusted Sites<ept id=\"p1\">**</ept> zone are granted no permissions by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]</ph> at all.","pos":[15355,15526],"source":"Applications identified as being from the **Untrusted Sites** zone are granted no permissions by [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] at all."},{"content":"Consequently, a predefined permission set does not exist for them.","pos":[15527,15593]},{"content":"The following figure illustrates the relationship between zones, permission sets, permissions, and resources.","pos":[15600,15709]},{"pos":[15716,15789],"content":"<bpt id=\"p1\">![</bpt>CAS permission sets<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/caspermissionsets.png \"</bpt>CASPermissionSets<ept id=\"p2\">\")</ept>","source":"![CAS permission sets](./media/caspermissionsets.png \"CASPermissionSets\")"},{"content":"The restrictions of the Internet zone security sandbox apply equally to any code that a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph> imports from a system library, including <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph>.","pos":[15796,16075],"source":"The restrictions of the Internet zone security sandbox apply equally to any code that a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] imports from a system library, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]."},{"content":"This ensures that every bit of the code is locked down, even <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph>.","pos":[16076,16204],"source":" This ensures that every bit of the code is locked down, even [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]."},{"content":"Unfortunately, to be able to execute, a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph> needs to execute functionality that requires more permissions than those enabled by the Internet zone security sandbox.","pos":[16205,16447],"source":" Unfortunately, to be able to execute, a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] needs to execute functionality that requires more permissions than those enabled by the Internet zone security sandbox."},{"pos":[16454,16593],"content":"Consider a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph> application that includes the following page:","source":"Consider a [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] application that includes the following page:"},{"pos":[16600,16922],"content":"[!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]\n[!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]","leadings":[""," "],"nodes":[]},{"pos":[16929,17275],"content":"To execute this <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph>, the underlying <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> code must execute more functionality than is available to the calling <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph>, including:","source":"To execute this [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], the underlying [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code must execute more functionality than is available to the calling [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], including:"},{"content":"Creating a window handle (hWnd) for rendering","pos":[17285,17330]},{"content":"Dispatching messages","pos":[17340,17360]},{"content":"Loading the Tahoma font","pos":[17370,17393]},{"content":"From a security point of view, allowing direct access to any of these operations from the sandboxed application would be catastrophic.","pos":[17400,17534]},{"content":"Fortunately, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> caters to this situation by allowing these operations to execute with elevated privileges on behalf of the sandboxed application.","pos":[17541,17750],"source":"Fortunately, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] caters to this situation by allowing these operations to execute with elevated privileges on behalf of the sandboxed application."},{"content":"While all <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> operations are checked against the limited Internet zone security permissions of the application domain of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph>, <ph id=\"ph3\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> (as with other system libraries) is granted a permission set that includes all possible permissions","pos":[17751,18189],"source":" While all [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] operations are checked against the limited Internet zone security permissions of the application domain of the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] (as with other system libraries) is granted a permission set that includes all possible permissions"},{"pos":[18196,18432],"content":"This requires that <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> receives elevated privileges while preventing those privileges from being governed by the Internet zone permission set of the host application domain.","source":"This requires that [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] receives elevated privileges while preventing those privileges from being governed by the Internet zone permission set of the host application domain."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> does this by using the <bpt id=\"p1\">**</bpt>Assert<ept id=\"p1\">**</ept> method of a permission.","pos":[18439,18563],"source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] does this by using the **Assert** method of a permission."},{"content":"The following code shows how this happens.","pos":[18564,18606]},{"pos":[18613,18935],"content":"[!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]\n[!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]","leadings":[""," "],"nodes":[]},{"pos":[18942,19228],"content":"The <bpt id=\"p1\">**</bpt>Assert<ept id=\"p1\">**</ept> essentially prevents the unlimited permissions required by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> from being restricted by the Internet zone permissions of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph>.","source":"The **Assert** essentially prevents the unlimited permissions required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] from being restricted by the Internet zone permissions of the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]."},{"content":"From a platform perspective, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> is responsible for using <bpt id=\"p1\">**</bpt>Assert<ept id=\"p1\">**</ept> correctly; an incorrect use of <bpt id=\"p2\">**</bpt>Assert<ept id=\"p2\">**</ept> could enable malicious code to elevate privileges.","pos":[19235,19459],"source":"From a platform perspective, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is responsible for using **Assert** correctly; an incorrect use of **Assert** could enable malicious code to elevate privileges."},{"content":"Consequently, it is important then to only call <bpt id=\"p1\">**</bpt>Assert<ept id=\"p1\">**</ept> when needed, and to ensure that sandbox restrictions remain intact.","pos":[19460,19586],"source":" Consequently, it is important then to only call **Assert** when needed, and to ensure that sandbox restrictions remain intact."},{"content":"For example, sandboxed code is not allowed to open random files, but it is allowed to use fonts.","pos":[19587,19683]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> enables sandboxed applications to use font functionality by calling <bpt id=\"p1\">**</bpt>Assert<ept id=\"p1\">**</ept>, and for <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> to read files known to contain those fonts on behalf of the sandboxed application.","pos":[19684,19988],"source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] enables sandboxed applications to use font functionality by calling **Assert**, and for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] to read files known to contain those fonts on behalf of the sandboxed application."},{"pos":[20037,20057],"content":"ClickOnce Deployment","linkify":"ClickOnce Deployment","nodes":[{"content":"ClickOnce Deployment","pos":[0,20]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)]</ph> is a comprehensive deployment technology that is included with .NET Framework, and integrates with <ph id=\"ph2\">[!INCLUDE[TLA#tla_visualstu](../../../includes/tlasharptla-visualstu-md.md)]</ph> (see <bpt id=\"p1\">[</bpt>ClickOnce security and deployment<ept id=\"p1\">](/visualstudio/deployment/clickonce-security-and-deployment)</ept> for detailed information).","pos":[20061,20441],"source":"[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] is a comprehensive deployment technology that is included with .NET Framework, and integrates with [!INCLUDE[TLA#tla_visualstu](../../../includes/tlasharptla-visualstu-md.md)] (see [ClickOnce security and deployment](/visualstudio/deployment/clickonce-security-and-deployment) for detailed information)."},{"content":"Standalone <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications can be deployed using <ph id=\"ph2\">[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)]</ph>, while browser-hosted applications must be deployed with <ph id=\"ph3\">[!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)]</ph>.","pos":[20442,20768],"source":" Standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications can be deployed using [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)], while browser-hosted applications must be deployed with [!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)]."},{"content":"Applications deployed using <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)]</ph> are given an additional security layer over <ph id=\"ph2\">[!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)]</ph>; essentially, <ph id=\"ph3\">[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)]</ph> deployed applications request the permissions that they need.","pos":[20775,21143],"source":"Applications deployed using [!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)] are given an additional security layer over [!INCLUDE[TLA#tla_cas](../../../includes/tlasharptla-cas-md.md)]; essentially, [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] deployed applications request the permissions that they need."},{"content":"They are granted only those permissions if they do not exceed the set of permissions for the zone from which the application is deployed.","pos":[21144,21281]},{"content":"By reducing the set of permissions to only those that are needed, even if they are less than those provided by the launch zone's permission set, the number of resources that the application has access to is reduce to a bare minimum.","pos":[21282,21514]},{"content":"Consequently, if the application is hijacked, the potential for damage to the client machine is reduced.","pos":[21515,21619]},{"pos":[21677,21706],"content":"Security-Critical Methodology","linkify":"Security-Critical Methodology","nodes":[{"content":"Security-Critical Methodology","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> code that uses permissions to enable the Internet zone sandbox for <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph> applications must be held to highest possible degree of security audit and control.","pos":[21710,22014],"source":"The [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that uses permissions to enable the Internet zone sandbox for [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] applications must be held to highest possible degree of security audit and control."},{"content":"To facilitate this requirement, .NET Framework provides new support for managing code that elevates privilege.","pos":[22015,22125]},{"content":"Specifically, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)]</ph> enables you to identify code that elevates privilege and mark it with the <ph id=\"ph2\">&lt;xref:System.Security.SecurityCriticalAttribute&gt;</ph>; any code not marked with <ph id=\"ph3\">&lt;xref:System.Security.SecurityCriticalAttribute&gt;</ph> becomes <bpt id=\"p1\">*</bpt>transparent<ept id=\"p1\">*</ept> using this methodology.","pos":[22126,22454],"source":" Specifically, the [!INCLUDE[TLA2#tla_clr](../../../includes/tla2sharptla-clr-md.md)] enables you to identify code that elevates privilege and mark it with the <xref:System.Security.SecurityCriticalAttribute>; any code not marked with <xref:System.Security.SecurityCriticalAttribute> becomes *transparent* using this methodology."},{"content":"Conversely, managed code that is not marked with <ph id=\"ph1\">&lt;xref:System.Security.SecurityCriticalAttribute&gt;</ph> is prevented from elevating privilege.","pos":[22455,22591],"source":" Conversely, managed code that is not marked with <xref:System.Security.SecurityCriticalAttribute> is prevented from elevating privilege."},{"content":"The Security-Critical Methodology allows the organization of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> code that elevates privilege into <bpt id=\"p1\">*</bpt>security-critical kernel<ept id=\"p1\">*</ept>, with the remainder being transparent.","pos":[22598,22825],"source":"The Security-Critical Methodology allows the organization of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that elevates privilege into *security-critical kernel*, with the remainder being transparent."},{"content":"Isolating the security-critical code enables the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> engineering team focus an additional security analysis and source control on the security-critical kernel above and beyond standard security practices (see <bpt id=\"p1\">[</bpt>WPF Security Strategy - Security Engineering<ept id=\"p1\">](wpf-security-strategy-security-engineering.md)</ept>).","pos":[22826,23193],"source":" Isolating the security-critical code enables the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] engineering team focus an additional security analysis and source control on the security-critical kernel above and beyond standard security practices (see [WPF Security Strategy - Security Engineering](wpf-security-strategy-security-engineering.md))."},{"content":"Note that .NET Framework permits trusted code to extend the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)]</ph> Internet zone sandbox by allowing developers to write managed assemblies that are marked with <ph id=\"ph2\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> (APTCA) and deployed to the user's Global Assembly Cache (GAC).","pos":[23200,23561],"source":"Note that .NET Framework permits trusted code to extend the [!INCLUDE[TLA2#tla_winfxwebapp](../../../includes/tla2sharptla-winfxwebapp-md.md)] Internet zone sandbox by allowing developers to write managed assemblies that are marked with <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) and deployed to the user's Global Assembly Cache (GAC)."},{"content":"Marking an assembly with APTCA is a highly sensitive security operation as it allows any code to call that assembly, including malicious code from the Internet.","pos":[23562,23722]},{"content":"Extreme caution and best practices must be used when doing this and users must choose to trust that software in order for it to be installed.","pos":[23723,23864]},{"pos":[23928,23964],"content":"Microsoft Internet Explorer Security","linkify":"Microsoft Internet Explorer Security","nodes":[{"content":"Microsoft Internet Explorer Security","pos":[0,36]}]},{"content":"Beyond reducing security issues and simplifying security configuration, <ph id=\"ph1\">[!INCLUDE[TLA#tla_ie6sp2](../../../includes/tlasharptla-ie6sp2-md.md)]</ph> contains several features that security improvements that enhance security for users of <ph id=\"ph2\">[!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]</ph>.","pos":[23968,24298],"source":"Beyond reducing security issues and simplifying security configuration, [!INCLUDE[TLA#tla_ie6sp2](../../../includes/tlasharptla-ie6sp2-md.md)] contains several features that security improvements that enhance security for users of [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]."},{"content":"The thrust of these features attempts to allow users greater control over their browsing experience.","pos":[24299,24399]},{"pos":[24406,24536],"content":"Prior to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph>, users could be subject to any of the following:","source":"Prior to [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)], users could be subject to any of the following:"},{"content":"Random popup windows.","pos":[24546,24567]},{"content":"Confusing script redirection.","pos":[24577,24606]},{"content":"Numerous security dialogs on some Web sites.","pos":[24616,24660]},{"content":"In some cases, untrustworthy Web sites would try to trick users by spoofing installation <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]</ph> or repeatedly showing a <ph id=\"ph2\">[!INCLUDE[TLA#tla_actx](../../../includes/tlasharptla-actx-md.md)]</ph> installation dialog box, even though the user may have canceled it.","pos":[24667,24977],"source":"In some cases, untrustworthy Web sites would try to trick users by spoofing installation [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] or repeatedly showing a [!INCLUDE[TLA#tla_actx](../../../includes/tlasharptla-actx-md.md)] installation dialog box, even though the user may have canceled it."},{"content":"Using these techniques, it is possible that a significant number of users have been tricked into making poor decisions that resulted with the installation of spyware applications.","pos":[24978,25157]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> includes several features to mitigate these types of issues, which revolve around the concept of user initiation.","pos":[25164,25350],"source":"[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] includes several features to mitigate these types of issues, which revolve around the concept of user initiation."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> detects when a user has clicked on a link or page element prior to an action, which is known as <bpt id=\"p1\">*</bpt>user initiation<ept id=\"p1\">*</ept>, and treats it differently than when a similar action is instead triggered by the script on a page.","pos":[25351,25637],"source":"[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] detects when a user has clicked on a link or page element prior to an action, which is known as *user initiation*, and treats it differently than when a similar action is instead triggered by the script on a page."},{"content":"As an example, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> incorporates a <bpt id=\"p1\">**</bpt>Pop-Up Blocker<ept id=\"p1\">**</ept> that detects when a user clicks a button prior to the page creating a pop-up.","pos":[25638,25837],"source":" As an example, [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] incorporates a **Pop-Up Blocker** that detects when a user clicks a button prior to the page creating a pop-up."},{"content":"This enables <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> to allow most innocuous pop-ups while preventing pop-ups that users neither ask for nor want.","pos":[25838,26017],"source":" This enables [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to allow most innocuous pop-ups while preventing pop-ups that users neither ask for nor want."},{"content":"Blocked pop-ups are trapped under the new <bpt id=\"p1\">**</bpt>Information Bar<ept id=\"p1\">**</ept>, which allows the user to manually override the block and view the pop-up.","pos":[26018,26154],"source":" Blocked pop-ups are trapped under the new **Information Bar**, which allows the user to manually override the block and view the pop-up."},{"content":"The same user-initiation logic is also applied to <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> security prompts.","pos":[26161,26246],"source":"The same user-initiation logic is also applied to **Open**/**Save** security prompts."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_actx](../../../includes/tla2sharptla-actx-md.md)]</ph> installation dialog boxes are always trapped under the Information Bar unless they represent an upgrade from a previously installed control.","pos":[26247,26456],"source":"[!INCLUDE[TLA2#tla_actx](../../../includes/tla2sharptla-actx-md.md)] installation dialog boxes are always trapped under the Information Bar unless they represent an upgrade from a previously installed control."},{"content":"These measures combine to give users a safer, more controlled user experience since they are protected against sites which harass them to install either unwanted or malicious software.","pos":[26457,26641]},{"content":"These features also protect customers who use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> to browse to web sites that allow them to download and install <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications.","pos":[26648,26910],"source":"These features also protect customers who use [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to browse to web sites that allow them to download and install [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications."},{"content":"In particular, this is because <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> offers a better user experience that reduces the chance for users to install malicious or devious applications irrespective of what technology was used to build it, including <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph>.","pos":[26911,27257],"source":" In particular, this is because [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] offers a better user experience that reduces the chance for users to install malicious or devious applications irrespective of what technology was used to build it, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> adds to these protections by using <ph id=\"ph2\">[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)]</ph> to facilitate downloading of its applications over the Internet.","pos":[27258,27501],"source":"[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] adds to these protections by using [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] to facilitate downloading of its applications over the Internet."},{"content":"Since <ph id=\"ph1\">[!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)]</ph> execute within an Internet zone security sandbox, they can be seamlessly launched.","pos":[27502,27689],"source":" Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] execute within an Internet zone security sandbox, they can be seamlessly launched."},{"content":"On the other hand, standalone <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]</ph> applications require full trust to execute.","pos":[27690,27830],"source":" On the other hand, standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications require full trust to execute."},{"content":"For these applications, <ph id=\"ph1\">[!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)]</ph> will display a security dialog box during the launch process to notify the use of the application's additional security requirements.","pos":[27831,28065],"source":" For these applications, [!INCLUDE[TLA#tla_clickonce](../../../includes/tlasharptla-clickonce-md.md)] will display a security dialog box during the launch process to notify the use of the application's additional security requirements."},{"content":"However, this must be user-initiated, will also be governed by user initiated logic, and can be canceled.","pos":[28066,28171]},{"pos":[28178,28417],"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie7](../../../includes/tla2sharptla-ie7-md.md)]</ph> incorporates and extends the security capabilities of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]</ph> as part of an ongoing commitment to security.","source":"[!INCLUDE[TLA2#tla_ie7](../../../includes/tla2sharptla-ie7-md.md)] incorporates and extends the security capabilities of [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] as part of an ongoing commitment to security."},{"pos":[28426,28434],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[28438,28624],"content":"<bpt id=\"p1\">[</bpt>Understanding Security in Microsoft Internet Explorer 6 in Windows XP SP2<ept id=\"p1\">](https://www.microsoft.com/downloads/details.aspx?FamilyId=E550F940-37A0-4541-B5E2-704AB386C3ED&amp;displaylang=en)</ept>","source":"[Understanding Security in Microsoft Internet Explorer 6 in Windows XP SP2](https://www.microsoft.com/downloads/details.aspx?FamilyId=E550F940-37A0-4541-B5E2-704AB386C3ED&displaylang=en)"},{"pos":[28627,28682],"content":"<bpt id=\"p1\">[</bpt>Code Access Security<ept id=\"p1\">](../misc/code-access-security.md)</ept>","source":"[Code Access Security](../misc/code-access-security.md)"},{"pos":[28685,28712],"content":"<bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](security-wpf.md)</ept>","source":"[Security](security-wpf.md)"},{"pos":[28715,28774],"content":"<bpt id=\"p1\">[</bpt>WPF Partial Trust Security<ept id=\"p1\">](wpf-partial-trust-security.md)</ept>","source":"[WPF Partial Trust Security](wpf-partial-trust-security.md)"},{"pos":[28777,28870],"content":"<bpt id=\"p1\">[</bpt>WPF Security Strategy - Security Engineering<ept id=\"p1\">](wpf-security-strategy-security-engineering.md)</ept>","source":"[WPF Security Strategy - Security Engineering](wpf-security-strategy-security-engineering.md)"}]}