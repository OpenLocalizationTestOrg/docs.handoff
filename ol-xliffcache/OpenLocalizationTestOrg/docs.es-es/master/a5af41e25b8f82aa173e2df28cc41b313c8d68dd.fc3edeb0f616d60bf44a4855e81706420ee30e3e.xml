{"content":"---\ntitle: \"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"collection initializers [Visual Basic]\"\nms.assetid: f64b52c7-8b11-4410-93a6-cb3aeebcc772\n---\n# How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)\nWhen you use a collection initializer to create a collection, the Visual Basic compiler searches for an `Add` method of the collection type for which the parameters for the `Add` method match the types of the values in the collection initializer. This `Add` method is used to populate the collection with the values from the collection initializer.  \n  \n If no matching `Add` method exists and you cannot modify the code for the collection, you can add an extension method called `Add` that takes the parameters that are required by the collection initializer. This is typically what you need to do when you use collection initializers for generic collections.  \n  \n## Example  \n The following example shows how to add an extension method to the generic <xref:System.Collections.Generic.List%601> type so that a collection initializer can be used to add objects of type `Employee`. The extension method enables you to use the shortened collection initializer syntax.  \n  \n [!code-vb[VbVbalrCollectionInitializersHowTo1#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializersHowTo1/VB/Module1.vb#1)]  \n  \n [!code-vb[VbVbalrCollectionInitializersHowTo1#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializersHowTo1/VB/Module1.vb#2)]  \n  \n [!code-vb[VbVbalrCollectionInitializersHowTo1#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializersHowTo1/VB/Module1.vb#3)]  \n  \n## See also\n\n- [Collection Initializers](../../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)\n- [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)\n","nodes":[{"pos":[4,235],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"collection initializers [Visual Basic]\"\nms.assetid: f64b52c7-8b11-4410-93a6-cb3aeebcc772","nodes":[{"content":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","nodes":[{"pos":[0,86],"content":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","nodes":[{"content":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","pos":[0,86]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[242,328],"content":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","linkify":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","nodes":[{"content":"How to: Create an Add Extension Method Used by a Collection Initializer (Visual Basic)","pos":[0,86]}]},{"content":"When you use a collection initializer to create a collection, the Visual Basic compiler searches for an <ph id=\"ph1\">`Add`</ph> method of the collection type for which the parameters for the <ph id=\"ph2\">`Add`</ph> method match the types of the values in the collection initializer.","pos":[329,575],"source":"When you use a collection initializer to create a collection, the Visual Basic compiler searches for an `Add` method of the collection type for which the parameters for the `Add` method match the types of the values in the collection initializer."},{"content":"This <ph id=\"ph1\">`Add`</ph> method is used to populate the collection with the values from the collection initializer.","pos":[576,677],"source":" This `Add` method is used to populate the collection with the values from the collection initializer."},{"content":"If no matching <ph id=\"ph1\">`Add`</ph> method exists and you cannot modify the code for the collection, you can add an extension method called <ph id=\"ph2\">`Add`</ph> that takes the parameters that are required by the collection initializer.","pos":[684,889],"source":"If no matching `Add` method exists and you cannot modify the code for the collection, you can add an extension method called `Add` that takes the parameters that are required by the collection initializer."},{"content":"This is typically what you need to do when you use collection initializers for generic collections.","pos":[890,989]},{"pos":[998,1005],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows how to add an extension method to the generic <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> type so that a collection initializer can be used to add objects of type <ph id=\"ph2\">`Employee`</ph>.","pos":[1009,1210],"source":"The following example shows how to add an extension method to the generic <xref:System.Collections.Generic.List%601> type so that a collection initializer can be used to add objects of type `Employee`."},{"content":"The extension method enables you to use the shortened collection initializer syntax.","pos":[1211,1295]},{"pos":[1787,1795],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1799,1919],"content":"<bpt id=\"p1\">[</bpt>Collection Initializers<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)</ept>","source":"[Collection Initializers](../../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)"},{"pos":[1922,2133],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Collection Used by a Collection Initializer<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)</ept>","source":"[How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)"}]}