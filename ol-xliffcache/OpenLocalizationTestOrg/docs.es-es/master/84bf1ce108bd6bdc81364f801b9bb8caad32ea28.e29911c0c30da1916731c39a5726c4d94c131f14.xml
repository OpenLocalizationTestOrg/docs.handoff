{"content":"---\ntitle: \"Configuring Parameters and Parameter Data Types | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707\ncaps.latest.revision: 6\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Configuring Parameters and Parameter Data Types\nCommand objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation. Unlike command text, parameter input is treated as a literal value, not as executable code. This helps guard against \"SQL injection\" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.  \n  \n Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan. For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online. In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.  \n  \n A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection. The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.  \n  \n## Supplying the ParameterDirection Property  \n When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters. The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.  \n  \n|Member name|Description|  \n|-----------------|-----------------|  \n|<xref:System.Data.ParameterDirection>|The parameter is an input parameter. This is the default.|  \n|<xref:System.Data.ParameterDirection>|The parameter can perform both input and output.|  \n|<xref:System.Data.ParameterDirection>|The parameter is an output parameter.|  \n|<xref:System.Data.ParameterDirection>|The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.|  \n  \n## Working with Parameter Placeholders  \n The syntax for parameter placeholders depends on the data source. The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently. This syntax is customized to a specific data source, as described in the following table.  \n  \n|Data provider|Parameter naming syntax|  \n|-------------------|-----------------------------|  \n|<xref:System.Data.SqlClient>|Uses named parameters in the format `@`*parametername*.|  \n|<xref:System.Data.OleDb>|Uses positional parameter markers indicated by a question mark (`?`).|  \n|<xref:System.Data.Odbc>|Uses positional parameter markers indicated by a question mark (`?`).|  \n|<xref:System.Data.OracleClient>|Uses named parameters in the format `:`*parmname* (or *parmname*).|  \n  \n## Specifying Parameter Data Types  \n The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider. Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source. You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.  \n  \n The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object. The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.  \n  \n|.NET Framework type|DbType|SqlDbType|OleDbType|OdbcType|OracleType|  \n|-------------------------|------------|---------------|---------------|--------------|----------------|  \n|<xref:System.Boolean>|Boolean|Bit|Boolean|Bit|Byte|  \n|<xref:System.Byte>|Byte|TinyInt|UnsignedTinyInt|TinyInt|Byte|  \n|byte[]|Binary|VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.|VarBinary|Binary|Raw|  \n|<xref:System.Char>|``|Inferring a <xref:System.Data.SqlDbType> from char is not supported.|Char|Char|Byte|  \n|<xref:System.DateTime>|DateTime|DateTime|DBTimeStamp|DateTime|DateTime|  \n|<xref:System.DateTimeOffset>|DateTimeOffset|DateTimeOffset in SQL Server 2008. Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.|||DateTime|  \n|<xref:System.Decimal>|Decimal|Decimal|Decimal|Numeric|Number|  \n|<xref:System.Double>|Double|Float|Double|Double|Double|  \n|<xref:System.Single>|Single|Real|Single|Real|Float|  \n|<xref:System.Guid>|Guid|UniqueIdentifier|Guid|UniqueIdentifier|Raw|  \n|<xref:System.Int16>|Int16|SmallInt|SmallInt|SmallInt|Int16|  \n|<xref:System.Int32>|Int32|Int|Int|Int|Int32|  \n|<xref:System.Int64>|Int64|BigInt|BigInt|BigInt|Number|  \n|<xref:System.Object>|Object|Variant|Variant|Inferring an OdbcType from Object is not supported.|Blob|  \n|<xref:System.String>|String|NVarChar. This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters. For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.|VarWChar|NVarChar|NVarChar|  \n|<xref:System.TimeSpan>|Time|Time in SQL Server 2008. Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.|DBTime|Time|DateTime|  \n|<xref:System.UInt16>|UInt16|Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.|UnsignedSmallInt|Int|UInt16|  \n|<xref:System.UInt32>|UInt32|Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.|UnsignedInt|BigInt|UInt32|  \n|<xref:System.UInt64>|UInt64|Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.|UnsignedBigInt|Numeric|Number|  \n||AnsiString|VarChar|VarChar|VarChar|VarChar|  \n||AnsiStringFixedLength|Char|Char|Char|Char|  \n|``|Currency|Money|Currency|Inferring an `OdbcType` from `Currency` is not supported.|Number|  \n|``|Date|Date in SQL Server 2008. Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.|DBDate|Date|DateTime|  \n|``|SByte|Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.|TinyInt|Inferring an `OdbcType` from SByte is not supported.|SByte|  \n||StringFixedLength|NChar|WChar|NChar|NChar|  \n||Time|Time in SQL Server 2008. Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.|DBTime|Time|DateTime|  \n||VarNumeric|Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.|VarNumeric|Inferring an `OdbcType` from VarNumeric is not supported.|Number|  \n|user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>|Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either|SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant|OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.|OdbcType.NVarChar|not supported|  \n  \n> [!NOTE]\n>  Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero. If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.  \n  \n> [!NOTE]\n>  When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]). The null value in the system is an empty object that has no value. <xref:System.DBNull> is used to represent null values. For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).  \n  \n## Deriving Parameter Information  \n Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class. Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure. Note that `DeriveParameters` overwrites any existing parameter information for the command.  \n  \n> [!NOTE]\n>  Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information. If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.  \n  \n For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).  \n  \n## Using Parameters with a SqlCommand and a Stored Procedure  \n Stored procedures offer many advantages in data-driven applications. By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security. Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.  \n  \n> [!NOTE]\n>  Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse. Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`. Changes in database context last only to the end of the `sp_executesql` statement. For more information, see SQL Server Books Online.  \n  \n When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure. The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure. It treats parameters in the stored procedure as named parameters and searches for matching parameter markers. For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`. When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.  \n  \n```  \nCREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  \n```  \n  \n### Example  \n This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database. The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`. The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends. The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set. A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.  \n  \n> [!NOTE]\n>  Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.  \n  \n [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]\n [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  \n  \n## Using Parameters with an OleDbCommand or OdbcCommand  \n When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure. The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order. In addition, return value parameters must be the first parameters added to the `Parameters` collection.  \n  \n The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure. In this case, you must use the question mark (?) placeholder, as in the following example.  \n  \n```  \nSELECT * FROM Customers WHERE CustomerID = ?  \n```  \n  \n As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ? placeholder for the parameter.  \n  \n### OleDb Example  \n  \n```vb  \nDim command As OleDbCommand = New OleDbCommand( _  \n  \"SampleProc\", connection)  \ncommand.CommandType = CommandType.StoredProcedure  \n  \nDim parameter As OleDbParameter = command.Parameters.Add( _  \n  \"RETURN_VALUE\", OleDbType.Integer)  \nparameter.Direction = ParameterDirection.ReturnValue  \n  \nparameter = command.Parameters.Add( _  \n  \"@InputParm\", OleDbType.VarChar, 12)  \nparameter.Value = \"Sample Value\"  \n  \nparameter = command.Parameters.Add( _  \n  \"@OutputParm\", OleDbType.VarChar, 28)  \nparameter.Direction = ParameterDirection.Output  \n```  \n  \n```csharp  \nOleDbCommand command = new OleDbCommand(\"SampleProc\", connection);  \ncommand.CommandType = CommandType.StoredProcedure;  \n  \nOleDbParameter parameter = command.Parameters.Add(  \n  \"RETURN_VALUE\", OleDbType.Integer);  \nparameter.Direction = ParameterDirection.ReturnValue;  \n  \nparameter = command.Parameters.Add(  \n  \"@InputParm\", OleDbType.VarChar, 12);  \nparameter.Value = \"Sample Value\";  \n  \nparameter = command.Parameters.Add(  \n  \"@OutputParm\", OleDbType.VarChar, 28);  \nparameter.Direction = ParameterDirection.Output;  \n```  \n  \n## Odbc Example  \n  \n```vb  \nDim command As OdbcCommand = New OdbcCommand( _  \n  \"{ ? = CALL SampleProc(?, ?) }\", connection)  \ncommand.CommandType = CommandType.StoredProcedure  \n  \nDim parameter As OdbcParameter = command.Parameters.Add(\"RETURN_VALUE\", OdbcType.Int)  \nparameter.Direction = ParameterDirection.ReturnValue  \n  \nparameter = command.Parameters.Add( _  \n  \"@InputParm\", OdbcType.VarChar, 12)  \nparameter.Value = \"Sample Value\"  \n  \nparameter = command.Parameters.Add( _  \n  \"@OutputParm\", OdbcType.VarChar, 28)  \nparameter.Direction = ParameterDirection.Output  \n```  \n  \n```csharp  \nOdbcCommand command = new OdbcCommand( _  \n  \"{ ? = CALL SampleProc(?, ?) }\", connection);  \ncommand.CommandType = CommandType.StoredProcedure;  \n  \nOdbcParameter parameter = command.Parameters.Add( _  \n  \"RETURN_VALUE\", OdbcType.Int);  \nparameter.Direction = ParameterDirection.ReturnValue;  \n  \nparameter = command.Parameters.Add( _  \n  \"@InputParm\", OdbcType.VarChar, 12);  \nparameter.Value = \"Sample Value\";  \n  \nparameter = command.Parameters.Add( _  \n  \"@OutputParm\", OdbcType.VarChar, 28);  \nparameter.Direction = ParameterDirection.Output;  \n```  \n  \n## See Also  \n [Commands and Parameters](../../../../docs/framework/data/adonet/commands-and-parameters.md)   \n [DataAdapter Parameters](../../../../docs/framework/data/adonet/dataadapter-parameters.md)   \n [Data Type Mappings in ADO.NET](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[12,76],"content":"Configuring Parameters and Parameter Data Types | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Configuring Parameters and Parameter Data Types | Microsoft Docs","pos":[0,64]}]},{"pos":[385,432],"content":"Configuring Parameters and Parameter Data Types","linkify":"Configuring Parameters and Parameter Data Types","nodes":[{"content":"Configuring Parameters and Parameter Data Types","pos":[0,47]}]},{"content":"Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.","pos":[433,558]},{"content":"Unlike command text, parameter input is treated as a literal value, not as executable code.","pos":[559,650]},{"content":"This helps guard against \"SQL injection\" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.","pos":[651,802]},{"content":"Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.","pos":[809,986]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Execution Plan Caching and Reuse<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=120424)</ept> and <bpt id=\"p2\">[</bpt>Parameters and Execution Plan Reuse<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=120423)</ept> in SQL Server Books Online.","pos":[987,1211],"source":" For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online."},{"content":"In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.","pos":[1212,1363]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Data.Common.DbParameter&gt;</ph> object can be created by using its constructor, or by adding it to the <ph id=\"ph2\">&lt;xref:System.Data.Common.DbCommand.DbParameterCollection%2A&gt;</ph> by calling the <ph id=\"ph3\">`Add`</ph> method of the <ph id=\"ph4\">&lt;xref:System.Data.Common.DbParameterCollection&gt;</ph> collection.","pos":[1370,1636],"source":"A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection."},{"content":"The <ph id=\"ph1\">`Add`</ph> method will take as input either constructor arguments or an existing parameter object, depending on the data provider.","pos":[1637,1766],"source":" The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider."},{"pos":[1775,1816],"content":"Supplying the ParameterDirection Property","linkify":"Supplying the ParameterDirection Property","nodes":[{"content":"Supplying the ParameterDirection Property","pos":[0,41]}]},{"content":"When adding parameters, you must supply a <ph id=\"ph1\">&lt;xref:System.Data.ParameterDirection&gt;</ph> property for parameters other than input parameters.","pos":[1820,1952],"source":"When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters."},{"content":"The following table shows the <ph id=\"ph1\">`ParameterDirection`</ph> values that you can use with the <ph id=\"ph2\">&lt;xref:System.Data.ParameterDirection&gt;</ph> enumeration.","pos":[1953,2087],"source":" The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration."},{"content":"Member name","pos":[2094,2105]},{"content":"Description","pos":[2106,2117]},{"content":"The parameter is an input parameter.","pos":[2200,2236]},{"content":"This is the default.","pos":[2237,2257]},{"content":"The parameter can perform both input and output.","pos":[2300,2348]},{"content":"The parameter is an output parameter.","pos":[2391,2428]},{"content":"The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.","pos":[2471,2601]},{"pos":[2611,2646],"content":"Working with Parameter Placeholders","linkify":"Working with Parameter Placeholders","nodes":[{"content":"Working with Parameter Placeholders","pos":[0,35]}]},{"content":"The syntax for parameter placeholders depends on the data source.","pos":[2650,2715]},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data providers handle naming and specifying parameters and parameter placeholders differently.","pos":[2716,2878],"source":" The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently."},{"content":"This syntax is customized to a specific data source, as described in the following table.","pos":[2879,2968]},{"content":"Data provider","pos":[2975,2988]},{"content":"Parameter naming syntax","pos":[2989,3012]},{"pos":[3100,3155],"content":"Uses named parameters in the format <ph id=\"ph1\">`@`</ph><bpt id=\"p1\">*</bpt>parametername<ept id=\"p1\">*</ept>.","source":"Uses named parameters in the format `@`*parametername*."},{"pos":[3185,3254],"content":"Uses positional parameter markers indicated by a question mark (<ph id=\"ph1\">`?`</ph>).","source":"Uses positional parameter markers indicated by a question mark (`?`)."},{"pos":[3283,3352],"content":"Uses positional parameter markers indicated by a question mark (<ph id=\"ph1\">`?`</ph>).","source":"Uses positional parameter markers indicated by a question mark (`?`)."},{"pos":[3389,3455],"content":"Uses named parameters in the format <ph id=\"ph1\">`:`</ph><bpt id=\"p1\">*</bpt>parmname<ept id=\"p1\">*</ept> (or <bpt id=\"p2\">*</bpt>parmname<ept id=\"p2\">*</ept>).","source":"Uses named parameters in the format `:`*parmname* (or *parmname*)."},{"pos":[3465,3496],"content":"Specifying Parameter Data Types","linkify":"Specifying Parameter Data Types","nodes":[{"content":"Specifying Parameter Data Types","pos":[0,31]}]},{"content":"The data type of a parameter is specific to the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data provider.","pos":[3500,3626],"source":"The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider."},{"content":"Specifying the type converts the value of the <ph id=\"ph1\">`Parameter`</ph> to the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data provider type before passing the value to the data source.","pos":[3627,3819],"source":" Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source."},{"content":"You may also specify the type of a <ph id=\"ph1\">`Parameter`</ph> in a generic manner by setting the <ph id=\"ph2\">`DbType`</ph> property of the <ph id=\"ph3\">`Parameter`</ph> object to a particular <ph id=\"ph4\">&lt;xref:System.Data.DbType&gt;</ph>.","pos":[3820,3988],"source":" You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>."},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data provider type of a <ph id=\"ph2\">`Parameter`</ph> object is inferred from the <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> type of the <ph id=\"ph4\">`Value`</ph> of the <ph id=\"ph5\">`Parameter`</ph> object, or from the <ph id=\"ph6\">`DbType`</ph> of the <ph id=\"ph7\">`Parameter`</ph> object.","pos":[3995,4285],"source":"The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object."},{"content":"The following table shows the inferred <ph id=\"ph1\">`Parameter`</ph> type based on the object passed as the <ph id=\"ph2\">`Parameter`</ph> value or the specified <ph id=\"ph3\">`DbType`</ph>.","pos":[4286,4420],"source":" The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`."},{"content":".NET Framework type","pos":[4427,4446]},{"content":"DbType","pos":[4447,4453]},{"content":"SqlDbType","pos":[4454,4463]},{"content":"OleDbType","pos":[4464,4473]},{"content":"OdbcType","pos":[4474,4482]},{"content":"OracleType","pos":[4483,4493]},{"content":"Boolean","pos":[4627,4634]},{"content":"Bit","pos":[4635,4638]},{"content":"Boolean","pos":[4639,4646]},{"content":"Bit","pos":[4647,4650]},{"content":"Byte","pos":[4651,4655]},{"content":"Byte","pos":[4679,4683]},{"content":"TinyInt","pos":[4684,4691]},{"content":"UnsignedTinyInt","pos":[4692,4707]},{"content":"TinyInt","pos":[4708,4715]},{"content":"Byte","pos":[4716,4720]},{"content":"byte[]","pos":[4725,4731]},{"content":"Binary","pos":[4732,4738]},{"pos":[4739,4961],"content":"VarBinary<ph id=\"ph1\">`.`</ph> This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <ph id=\"ph2\">&lt;xref:System.Data.SqlDbType&gt;</ph>.","source":"VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>."},{"content":"VarBinary","pos":[4962,4971]},{"content":"Binary","pos":[4972,4978]},{"content":"Raw","pos":[4979,4982]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from char is not supported.","pos":[5009,5077],"source":"Inferring a <xref:System.Data.SqlDbType> from char is not supported."},{"content":"Char","pos":[5078,5082]},{"content":"Char","pos":[5083,5087]},{"content":"Byte","pos":[5088,5092]},{"content":"DateTime","pos":[5120,5128]},{"content":"DateTime","pos":[5129,5137]},{"content":"DBTimeStamp","pos":[5138,5149]},{"content":"DateTime","pos":[5150,5158]},{"content":"DateTime","pos":[5159,5167]},{"content":"DateTimeOffset","pos":[5201,5215]},{"content":"DateTimeOffset in SQL Server 2008.","pos":[5216,5250]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.","pos":[5251,5384],"source":" Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008."},{"content":"DateTime","pos":[5387,5395]},{"content":"Decimal","pos":[5422,5429]},{"content":"Decimal","pos":[5430,5437]},{"content":"Decimal","pos":[5438,5445]},{"content":"Numeric","pos":[5446,5453]},{"content":"Number","pos":[5454,5460]},{"content":"Double","pos":[5486,5492]},{"content":"Float","pos":[5493,5498]},{"content":"Double","pos":[5499,5505]},{"content":"Double","pos":[5506,5512]},{"content":"Double","pos":[5513,5519]},{"content":"Single","pos":[5545,5551]},{"content":"Real","pos":[5552,5556]},{"content":"Single","pos":[5557,5563]},{"content":"Real","pos":[5564,5568]},{"content":"Float","pos":[5569,5574]},{"content":"Guid","pos":[5598,5602]},{"content":"UniqueIdentifier","pos":[5603,5619]},{"content":"Guid","pos":[5620,5624]},{"content":"UniqueIdentifier","pos":[5625,5641]},{"content":"Raw","pos":[5642,5645]},{"content":"Int16","pos":[5670,5675]},{"content":"SmallInt","pos":[5676,5684]},{"content":"SmallInt","pos":[5685,5693]},{"content":"SmallInt","pos":[5694,5702]},{"content":"Int16","pos":[5703,5708]},{"content":"Int32","pos":[5733,5738]},{"content":"Int","pos":[5739,5742]},{"content":"Int","pos":[5743,5746]},{"content":"Int","pos":[5747,5750]},{"content":"Int32","pos":[5751,5756]},{"content":"Int64","pos":[5781,5786]},{"content":"BigInt","pos":[5787,5793]},{"content":"BigInt","pos":[5794,5800]},{"content":"BigInt","pos":[5801,5807]},{"content":"Number","pos":[5808,5814]},{"content":"Object","pos":[5840,5846]},{"content":"Variant","pos":[5847,5854]},{"content":"Variant","pos":[5855,5862]},{"content":"Inferring an OdbcType from Object is not supported.","pos":[5863,5914]},{"content":"Blob","pos":[5915,5919]},{"content":"String","pos":[5945,5951]},{"content":"NVarChar.","pos":[5952,5961]},{"content":"This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.","pos":[5962,6084]},{"content":"For strings larger than 4000 characters, explicitly set the <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph>.","pos":[6085,6174],"source":" For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>."},{"content":"VarWChar","pos":[6175,6183]},{"content":"NVarChar","pos":[6184,6192]},{"content":"NVarChar","pos":[6193,6201]},{"content":"Time","pos":[6229,6233]},{"content":"Time in SQL Server 2008.","pos":[6234,6258]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.","pos":[6259,6386],"source":" Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008."},{"content":"DBTime","pos":[6387,6393]},{"content":"Time","pos":[6394,6398]},{"content":"DateTime","pos":[6399,6407]},{"content":"UInt16","pos":[6433,6439]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from UInt16 is not supported.","pos":[6440,6510],"source":"Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported."},{"content":"UnsignedSmallInt","pos":[6511,6527]},{"content":"Int","pos":[6528,6531]},{"content":"UInt16","pos":[6532,6538]},{"content":"UInt32","pos":[6564,6570]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from UInt32 is not supported.","pos":[6571,6641],"source":"Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported."},{"content":"UnsignedInt","pos":[6642,6653]},{"content":"BigInt","pos":[6654,6660]},{"content":"UInt32","pos":[6661,6667]},{"content":"UInt64","pos":[6693,6699]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from UInt64 is not supported.","pos":[6700,6770],"source":"Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported."},{"content":"UnsignedBigInt","pos":[6771,6785]},{"content":"Numeric","pos":[6786,6793]},{"content":"Number","pos":[6794,6800]},{"content":"AnsiString","pos":[6806,6816]},{"content":"VarChar","pos":[6817,6824]},{"content":"VarChar","pos":[6825,6832]},{"content":"VarChar","pos":[6833,6840]},{"content":"VarChar","pos":[6841,6848]},{"content":"AnsiStringFixedLength","pos":[6854,6875]},{"content":"Char","pos":[6876,6880]},{"content":"Char","pos":[6881,6885]},{"content":"Char","pos":[6886,6890]},{"content":"Char","pos":[6891,6895]},{"content":"Currency","pos":[6903,6911]},{"content":"Money","pos":[6912,6917]},{"content":"Currency","pos":[6918,6926]},{"pos":[6927,6984],"content":"Inferring an <ph id=\"ph1\">`OdbcType`</ph> from <ph id=\"ph2\">`Currency`</ph> is not supported.","source":"Inferring an `OdbcType` from `Currency` is not supported."},{"content":"Number","pos":[6985,6991]},{"content":"Date","pos":[6999,7003]},{"content":"Date in SQL Server 2008.","pos":[7004,7028]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.","pos":[7029,7152],"source":" Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008."},{"content":"DBDate","pos":[7153,7159]},{"content":"Date","pos":[7160,7164]},{"content":"DateTime","pos":[7165,7173]},{"content":"SByte","pos":[7181,7186]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from SByte is not supported.","pos":[7187,7256],"source":"Inferring a <xref:System.Data.SqlDbType> from SByte is not supported."},{"content":"TinyInt","pos":[7257,7264]},{"pos":[7265,7317],"content":"Inferring an <ph id=\"ph1\">`OdbcType`</ph> from SByte is not supported.","source":"Inferring an `OdbcType` from SByte is not supported."},{"content":"SByte","pos":[7318,7323]},{"content":"StringFixedLength","pos":[7329,7346]},{"content":"NChar","pos":[7347,7352]},{"content":"WChar","pos":[7353,7358]},{"content":"NChar","pos":[7359,7364]},{"content":"NChar","pos":[7365,7370]},{"content":"Time","pos":[7376,7380]},{"content":"Time in SQL Server 2008.","pos":[7381,7405]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.","pos":[7406,7529],"source":" Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008."},{"content":"DBTime","pos":[7530,7536]},{"content":"Time","pos":[7537,7541]},{"content":"DateTime","pos":[7542,7550]},{"content":"VarNumeric","pos":[7556,7566]},{"content":"Inferring a <ph id=\"ph1\">&lt;xref:System.Data.SqlDbType&gt;</ph> from VarNumeric is not supported.","pos":[7567,7641],"source":"Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported."},{"content":"VarNumeric","pos":[7642,7652]},{"pos":[7653,7710],"content":"Inferring an <ph id=\"ph1\">`OdbcType`</ph> from VarNumeric is not supported.","source":"Inferring an `OdbcType` from VarNumeric is not supported."},{"content":"Number","pos":[7711,7717]},{"content":"user-defined type (an object with <ph id=\"ph1\">&lt;xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute&gt;</ph>","pos":[7722,7822],"source":"user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>"},{"content":"Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either","pos":[7823,7981]},{"content":"SqlDbType.Udt if <ph id=\"ph1\">&lt;xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute&gt;</ph> is present, otherwise Variant","pos":[7982,8090],"source":"SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant"},{"content":"OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.","pos":[8091,8157]},{"content":"OdbcType.NVarChar","pos":[8158,8175]},{"content":"not supported","pos":[8176,8189]},{"pos":[8198,8469],"content":"[!NOTE]\n Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero. If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.","leadings":["","> "],"nodes":[{"content":" Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero. If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.","pos":[8,269],"nodes":[{"content":"Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.","pos":[1,137]},{"content":"If the result of the conversion is not representable in the destination type, an <ph id=\"ph1\">&lt;xref:System.OverflowException&gt;</ph> is thrown.","pos":[138,261],"source":" If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown."}]}]},{"pos":[8477,8920],"content":"[!NOTE]\n When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]). The null value in the system is an empty object that has no value. <xref:System.DBNull> is used to represent null values. For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).","leadings":["","> "],"nodes":[{"content":" When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]). The null value in the system is an empty object that has no value. <xref:System.DBNull> is used to represent null values. For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).","pos":[8,441],"nodes":[{"content":"When you send a null parameter value to the server, you must specify <ph id=\"ph1\">&lt;xref:System.DBNull&gt;</ph>, not <ph id=\"ph2\">`null`</ph> (<ph id=\"ph3\">`Nothing`</ph> in <ph id=\"ph4\">[!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]</ph>).","pos":[1,172],"source":" When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)])."},{"content":"The null value in the system is an empty object that has no value.","pos":[173,239]},{"content":"<ph id=\"ph1\">&lt;xref:System.DBNull&gt;</ph> is used to represent null values.","pos":[240,294],"source":"<xref:System.DBNull> is used to represent null values."},{"content":"For more information about database nulls, see <bpt id=\"p1\">[</bpt>Handling Null Values<ept id=\"p1\">](../../../../docs/framework/data/adonet/sql/handling-null-values.md)</ept>.","pos":[295,433],"source":" For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md)."}]}]},{"pos":[8929,8959],"content":"Deriving Parameter Information","linkify":"Deriving Parameter Information","nodes":[{"content":"Deriving Parameter Information","pos":[0,30]}]},{"content":"Parameters can also be derived from a stored procedure using the <ph id=\"ph1\">`DbCommandBuilder`</ph> class.","pos":[8963,9053],"source":"Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class."},{"content":"Both the <ph id=\"ph1\">`SqlCommandBuilder`</ph> and <ph id=\"ph2\">`OleDbCommandBuilder`</ph> classes provide a static method, <ph id=\"ph3\">`DeriveParameters`</ph>, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.","pos":[9054,9294],"source":" Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure."},{"content":"Note that <ph id=\"ph1\">`DeriveParameters`</ph> overwrites any existing parameter information for the command.","pos":[9295,9386],"source":" Note that `DeriveParameters` overwrites any existing parameter information for the command."},{"pos":[9394,9697],"content":"[!NOTE]\n Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information. If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.","leadings":["","> "],"nodes":[{"content":" Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information. If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.","pos":[8,301],"nodes":[{"content":"Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.","pos":[1,153]},{"content":"If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.","pos":[154,293]}]}]},{"pos":[9704,9857],"content":"For more information, see <bpt id=\"p1\">[</bpt>Generating Commands with CommandBuilders<ept id=\"p1\">](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md)</ept>.","source":"For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md)."},{"pos":[9866,9923],"content":"Using Parameters with a SqlCommand and a Stored Procedure","linkify":"Using Parameters with a SqlCommand and a Stored Procedure","nodes":[{"content":"Using Parameters with a SqlCommand and a Stored Procedure","pos":[0,57]}]},{"content":"Stored procedures offer many advantages in data-driven applications.","pos":[9927,9995]},{"content":"By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.","pos":[9996,10155]},{"content":"Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommand.Parameters%2A&gt;</ph> collection of the <ph id=\"ph2\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> <ph id=\"ph3\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.","pos":[10156,10587],"source":" Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values."},{"pos":[10595,10965],"content":"[!NOTE]\n Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse. Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`. Changes in database context last only to the end of the `sp_executesql` statement. For more information, see SQL Server Books Online.","leadings":["","> "],"nodes":[{"content":" Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse. Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`. Changes in database context last only to the end of the `sp_executesql` statement. For more information, see SQL Server Books Online.","pos":[8,368],"nodes":[{"content":"Parameterized statements are executed on the server by using <ph id=\"ph1\">`sp_executesql,`</ph> which allows for query plan reuse.","pos":[1,113],"source":" Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse."},{"content":"Local cursors or variables in the <ph id=\"ph1\">`sp_executesql`</ph> batch are not visible to the batch that calls <ph id=\"ph2\">`sp_executesql`</ph>.","pos":[114,226],"source":" Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`."},{"content":"Changes in database context last only to the end of the <ph id=\"ph1\">`sp_executesql`</ph> statement.","pos":[227,309],"source":" Changes in database context last only to the end of the `sp_executesql` statement."},{"content":"For more information, see SQL Server Books Online.","pos":[310,360]}]}]},{"content":"When using parameters with a <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand&gt;</ph> to execute a SQL Server stored procedure, the names of the parameters added to the <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlCommand.Parameters%2A&gt;</ph> collection must match the names of the parameter markers in the stored procedure.","pos":[10972,11259],"source":"When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure."},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.","pos":[11260,11473],"source":" The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure."},{"content":"It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.","pos":[11474,11583]},{"content":"For example, the <ph id=\"ph1\">`CustOrderHist`</ph> stored procedure is defined by using a parameter named <ph id=\"ph2\">`@CustomerID`</ph>.","pos":[11584,11686],"source":" For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`."},{"content":"When your code executes the stored procedure, it must also use a parameter named <ph id=\"ph1\">`@CustomerID`</ph>.","pos":[11687,11782],"source":" When your code executes the stored procedure, it must also use a parameter named `@CustomerID`."},{"pos":[11867,11874],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example demonstrates how to call a SQL Server stored procedure in the <ph id=\"ph1\">`Northwind`</ph> sample database.","pos":[11878,11981],"source":"This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database."},{"content":"The name of the stored procedure is <ph id=\"ph1\">`dbo.SalesByCategory`</ph> and it has an input parameter named <ph id=\"ph2\">`@CategoryName`</ph> with a data type of <ph id=\"ph3\">`nvarchar(15)`</ph>.","pos":[11982,12127],"source":" The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`."},{"content":"The code creates a new <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph> inside a using block so that the connection is disposed when the procedure ends.","pos":[12128,12274],"source":" The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlParameter&gt;</ph> objects are created, and their properties set.","pos":[12275,12411],"source":" The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataReader&gt;</ph> executes the <ph id=\"ph2\">`SqlCommand`</ph> and returns the result set from the stored procedure, displaying the output in the console window.","pos":[12412,12581],"source":" A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window."},{"pos":[12589,12825],"content":"[!NOTE]\n Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.","leadings":["","> "],"nodes":[{"content":"Instead of creating <ph id=\"ph1\">`SqlCommand`</ph> and <ph id=\"ph2\">`SqlParameter`</ph> objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.","pos":[9,234],"source":" Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement."}]},{"pos":[12832,13157],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks SqlClient.StoredProcedure#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks SqlClient.StoredProcedure#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]\n [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]"},{"pos":[13166,13218],"content":"Using Parameters with an OleDbCommand or OdbcCommand","linkify":"Using Parameters with an OleDbCommand or OdbcCommand","nodes":[{"content":"Using Parameters with an OleDbCommand or OdbcCommand","pos":[0,52]}]},{"content":"When using parameters with an <ph id=\"ph1\">&lt;xref:System.Data.OleDb.OleDbCommand&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.Odbc.OdbcCommand&gt;</ph>, the order of the parameters added to the <ph id=\"ph3\">`Parameters`</ph> collection must match the order of the parameters defined in your stored procedure.","pos":[13222,13467],"source":"When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure."},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for OLE DB and <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.","pos":[13468,13743],"source":" The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order."},{"content":"In addition, return value parameters must be the first parameters added to the <ph id=\"ph1\">`Parameters`</ph> collection.","pos":[13744,13847],"source":" In addition, return value parameters must be the first parameters added to the `Parameters` collection."},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for OLE DB and <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.","pos":[13854,14135],"source":"The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure."},{"content":"In this case, you must use the question mark (?) placeholder, as in the following example.","pos":[14136,14226]},{"content":"As a result, the order in which <ph id=\"ph1\">`Parameter`</ph> objects are added to the <ph id=\"ph2\">`Parameters`</ph> collection must directly correspond to the position of the ?","pos":[14295,14437],"source":"As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?"},{"content":"placeholder for the parameter.","pos":[14438,14468]},{"pos":[14478,14491],"content":"OleDb Example","linkify":"OleDb Example","nodes":[{"content":"OleDb Example","pos":[0,13]}]},{"pos":[15613,15625],"content":"Odbc Example","linkify":"Odbc Example","nodes":[{"content":"Odbc Example","pos":[0,12]}]},{"pos":[16771,16779],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Commands and Parameters<ept id=\"p1\">](../../../../docs/framework/data/adonet/commands-and-parameters.md)</ept><ph id=\"ph1\"> </ph>","pos":[16783,16876],"source":"[Commands and Parameters](../../../../docs/framework/data/adonet/commands-and-parameters.md) "},{"content":"<bpt id=\"p1\"> [</bpt>DataAdapter Parameters<ept id=\"p1\">](../../../../docs/framework/data/adonet/dataadapter-parameters.md)</ept><ph id=\"ph1\"> </ph>","pos":[16879,16971],"source":" [DataAdapter Parameters](../../../../docs/framework/data/adonet/dataadapter-parameters.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Data Type Mappings in ADO.NET<ept id=\"p1\">](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)</ept><ph id=\"ph1\"> </ph>","pos":[16974,17080],"source":" [Data Type Mappings in ADO.NET](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[17083,17187],"source":" [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}