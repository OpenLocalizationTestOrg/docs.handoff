{"content":"---\ntitle: \"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: e243e694-c987-43aa-8b22-1e33dace582c\n---\n# Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)\nYou can add content (elements, attributes, comments, processing instructions, text, and CDATA) to an existing XML tree.  \n  \n## Methods for Adding Content  \n The following methods add child content to an <xref:System.Xml.Linq.XElement> or an <xref:System.Xml.Linq.XDocument>:  \n  \n|Method|Description|  \n|------------|-----------------|  \n|<xref:System.Xml.Linq.XContainer.Add%2A>|Adds content at the end of the child content of the <xref:System.Xml.Linq.XContainer>.|  \n|<xref:System.Xml.Linq.XContainer.AddFirst%2A>|Adds content at the beginning of the child content of the <xref:System.Xml.Linq.XContainer>.|  \n  \n The following methods add content as sibling nodes of an <xref:System.Xml.Linq.XNode>. The most common node to which you add sibling content is <xref:System.Xml.Linq.XElement>, although you can add valid sibling content to other types of nodes such as <xref:System.Xml.Linq.XText> or <xref:System.Xml.Linq.XComment>.  \n  \n|Method|Description|  \n|------------|-----------------|  \n|<xref:System.Xml.Linq.XNode.AddAfterSelf%2A>|Adds content after the <xref:System.Xml.Linq.XNode>.|  \n|<xref:System.Xml.Linq.XNode.AddBeforeSelf%2A>|Adds content before the <xref:System.Xml.Linq.XNode>.|  \n  \n## Example  \n  \n### Description  \n The following example creates two XML trees, and then modifies one of the trees.  \n  \n### Code  \n  \n```vb  \nDim srcTree As XElement = _  \n    <Root>  \n        <Element1>1</Element1>  \n        <Element2>2</Element2>  \n        <Element3>3</Element3>  \n        <Element4>4</Element4>  \n        <Element5>5</Element5>  \n    </Root>  \nDim xmlTree As XElement = _  \n    <Root>  \n        <Child1>1</Child1>  \n        <Child2>2</Child2>  \n        <Child3>3</Child3>  \n        <Child4>4</Child4>  \n        <Child5>5</Child5>  \n    </Root>  \n  \nxmlTree.Add(<NewChild>new content</NewChild>)  \nxmlTree.Add( _  \n    From el In srcTree.Elements() _  \n    Where CInt(el) > 3 _  \n    Select el)  \n  \n' Even though Child9 does not exist in srcTree, the following statement  \n' will not throw an exception, and nothing will be added to xmlTree.  \nxmlTree.Add(srcTree.Element(\"Child9\"))  \nConsole.WriteLine(xmlTree)  \n```  \n  \n### Comments  \n This code produces the following output:  \n  \n```xml  \n<Root>  \n  <Child1>1</Child1>  \n  <Child2>2</Child2>  \n  <Child3>3</Child3>  \n  <Child4>4</Child4>  \n  <Child5>5</Child5>  \n  <NewChild>new content</NewChild>  \n  <Element4>4</Element4>  \n  <Element5>5</Element5>  \n</Root>  \n```  \n  \n## See also\n\n- [Modifying XML Trees (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/modifying-xml-trees-linq-to-xml.md)\n","nodes":[{"pos":[4,150],"embed":true,"restype":"x-metadata","content":"title: \"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: e243e694-c987-43aa-8b22-1e33dace582c","nodes":[{"content":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","nodes":[{"pos":[0,68],"content":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","nodes":[{"content":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","pos":[0,68]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[157,225],"content":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","linkify":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","nodes":[{"content":"Adding Elements, Attributes, and Nodes to an XML Tree (Visual Basic)","pos":[0,68]}]},{"content":"You can add content (elements, attributes, comments, processing instructions, text, and CDATA) to an existing XML tree.","pos":[226,345]},{"pos":[354,380],"content":"Methods for Adding Content","linkify":"Methods for Adding Content","nodes":[{"content":"Methods for Adding Content","pos":[0,26]}]},{"pos":[384,501],"content":"The following methods add child content to an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or an <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>:","source":"The following methods add child content to an <xref:System.Xml.Linq.XElement> or an <xref:System.Xml.Linq.XDocument>:"},{"content":"Method","pos":[508,514]},{"content":"Description","pos":[515,526]},{"pos":[607,693],"content":"Adds content at the end of the child content of the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XContainer&gt;</ph>.","source":"Adds content at the end of the child content of the <xref:System.Xml.Linq.XContainer>."},{"pos":[744,836],"content":"Adds content at the beginning of the child content of the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XContainer&gt;</ph>.","source":"Adds content at the beginning of the child content of the <xref:System.Xml.Linq.XContainer>."},{"content":"The following methods add content as sibling nodes of an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph>.","pos":[844,930],"source":"The following methods add content as sibling nodes of an <xref:System.Xml.Linq.XNode>."},{"content":"The most common node to which you add sibling content is <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>, although you can add valid sibling content to other types of nodes such as <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XText&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XComment&gt;</ph>.","pos":[931,1160],"source":" The most common node to which you add sibling content is <xref:System.Xml.Linq.XElement>, although you can add valid sibling content to other types of nodes such as <xref:System.Xml.Linq.XText> or <xref:System.Xml.Linq.XComment>."},{"content":"Method","pos":[1167,1173]},{"content":"Description","pos":[1174,1185]},{"pos":[1270,1322],"content":"Adds content after the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph>.","source":"Adds content after the <xref:System.Xml.Linq.XNode>."},{"pos":[1373,1426],"content":"Adds content before the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph>.","source":"Adds content before the <xref:System.Xml.Linq.XNode>."},{"pos":[1436,1443],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1453,1464],"content":"Description","linkify":"Description","nodes":[{"content":"Description","pos":[0,11]}]},{"content":"The following example creates two XML trees, and then modifies one of the trees.","pos":[1468,1548]},{"pos":[1558,1562],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[2381,2389],"content":"Comments","linkify":"Comments","nodes":[{"content":"Comments","pos":[0,8]}]},{"content":"This code produces the following output:","pos":[2393,2433]},{"pos":[2685,2693],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2697,2840],"content":"<bpt id=\"p1\">[</bpt>Modifying XML Trees (LINQ to XML) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/modifying-xml-trees-linq-to-xml.md)</ept>","source":"[Modifying XML Trees (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/modifying-xml-trees-linq-to-xml.md)"}]}