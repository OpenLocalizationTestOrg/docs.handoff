{"content":"---\ntitle: \"Aggregate Canonical Functions\"\nms.date: \"03/30/2017\"\nms.assetid: 3bcff826-ca90-41b3-a791-04d6ff0e5085\n---\n\n# Aggregate Canonical Functions\n\nAggregates are expressions that reduce a series of input values into, for example, a single value. Aggregates are normally used in conjunction with the GROUP BY clause of the SELECT expression, and there are constraints on where they can be used.\n\n## Aggregate Entity SQL canonical functions\n\nThe following are the aggregate Entity SQL canonical functions.\n\n### Avg(expression)\n\nReturns the average of the non-null values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, and `Decimal`.\n\n**Return Value**\n\nThe type of `expression`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_AVG](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_avg)]\n[!code-sql[DP EntityServices Concepts#EDM_AVG](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_avg)]\n\n### BigCount(expression)\n\nReturns the size of the aggregate including null and duplicate values.\n\n**Arguments**\n\nAny type.\n\n**Return Value**\n\nAn `Int64`.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_BIGCOUNT](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_bigcount)]\n[!code-sql[DP EntityServices Concepts#EDM_BIGCOUNT](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_bigcount)]\n\n### Count(expression)\n\nReturns the size of the aggregate including null and duplicate values.\n\n**Arguments**\n\nAny type.\n\n**Return Value**\n\nAn `Int32`.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_COUNT](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_count)]\n[!code-sql[DP EntityServices Concepts#EDM_COUNT](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_count)]\n\n### Max(expression)\n\nReturns the maximum of the non-null values.\n\n**Arguments**\n\nA `Byte`, `Int16`, `Int32`, `Int64`, `Byte`, `Single`, `Double`, `Decimal`, `DateTime`, `DateTimeOffset`, `Time`, `String`, `Binary`.\n\n**Return Value**\n\nThe type of `expression`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_MAX](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_max)]\n[!code-sql[DP EntityServices Concepts#EDM_MAX](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_max)]\n\n### Min(expression)\n\nReturns the minimum of the non-null values.\n\n**Arguments**\n\nA `Byte`, `Int16`, `Int32`, `Int64`, `Byte`, `Single`, `Double`, `Decimal`, `DateTime`, `DateTimeOffset`, `Time`, `String`, `Binary`.\n\n**Return Value**\n\nThe type of `expression`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_MIN](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_min)]\n[!code-sql[DP EntityServices Concepts#EDM_MIN](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_min)]\n\n### StDev(expression)\n\nReturns the standard deviation of the non-null values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, `Decimal`.\n\n**Return Value**\n\nA `Double`. `Null`, if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_STDEV](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_stdev)]\n[!code-sql[DP EntityServices Concepts#EDM_STDEV](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_stdev)]\n\n### StDevP(expression)\n\nReturns the standard deviation for the population of all values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, `Decimal`.\n\n**Return Value**\n\nA `Double`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_STDEVP](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_stdevp)]\n[!code-sql[DP EntityServices Concepts#EDM_STDEVP](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_stdevp)]\n\n### Sum(expression)\n\nReturns the sum of the non-null values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, `Decimal`.\n\n**Return Value**\n\nA `Double`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_SUM](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_sum)]\n[!code-sql[DP EntityServices Concepts#EDM_SUM](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_sum)]\n\n### Var(expression)\n\nReturns the variance of all non-null values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, `Decimal`.\n\n**Return Value**\n\nA `Double`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_VAR](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_var)]\n[!code-sql[DP EntityServices Concepts#EDM_VAR](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_var)]\n\n### VarP(expression)\n\nReturns the variance for the population of all non-null values.\n\n**Arguments**\n\nAn `Int32`, `Int64`, `Double`, `Decimal`.\n\n**Return Value**\n\nA `Double`, or `null` if all input values are `null` values.\n\n**Example**\n\n[!code-csharp[DP EntityServices Concepts#EDM_VARP](~/samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts/cs/entitysql.cs#edm_varp)]\n[!code-sql[DP EntityServices Concepts#EDM_VARP](~/samples/snippets/tsql/VS_Snippets_Data/dp entityservices concepts/tsql/entitysql.sql#edm_varp)]\n\nEquivalent functionality is available in the Microsoft SQL Client Managed Provider. For more information, see [SqlClient for Entity Framework Functions](../../../../../../docs/framework/data/adonet/ef/sqlclient-for-ef-functions.md).\n\n## Collection-based aggregates\n\nCollection-based aggregates (collection functions) operate on collections and return a value. For example if ORDERS is a collection of all orders, you can calculate the earliest ship date with the following expression:\n\n```sql\nmin(select value o.ShipDate from LOB.Orders as o)\n```\n\nExpressions inside collection-based aggregates are evaluated within the current ambient name-resolution scope.\n\n## Group-based aggregates\n\nGroup-based aggregates are calculated over a group as defined by the GROUP BY clause. For each group in the result, a separate aggregate is calculated by using the elements in each group as input to the aggregate calculation. When a group-by clause is used in a select expression, only grouping expression names, aggregates, or constant expressions can be present in the projection or order-by clause.\n\nThe following example calculates the average quantity ordered for each product:\n\n```sql\nselect p, avg(ol.Quantity) from LOB.OrderLines as ol\n  group by ol.Product as p\n```\n\nIt's possible to have a group-based aggregate without an explicit group-by clause in the SELECT expression. In this case, all elements are treated as a single group. This is equivalent of specifying a grouping based on a constant. Take, for example, the following expression:\n\n```sql\nselect avg(ol.Quantity) from LOB.OrderLines as ol\n```\n\nThis is equivalent to the following:\n\n```sql\nselect avg(ol.Quantity) from LOB.OrderLines as ol group by 1\n```\n\nExpressions inside the group-based aggregate are evaluated within the name-resolution scope that would be visible to the WHERE clause expression.\n\nAs in [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)], group-based aggregates can also specify an ALL or DISTINCT modifier. If the DISTINCT modifier is specified, duplicates are eliminated from the aggregate input collection, before the aggregate is computed. If the ALL modifier is specified (or if no modifier is specified), no duplicate elimination is performed.\n\n## See also\n\n- [Canonical Functions](../../../../../../docs/framework/data/adonet/ef/language-reference/canonical-functions.md)\n","nodes":[{"pos":[4,113],"embed":true,"restype":"x-metadata","content":"title: \"Aggregate Canonical Functions\"\nms.date: \"03/30/2017\"\nms.assetid: 3bcff826-ca90-41b3-a791-04d6ff0e5085","nodes":[{"content":"Aggregate Canonical Functions","nodes":[{"pos":[0,29],"content":"Aggregate Canonical Functions","nodes":[{"content":"Aggregate Canonical Functions","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[121,150],"content":"Aggregate Canonical Functions","linkify":"Aggregate Canonical Functions","nodes":[{"content":"Aggregate Canonical Functions","pos":[0,29]}]},{"content":"Aggregates are expressions that reduce a series of input values into, for example, a single value.","pos":[152,250]},{"content":"Aggregates are normally used in conjunction with the GROUP BY clause of the SELECT expression, and there are constraints on where they can be used.","pos":[251,398]},{"pos":[403,443],"content":"Aggregate Entity SQL canonical functions","linkify":"Aggregate Entity SQL canonical functions","nodes":[{"content":"Aggregate Entity SQL canonical functions","pos":[0,40]}]},{"content":"The following are the aggregate Entity SQL canonical functions.","pos":[445,508]},{"pos":[514,529],"content":"Avg(expression)","linkify":"Avg(expression)","nodes":[{"content":"Avg(expression)","pos":[0,15]}]},{"content":"Returns the average of the non-null values.","pos":[531,574]},{"pos":[576,589],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[591,636],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, and <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, and `Decimal`."},{"pos":[638,654],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[656,730],"content":"The type of <ph id=\"ph1\">`expression`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"The type of `expression`, or `null` if all input values are `null` values."},{"pos":[732,743],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[1040,1060],"content":"BigCount(expression)","linkify":"BigCount(expression)","nodes":[{"content":"BigCount(expression)","pos":[0,20]}]},{"content":"Returns the size of the aggregate including null and duplicate values.","pos":[1062,1132]},{"pos":[1134,1147],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"content":"Any type.","pos":[1149,1158]},{"pos":[1160,1176],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[1178,1189],"content":"An <ph id=\"ph1\">`Int64`</ph>.","source":"An `Int64`."},{"pos":[1191,1202],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[1519,1536],"content":"Count(expression)","linkify":"Count(expression)","nodes":[{"content":"Count(expression)","pos":[0,17]}]},{"content":"Returns the size of the aggregate including null and duplicate values.","pos":[1538,1608]},{"pos":[1610,1623],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"content":"Any type.","pos":[1625,1634]},{"pos":[1636,1652],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[1654,1665],"content":"An <ph id=\"ph1\">`Int32`</ph>.","source":"An `Int32`."},{"pos":[1667,1678],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[1983,1998],"content":"Max(expression)","linkify":"Max(expression)","nodes":[{"content":"Max(expression)","pos":[0,15]}]},{"content":"Returns the maximum of the non-null values.","pos":[2000,2043]},{"pos":[2045,2058],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[2060,2193],"content":"A <ph id=\"ph1\">`Byte`</ph>, <ph id=\"ph2\">`Int16`</ph>, <ph id=\"ph3\">`Int32`</ph>, <ph id=\"ph4\">`Int64`</ph>, <ph id=\"ph5\">`Byte`</ph>, <ph id=\"ph6\">`Single`</ph>, <ph id=\"ph7\">`Double`</ph>, <ph id=\"ph8\">`Decimal`</ph>, <ph id=\"ph9\">`DateTime`</ph>, <ph id=\"ph10\">`DateTimeOffset`</ph>, <ph id=\"ph11\">`Time`</ph>, <ph id=\"ph12\">`String`</ph>, <ph id=\"ph13\">`Binary`</ph>.","source":"A `Byte`, `Int16`, `Int32`, `Int64`, `Byte`, `Single`, `Double`, `Decimal`, `DateTime`, `DateTimeOffset`, `Time`, `String`, `Binary`."},{"pos":[2195,2211],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[2213,2287],"content":"The type of <ph id=\"ph1\">`expression`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"The type of `expression`, or `null` if all input values are `null` values."},{"pos":[2289,2300],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[2597,2612],"content":"Min(expression)","linkify":"Min(expression)","nodes":[{"content":"Min(expression)","pos":[0,15]}]},{"content":"Returns the minimum of the non-null values.","pos":[2614,2657]},{"pos":[2659,2672],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[2674,2807],"content":"A <ph id=\"ph1\">`Byte`</ph>, <ph id=\"ph2\">`Int16`</ph>, <ph id=\"ph3\">`Int32`</ph>, <ph id=\"ph4\">`Int64`</ph>, <ph id=\"ph5\">`Byte`</ph>, <ph id=\"ph6\">`Single`</ph>, <ph id=\"ph7\">`Double`</ph>, <ph id=\"ph8\">`Decimal`</ph>, <ph id=\"ph9\">`DateTime`</ph>, <ph id=\"ph10\">`DateTimeOffset`</ph>, <ph id=\"ph11\">`Time`</ph>, <ph id=\"ph12\">`String`</ph>, <ph id=\"ph13\">`Binary`</ph>.","source":"A `Byte`, `Int16`, `Int32`, `Int64`, `Byte`, `Single`, `Double`, `Decimal`, `DateTime`, `DateTimeOffset`, `Time`, `String`, `Binary`."},{"pos":[2809,2825],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[2827,2901],"content":"The type of <ph id=\"ph1\">`expression`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"The type of `expression`, or `null` if all input values are `null` values."},{"pos":[2903,2914],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[3211,3228],"content":"StDev(expression)","linkify":"StDev(expression)","nodes":[{"content":"StDev(expression)","pos":[0,17]}]},{"content":"Returns the standard deviation of the non-null values.","pos":[3230,3284]},{"pos":[3286,3299],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[3301,3342],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, `Decimal`."},{"pos":[3344,3360],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"content":"A <ph id=\"ph1\">`Double`</ph>.","pos":[3362,3373],"source":"A `Double`."},{"content":"<ph id=\"ph1\">`Null`</ph>, if all input values are <ph id=\"ph2\">`null`</ph> values.","pos":[3374,3420],"source":"`Null`, if all input values are `null` values."},{"pos":[3422,3433],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[3738,3756],"content":"StDevP(expression)","linkify":"StDevP(expression)","nodes":[{"content":"StDevP(expression)","pos":[0,18]}]},{"content":"Returns the standard deviation for the population of all values.","pos":[3758,3822]},{"pos":[3824,3837],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[3839,3880],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, `Decimal`."},{"pos":[3882,3898],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[3900,3960],"content":"A <ph id=\"ph1\">`Double`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"A `Double`, or `null` if all input values are `null` values."},{"pos":[3962,3973],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[4282,4297],"content":"Sum(expression)","linkify":"Sum(expression)","nodes":[{"content":"Sum(expression)","pos":[0,15]}]},{"content":"Returns the sum of the non-null values.","pos":[4299,4338]},{"pos":[4340,4353],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[4355,4396],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, `Decimal`."},{"pos":[4398,4414],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[4416,4476],"content":"A <ph id=\"ph1\">`Double`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"A `Double`, or `null` if all input values are `null` values."},{"pos":[4478,4489],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[4786,4801],"content":"Var(expression)","linkify":"Var(expression)","nodes":[{"content":"Var(expression)","pos":[0,15]}]},{"content":"Returns the variance of all non-null values.","pos":[4803,4847]},{"pos":[4849,4862],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[4864,4905],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, `Decimal`."},{"pos":[4907,4923],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[4925,4985],"content":"A <ph id=\"ph1\">`Double`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"A `Double`, or `null` if all input values are `null` values."},{"pos":[4987,4998],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[5295,5311],"content":"VarP(expression)","linkify":"VarP(expression)","nodes":[{"content":"VarP(expression)","pos":[0,16]}]},{"content":"Returns the variance for the population of all non-null values.","pos":[5313,5376]},{"pos":[5378,5391],"content":"<bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept>","source":"**Arguments**"},{"pos":[5393,5434],"content":"An <ph id=\"ph1\">`Int32`</ph>, <ph id=\"ph2\">`Int64`</ph>, <ph id=\"ph3\">`Double`</ph>, <ph id=\"ph4\">`Decimal`</ph>.","source":"An `Int32`, `Int64`, `Double`, `Decimal`."},{"pos":[5436,5452],"content":"<bpt id=\"p1\">**</bpt>Return Value<ept id=\"p1\">**</ept>","source":"**Return Value**"},{"pos":[5454,5514],"content":"A <ph id=\"ph1\">`Double`</ph>, or <ph id=\"ph2\">`null`</ph> if all input values are <ph id=\"ph3\">`null`</ph> values.","source":"A `Double`, or `null` if all input values are `null` values."},{"pos":[5516,5527],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"content":"Equivalent functionality is available in the Microsoft SQL Client Managed Provider.","pos":[5824,5907]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>SqlClient for Entity Framework Functions<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/sqlclient-for-ef-functions.md)</ept>.","pos":[5908,6056],"source":" For more information, see [SqlClient for Entity Framework Functions](../../../../../../docs/framework/data/adonet/ef/sqlclient-for-ef-functions.md)."},{"pos":[6061,6088],"content":"Collection-based aggregates","linkify":"Collection-based aggregates","nodes":[{"content":"Collection-based aggregates","pos":[0,27]}]},{"content":"Collection-based aggregates (collection functions) operate on collections and return a value.","pos":[6090,6183]},{"content":"For example if ORDERS is a collection of all orders, you can calculate the earliest ship date with the following expression:","pos":[6184,6308]},{"content":"Expressions inside collection-based aggregates are evaluated within the current ambient name-resolution scope.","pos":[6372,6482]},{"pos":[6487,6509],"content":"Group-based aggregates","linkify":"Group-based aggregates","nodes":[{"content":"Group-based aggregates","pos":[0,22]}]},{"content":"Group-based aggregates are calculated over a group as defined by the GROUP BY clause.","pos":[6511,6596]},{"content":"For each group in the result, a separate aggregate is calculated by using the elements in each group as input to the aggregate calculation.","pos":[6597,6736]},{"content":"When a group-by clause is used in a select expression, only grouping expression names, aggregates, or constant expressions can be present in the projection or order-by clause.","pos":[6737,6912]},{"content":"The following example calculates the average quantity ordered for each product:","pos":[6914,6993]},{"content":"It's possible to have a group-based aggregate without an explicit group-by clause in the SELECT expression.","pos":[7087,7194]},{"content":"In this case, all elements are treated as a single group.","pos":[7195,7252]},{"content":"This is equivalent of specifying a grouping based on a constant.","pos":[7253,7317]},{"content":"Take, for example, the following expression:","pos":[7318,7362]},{"content":"This is equivalent to the following:","pos":[7426,7462]},{"content":"Expressions inside the group-based aggregate are evaluated within the name-resolution scope that would be visible to the WHERE clause expression.","pos":[7537,7682]},{"content":"As in <ph id=\"ph1\">[!INCLUDE[tsql](../../../../../../includes/tsql-md.md)]</ph>, group-based aggregates can also specify an ALL or DISTINCT modifier.","pos":[7684,7815],"source":"As in [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)], group-based aggregates can also specify an ALL or DISTINCT modifier."},{"content":"If the DISTINCT modifier is specified, duplicates are eliminated from the aggregate input collection, before the aggregate is computed.","pos":[7816,7951]},{"content":"If the ALL modifier is specified (or if no modifier is specified), no duplicate elimination is performed.","pos":[7952,8057]},{"pos":[8062,8070],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8074,8186],"content":"<bpt id=\"p1\">[</bpt>Canonical Functions<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/canonical-functions.md)</ept>","source":"[Canonical Functions](../../../../../../docs/framework/data/adonet/ef/language-reference/canonical-functions.md)"}]}