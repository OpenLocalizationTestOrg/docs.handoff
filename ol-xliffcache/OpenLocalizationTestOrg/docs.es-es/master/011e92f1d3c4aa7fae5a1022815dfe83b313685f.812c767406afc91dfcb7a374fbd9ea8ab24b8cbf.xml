{"content":"---\ntitle: \"How to: read from comma-delimited text files in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"files, parsing\"\n  - \"text files, tasks\"\n  - \"reading text files, comma-delimited\"\n  - \"text files, reading\"\nms.assetid: a8413fe4-0dba-49c8-8692-44fb67a9ec4f\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: read from comma-delimited text files in Visual Basic\nThe `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs. The `TextFieldType` property defines whether it is a delimited file or one with fixed-width fields of text.  \n  \n### To parse a comma delimited text file  \n  \n1.  Create a new `TextFieldParser`. The following code creates the `TextFieldParser` named `MyReader` and opens the file `test.txt`.  \n  \n     [!code-vb[VbFileIORead#15](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_1.vb)]  \n  \n2.  Define the `TextField` type and delimiter. The following code defines the `TextFieldType` property as `Delimited` and the delimiter as \",\".  \n  \n     [!code-vb[VbFileIORead#16](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_2.vb)]  \n  \n3.  Loop through the fields in the file. If any lines are corrupt, report an error and continue parsing. The following code loops through the file, displaying each field in turn and reporting any fields that are formatted incorrectly.  \n  \n     [!code-vb[VbFileIORead#17](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_3.vb)]  \n  \n4.  Close the `While` and `Using` blocks with `End While` and `End Using`.  \n  \n     [!code-vb[VbFileIORead#18](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_4.vb)]  \n  \n## Example  \n This example reads from the file `test.txt`.  \n  \n [!code-vb[VbFileIORead#19](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_5.vb)]  \n  \n## Robust programming  \n The following conditions may cause an exception:  \n  \n-   A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>). The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned the text contained in the line.  \n  \n-   The specified file does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   A partial-trust situation in which the user does not have sufficient permissions to access the file. (<xref:System.Security.SecurityException>).  \n  \n-   The path is too long (<xref:System.IO.PathTooLongException>).  \n  \n-   The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>).  \n  \n## See also  \n <xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName>   \n [How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)   \n [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)   \n [Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)   \n [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)   \n [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)","nodes":[{"pos":[12,89],"content":"How to: read from comma-delimited text files in Visual Basic | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: read from comma-delimited text files in Visual Basic | Microsoft Docs","pos":[0,77]}]},{"pos":[697,757],"content":"How to: read from comma-delimited text files in Visual Basic","linkify":"How to: read from comma-delimited text files in Visual Basic","nodes":[{"content":"How to: read from comma-delimited text files in Visual Basic","pos":[0,60]}]},{"content":"The <ph id=\"ph1\">`TextFieldParser`</ph> object provides a way to easily and efficiently parse structured text files, such as logs.","pos":[758,870],"source":"The `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs."},{"content":"The <ph id=\"ph1\">`TextFieldType`</ph> property defines whether it is a delimited file or one with fixed-width fields of text.","pos":[871,978],"source":" The `TextFieldType` property defines whether it is a delimited file or one with fixed-width fields of text."},{"pos":[988,1024],"content":"To parse a comma delimited text file","linkify":"To parse a comma delimited text file","nodes":[{"content":"To parse a comma delimited text file","pos":[0,36]}]},{"content":"Create a new <ph id=\"ph1\">`TextFieldParser`</ph>.","pos":[1034,1065],"source":"Create a new `TextFieldParser`."},{"content":"The following code creates the <ph id=\"ph1\">`TextFieldParser`</ph> named <ph id=\"ph2\">`MyReader`</ph> and opens the file <ph id=\"ph3\">`test.txt`</ph>.","pos":[1066,1162],"source":" The following code creates the `TextFieldParser` named `MyReader` and opens the file `test.txt`."},{"pos":[1173,1352],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#15<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#15](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_1.vb)]"},{"content":"Define the <ph id=\"ph1\">`TextField`</ph> type and delimiter.","pos":[1362,1404],"source":"Define the `TextField` type and delimiter."},{"content":"The following code defines the <ph id=\"ph1\">`TextFieldType`</ph> property as <ph id=\"ph2\">`Delimited`</ph> and the delimiter as \",\".","pos":[1405,1501],"source":" The following code defines the `TextFieldType` property as `Delimited` and the delimiter as \",\"."},{"pos":[1512,1691],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#16<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#16](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_2.vb)]"},{"content":"Loop through the fields in the file.","pos":[1701,1737]},{"content":"If any lines are corrupt, report an error and continue parsing.","pos":[1738,1801]},{"content":"The following code loops through the file, displaying each field in turn and reporting any fields that are formatted incorrectly.","pos":[1802,1931]},{"pos":[1942,2121],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#17<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#17](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_3.vb)]"},{"pos":[2131,2201],"content":"Close the <ph id=\"ph1\">`While`</ph> and <ph id=\"ph2\">`Using`</ph> blocks with <ph id=\"ph3\">`End While`</ph> and <ph id=\"ph4\">`End Using`</ph>.","source":"Close the `While` and `Using` blocks with `End While` and `End Using`."},{"pos":[2212,2391],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#18<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#18](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_4.vb)]"},{"pos":[2400,2407],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2411,2455],"content":"This example reads from the file <ph id=\"ph1\">`test.txt`</ph>.","source":"This example reads from the file `test.txt`."},{"pos":[2462,2641],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#19<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#19](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-comma-delimited-text-files_5.vb)]"},{"pos":[2650,2668],"content":"Robust programming","linkify":"Robust programming","nodes":[{"content":"Robust programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[2672,2720]},{"content":"A row cannot be parsed using the specified format (<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.MalformedLineException&gt;</ph>).","pos":[2730,2841],"source":"A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>)."},{"content":"The exception message specifies the line causing the exception, while the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A&gt;</ph> property is assigned the text contained in the line.","pos":[2842,3033],"source":" The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned the text contained in the line."},{"content":"The specified file does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","pos":[3043,3118],"source":"The specified file does not exist (<xref:System.IO.FileNotFoundException>)."},{"content":"A partial-trust situation in which the user does not have sufficient permissions to access the file.","pos":[3128,3228]},{"content":"(<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[3229,3272],"source":" (<xref:System.Security.SecurityException>)."},{"content":"The path is too long (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","pos":[3282,3343],"source":"The path is too long (<xref:System.IO.PathTooLongException>)."},{"content":"The user does not have sufficient permissions to access the file (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","pos":[3353,3462],"source":"The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>)."},{"pos":[3471,3479],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName&gt;</ph>","pos":[3483,3559],"source":"<xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName> "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Read From Fixed-width Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[3563,3729],"source":" [How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Read From Text Files with Multiple Formats<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)</ept><ph id=\"ph1\"> </ph>","pos":[3732,3918],"source":" [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Parsing Text Files with the TextFieldParser Object<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)</ept><ph id=\"ph1\"> </ph>","pos":[3921,4108],"source":" [Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Manipulating Files and Directories in Visual Basic<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)</ept><ph id=\"ph1\"> </ph>","pos":[4111,4307],"source":" [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Troubleshooting: Reading from and Writing to Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)</ept>","pos":[4310,4505],"source":" [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)"}]}