{"content":"---\ntitle: \"Mixing Trust Protocols in Federated Scenarios | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: d7b5fee9-2246-4b09-b8d7-9e63cb817279\ncaps.latest.revision: 7\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# Mixing Trust Protocols in Federated Scenarios\nThere may be scenarios in which federated clients communicate with a service and a Security Token Service (STS) that do not have the same trust version. The service WSDL can contain a `RequestSecurityTokenTemplate` assertion with WS-Trust elements that are of different versions than the STS. In such cases, a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] client converts the WS-Trust elements received from the `RequestSecurityTokenTemplate` to match the STS trust version. [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] handles mismatched trust versions only for standard bindings. All standard algorithm parameters that are recognized by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] are part of the standard binding. This topic describes the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] behavior with various trust settings between the service and the STS.  \n  \n## RP Feb 2005 and STS Feb 2005  \n The WSDL for Relying Party (RP) contains the following elements within the `RequestSecurityTokenTemplate` section:  \n  \n-   `CanonicalizationAlgorithm`  \n  \n-   `EncryptionAlgorithm`  \n  \n-   `EncryptWith`  \n  \n-   `SignWith`  \n  \n-   `KeySize`  \n  \n-   `KeyType`  \n  \n The client configuration file contains a list of parameters.  \n  \n [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cannot differentiate between the client and service parameters; it adds all the parameters and sends them in the `RequestSecurityTokenTemplate` (RST).  \n  \n## RP Trust 1.3 and STS Trust 1.3  \n The WSDL for RP contains the following elements within the `RequestSecurityTokenTemplate` section:  \n  \n-   `CanonicalizationAlgorithm`  \n  \n-   `EncryptionAlgorithm`  \n  \n-   `EncryptWith`  \n  \n-   `SignWith`  \n  \n-   `KeySize`  \n  \n-   `KeyType`  \n  \n-   `KeyWrapAlgorithm`  \n  \n The client configuration file contains a `secondaryParameters` element that wraps the parameters specified by the RP.  \n  \n [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] removes the `EncryptionAlgorithm`, `CanonicalizationAlgorithm` and `KeyWrapAlgorithm` elements from the top-level element under the RST if these are present inside the `SecondaryParameters` element. [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] appends the `SecondaryParameters` element to the outgoing RST unmodified.  \n  \n## RP Trust Feb 2005 and STS Trust 1.3  \n The WSDL for RP contains the following elements in the `RequestSecurityTokenTemplate` section:  \n  \n-   `CanonicalizationAlgorithm`  \n  \n-   `EncryptionAlgorithm`  \n  \n-   `EncryptWith`  \n  \n-   `SignWith`  \n  \n-   `KeySize`  \n  \n-   `KeyType`  \n  \n The client configuration file contains a list of parameters.  \n  \n From the client configuration file, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cannot differentiate between the service and client parameters. Therefore [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] converts all the parameters to a Trust version 1.3 namespace.  \n  \n [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] handles the `KeyType`, `KeySize`, and `TokenType` elements as follows:  \n  \n-   Download the WSDL, create the binding, and assign `KeyType`, `KeySize`, and `TokenType` from the RP parameters. The client configuration file is then generated.  \n  \n-   The client can now change any parameter in the configuration file.  \n  \n-   During runtime, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] copies all parameters specified into the `AdditionalTokenParameters` section of the client configuration file except `KeyType`, `KeySize` and `TokenType`, because these parameters are accounted for during the configuration file generation.  \n  \n## RP Trust 1.3 and STS Trust Feb 2005  \n The WSDL for RP contains the following elements in the `RequestSecurityTokenTemplate` section:  \n  \n-   `CanonicalizationAlgorithm`  \n  \n-   `EncryptionAlgorithm`  \n  \n-   `EncryptWith`  \n  \n-   `SignWith`  \n  \n-   `KeySize`  \n  \n-   `KeyType`  \n  \n-   `KeyWrapAlgorithm`  \n  \n The client configuration file contains a `secondaryParamters` element that wraps the parameters specified by the RP.  \n  \n [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] copies all the parameters specified within the `SecondaryParameters` section to the top-level RST element, but does not convert them to the 2005 WS-Trust namespace.","nodes":[{"pos":[12,74],"content":"Mixing Trust Protocols in Federated Scenarios | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mixing Trust Protocols in Federated Scenarios | Microsoft Docs","pos":[0,62]}]},{"pos":[383,428],"content":"Mixing Trust Protocols in Federated Scenarios","linkify":"Mixing Trust Protocols in Federated Scenarios","nodes":[{"content":"Mixing Trust Protocols in Federated Scenarios","pos":[0,45]}]},{"content":"There may be scenarios in which federated clients communicate with a service and a Security Token Service (STS) that do not have the same trust version.","pos":[429,581]},{"content":"The service WSDL can contain a <ph id=\"ph1\">`RequestSecurityTokenTemplate`</ph> assertion with WS-Trust elements that are of different versions than the STS.","pos":[582,721],"source":" The service WSDL can contain a `RequestSecurityTokenTemplate` assertion with WS-Trust elements that are of different versions than the STS."},{"content":"In such cases, a <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> client converts the WS-Trust elements received from the <ph id=\"ph2\">`RequestSecurityTokenTemplate`</ph> to match the STS trust version.","pos":[722,913],"source":" In such cases, a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] client converts the WS-Trust elements received from the `RequestSecurityTokenTemplate` to match the STS trust version."},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> handles mismatched trust versions only for standard bindings.","pos":[914,1031],"source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] handles mismatched trust versions only for standard bindings."},{"content":"All standard algorithm parameters that are recognized by <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> are part of the standard binding.","pos":[1032,1178],"source":" All standard algorithm parameters that are recognized by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] are part of the standard binding."},{"content":"This topic describes the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> behavior with various trust settings between the service and the STS.","pos":[1179,1329],"source":" This topic describes the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] behavior with various trust settings between the service and the STS."},{"pos":[1338,1366],"content":"RP Feb 2005 and STS Feb 2005","linkify":"RP Feb 2005 and STS Feb 2005","nodes":[{"content":"RP Feb 2005 and STS Feb 2005","pos":[0,28]}]},{"pos":[1370,1484],"content":"The WSDL for Relying Party (RP) contains the following elements within the <ph id=\"ph1\">`RequestSecurityTokenTemplate`</ph> section:","source":"The WSDL for Relying Party (RP) contains the following elements within the `RequestSecurityTokenTemplate` section:"},{"content":"The client configuration file contains a list of parameters.","pos":[1640,1700]},{"pos":[1707,1913],"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> cannot differentiate between the client and service parameters; it adds all the parameters and sends them in the <ph id=\"ph2\">`RequestSecurityTokenTemplate`</ph> (RST).","source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cannot differentiate between the client and service parameters; it adds all the parameters and sends them in the `RequestSecurityTokenTemplate` (RST)."},{"pos":[1922,1952],"content":"RP Trust 1.3 and STS Trust 1.3","linkify":"RP Trust 1.3 and STS Trust 1.3","nodes":[{"content":"RP Trust 1.3 and STS Trust 1.3","pos":[0,30]}]},{"pos":[1956,2054],"content":"The WSDL for RP contains the following elements within the <ph id=\"ph1\">`RequestSecurityTokenTemplate`</ph> section:","source":"The WSDL for RP contains the following elements within the `RequestSecurityTokenTemplate` section:"},{"pos":[2238,2355],"content":"The client configuration file contains a <ph id=\"ph1\">`secondaryParameters`</ph> element that wraps the parameters specified by the RP.","source":"The client configuration file contains a `secondaryParameters` element that wraps the parameters specified by the RP."},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> removes the <ph id=\"ph2\">`EncryptionAlgorithm`</ph>, <ph id=\"ph3\">`CanonicalizationAlgorithm`</ph> and <ph id=\"ph4\">`KeyWrapAlgorithm`</ph> elements from the top-level element under the RST if these are present inside the <ph id=\"ph5\">`SecondaryParameters`</ph> element.","pos":[2362,2616],"source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] removes the `EncryptionAlgorithm`, `CanonicalizationAlgorithm` and `KeyWrapAlgorithm` elements from the top-level element under the RST if these are present inside the `SecondaryParameters` element."},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> appends the <ph id=\"ph2\">`SecondaryParameters`</ph> element to the outgoing RST unmodified.","pos":[2617,2746],"source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] appends the `SecondaryParameters` element to the outgoing RST unmodified."},{"pos":[2755,2790],"content":"RP Trust Feb 2005 and STS Trust 1.3","linkify":"RP Trust Feb 2005 and STS Trust 1.3","nodes":[{"content":"RP Trust Feb 2005 and STS Trust 1.3","pos":[0,35]}]},{"pos":[2794,2888],"content":"The WSDL for RP contains the following elements in the <ph id=\"ph1\">`RequestSecurityTokenTemplate`</ph> section:","source":"The WSDL for RP contains the following elements in the `RequestSecurityTokenTemplate` section:"},{"content":"The client configuration file contains a list of parameters.","pos":[3044,3104]},{"content":"From the client configuration file, <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> cannot differentiate between the service and client parameters.","pos":[3111,3266],"source":"From the client configuration file, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cannot differentiate between the service and client parameters."},{"content":"Therefore <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> converts all the parameters to a Trust version 1.3 namespace.","pos":[3267,3394],"source":" Therefore [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] converts all the parameters to a Trust version 1.3 namespace."},{"pos":[3401,3527],"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> handles the <ph id=\"ph2\">`KeyType`</ph>, <ph id=\"ph3\">`KeySize`</ph>, and <ph id=\"ph4\">`TokenType`</ph> elements as follows:","source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] handles the `KeyType`, `KeySize`, and `TokenType` elements as follows:"},{"content":"Download the WSDL, create the binding, and assign <ph id=\"ph1\">`KeyType`</ph>, <ph id=\"ph2\">`KeySize`</ph>, and <ph id=\"ph3\">`TokenType`</ph> from the RP parameters.","pos":[3537,3648],"source":"Download the WSDL, create the binding, and assign `KeyType`, `KeySize`, and `TokenType` from the RP parameters."},{"content":"The client configuration file is then generated.","pos":[3649,3697]},{"content":"The client can now change any parameter in the configuration file.","pos":[3707,3773]},{"pos":[3783,4094],"content":"During runtime, <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> copies all parameters specified into the <ph id=\"ph2\">`AdditionalTokenParameters`</ph> section of the client configuration file except <ph id=\"ph3\">`KeyType`</ph>, <ph id=\"ph4\">`KeySize`</ph> and <ph id=\"ph5\">`TokenType`</ph>, because these parameters are accounted for during the configuration file generation.","source":"During runtime, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] copies all parameters specified into the `AdditionalTokenParameters` section of the client configuration file except `KeyType`, `KeySize` and `TokenType`, because these parameters are accounted for during the configuration file generation."},{"pos":[4103,4138],"content":"RP Trust 1.3 and STS Trust Feb 2005","linkify":"RP Trust 1.3 and STS Trust Feb 2005","nodes":[{"content":"RP Trust 1.3 and STS Trust Feb 2005","pos":[0,35]}]},{"pos":[4142,4236],"content":"The WSDL for RP contains the following elements in the <ph id=\"ph1\">`RequestSecurityTokenTemplate`</ph> section:","source":"The WSDL for RP contains the following elements in the `RequestSecurityTokenTemplate` section:"},{"pos":[4420,4536],"content":"The client configuration file contains a <ph id=\"ph1\">`secondaryParamters`</ph> element that wraps the parameters specified by the RP.","source":"The client configuration file contains a `secondaryParamters` element that wraps the parameters specified by the RP."},{"pos":[4543,4763],"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> copies all the parameters specified within the <ph id=\"ph2\">`SecondaryParameters`</ph> section to the top-level RST element, but does not convert them to the 2005 WS-Trust namespace.","source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] copies all the parameters specified within the `SecondaryParameters` section to the top-level RST element, but does not convert them to the 2005 WS-Trust namespace."}]}