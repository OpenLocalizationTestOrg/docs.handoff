{"content":"---\ntitle: \"How to: Read a Value from a Registry Key in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"registry keys, determining if a value exists in\"\n  - \"My.Computer.Registry object, examples\"\n  - \"registry, determining if values exist\"\n  - \"registry keys, reading from\"\n  - \"registry, reading\"\nms.assetid: 775d0a57-68c9-464e-8949-9a39bd29cc64\ncaps.latest.revision: 31\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Read a Value from a Registry Key in Visual Basic\nThe `GetValue` method of the `My.Computer.Registry` object can be used to read values in the Windows registry.  \n  \n If the key, \"Software\\MyApp\" in the following example, does not exist, an exception is thrown. If the `ValueName`,  \"Name\" in the following example, does not exist, `Nothing` is returned.  \n  \n The `GetValue` method can also be used to determine whether a given value exists in a specific registry key.  \n  \n When code reads the registry from a Web application, the current user is determined by the authentication and impersonation that is implemented in the Web application.  \n  \n### To read a value from a registry key  \n  \n-   Use the `GetValue` method, specifying the path and name) to read a value from registry key. The following example reads the value `Name` from `HKEY_CURRENT_USER\\Software\\MyApp` and displays it in a message box.  \n  \n     [!code-vb[VbResourceTasks#4](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-read-a-value-from-a-registry-key_1.vb)]  \n  \n This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **Windows Operating System > Registry**. For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets).  \n  \n### To determine whether a value exists in a registry key  \n  \n-   Use the `GetValue` method to retrieve the value. The following code checks whether the value exists and returns a message if it does not.  \n  \n     [!code-vb[VbResourceTasks#12](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-read-a-value-from-a-registry-key_2.vb)]  \n  \n## Robust Programming  \n The registry holds top-level, or root, keys that are used to store data. For instance, the HKEY_LOCAL_MACHINE root key is used for storing machine-level settings used by all users, while HKEY_CURRENT_USER is used for storing data specific to an individual user.  \n  \n The following conditions may cause an exception:  \n  \n-   The name of the key is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The user does not have permissions to read from registry keys (<xref:System.Security.SecurityException>).  \n  \n-   The key name exceeds the 255-character limit (<xref:System.ArgumentException>).  \n  \n## .NET Framework Security  \n To run this process, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.RegistryPermission> class. If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges. Similarly, the user must have the correct ACLs for creating or writing to settings. For example, a local application that has the code access security permission might not have operating system permission. For more information, see [Code Access Security Basics](https://msdn.microsoft.com/library/33tceax8).  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.MyServices.RegistryProxy>   \n <xref:Microsoft.Win32.RegistryHive>   \n [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)","nodes":[{"pos":[4,773],"embed":true,"restype":"x-metadata","content":"title: \"How to: Read a Value from a Registry Key in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"registry keys, determining if a value exists in\"\n  - \"My.Computer.Registry object, examples\"\n  - \"registry, determining if values exist\"\n  - \"registry keys, reading from\"\n  - \"registry, reading\"\nms.assetid: 775d0a57-68c9-464e-8949-9a39bd29cc64\ncaps.latest.revision: 31\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic | Microsoft Docs","nodes":[{"pos":[0,73],"content":"How to: Read a Value from a Registry Key in Visual Basic | Microsoft Docs","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic | Microsoft Docs","pos":[0,73]}]}],"path":["title"]}],"yml":true},{"pos":[780,836],"content":"How to: Read a Value from a Registry Key in Visual Basic","linkify":"How to: Read a Value from a Registry Key in Visual Basic","nodes":[{"content":"How to: Read a Value from a Registry Key in Visual Basic","pos":[0,56]}]},{"pos":[837,947],"content":"The <ph id=\"ph1\">`GetValue`</ph> method of the <ph id=\"ph2\">`My.Computer.Registry`</ph> object can be used to read values in the Windows registry.","source":"The `GetValue` method of the `My.Computer.Registry` object can be used to read values in the Windows registry."},{"content":"If the key, \"Software\\MyApp\" in the following example, does not exist, an exception is thrown.","pos":[954,1048]},{"content":"If the <ph id=\"ph1\">`ValueName`</ph>,  \"Name\" in the following example, does not exist, <ph id=\"ph2\">`Nothing`</ph> is returned.","pos":[1049,1141],"source":" If the `ValueName`,  \"Name\" in the following example, does not exist, `Nothing` is returned."},{"pos":[1148,1256],"content":"The <ph id=\"ph1\">`GetValue`</ph> method can also be used to determine whether a given value exists in a specific registry key.","source":"The `GetValue` method can also be used to determine whether a given value exists in a specific registry key."},{"content":"When code reads the registry from a Web application, the current user is determined by the authentication and impersonation that is implemented in the Web application.","pos":[1263,1430]},{"pos":[1440,1475],"content":"To read a value from a registry key","linkify":"To read a value from a registry key","nodes":[{"content":"To read a value from a registry key","pos":[0,35]}]},{"content":"Use the <ph id=\"ph1\">`GetValue`</ph> method, specifying the path and name) to read a value from registry key.","pos":[1485,1576],"source":"Use the `GetValue` method, specifying the path and name) to read a value from registry key."},{"content":"The following example reads the value <ph id=\"ph1\">`Name`</ph> from <ph id=\"ph2\">`HKEY_CURRENT_USER\\Software\\MyApp`</ph> and displays it in a message box.","pos":[1577,1695],"source":" The following example reads the value `Name` from `HKEY_CURRENT_USER\\Software\\MyApp` and displays it in a message box."},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[1884,1952]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>Windows Operating System &gt; Registry<ept id=\"p1\">**</ept>.","pos":[1953,2038],"source":" In the code snippet picker, it is located in **Windows Operating System > Registry**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/code-snippets)</ept>.","pos":[2039,2140],"source":" For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets)."},{"pos":[2150,2203],"content":"To determine whether a value exists in a registry key","linkify":"To determine whether a value exists in a registry key","nodes":[{"content":"To determine whether a value exists in a registry key","pos":[0,53]}]},{"content":"Use the <ph id=\"ph1\">`GetValue`</ph> method to retrieve the value.","pos":[2213,2261],"source":"Use the `GetValue` method to retrieve the value."},{"content":"The following code checks whether the value exists and returns a message if it does not.","pos":[2262,2350]},{"pos":[2542,2560],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The registry holds top-level, or root, keys that are used to store data.","pos":[2564,2636]},{"content":"For instance, the HKEY_LOCAL_MACHINE root key is used for storing machine-level settings used by all users, while HKEY_CURRENT_USER is used for storing data specific to an individual user.","pos":[2637,2825]},{"content":"The following conditions may cause an exception:","pos":[2832,2880]},{"pos":[2890,2961],"content":"The name of the key is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The name of the key is `Nothing` (<xref:System.ArgumentNullException>)."},{"content":"The user does not have permissions to read from registry keys (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[2971,3076],"source":"The user does not have permissions to read from registry keys (<xref:System.Security.SecurityException>)."},{"content":"The key name exceeds the 255-character limit (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","pos":[3086,3165],"source":"The key name exceeds the 255-character limit (<xref:System.ArgumentException>)."},{"pos":[3174,3197],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"To run this process, your assembly requires a privilege level granted by the <ph id=\"ph1\">&lt;xref:System.Security.Permissions.RegistryPermission&gt;</ph> class.","pos":[3201,3338],"source":"To run this process, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.RegistryPermission> class."},{"content":"If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges.","pos":[3339,3454]},{"content":"Similarly, the user must have the correct ACLs for creating or writing to settings.","pos":[3455,3538]},{"content":"For example, a local application that has the code access security permission might not have operating system permission.","pos":[3539,3660]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](https://msdn.microsoft.com/library/33tceax8)</ept>.","pos":[3661,3762],"source":" For more information, see [Code Access Security Basics](https://msdn.microsoft.com/library/33tceax8)."},{"pos":[3771,3779],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.RegistryProxy&gt;</ph>","pos":[3783,3836],"source":"<xref:Microsoft.VisualBasic.MyServices.RegistryProxy> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.Win32.RegistryHive&gt;</ph>","pos":[3841,3876],"source":"<xref:Microsoft.Win32.RegistryHive> "},{"content":"<bpt id=\"p1\">[</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept>","pos":[3881,4040],"source":"[Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)"}]}