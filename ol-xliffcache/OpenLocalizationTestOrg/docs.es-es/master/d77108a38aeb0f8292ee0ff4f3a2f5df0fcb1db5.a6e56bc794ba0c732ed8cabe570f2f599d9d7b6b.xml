{"content":"---\ntitle: \"METAHOST_POLICY_FLAGS Enumeration | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"METAHOST_POLICY_FLAGS\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"METAHOST_POLICY_FLAGS\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"METAHOST_POLICY_FLAGS enumeration [.NET Framework hosting]\"\nms.assetid: 3bb4b526-0118-42e2-ba59-c95648528ce9\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 21\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# METAHOST_POLICY_FLAGS Enumeration\nProvides binding policies that are common to most runtime hosts. This enumeration is used by the [ICLRMetaHostPolicy::GetRequestedRuntime](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md) method.  \n  \n## Syntax  \n  \n```  \ntypedef enum {  \n    METAHOST_POLICY_HIGHCOMPAT              = 0x00,  \n    METAHOST_POLICY_APPLY_UPGRADE_POLICY    = 0x08,  \n    METAHOST_POLICY_EMULATE_EXE_LAUNCH      = 0x10,  \n    METAHOST_POLICY_SHOW_ERROR_DIALOG       = 0x20,  \n    METAHOST_POLICY_USE_PROCESS_IMAGE_PATH  = 0x40,  \n    METAHOST_POLICY_ENSURE_SKU_SUPPORTED    = 0x80,  \n    METAHOST_POLICY_IGNORE_ERROR_MODE       = 0x1000  \n  \n} METAHOST_POLICY_FLAGS;  \n```  \n  \n## Members  \n  \n|Member|Description|  \n|------------|-----------------|  \n|`METAHOST_POLICY_HIGHCOMPAT`|Defines the high-compatibility policy, which does not consider any common language runtime (CLR) that is loaded into the current process. Instead, it considers only the installed CLRs and the preferences of the component, as derived from the assembly file itself, the declared built-against version, or the configuration file.|  \n|`METAHOST_POLICY_APPLY_UPGRADE_POLICY`|Applies upgrade policy to the version bind result when an exact match is not found, based on the contents of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework\\Policy\\Upgrades. This has the same effect as [RUNTIME_INFO_UPGRADE_VERSION](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md).|  \n|`METAHOST_POLICY_EMULATE_EXE_LAUNCH`|Binding results are returned as if the image provided to the call were launched in a new process. Currently, `GetRequestedRuntime` ignores the set of loadable runtimes and binds against the set of installed runtimes. This flag allows a host to determine which runtime an EXE will bind to when it is launched.|  \n|`METAHOST_POLICY_SHOW_ERROR_DIALOG`|An error dialog box is displayed if `GetRequestedRuntime` is unable to find a runtime that is compatible with the input parameters. Beginning with the [!INCLUDE[net_v45](../../../../includes/net-v45-md.md)], this error dialog box can take the form of a Windows feature dialog box that asks whether the user would like to enable the appropriate feature.|  \n|`METAHOST_POLICY_USE_PROCESS_IMAGE_PATH`|`GetRequestedRuntime` uses the process image (and any corresponding configuration file) as additional input to the binding process. By default, `GetRequestedRuntime` does not fall back to the process image path (typically, the EXE that was used to launch the process) when determining the runtime to bind to.|  \n|`METAHOST_POLICY_ENSURE_SKU_SUPPORTED`|`GetRequestedRuntime` must check whether the appropriate SKU is installed when no information is available in the configuration file. This allows applications that do not have configuration files to fail gracefully on smaller SKUs than the default installation of the .NET Framework. By default, `GetRequestedRuntime` does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file `<supportedRuntime />` element.|  \n|`METAHOST_POLICY_ENSURE_SKU_SUPPORTED`|`GetRequestedRuntime` must check whether the appropriate SKU is installed when no information is available in the configuration file. This allows applications that do not have configuration files to fail gracefully on smaller SKUs than the default installation of the .NET Framework. By default, `GetRequestedRuntime` does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file `<supportedRuntime />` element.|  \n|`METAHOST_POLICY_IGNORE_ERROR_MODE`|`GetRequestedRuntime` should ignore SEM_FAILCRITICALERRORS (which is set by calling the [SetErrorMode](http://go.microsoft.com/fwlink/p/?LinkId=255242) function), and show the error dialog box. By default, SEM_FAILCRITICALERRORS suppresses the error dialog box. It may have been inherited from another process, and the silent error may be undesirable in your scenario.|  \n  \n## Remarks  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Metahost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Hosting Enumerations](../../../../docs/framework/unmanaged-api/hosting/hosting-enumerations.md)   \n [GetRequestedRuntime Method](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md)","nodes":[{"pos":[4,631],"embed":true,"restype":"x-metadata","content":"title: \"METAHOST_POLICY_FLAGS Enumeration | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"METAHOST_POLICY_FLAGS\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"METAHOST_POLICY_FLAGS\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"METAHOST_POLICY_FLAGS enumeration [.NET Framework hosting]\"\nms.assetid: 3bb4b526-0118-42e2-ba59-c95648528ce9\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 21\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"METAHOST_POLICY_FLAGS Enumeration | Microsoft Docs","nodes":[{"pos":[0,50],"content":"METAHOST_POLICY_FLAGS Enumeration | Microsoft Docs","nodes":[{"content":"METAHOST_POLICY_FLAGS Enumeration | Microsoft Docs","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[638,671],"content":"METAHOST_POLICY_FLAGS Enumeration","linkify":"METAHOST_POLICY_FLAGS Enumeration","nodes":[{"content":"METAHOST_POLICY_FLAGS Enumeration","pos":[0,33]}]},{"content":"Provides binding policies that are common to most runtime hosts.","pos":[672,736]},{"content":"This enumeration is used by the <bpt id=\"p1\">[</bpt>ICLRMetaHostPolicy::GetRequestedRuntime<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md)</ept> method.","pos":[737,917],"source":" This enumeration is used by the [ICLRMetaHostPolicy::GetRequestedRuntime](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md) method."},{"pos":[926,932],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1382,1389],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"content":"Member","pos":[1396,1402]},{"content":"Description","pos":[1403,1414]},{"content":"Defines the high-compatibility policy, which does not consider any common language runtime (CLR) that is loaded into the current process.","pos":[1483,1620]},{"content":"Instead, it considers only the installed CLRs and the preferences of the component, as derived from the assembly file itself, the declared built-against version, or the configuration file.","pos":[1621,1809]},{"content":"Applies upgrade policy to the version bind result when an exact match is not found, based on the contents of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft<ph id=\"ph1\">\\\\</ph>.NETFramework\\Policy\\Upgrades.","pos":[1853,2031],"source":"Applies upgrade policy to the version bind result when an exact match is not found, based on the contents of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework\\Policy\\Upgrades."},{"content":"This has the same effect as <bpt id=\"p1\">[</bpt>RUNTIME_INFO_UPGRADE_VERSION<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md)</ept>.","pos":[2032,2175],"source":" This has the same effect as [RUNTIME_INFO_UPGRADE_VERSION](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md)."},{"content":"Binding results are returned as if the image provided to the call were launched in a new process.","pos":[2217,2314]},{"content":"Currently, <ph id=\"ph1\">`GetRequestedRuntime`</ph> ignores the set of loadable runtimes and binds against the set of installed runtimes.","pos":[2315,2433],"source":" Currently, `GetRequestedRuntime` ignores the set of loadable runtimes and binds against the set of installed runtimes."},{"content":"This flag allows a host to determine which runtime an EXE will bind to when it is launched.","pos":[2434,2525]},{"content":"An error dialog box is displayed if <ph id=\"ph1\">`GetRequestedRuntime`</ph> is unable to find a runtime that is compatible with the input parameters.","pos":[2566,2697],"source":"An error dialog box is displayed if `GetRequestedRuntime` is unable to find a runtime that is compatible with the input parameters."},{"content":"Beginning with the <ph id=\"ph1\">[!INCLUDE[net_v45](../../../../includes/net-v45-md.md)]</ph>, this error dialog box can take the form of a Windows feature dialog box that asks whether the user would like to enable the appropriate feature.","pos":[2698,2918],"source":" Beginning with the [!INCLUDE[net_v45](../../../../includes/net-v45-md.md)], this error dialog box can take the form of a Windows feature dialog box that asks whether the user would like to enable the appropriate feature."},{"content":"<ph id=\"ph1\">`GetRequestedRuntime`</ph> uses the process image (and any corresponding configuration file) as additional input to the binding process.","pos":[2964,3095],"source":"`GetRequestedRuntime` uses the process image (and any corresponding configuration file) as additional input to the binding process."},{"content":"By default, <ph id=\"ph1\">`GetRequestedRuntime`</ph> does not fall back to the process image path (typically, the EXE that was used to launch the process) when determining the runtime to bind to.","pos":[3096,3272],"source":" By default, `GetRequestedRuntime` does not fall back to the process image path (typically, the EXE that was used to launch the process) when determining the runtime to bind to."},{"content":"<ph id=\"ph1\">`GetRequestedRuntime`</ph> must check whether the appropriate SKU is installed when no information is available in the configuration file.","pos":[3316,3449],"source":"`GetRequestedRuntime` must check whether the appropriate SKU is installed when no information is available in the configuration file."},{"content":"This allows applications that do not have configuration files to fail gracefully on smaller SKUs than the default installation of the .NET Framework.","pos":[3450,3599]},{"content":"By default, <ph id=\"ph1\">`GetRequestedRuntime`</ph> does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file <ph id=\"ph2\">`&lt;supportedRuntime /&gt;`</ph> element.","pos":[3600,3785],"source":" By default, `GetRequestedRuntime` does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file `<supportedRuntime />` element."},{"content":"<ph id=\"ph1\">`GetRequestedRuntime`</ph> must check whether the appropriate SKU is installed when no information is available in the configuration file.","pos":[3829,3962],"source":"`GetRequestedRuntime` must check whether the appropriate SKU is installed when no information is available in the configuration file."},{"content":"This allows applications that do not have configuration files to fail gracefully on smaller SKUs than the default installation of the .NET Framework.","pos":[3963,4112]},{"content":"By default, <ph id=\"ph1\">`GetRequestedRuntime`</ph> does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file <ph id=\"ph2\">`&lt;supportedRuntime /&gt;`</ph> element.","pos":[4113,4298],"source":" By default, `GetRequestedRuntime` does not check whether the appropriate SKU is installed unless the SKU attribute is specified in the configuration file `<supportedRuntime />` element."},{"content":"<ph id=\"ph1\">`GetRequestedRuntime`</ph> should ignore SEM_FAILCRITICALERRORS (which is set by calling the <bpt id=\"p1\">[</bpt>SetErrorMode<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=255242)</ept> function), and show the error dialog box.","pos":[4339,4532],"source":"`GetRequestedRuntime` should ignore SEM_FAILCRITICALERRORS (which is set by calling the [SetErrorMode](http://go.microsoft.com/fwlink/p/?LinkId=255242) function), and show the error dialog box."},{"content":"By default, SEM_FAILCRITICALERRORS suppresses the error dialog box.","pos":[4533,4600]},{"content":"It may have been inherited from another process, and the silent error may be undesirable in your scenario.","pos":[4601,4707]},{"pos":[4717,4724],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4733,4745],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4749,4853],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4860,4882],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Metahost.h","source":"**Header:** Metahost.h"},{"pos":[4889,4939],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[4946,4974],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[5063,5071],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hosting Enumerations<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-enumerations.md)</ept><ph id=\"ph1\"> </ph>","pos":[5075,5172],"source":"[Hosting Enumerations](../../../../docs/framework/unmanaged-api/hosting/hosting-enumerations.md) "},{"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntime Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md)</ept>","pos":[5176,5303],"source":"[GetRequestedRuntime Method](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-getrequestedruntime-method.md)"}]}