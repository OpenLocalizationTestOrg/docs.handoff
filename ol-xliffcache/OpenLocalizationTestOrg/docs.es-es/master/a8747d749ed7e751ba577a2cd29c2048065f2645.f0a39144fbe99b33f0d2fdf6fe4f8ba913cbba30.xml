{"content":"---\ntitle: \"Side-by-Side Execution in ADO.NET\"\nms.date: \"03/30/2017\"\nms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393\n---\n# Side-by-Side Execution in ADO.NET\nSide-by-side execution in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] is the ability to execute an application on a computer that has multiple versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] installed, exclusively using the version for which the application was compiled. For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).  \n  \n An application compiled by using one version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] can run on a different version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. However, we recommend that you compile a version of the application for each installed version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], and run them separately. In either scenario, you should be aware of changes in [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] between releases that can affect the forward compatibility or backward compatibility of your application.  \n  \n## Forward Compatibility and Backward Compatibility  \n Forward compatibility means that an application can be compiled with an earlier version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but will still run successfully on a later version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] code written for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 is forward compatible with later versions.  \n  \n Backward compatibility means that an application is compiled for a newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but continues to run on earlier versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] without any loss of functionality. Of course, this will not be the case for features introduced in a new version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].  \n  \n## The .NET Framework Data Provider for ODBC  \n Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. The ODBC data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173). The namespace for the downloaded [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC is **Microsoft.Data.Odbc**.  \n  \n If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**. You then must recompile it for the newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].  \n  \n If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the ODBC data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system. You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0.  \n  \n## The .NET Framework Data Provider for Oracle  \n Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]. The data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).  \n  \n If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system.  \n  \n## Code Access Security  \n The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission. Any attempt to use the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] k data providers from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.  \n  \n However, starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0, all of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers can be used in partially trusted zones. In addition, a new security feature was added to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1. This feature enables you to restrict what connection strings can be used in a particular security zone. You can also disable the use of blank passwords for a particular security zone. For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).  \n  \n Because each installation of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has a separate Security.config file, there are no compatibility issues with security settings. However, if your application depends on the additional security capabilities of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] included in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, you will not be able to distribute it to a version 1.0 system.  \n  \n## SqlCommand Execution  \n Starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.  \n  \n In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure. As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command. The state of the connection is not modified for any subsequent commands executed while the connection is open.  \n  \n In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit. As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.  \n  \n Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.  \n  \n```sql\nSET NOCOUNT ON;  \nSELECT * FROM dbo.Customers;  \n```  \n  \n In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open. In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, NOCOUNT is only ON for the current command execution.  \n  \n This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].  \n  \n For applications that run on both earlier and later versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], you can write your code to make sure that the behavior is the same regardless of the version you are running on. If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>. If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command. For example:  \n  \n```sql\nSET NOCOUNT ON;  \nSELECT * FROM dbo.Customers;  \nSET NOCOUNT OFF;  \n```  \n  \n## See also\n\n- [ADO.NET Overview](../../../../docs/framework/data/adonet/ado-net-overview.md)\n- [Retrieving and Modifying Data in ADO.NET](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,117],"embed":true,"restype":"x-metadata","content":"title: \"Side-by-Side Execution in ADO.NET\"\nms.date: \"03/30/2017\"\nms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393","nodes":[{"content":"Side-by-Side Execution in ADO.NET","nodes":[{"pos":[0,33],"content":"Side-by-Side Execution in ADO.NET","nodes":[{"content":"Side-by-Side Execution in ADO.NET","pos":[0,33]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[124,157],"content":"Side-by-Side Execution in ADO.NET","linkify":"Side-by-Side Execution in ADO.NET","nodes":[{"content":"Side-by-Side Execution in ADO.NET","pos":[0,33]}]},{"content":"Side-by-side execution in the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> is the ability to execute an application on a computer that has multiple versions of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> installed, exclusively using the version for which the application was compiled.","pos":[158,485],"source":"Side-by-side execution in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] is the ability to execute an application on a computer that has multiple versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] installed, exclusively using the version for which the application was compiled."},{"content":"For detailed information about configuring side-by-side execution, see <bpt id=\"p1\">[</bpt>Side-by-Side Execution<ept id=\"p1\">](../../../../docs/framework/deployment/side-by-side-execution.md)</ept>.","pos":[486,647],"source":" For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md)."},{"content":"An application compiled by using one version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> can run on a different version of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[654,872],"source":"An application compiled by using one version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] can run on a different version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"However, we recommend that you compile a version of the application for each installed version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>, and run them separately.","pos":[873,1064],"source":" However, we recommend that you compile a version of the application for each installed version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], and run them separately."},{"content":"In either scenario, you should be aware of changes in <ph id=\"ph1\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> between releases that can affect the forward compatibility or backward compatibility of your application.","pos":[1065,1282],"source":" In either scenario, you should be aware of changes in [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] between releases that can affect the forward compatibility or backward compatibility of your application."},{"pos":[1291,1339],"content":"Forward Compatibility and Backward Compatibility","linkify":"Forward Compatibility and Backward Compatibility","nodes":[{"content":"Forward Compatibility and Backward Compatibility","pos":[0,48]}]},{"content":"Forward compatibility means that an application can be compiled with an earlier version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>, but will still run successfully on a later version of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[1343,1625],"source":"Forward compatibility means that an application can be compiled with an earlier version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but will still run successfully on a later version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> code written for the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1 is forward compatible with later versions.","pos":[1626,1823],"source":"[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] code written for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 is forward compatible with later versions."},{"content":"Backward compatibility means that an application is compiled for a newer version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>, but continues to run on earlier versions of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> without any loss of functionality.","pos":[1830,2129],"source":"Backward compatibility means that an application is compiled for a newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but continues to run on earlier versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] without any loss of functionality."},{"content":"Of course, this will not be the case for features introduced in a new version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[2130,2279],"source":" Of course, this will not be the case for features introduced in a new version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"pos":[2288,2329],"content":"The .NET Framework Data Provider for ODBC","linkify":"The .NET Framework Data Provider for ODBC","nodes":[{"content":"The .NET Framework Data Provider for ODBC","pos":[0,41]}]},{"content":"Starting with version 1.1, the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for ODBC (<ph id=\"ph2\">&lt;xref:System.Data.Odbc&gt;</ph>) is included as a part of the <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[2333,2570],"source":"Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"The ODBC data provider is available to <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 developers as a Web download from the <bpt id=\"p1\">[</bpt>Data Access and Storage Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?linkid=4173)</ept>.","pos":[2571,2813],"source":" The ODBC data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173)."},{"content":"The namespace for the downloaded <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for ODBC is <bpt id=\"p1\">**</bpt>Microsoft.Data.Odbc<ept id=\"p1\">**</ept>.","pos":[2814,2961],"source":" The namespace for the downloaded [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC is **Microsoft.Data.Odbc**."},{"content":"If you have an application developed for the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1 or a later version, you must update the namespace for the ODBC data provider to <bpt id=\"p1\">**</bpt>System.Data.Odbc<ept id=\"p1\">**</ept>.","pos":[2968,3375],"source":"If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**."},{"content":"You then must recompile it for the newer version of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[3376,3496],"source":" You then must recompile it for the newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"If you have an application developed for the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0, you must download the ODBC data provider and install it on the <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 system.","pos":[3503,3965],"source":"If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the ODBC data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system."},{"content":"You then must change the namespace for the ODBC data provider to <bpt id=\"p1\">**</bpt>Microsoft.Data.Odbc<ept id=\"p1\">**</ept>, and recompile the application for the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0.","pos":[3966,4170],"source":" You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0."},{"pos":[4179,4222],"content":"The .NET Framework Data Provider for Oracle","linkify":"The .NET Framework Data Provider for Oracle","nodes":[{"content":"The .NET Framework Data Provider for Oracle","pos":[0,43]}]},{"content":"Starting with version 1.1, the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> Data Provider for Oracle (<ph id=\"ph2\">&lt;xref:System.Data.OracleClient&gt;</ph>) is included as a part of the <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","pos":[4226,4473],"source":"Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"The data provider is available to <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 developers as a Web download from the <bpt id=\"p1\">[</bpt>Data Access and Storage Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?linkid=4173)</ept>.","pos":[4474,4711],"source":" The data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173)."},{"pos":[4718,5170],"content":"If you have an application developed for the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0, you must download the data provider and install it on the <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 system.","source":"If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system."},{"pos":[5179,5199],"content":"Code Access Security","linkify":"Code Access Security","nodes":[{"content":"Code Access Security","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data providers in the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 (<ph id=\"ph3\">&lt;xref:System.Data.SqlClient&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Data.OleDb&gt;</ph>) are required to run with FullTrust permission.","pos":[5203,5472],"source":"The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission."},{"content":"Any attempt to use the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> k data providers from the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0 in a zone with less than FullTrust permission causes a <ph id=\"ph3\">&lt;xref:System.Security.SecurityException&gt;</ph>.","pos":[5473,5758],"source":" Any attempt to use the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] k data providers from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>."},{"content":"However, starting with the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 2.0, all of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data providers can be used in partially trusted zones.","pos":[5765,5998],"source":"However, starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0, all of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers can be used in partially trusted zones."},{"content":"In addition, a new security feature was added to the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> data providers in the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1.","pos":[5999,6214],"source":" In addition, a new security feature was added to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1."},{"content":"This feature enables you to restrict what connection strings can be used in a particular security zone.","pos":[6215,6318]},{"content":"You can also disable the use of blank passwords for a particular security zone.","pos":[6319,6398]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security and ADO.NET<ept id=\"p1\">](../../../../docs/framework/data/adonet/code-access-security.md)</ept>.","pos":[6399,6524],"source":" For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)."},{"content":"Because each installation of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> has a separate Security.config file, there are no compatibility issues with security settings.","pos":[6531,6722],"source":"Because each installation of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has a separate Security.config file, there are no compatibility issues with security settings."},{"content":"However, if your application depends on the additional security capabilities of <ph id=\"ph1\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> included in the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1 and later, you will not be able to distribute it to a version 1.0 system.","pos":[6723,7026],"source":" However, if your application depends on the additional security capabilities of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] included in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, you will not be able to distribute it to a version 1.0 system."},{"pos":[7035,7055],"content":"SqlCommand Execution","linkify":"SqlCommand Execution","nodes":[{"content":"SqlCommand Execution","pos":[0,20]}]},{"pos":[7059,7273],"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1, the way that <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A&gt;</ph> executes commands at the data source was changed.","source":"Starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed."},{"content":"In the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0, <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A&gt;</ph> executed all commands in the context of the <bpt id=\"p1\">**</bpt>sp_executesql<ept id=\"p1\">**</ept> stored procedure.","pos":[7280,7500],"source":"In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure."},{"content":"As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.","pos":[7501,7645]},{"content":"The state of the connection is not modified for any subsequent commands executed while the connection is open.","pos":[7646,7756]},{"content":"In the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1 and later, <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A&gt;</ph> only executes a command in the context of the <bpt id=\"p1\">**</bpt>sp_executesql<ept id=\"p1\">**</ept> stored procedure if the command contains parameters, which provides a performance benefit.","pos":[7763,8068],"source":"In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit."},{"content":"As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.","pos":[8069,8283]},{"pos":[8290,8410],"content":"Consider the following batch of commands executed in a call to <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A&gt;</ph>.","source":"Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>."},{"content":"In the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.","pos":[8482,8665],"source":"In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open."},{"content":"In the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> version 1.0, NOCOUNT is only ON for the current command execution.","pos":[8666,8803],"source":" In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, NOCOUNT is only ON for the current command execution."},{"pos":[8810,9077],"content":"This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A&gt;</ph> for either version of the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>.","source":"This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]."},{"content":"For applications that run on both earlier and later versions of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>, you can write your code to make sure that the behavior is the same regardless of the version you are running on.","pos":[9084,9329],"source":"For applications that run on both earlier and later versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], you can write your code to make sure that the behavior is the same regardless of the version you are running on."},{"content":"If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A&gt;</ph>.","pos":[9330,9544],"source":" If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>."},{"content":"If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.","pos":[9545,9741]},{"content":"For example:","pos":[9742,9754]},{"pos":[9847,9855],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[9859,9937],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Overview<ept id=\"p1\">](../../../../docs/framework/data/adonet/ado-net-overview.md)</ept>","source":"[ADO.NET Overview](../../../../docs/framework/data/adonet/ado-net-overview.md)"},{"pos":[9940,10055],"content":"<bpt id=\"p1\">[</bpt>Retrieving and Modifying Data in ADO.NET<ept id=\"p1\">](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)</ept>","source":"[Retrieving and Modifying Data in ADO.NET](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)"},{"pos":[10058,10162],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}