{"content":"---\ntitle: \"Packaging an Assembly for COM\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"exposing .NET Framework components to COM\"\n  - \"COM interop, packaging assemblies\"\n  - \"packaging assemblies for COM\"\n  - \"Tlbexp.exe\"\n  - \"TypeLibConverter class\"\n  - \".NET Services Installation tool\"\n  - \"Assembly Registration tool\"\n  - \"Type Library Exporter\"\n  - \"Reqsvcs.exe\"\n  - \"interoperation with unmanaged code, exposing .NET Framework components\"\n  - \"interoperation with unmanaged code, packaging assemblies\"\n  - \"COM interop, exposing COM components\"\n  - \"Reqasm.exe\"\nms.assetid: 39dc55aa-f2a1-4093-87bb-f1c0edb6e761\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Packaging an Assembly for COM\nCOM developers can benefit from the following information about the managed types they plan to incorporate in their application:  \n  \n-   A list of types that COM applications can consume  \n  \n     Some managed types are invisible to COM; some are visible but not creatable; and some are both visible and creatable. An assembly can comprise any combination of invisible, visible, not creatable, and creatable types. For completeness, identify the types in an assembly that you intend to expose to COM, especially when those types are a subset of the types exposed to the .NET Framework.  \n  \n     For additional information, see [Qualifying .NET Types for Interoperation](qualifying-net-types-for-interoperation.md).  \n  \n-   Versioning instructions  \n  \n     Managed classes that implement the class interface (a COM interop-generated interface) are subject to versioning restrictions.  \n  \n     For guidelines on using the class interface, see [Introducing the class interface](com-callable-wrapper.md#introducing-the-class-interface).  \n  \n-   Deployment instructions  \n  \n     Strong-named assemblies that are signed by a publisher can be installed into the global assembly cache. Unsigned assemblies must be installed on the user's machine as private assemblies.  \n  \n     For additional information, see [Assembly Security Considerations](../app-domains/assembly-security-considerations.md).  \n  \n-   Type library inclusion  \n  \n     Most types require a type library when consumed by a COM application. You can generate a type library or have COM developers perform this task. The [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] provides the following options for generating a type library:  \n  \n    -   [Type Library Exporter](#cpconpackagingassemblyforcomanchor1)  \n  \n    -   [TypeLibConverter Class](#cpconpackagingassemblyforcomanchor2)  \n  \n    -   [Assembly Registration Tool](#cpconpackagingassemblyforcomanchor3)  \n  \n    -   [.NET Services Installation Tool](#cpconpackagingassemblyforcomanchor4)  \n  \n     Regardless of the mechanism you choose, only public types defined in the assembly you supply are included in the generated type library.  \n  \n     You can package a type library as a separate file or embed it as Win32 resource file within a .NET-based application. Microsoft Visual Basic 6.0 performed this task for you automatically; however, when using [!INCLUDE[vbprvbext](../../../includes/vbprvbext-md.md)], you must embed your type library manually. For instructions, see [How to: Embed Type Libraries as Win32 Resources in .NET-Based Applications](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100)).  \n  \n<a name=\"cpconpackagingassemblyforcomanchor1\"></a>   \n## Type Library Exporter  \n The [Type Library Exporter (Tlbexp.exe)](../tools/tlbexp-exe-type-library-exporter.md) is a command-line tool that converts the classes and interfaces contained in an assembly to a COM type library. Once the type information of the class is available, COM clients can create an instance of the .NET class and call the methods of the instance, just as if it were a COM object. Tlbexp.exe converts an entire assembly at one time. You cannot use Tlbexp.exe to generate type information for a subset of the types defined in an assembly.  \n  \n<a name=\"cpconpackagingassemblyforcomanchor2\"></a>   \n## TypeLibConverter Class  \n The <xref:System.Runtime.InteropServices.TypeLibConverter> class, located in the **System.Runtime.Interop** namespace, converts the classes and interfaces contained in an assembly to a COM type library. This API produces the same type information as the Type Library Exporter, described in the previous section.  \n  \n The **TypeLibConverter class** implements the <xref:System.Runtime.InteropServices.ITypeLibConverter>.  \n  \n<a name=\"cpconpackagingassemblyforcomanchor3\"></a>   \n## Assembly Registration Tool  \n The [Assembly Registration Tool (Regasm.exe)](../tools/regasm-exe-assembly-registration-tool.md) can generate and register a type library when you apply the **/tlb:** option. COM clients require that type libraries be installed in the Windows registry. Without this option, Regasm.exe only registers the types in an assembly, not the type library. Registering the types in an assembly and registering the type library are distinct activities.  \n  \n<a name=\"cpconpackagingassemblyforcomanchor4\"></a>   \n## .NET Services Installation Tool  \n The [.NET Services Installation Tool (Regsvcs.exe)](../tools/regsvcs-exe-net-services-installation-tool.md) adds managed classes to Windows 2000 Component Services and combines several tasks within a single tool. In addition to loading and registering an assembly, Regsvcs.exe can generate, register, and install the type library into an existing COM+ 1.0 application.  \n  \n## See also\n\n- <xref:System.Runtime.InteropServices.TypeLibConverter>\n- <xref:System.Runtime.InteropServices.ITypeLibConverter>\n- [Exposing .NET Framework Components to COM](exposing-dotnet-components-to-com.md)\n- [Qualifying .NET Types for Interoperation](qualifying-net-types-for-interoperation.md)\n- [Introducing the class interface](com-callable-wrapper.md#introducing-the-class-interface)\n- [Assembly Security Considerations](../app-domains/assembly-security-considerations.md)\n- [Tlbexp.exe (Type Library Exporter)](../tools/tlbexp-exe-type-library-exporter.md)\n- [Registering Assemblies with COM](registering-assemblies-with-com.md)\n- [How to: Embed Type Libraries as Win32 Resources in Applications](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100))\n","nodes":[{"pos":[4,661],"embed":true,"restype":"x-metadata","content":"title: \"Packaging an Assembly for COM\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"exposing .NET Framework components to COM\"\n  - \"COM interop, packaging assemblies\"\n  - \"packaging assemblies for COM\"\n  - \"Tlbexp.exe\"\n  - \"TypeLibConverter class\"\n  - \".NET Services Installation tool\"\n  - \"Assembly Registration tool\"\n  - \"Type Library Exporter\"\n  - \"Reqsvcs.exe\"\n  - \"interoperation with unmanaged code, exposing .NET Framework components\"\n  - \"interoperation with unmanaged code, packaging assemblies\"\n  - \"COM interop, exposing COM components\"\n  - \"Reqasm.exe\"\nms.assetid: 39dc55aa-f2a1-4093-87bb-f1c0edb6e761\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Packaging an Assembly for COM","nodes":[{"pos":[0,29],"content":"Packaging an Assembly for COM","nodes":[{"content":"Packaging an Assembly for COM","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[668,697],"content":"Packaging an Assembly for COM","linkify":"Packaging an Assembly for COM","nodes":[{"content":"Packaging an Assembly for COM","pos":[0,29]}]},{"content":"COM developers can benefit from the following information about the managed types they plan to incorporate in their application:","pos":[698,826]},{"content":"A list of types that COM applications can consume","pos":[836,885]},{"content":"Some managed types are invisible to COM; some are visible but not creatable; and some are both visible and creatable.","pos":[896,1013]},{"content":"An assembly can comprise any combination of invisible, visible, not creatable, and creatable types.","pos":[1014,1113]},{"content":"For completeness, identify the types in an assembly that you intend to expose to COM, especially when those types are a subset of the types exposed to the .NET Framework.","pos":[1114,1284]},{"pos":[1295,1414],"content":"For additional information, see <bpt id=\"p1\">[</bpt>Qualifying .NET Types for Interoperation<ept id=\"p1\">](qualifying-net-types-for-interoperation.md)</ept>.","source":"For additional information, see [Qualifying .NET Types for Interoperation](qualifying-net-types-for-interoperation.md)."},{"content":"Versioning instructions","pos":[1424,1447]},{"content":"Managed classes that implement the class interface (a COM interop-generated interface) are subject to versioning restrictions.","pos":[1458,1584]},{"pos":[1595,1735],"content":"For guidelines on using the class interface, see <bpt id=\"p1\">[</bpt>Introducing the class interface<ept id=\"p1\">](com-callable-wrapper.md#introducing-the-class-interface)</ept>.","source":"For guidelines on using the class interface, see [Introducing the class interface](com-callable-wrapper.md#introducing-the-class-interface)."},{"content":"Deployment instructions","pos":[1745,1768]},{"content":"Strong-named assemblies that are signed by a publisher can be installed into the global assembly cache.","pos":[1779,1882]},{"content":"Unsigned assemblies must be installed on the user's machine as private assemblies.","pos":[1883,1965]},{"pos":[1976,2095],"content":"For additional information, see <bpt id=\"p1\">[</bpt>Assembly Security Considerations<ept id=\"p1\">](../app-domains/assembly-security-considerations.md)</ept>.","source":"For additional information, see [Assembly Security Considerations](../app-domains/assembly-security-considerations.md)."},{"content":"Type library inclusion","pos":[2105,2127]},{"content":"Most types require a type library when consumed by a COM application.","pos":[2138,2207]},{"content":"You can generate a type library or have COM developers perform this task.","pos":[2208,2281]},{"content":"The <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]</ph> provides the following options for generating a type library:","pos":[2282,2406],"source":" The [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] provides the following options for generating a type library:"},{"pos":[2420,2481],"content":"<bpt id=\"p1\">[</bpt>Type Library Exporter<ept id=\"p1\">](#cpconpackagingassemblyforcomanchor1)</ept>","source":"[Type Library Exporter](#cpconpackagingassemblyforcomanchor1)"},{"pos":[2495,2557],"content":"<bpt id=\"p1\">[</bpt>TypeLibConverter Class<ept id=\"p1\">](#cpconpackagingassemblyforcomanchor2)</ept>","source":"[TypeLibConverter Class](#cpconpackagingassemblyforcomanchor2)"},{"pos":[2571,2637],"content":"<bpt id=\"p1\">[</bpt>Assembly Registration Tool<ept id=\"p1\">](#cpconpackagingassemblyforcomanchor3)</ept>","source":"[Assembly Registration Tool](#cpconpackagingassemblyforcomanchor3)"},{"pos":[2651,2722],"content":"<bpt id=\"p1\">[</bpt>.NET Services Installation Tool<ept id=\"p1\">](#cpconpackagingassemblyforcomanchor4)</ept>","source":"[.NET Services Installation Tool](#cpconpackagingassemblyforcomanchor4)"},{"content":"Regardless of the mechanism you choose, only public types defined in the assembly you supply are included in the generated type library.","pos":[2733,2869]},{"content":"You can package a type library as a separate file or embed it as Win32 resource file within a .NET-based application.","pos":[2880,2997]},{"content":"Microsoft Visual Basic 6.0 performed this task for you automatically; however, when using <ph id=\"ph1\">[!INCLUDE[vbprvbext](../../../includes/vbprvbext-md.md)]</ph>, you must embed your type library manually.","pos":[2998,3188],"source":" Microsoft Visual Basic 6.0 performed this task for you automatically; however, when using [!INCLUDE[vbprvbext](../../../includes/vbprvbext-md.md)], you must embed your type library manually."},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>How to: Embed Type Libraries as Win32 Resources in .NET-Based Applications<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100))</ept>.","pos":[3189,3377],"source":" For instructions, see [How to: Embed Type Libraries as Win32 Resources in .NET-Based Applications](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100))."},{"pos":[3440,3461],"content":"Type Library Exporter","linkify":"Type Library Exporter","nodes":[{"content":"Type Library Exporter","pos":[0,21]}]},{"content":"The <bpt id=\"p1\">[</bpt>Type Library Exporter (Tlbexp.exe)<ept id=\"p1\">](../tools/tlbexp-exe-type-library-exporter.md)</ept> is a command-line tool that converts the classes and interfaces contained in an assembly to a COM type library.","pos":[3465,3663],"source":"The [Type Library Exporter (Tlbexp.exe)](../tools/tlbexp-exe-type-library-exporter.md) is a command-line tool that converts the classes and interfaces contained in an assembly to a COM type library."},{"content":"Once the type information of the class is available, COM clients can create an instance of the .NET class and call the methods of the instance, just as if it were a COM object.","pos":[3664,3840]},{"content":"Tlbexp.exe converts an entire assembly at one time.","pos":[3841,3892]},{"content":"You cannot use Tlbexp.exe to generate type information for a subset of the types defined in an assembly.","pos":[3893,3997]},{"pos":[4060,4082],"content":"TypeLibConverter Class","linkify":"TypeLibConverter Class","nodes":[{"content":"TypeLibConverter Class","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.TypeLibConverter&gt;</ph> class, located in the <bpt id=\"p1\">**</bpt>System.Runtime.Interop<ept id=\"p1\">**</ept> namespace, converts the classes and interfaces contained in an assembly to a COM type library.","pos":[4086,4288],"source":"The <xref:System.Runtime.InteropServices.TypeLibConverter> class, located in the **System.Runtime.Interop** namespace, converts the classes and interfaces contained in an assembly to a COM type library."},{"content":"This API produces the same type information as the Type Library Exporter, described in the previous section.","pos":[4289,4397]},{"pos":[4404,4506],"content":"The <bpt id=\"p1\">**</bpt>TypeLibConverter class<ept id=\"p1\">**</ept> implements the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ITypeLibConverter&gt;</ph>.","source":"The **TypeLibConverter class** implements the <xref:System.Runtime.InteropServices.ITypeLibConverter>."},{"pos":[4569,4595],"content":"Assembly Registration Tool","linkify":"Assembly Registration Tool","nodes":[{"content":"Assembly Registration Tool","pos":[0,26]}]},{"content":"The <bpt id=\"p1\">[</bpt>Assembly Registration Tool (Regasm.exe)<ept id=\"p1\">](../tools/regasm-exe-assembly-registration-tool.md)</ept> can generate and register a type library when you apply the <bpt id=\"p2\">**</bpt>/tlb:<ept id=\"p2\">**</ept> option.","pos":[4599,4773],"source":"The [Assembly Registration Tool (Regasm.exe)](../tools/regasm-exe-assembly-registration-tool.md) can generate and register a type library when you apply the **/tlb:** option."},{"content":"COM clients require that type libraries be installed in the Windows registry.","pos":[4774,4851]},{"content":"Without this option, Regasm.exe only registers the types in an assembly, not the type library.","pos":[4852,4946]},{"content":"Registering the types in an assembly and registering the type library are distinct activities.","pos":[4947,5041]},{"pos":[5104,5135],"content":".NET Services Installation Tool","linkify":".NET Services Installation Tool","nodes":[{"content":".NET Services Installation Tool","pos":[0,31]}]},{"content":"The <bpt id=\"p1\">[</bpt>.NET Services Installation Tool (Regsvcs.exe)<ept id=\"p1\">](../tools/regsvcs-exe-net-services-installation-tool.md)</ept> adds managed classes to Windows 2000 Component Services and combines several tasks within a single tool.","pos":[5139,5351],"source":"The [.NET Services Installation Tool (Regsvcs.exe)](../tools/regsvcs-exe-net-services-installation-tool.md) adds managed classes to Windows 2000 Component Services and combines several tasks within a single tool."},{"content":"In addition to loading and registering an assembly, Regsvcs.exe can generate, register, and install the type library into an existing COM+ 1.0 application.","pos":[5352,5507]},{"pos":[5516,5524],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5643,5724],"content":"<bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](exposing-dotnet-components-to-com.md)</ept>","source":"[Exposing .NET Framework Components to COM](exposing-dotnet-components-to-com.md)"},{"pos":[5727,5813],"content":"<bpt id=\"p1\">[</bpt>Qualifying .NET Types for Interoperation<ept id=\"p1\">](qualifying-net-types-for-interoperation.md)</ept>","source":"[Qualifying .NET Types for Interoperation](qualifying-net-types-for-interoperation.md)"},{"pos":[5816,5906],"content":"<bpt id=\"p1\">[</bpt>Introducing the class interface<ept id=\"p1\">](com-callable-wrapper.md#introducing-the-class-interface)</ept>","source":"[Introducing the class interface](com-callable-wrapper.md#introducing-the-class-interface)"},{"pos":[5909,5995],"content":"<bpt id=\"p1\">[</bpt>Assembly Security Considerations<ept id=\"p1\">](../app-domains/assembly-security-considerations.md)</ept>","source":"[Assembly Security Considerations](../app-domains/assembly-security-considerations.md)"},{"pos":[5998,6080],"content":"<bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../tools/tlbexp-exe-type-library-exporter.md)</ept>","source":"[Tlbexp.exe (Type Library Exporter)](../tools/tlbexp-exe-type-library-exporter.md)"},{"pos":[6083,6152],"content":"<bpt id=\"p1\">[</bpt>Registering Assemblies with COM<ept id=\"p1\">](registering-assemblies-with-com.md)</ept>","source":"[Registering Assemblies with COM](registering-assemblies-with-com.md)"},{"pos":[6155,6309],"content":"<bpt id=\"p1\">[</bpt>How to: Embed Type Libraries as Win32 Resources in Applications<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100))</ept>","source":"[How to: Embed Type Libraries as Win32 Resources in Applications](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ww9a897z(v=vs.100))"}]}