{"content":"---\ntitle: \"Application Management Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"application management [WPF]\"\nms.assetid: 32b1c054-5aca-423b-b4b5-ed8dc4dc637d\ncaps.latest.revision: 56\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Application Management Overview\nAll applications tend to share a common set of functionality that applies to application implementation and management. This topic provides an overview of the functionality in the              <xref:System.Windows.Application> class for creating and managing applications.  \n   \n  \n## The Application Class  \n In                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], common application-scoped functionality is encapsulated in the                  <xref:System.Windows.Application> class. The                  <xref:System.Windows.Application> class includes the following functionality:  \n  \n-   Tracking and interacting with application lifetime.  \n  \n-   Retrieving and processing command-line parameters.  \n  \n-   Detecting and responding to unhandled exceptions.  \n  \n-   Sharing application-scope properties and resources.  \n  \n-   Managing windows in standalone applications.  \n  \n-   Tracking and managing navigation.  \n  \n<a name=\"The_Application_Class\"></a>   \n## How to Perform Common Tasks Using the Application Class  \n If you are not interested in all of the details of the                  <xref:System.Windows.Application> class, t                 he following table                  lists some of the common tasks for                  <xref:System.Windows.Application> and how to accomplish them. By viewing the related API and topics, you can find more information and sample code.  \n  \n|Task|Approach|  \n|----------|--------------|  \n|Get an object that represents the current application|Use the                                  <xref:System.Windows.Application.Current%2A?displayProperty=fullName> property.|  \n|Add a startup screen to an application|See                                  [Add a Splash Screen to a WPF Application](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md).|  \n|Start an application|Use the                                  <xref:System.Windows.Application.Run%2A?displayProperty=fullName> method.|  \n|Stop an application|Use the                                  <xref:System.Windows.Application.Shutdown%2A> method of the                                  <xref:System.Windows.Application.Current%2A?displayProperty=fullName> object.|  \n|Get arguments from the command line|Handle the                                  <xref:System.Windows.Application.Startup?displayProperty=fullName> event and use the                                  <xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=fullName> property. For an example, see the                                  <xref:System.Windows.Application.Startup?displayProperty=fullName> event.|  \n|Get and set the application exit code|Set the                                  <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=fullName> property in the                                  <xref:System.Windows.Application.Exit?displayProperty=fullName> event handler or call the                                  <xref:System.Windows.Application.Shutdown%2A> method and pass in an integer.|  \n|Detect and respond to unhandled exceptions|Handle the                                  <xref:System.Windows.Application.DispatcherUnhandledException> event.|  \n|Get and set application-scoped resources|Use the                                  <xref:System.Windows.Application.Resources%2A?displayProperty=fullName> property                                 .|  \n|Use an application-scope resource dictionary|See                                  [Use an Application-Scope Resource Dictionary](../../../../docs/framework/wpf/app-development/how-to-use-an-application-scope-resource-dictionary.md).|  \n|Get and set application-scoped properties|Use the                                  <xref:System.Windows.Application.Properties%2A?displayProperty=fullName> property                                 .|  \n|Get and save an application's state|See                                  [Persist and Restore Application-Scope Properties Across Application Sessions](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md).|  \n|Manage non-code data files, including resource files, content files, and site-of-origin files.|See                                  [WPF Application Resource, Content, and Data Files](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md).|  \n|Manage windows in standalone applications|See                                  [WPF Windows Overview](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md).|  \n|Track and manage navigation|See                                  [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).|  \n  \n<a name=\"The_Application_Definition\"></a>   \n## The Application Definition  \n To utilize the functionality of the                  <xref:System.Windows.Application> class, you must implement an application definition. A                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application definition is a class that derives from                  <xref:System.Windows.Application> and is configured with a special                  [!INCLUDE[TLA#tla_msbuild](../../../../includes/tlasharptla-msbuild-md.md)] setting.  \n  \n### Implementing an Application Definition  \n A typical                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application definition is implemented using both markup and code-behind. This allows you to use markup to declaratively set application properties, resources, and register events, while handling events and implementing application-specific behavior in code-behind.  \n  \n The following example shows how to implement an application definition using both markup and code-behind:  \n  \n [!code-xml[ApplicationSnippets#ApplicationXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml#applicationxaml)]  \n  \n [!code-csharp[ApplicationSnippets#ApplicationCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml.cs#applicationcodebehind)]\n [!code-vb[ApplicationSnippets#ApplicationCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSnippets/visualbasic/application.xaml.vb#applicationcodebehind)]  \n  \n To allow a markup file and code-behind file to work together, the following needs to happen:  \n  \n-   In markup, the                                  `Application` element must include the                                  `x:Class` attribute. When the application is built, the existence of                                  `x:Class` in the markup file causes                                  [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] to create a                                  `partial` class that derives from                                  <xref:System.Windows.Application> and has the name that is specified by the                                  `x:Class` attribute. This requires the addition of an                                  [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] namespace declaration for the                                  [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] schema (                                  `xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"` ).  \n  \n-   In code-behind, the class must be a                                  `partial` class with the same name that is specified by the                                  `x:Class` attribute in markup and must derive from                                  <xref:System.Windows.Application>. This allows the code-behind file to be associated with the                                  `partial` class that is generated for the markup file when the application is built (see                                  [Building a WPF Application](../../../../docs/framework/wpf/app-development/building-a-wpf-application-wpf.md)).  \n  \n> [!NOTE]\n>  When you create a new WPF Application project or WPF Browser Application project using                              [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], an application definition is included by default and is defined using both markup and code-behind.  \n  \n This code is the minimum that is required to implement an application definition. However, an additional                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] configuration needs to be made to the application definition before building and running the application.  \n  \n### Configuring the Application Definition for MSBuild  \n Standalone applications and                          [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] require the implementation of a certain level of infrastructure before they can run. The most important part of this infrastructure is the entry point. When an application is launched by a user, the operating system calls the entry point, which is a well-known function for starting applications.  \n  \n Traditionally, developers have needed to write some or all of this code for themselves, depending on the technology. However,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] generates this code for you when the markup file of your application definition is configured as an                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]`ApplicationDefinition` item, as shown in the following                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] project file:  \n  \n```  \n<Project   \n  DefaultTargets=\"Build\"  \n                        xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">  \n  ...  \n  <ApplicationDefinition Include=\"App.xaml\" />  \n  <Compile Include=\"App.xaml.cs\" />  \n  ...  \n</Project>  \n  \n```  \n  \n Because the code-behind file contains code, it is marked as an                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]`Compile` item, as is normal.  \n  \n The application of these                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] configurations to the markup and code-behind files of an application definition causes                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] to generate code like the following:  \n  \n [!code-csharp[AppDefAugSnippets#AppDefAugCODE1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode1)]\n [!code-vb[AppDefAugSnippets#AppDefAugCODE1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode1)]  \n[!code-csharp[AppDefAugSnippets#AppDefAugCODE2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode2)]\n[!code-vb[AppDefAugSnippets#AppDefAugCODE2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode2)]  \n  \n The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method                          `Main`. The                          <xref:System.STAThreadAttribute> attribute is applied to the                          `Main` method to indicate that the main                          [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] thread for the                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application is an STA thread, which is required for                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications. When called,                          `Main` creates a new instance of                          `App` before calling the                          `InitializeComponent` method to register the events and set the properties that are implemented in markup. Because                          `InitializeComponent` is generated for you, you don't need to explicitly call                          `InitializeComponent` from an application definition like you do for                          <xref:System.Windows.Controls.Page> and                          <xref:System.Windows.Window> implementations. Finally, the                          <xref:System.Windows.Application.Run%2A> method is called to start the application.  \n  \n<a name=\"Getting_the_Current_Application\"></a>   \n## Getting the Current Application  \n Because the functionality of the                  <xref:System.Windows.Application> class are shared across an application, there can be only one instance of the                  <xref:System.Windows.Application> class per                  <xref:System.AppDomain>. To enforce this, the                  <xref:System.Windows.Application> class is implemented as a singleton class (see                  [Implementing Singleton in C#](http://go.microsoft.com/fwlink/?LinkId=100567)), which creates a single instance of itself and provides shared access to it with the                  `static`<xref:System.Windows.Application.Current%2A> property.  \n  \n The following code shows how to acquire a reference to the                  <xref:System.Windows.Application> object for the current                  <xref:System.AppDomain>.  \n  \n [!code-csharp[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getcurrentappcode)]\n [!code-vb[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getcurrentappcode)]  \n  \n <xref:System.Windows.Application.Current%2A> returns a reference to an instance of the                  <xref:System.Windows.Application> class. If you want a reference to your                  <xref:System.Windows.Application> derived class you must cast the value of the                  <xref:System.Windows.Application.Current%2A> property, as shown in the following example.  \n  \n [!code-csharp[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getstcurrentappcode)]\n [!code-vb[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getstcurrentappcode)]  \n  \n You can inspect the value of                  <xref:System.Windows.Application.Current%2A> at any point in the lifetime of an                  <xref:System.Windows.Application> object. However, you should be careful. After the                  <xref:System.Windows.Application> class is instantiated, there is a period during which the state of the                  <xref:System.Windows.Application> object is inconsistent. During this period,                  <xref:System.Windows.Application> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events. If you try to use the                  <xref:System.Windows.Application> object during this period, your code may have unexpected results, particularly if it depends on the various                  <xref:System.Windows.Application> properties being set.  \n  \n When                  <xref:System.Windows.Application> completes its initialization work, its lifetime truly begins.  \n  \n<a name=\"Application_Lifetime\"></a>   \n## Application Lifetime  \n The lifetime of a                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application is marked by several events that are raised by                  <xref:System.Windows.Application> to let you know when your application has started, has been activated and deactivated, and has been shut down.  \n  \n  \n<a name=\"Splash_Screen\"></a>   \n### Splash Screen  \n Starting in                          the                         [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], you can specify an image to be used in a startup window, or                          *splash screen*. The                          <xref:System.Windows.SplashScreen> class makes it easy to display a startup window while your application is loading. The                          <xref:System.Windows.SplashScreen> window is created and shown before                          <xref:System.Windows.Application.Run%2A> is called. For more information, see                          [Application Startup Time](../../../../docs/framework/wpf/advanced/application-startup-time.md) and                          [Add a Splash Screen to a WPF Application](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md).  \n  \n<a name=\"Starting_an_Application\"></a>   \n### Starting an Application  \n After                          <xref:System.Windows.Application.Run%2A> is called and the application is initialized, the application is ready to run. This moment is signified when the                          <xref:System.Windows.Application.Startup> event is raised:  \n  \n [!code-csharp[ApplicationStartupSnippets#StartupCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind1)]\n [!code-vb[ApplicationStartupSnippets#StartupCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind1)]  \n[!code-csharp[ApplicationStartupSnippets#StartupCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind2)]\n[!code-vb[ApplicationStartupSnippets#StartupCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind2)]  \n  \n At this point in an application's lifetime, the most common thing to do is to show a                          [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].  \n  \n<a name=\"Showing_a_User_Interface\"></a>   \n### Showing a User Interface  \n Most standalone                          [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] applications open a                          <xref:System.Windows.Window> when they begin running. The                          <xref:System.Windows.Application.Startup> event handler is one location from which you can do this, as demonstrated by the following code.  \n  \n [!code-xml[AppShowWindowHardSnippets#StartupEventMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml#startupeventmarkup)]  \n  \n [!code-csharp[AppShowWindowHardSnippets#StartupEventCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml.cs#startupeventcodebehind)]\n [!code-vb[AppShowWindowHardSnippets#StartupEventCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppShowWindowHardSnippets/VisualBasic/Application.xaml.vb#startupeventcodebehind)]  \n  \n> [!NOTE]\n>  The first                              <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This                              <xref:System.Windows.Window> object is referenced by the                              <xref:System.Windows.Application.MainWindow%2A?displayProperty=fullName> property. The value of the                              <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated                              <xref:System.Windows.Window> should be the main window.  \n  \n When an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] first starts, it will most likely navigate to a                          <xref:System.Windows.Controls.Page>. This is shown in the following code.  \n  \n [!code-xml[XBAPAppStartupSnippets#StartupXBAPMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml#startupxbapmarkup)]  \n  \n [!code-csharp[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml.cs#startupxbapcodebehind)]\n [!code-vb[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XBAPAppStartupSnippets/VisualBasic/Application.xaml.vb#startupxbapcodebehind)]  \n  \n If you handle                          <xref:System.Windows.Application.Startup> to only open a                          <xref:System.Windows.Window> or navigate to a                          <xref:System.Windows.Controls.Page>, you can set the                          `StartupUri` attribute in markup instead.  \n  \n The following example shows how to use the                          <xref:System.Windows.Application.StartupUri%2A> from a standalone application to open a                          <xref:System.Windows.Window>.  \n  \n [!code-xml[ApplicationManagementOverviewSnippets#OverviewStartupUriMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/App.xaml#overviewstartupurimarkup)]  \n  \n The following example shows how to use                          <xref:System.Windows.Application.StartupUri%2A> from an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to navigate to a                          <xref:System.Windows.Controls.Page>.  \n  \n [!code-xml[PageSnippets#XBAPStartupUriMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PageSnippets/CSharp/App.xaml#xbapstartupurimarkup)]  \n  \n This markup has the same effect as the previous code for opening a window.  \n  \n> [!NOTE]\n>  For more information on navigation, see                              [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).  \n  \n You need to handle the                          <xref:System.Windows.Application.Startup> event to open a                          <xref:System.Windows.Window> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched.  \n  \n<a name=\"Processing_Command_Line_Arguments\"></a>   \n### Processing Command-Line Arguments  \n In                          [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)], standalone applications can be launched from either a command prompt or the desktop. In both cases, command-line arguments can be passed to the application. The following example shows an application that is launched with a single command-line argument, \"/StartMinimized\":  \n  \n `wpfapplication.exe /StartMinimized`  \n  \n During application initialization,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] retrieves the command-line arguments from the operating system and passes them to the                          <xref:System.Windows.Application.Startup> event handler via the                          <xref:System.Windows.StartupEventArgs.Args%2A> property of the                          <xref:System.Windows.StartupEventArgs> parameter. You can retrieve and store the command-line arguments using code like the following.  \n  \n [!code-xml[ApplicationStartupSnippets#HandleStartupXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml#handlestartupxaml)]  \n  \n [!code-csharp[ApplicationStartupSnippets#HandleStartupCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#handlestartupcodebehind)]\n [!code-vb[ApplicationStartupSnippets#HandleStartupCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#handlestartupcodebehind)]  \n  \n The code handles                          <xref:System.Windows.Application.Startup> to check whether the                          **/StartMinimized** command-line argument was provided; if so, it opens the main window with a                          <xref:System.Windows.WindowState> of                          <xref:System.Windows.WindowState>. Note that because the                          <xref:System.Windows.Window.WindowState%2A> property must be set programmatically, the main                          <xref:System.Windows.Window> must be opened explicitly in code.  \n  \n [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] cannot retrieve and process command-line arguments because they are launched using                          [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] deployment (see                          [Deploying a WPF Application](../../../../docs/framework/wpf/app-development/deploying-a-wpf-application-wpf.md)). However, they can retrieve and process query string parameters from the URLs that are used to launch them.  \n  \n<a name=\"Application_Activation_and_Deactivation\"></a>   \n### Application Activation and Deactivation  \n [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] allows users to switch between applications. The most common way is to use the ALT+TAB key combination. An application can only be switched to if it has a visible                          <xref:System.Windows.Window> that a user can select. The currently selected                          <xref:System.Windows.Window> is the                          *active window* (also known as the                          *foreground window*) and is the                          <xref:System.Windows.Window> that receives user input. The application with the active window is the                          *active application* (or                          *foreground application*). An application becomes the active application in the following circumstances:  \n  \n-   It is launched and shows a                                  <xref:System.Windows.Window>.  \n  \n-   A user switches from another application by selecting a                                  <xref:System.Windows.Window> in the application.  \n  \n You can detect when an application becomes active by handling the                          <xref:System.Windows.Application.Activated?displayProperty=fullName> event.  \n  \n Likewise, an application can become inactive in the following circumstances:  \n  \n-   A user switches to another application from the current one.  \n  \n-   When the application shuts down.  \n  \n You can detect when an application becomes inactive by handling the                          <xref:System.Windows.Application.Deactivated?displayProperty=fullName> event.  \n  \n The following code shows how to handle the                          <xref:System.Windows.Application.Activated> and                          <xref:System.Windows.Application.Deactivated> events to determine whether an application is active.  \n  \n [!code-xml[ApplicationActivationSnippets#DetectActivationStateXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml#detectactivationstatexaml)]  \n  \n [!code-csharp[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)]\n [!code-vb[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)]  \n  \n A                          <xref:System.Windows.Window> can also be activated and deactivated. See                          <xref:System.Windows.Window.Activated?displayProperty=fullName> and                          <xref:System.Windows.Window.Deactivated?displayProperty=fullName> for more information.  \n  \n> [!NOTE]\n>  Neither                              <xref:System.Windows.Application.Activated?displayProperty=fullName> nor                              <xref:System.Windows.Application.Deactivated?displayProperty=fullName> is raised for                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].  \n  \n<a name=\"Application_Shutdown\"></a>   \n### Application Shutdown  \n The life of an application ends when it is shut down, which can occur for the following reasons:  \n  \n-   A user closes every                                  <xref:System.Windows.Window>.  \n  \n-   A user closes the main                                  <xref:System.Windows.Window>.  \n  \n-   A user ends the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session by logging off or shutting down.  \n  \n-   An application-specific condition has been met.  \n  \n To help you manage application shutdown,                          <xref:System.Windows.Application> provides the                          <xref:System.Windows.Application.Shutdown%2A> method, the                          <xref:System.Windows.Application.ShutdownMode%2A> property, and the                          <xref:System.Windows.Application.SessionEnding> and                          <xref:System.Windows.Application.Exit> events.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have                              <xref:System.Security.Permissions.UIPermission>. Standalone                              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications always have this permission. However,                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] running in the Internet zone partial-trust security sandbox do not.  \n  \n#### Shutdown Mode  \n Most applications shut down either when all the windows are closed or when the main window is closed. Sometimes, however, other application-specific conditions may determine when an application shuts down. You can specify the conditions under which your application will shut down by setting                                  <xref:System.Windows.Application.ShutdownMode%2A> with one of the following                                  <xref:System.Windows.ShutdownMode> enumeration values:  \n  \n-   <xref:System.Windows.ShutdownMode>  \n  \n-   <xref:System.Windows.ShutdownMode>  \n  \n-   <xref:System.Windows.ShutdownMode>  \n  \n The default value of                                  <xref:System.Windows.Application.ShutdownMode%2A> is                                  <xref:System.Windows.ShutdownMode>, which means that an application automatically shuts down when the last window in the application is closed by the user. However, if your application should be shut down when the main window is closed,                                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] automatically does that if you set                                  <xref:System.Windows.Application.ShutdownMode%2A> to                                  <xref:System.Windows.ShutdownMode>. This is shown in the following example.  \n  \n [!code-xml[ApplicationShutdownModeSnippets#OnMainWindowCloseMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationShutdownModeSnippets/CS/Page1.xaml#onmainwindowclosemarkup)]  \n  \n When you have application-specific shutdown conditions, you set                                  <xref:System.Windows.Application.ShutdownMode%2A> to                                  <xref:System.Windows.ShutdownMode>. In this case, it is your responsibility to shut an application down by explicitly calling the                                  <xref:System.Windows.Application.Shutdown%2A> method; otherwise, your application will continue running even if all the windows are closed. Note that                                  <xref:System.Windows.Application.Shutdown%2A> is called implicitly when the                                  <xref:System.Windows.Application.ShutdownMode%2A> is either                                  <xref:System.Windows.ShutdownMode> or                                  <xref:System.Windows.ShutdownMode>.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.ShutdownMode%2A> can be set from an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], but it is ignored; an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is always shut down when it is navigated away from in a browser or when the browser that hosts the                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed. For more information, see                                      [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).  \n  \n#### Session Ending  \n The shutdown conditions that are described by the                                  <xref:System.Windows.Application.ShutdownMode%2A> property are specific to an application. In some cases, though, an application may shut down as a result of an external condition. The most common external condition occurs when a user ends the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session by the following actions:  \n  \n-   Logging off  \n  \n-   Shutting down  \n  \n-   Restarting  \n  \n-   Hibernating  \n  \n To detect when a                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session ends, you can handle the                                  <xref:System.Windows.Application.SessionEnding> event, as illustrated in the following example.  \n  \n [!code-xml[ApplicationSessionEndingSnippets#HandlingSessionEndingXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml#handlingsessionendingxaml)]  \n  \n [!code-csharp[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)]\n [!code-vb[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)]  \n  \n In this example, the code inspects the                                  <xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A> property to determine how the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session is ending. It uses this value to display a confirmation message to the user. If the user does not want the session to end, the code sets                                  <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> to                                  `true` to prevent the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session from ending.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Application.SessionEnding> is not raised for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].  \n  \n#### Exit  \n When an application shuts down, it may need to perform some final processing, such as persisting application state. For these situations, you can handle the                                  <xref:System.Windows.Application.Exit> event.  \n  \n [!code-xml[HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml1)]  \n[!code-xml[HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml2)]  \n  \n [!code-csharp[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind1)]\n [!code-vb[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind1)]  \n[!code-csharp[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind2)]\n[!code-vb[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind2)]  \n  \n For the complete example, see                                  [Persist and Restore Application-Scope Properties Across Application Sessions](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md).  \n  \n <xref:System.Windows.Application.Exit> can be handled by both standalone applications and                                  [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]. For                                  [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)],                                  <xref:System.Windows.Application.Exit> is raised when in the following circumstances:  \n  \n-   An                                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is navigated away from.  \n  \n-   In                                          [!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)], when the tab that is hosting the                                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed.  \n  \n-   When the browser is closed.  \n  \n#### Exit Code  \n Applications are mostly launched by the operating system in response to a user request. However, an application can be launched by another application to perform some specific task. When the launched application shuts down, the launching application may want to know the condition under which the launched application shut down. In these situations,                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] allows applications to return an application exit code on shutdown. By default,                                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications return an exit code value of 0.  \n  \n> [!NOTE]\n>  When you debug from                                      [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], the application exit code is displayed in the                                      **Output** window when the application shuts down, in a message that looks like the following:  \n>   \n>  `The program '[5340] AWPFApp.vshost.exe: Managed' has exited with code 0 (0x0).`  \n>   \n>  You open the                                      **Output** window by clicking                                      **Output** on the                                      **View** menu.  \n  \n To change the exit code, you can call the                                  <xref:System.Windows.Application.Shutdown%28System.Int32%29> overload, which accepts an integer argument to be the exit code:  \n  \n [!code-csharp[ApplicationExitSnippets#AppExitCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationExitSnippets/CSharp/MainWindow.xaml.cs#appexitcode)]\n [!code-vb[ApplicationExitSnippets#AppExitCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationExitSnippets/visualbasic/mainwindow.xaml.vb#appexitcode)]  \n  \n You can detect the value of the exit code, and change it, by handling the                                  <xref:System.Windows.Application.Exit> event. The                                  <xref:System.Windows.Application.Exit> event handler is passed an                                  <xref:System.Windows.ExitEventArgs> which provides access to the exit code with the                                  <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A> property. For more information, see                                  <xref:System.Windows.Application.Exit>.  \n  \n> [!NOTE]\n>  You can set the exit code in both standalone applications and                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]. However, the exit code value is ignored for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].  \n  \n<a name=\"Unhandled_Exceptions\"></a>   \n### Unhandled Exceptions  \n Sometimes an application may shut down under abnormal conditions, such as when an unanticipated exception is thrown. In this case, the application may not have the code to detect and process the exception. This type of exception is an unhandled exception; a notification similar to that shown in the following figure is displayed before the application is closed.  \n  \n ![Unhandled exception notification](../../../../docs/framework/wpf/app-development/media/applicationmanagementoverviewfigure2.png \"ApplicationManagementOverviewFigure2\")  \n  \n From the user experience perspective, it is better for an application to avoid this default behavior by doing some or all of the following:  \n  \n-   Displaying user-friendly information.  \n  \n-   Attempting to keep an application running.  \n  \n-   Recording detailed, developer-friendly, exception information in the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] event log.  \n  \n Implementing this support depends on being able to detect unhandled exceptions, which is what the                          <xref:System.Windows.Application.DispatcherUnhandledException> event is raised for.  \n  \n [!code-xml[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml#handledispatcherunhandledexceptionxaml)]  \n  \n [!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind1)]\n [!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind1)]  \n[!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind2)]\n[!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind2)]  \n  \n The                          <xref:System.Windows.Application.DispatcherUnhandledException> event handler is passed a                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs> parameter that contains contextual information regarding the unhandled exception, including the exception itself (                         <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=fullName>). You can use this information to determine how to handle the exception.  \n  \n When you handle                          <xref:System.Windows.Application.DispatcherUnhandledException>, you should set the                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=fullName> property to                          `true`; otherwise,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] still considers the exception to be unhandled and reverts to the default behavior described earlier. If an unhandled exception is raised and either the                          <xref:System.Windows.Application.DispatcherUnhandledException> event is not handled, or the event is handled and                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A> is set to                          `false`, the application shuts down immediately. Furthermore, no other                          <xref:System.Windows.Application> events are raised. Consequently, you need to handle                          <xref:System.Windows.Application.DispatcherUnhandledException> if your application has code that must run before the application shuts down.  \n  \n Although an application may shut down as a result of an unhandled exception, an application usually shuts down in response to a user request, as discussed in the next section.  \n  \n<a name=\"Application_Lifetime_Events\"></a>   \n### Application Lifetime Events  \n Standalone applications and                          [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] don't have exactly the same lifetimes. The following figure illustrates the key events in the lifetime of a standalone application and shows the sequence in which they are raised.  \n  \n ![Standalone Application &#45; Application Object Events](../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents.png \"ApplicationModelOverview_ApplicationObjectEvents\")  \n  \n Likewise, the following figure illustrates the key events in the lifetime of an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], and shows the sequence in which they are raised.  \n  \n ![XBAP &#45; Application Object Events](../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents-xbap.png \"ApplicationModelOverview_ApplicationObjectEvents_xbap\")  \n  \n## See Also  \n <xref:System.Windows.Application>   \n [WPF Windows Overview](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md)   \n [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md)   \n [WPF Application Resource, Content, and Data Files](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md)   \n [Pack URIs in WPF](../../../../docs/framework/wpf/app-development/pack-uris-in-wpf.md)   \n [Application Model: How-to Topics](http://msdn.microsoft.com/en-us/76771b09-3688-4d1c-8818-9b3f4cf39a30)   \n [Application Development](../../../../docs/framework/wpf/app-development/index.md)","nodes":[{"pos":[4,418],"embed":true,"restype":"x-metadata","content":"title: \"Application Management Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"application management [WPF]\"\nms.assetid: 32b1c054-5aca-423b-b4b5-ed8dc4dc637d\ncaps.latest.revision: 56\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Application Management Overview | Microsoft Docs","nodes":[{"pos":[0,48],"content":"Application Management Overview | Microsoft Docs","nodes":[{"content":"Application Management Overview | Microsoft Docs","pos":[0,48]}]}],"path":["title"]}],"yml":true},{"pos":[425,456],"content":"Application Management Overview","linkify":"Application Management Overview","nodes":[{"content":"Application Management Overview","pos":[0,31]}]},{"content":"All applications tend to share a common set of functionality that applies to application implementation and management.","pos":[457,576]},{"content":"This topic provides an overview of the functionality in the              <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class for creating and managing applications.","pos":[577,729],"source":" This topic provides an overview of the functionality in the              <xref:System.Windows.Application> class for creating and managing applications."},{"pos":[742,763],"content":"The Application Class","linkify":"The Application Class","nodes":[{"content":"The Application Class","pos":[0,21]}]},{"content":"In                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>, common application-scoped functionality is encapsulated in the                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> class.","pos":[767,978],"source":"In                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], common application-scoped functionality is encapsulated in the                  <xref:System.Windows.Application> class."},{"content":"The                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class includes the following functionality:","pos":[979,1077],"source":" The                  <xref:System.Windows.Application> class includes the following functionality:"},{"content":"Tracking and interacting with application lifetime.","pos":[1087,1138]},{"content":"Retrieving and processing command-line parameters.","pos":[1148,1198]},{"content":"Detecting and responding to unhandled exceptions.","pos":[1208,1257]},{"content":"Sharing application-scope properties and resources.","pos":[1267,1318]},{"content":"Managing windows in standalone applications.","pos":[1328,1372]},{"content":"Tracking and managing navigation.","pos":[1382,1415]},{"pos":[1464,1519],"content":"How to Perform Common Tasks Using the Application Class","linkify":"How to Perform Common Tasks Using the Application Class","nodes":[{"content":"How to Perform Common Tasks Using the Application Class","pos":[0,55]}]},{"content":"If you are not interested in all of the details of the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class, t                 he following table                  lists some of the common tasks for                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> and how to accomplish them.","pos":[1523,1803],"source":"If you are not interested in all of the details of the                  <xref:System.Windows.Application> class, t                 he following table                  lists some of the common tasks for                  <xref:System.Windows.Application> and how to accomplish them."},{"content":"By viewing the related API and topics, you can find more information and sample code.","pos":[1804,1889]},{"content":"Task","pos":[1896,1900]},{"content":"Approach","pos":[1901,1909]},{"content":"Get an object that represents the current application","pos":[1944,1997]},{"content":"Use the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A?displayProperty=fullName&gt;</ph> property.","pos":[1998,2118],"source":"Use the                                  <xref:System.Windows.Application.Current%2A?displayProperty=fullName> property."},{"content":"Add a startup screen to an application","pos":[2123,2161]},{"pos":[2162,2341],"content":"See                                  <bpt id=\"p1\">[</bpt>Add a Splash Screen to a WPF Application<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md)</ept>.","source":"See                                  [Add a Splash Screen to a WPF Application](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md)."},{"content":"Start an application","pos":[2346,2366]},{"content":"Use the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A?displayProperty=fullName&gt;</ph> method.","pos":[2367,2481],"source":"Use the                                  <xref:System.Windows.Application.Run%2A?displayProperty=fullName> method."},{"content":"Stop an application","pos":[2486,2505]},{"content":"Use the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method of the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.Current%2A?displayProperty=fullName&gt;</ph> object.","pos":[2506,2717],"source":"Use the                                  <xref:System.Windows.Application.Shutdown%2A> method of the                                  <xref:System.Windows.Application.Current%2A?displayProperty=fullName> object."},{"content":"Get arguments from the command line","pos":[2722,2757]},{"content":"Handle the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup?displayProperty=fullName&gt;</ph> event and use the                                  <ph id=\"ph2\">&lt;xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=fullName&gt;</ph> property.","pos":[2758,3001],"source":"Handle the                                  <xref:System.Windows.Application.Startup?displayProperty=fullName> event and use the                                  <xref:System.Windows.StartupEventArgs.Args%2A?displayProperty=fullName> property."},{"content":"For an example, see the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup?displayProperty=fullName&gt;</ph> event.","pos":[3002,3132],"source":" For an example, see the                                  <xref:System.Windows.Application.Startup?displayProperty=fullName> event."},{"content":"Get and set the application exit code","pos":[3137,3174]},{"content":"Set the                                  <ph id=\"ph1\">&lt;xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=fullName&gt;</ph> property in the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.Exit?displayProperty=fullName&gt;</ph> event handler or call the                                  <ph id=\"ph3\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method and pass in an integer.","pos":[3175,3548],"source":"Set the                                  <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A?displayProperty=fullName> property in the                                  <xref:System.Windows.Application.Exit?displayProperty=fullName> event handler or call the                                  <xref:System.Windows.Application.Shutdown%2A> method and pass in an integer."},{"content":"Detect and respond to unhandled exceptions","pos":[3553,3595]},{"content":"Handle the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event.","pos":[3596,3709],"source":"Handle the                                  <xref:System.Windows.Application.DispatcherUnhandledException> event."},{"content":"Get and set application-scoped resources","pos":[3714,3754]},{"content":"Use the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Resources%2A?displayProperty=fullName&gt;</ph> property                                 .","pos":[3755,3910],"source":"Use the                                  <xref:System.Windows.Application.Resources%2A?displayProperty=fullName> property                                 ."},{"content":"Use an application-scope resource dictionary","pos":[3915,3959]},{"pos":[3960,4147],"content":"See                                  <bpt id=\"p1\">[</bpt>Use an Application-Scope Resource Dictionary<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/how-to-use-an-application-scope-resource-dictionary.md)</ept>.","source":"See                                  [Use an Application-Scope Resource Dictionary](../../../../docs/framework/wpf/app-development/how-to-use-an-application-scope-resource-dictionary.md)."},{"content":"Get and set application-scoped properties","pos":[4152,4193]},{"content":"Use the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Properties%2A?displayProperty=fullName&gt;</ph> property                                 .","pos":[4194,4350],"source":"Use the                                  <xref:System.Windows.Application.Properties%2A?displayProperty=fullName> property                                 ."},{"content":"Get and save an application's state","pos":[4355,4390]},{"pos":[4391,4607],"content":"See                                  <bpt id=\"p1\">[</bpt>Persist and Restore Application-Scope Properties Across Application Sessions<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md)</ept>.","source":"See                                  [Persist and Restore Application-Scope Properties Across Application Sessions](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md)."},{"content":"Manage non-code data files, including resource files, content files, and site-of-origin files.","pos":[4612,4706]},{"pos":[4707,4895],"content":"See                                  <bpt id=\"p1\">[</bpt>WPF Application Resource, Content, and Data Files<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md)</ept>.","source":"See                                  [WPF Application Resource, Content, and Data Files](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md)."},{"content":"Manage windows in standalone applications","pos":[4900,4941]},{"pos":[4942,5074],"content":"See                                  <bpt id=\"p1\">[</bpt>WPF Windows Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md)</ept>.","source":"See                                  [WPF Windows Overview](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md)."},{"content":"Track and manage navigation","pos":[5079,5106]},{"pos":[5107,5237],"content":"See                                  <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/navigation-overview.md)</ept>.","source":"See                                  [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md)."},{"pos":[5292,5318],"content":"The Application Definition","linkify":"The Application Definition","nodes":[{"content":"The Application Definition","pos":[0,26]}]},{"content":"To utilize the functionality of the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class, you must implement an application definition.","pos":[5322,5461],"source":"To utilize the functionality of the                  <xref:System.Windows.Application> class, you must implement an application definition."},{"content":"A                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application definition is a class that derives from                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> and is configured with a special                  <ph id=\"ph3\">[!INCLUDE[TLA#tla_msbuild](../../../../includes/tlasharptla-msbuild-md.md)]</ph> setting.","pos":[5462,5788],"source":" A                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application definition is a class that derives from                  <xref:System.Windows.Application> and is configured with a special                  [!INCLUDE[TLA#tla_msbuild](../../../../includes/tlasharptla-msbuild-md.md)] setting."},{"pos":[5798,5836],"content":"Implementing an Application Definition","linkify":"Implementing an Application Definition","nodes":[{"content":"Implementing an Application Definition","pos":[0,38]}]},{"content":"A typical                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application definition is implemented using both markup and code-behind.","pos":[5840,6017],"source":"A typical                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application definition is implemented using both markup and code-behind."},{"content":"This allows you to use markup to declaratively set application properties, resources, and register events, while handling events and implementing application-specific behavior in code-behind.","pos":[6018,6209]},{"content":"The following example shows how to implement an application definition using both markup and code-behind:","pos":[6216,6321]},{"pos":[6328,6481],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationSnippets#ApplicationXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml#applicationxaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationSnippets#ApplicationXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml#applicationxaml)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationSnippets#ApplicationCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml.cs#applicationcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[6488,6659],"source":"[!code-csharp[ApplicationSnippets#ApplicationCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSnippets/CSharp/App.xaml.cs#applicationcodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationSnippets#ApplicationCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSnippets/visualbasic/application.xaml.vb#applicationcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[6661,6846],"source":"[!code-vb[ApplicationSnippets#ApplicationCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSnippets/visualbasic/application.xaml.vb#applicationcodebehind)]"},{"content":"To allow a markup file and code-behind file to work together, the following needs to happen:","pos":[6853,6945]},{"content":"In markup, the                                  <ph id=\"ph1\">`Application`</ph> element must include the                                  <ph id=\"ph2\">`x:Class`</ph> attribute.","pos":[6955,7095],"source":"In markup, the                                  `Application` element must include the                                  `x:Class` attribute."},{"content":"When the application is built, the existence of                                  <ph id=\"ph1\">`x:Class`</ph> in the markup file causes                                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph> to create a                                  <ph id=\"ph3\">`partial`</ph> class that derives from                                  <ph id=\"ph4\">&lt;xref:System.Windows.Application&gt;</ph> and has the name that is specified by the                                  <ph id=\"ph5\">`x:Class`</ph> attribute.","pos":[7096,7565],"source":" When the application is built, the existence of                                  `x:Class` in the markup file causes                                  [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] to create a                                  `partial` class that derives from                                  <xref:System.Windows.Application> and has the name that is specified by the                                  `x:Class` attribute."},{"content":"This requires the addition of an                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)]</ph> namespace declaration for the                                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> schema (                                  <ph id=\"ph3\">`xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"`</ph> ).","pos":[7566,7938],"source":" This requires the addition of an                                  [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] namespace declaration for the                                  [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] schema (                                  `xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"` )."},{"content":"In code-behind, the class must be a                                  <ph id=\"ph1\">`partial`</ph> class with the same name that is specified by the                                  <ph id=\"ph2\">`x:Class`</ph> attribute in markup and must derive from                                  <ph id=\"ph3\">&lt;xref:System.Windows.Application&gt;</ph>.","pos":[7948,8228],"source":"In code-behind, the class must be a                                  `partial` class with the same name that is specified by the                                  `x:Class` attribute in markup and must derive from                                  <xref:System.Windows.Application>."},{"content":"This allows the code-behind file to be associated with the                                  <ph id=\"ph1\">`partial`</ph> class that is generated for the markup file when the application is built (see                                  <bpt id=\"p1\">[</bpt>Building a WPF Application<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/building-a-wpf-application-wpf.md)</ept>).","pos":[8229,8555],"source":" This allows the code-behind file to be associated with the                                  `partial` class that is generated for the markup file when the application is built (see                                  [Building a WPF Application](../../../../docs/framework/wpf/app-development/building-a-wpf-application-wpf.md))."},{"pos":[8563,8869],"content":"[!NOTE]\n When you create a new WPF Application project or WPF Browser Application project using                              [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], an application definition is included by default and is defined using both markup and code-behind.","leadings":["","> "],"nodes":[{"content":"When you create a new WPF Application project or WPF Browser Application project using                              <ph id=\"ph1\">[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)]</ph>, an application definition is included by default and is defined using both markup and code-behind.","pos":[9,304],"source":"When you create a new WPF Application project or WPF Browser Application project using                              [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], an application definition is included by default and is defined using both markup and code-behind."}]},{"content":"This code is the minimum that is required to implement an application definition.","pos":[8876,8957]},{"content":"However, an additional                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph> configuration needs to be made to the application definition before building and running the application.","pos":[8958,9189],"source":" However, an additional                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] configuration needs to be made to the application definition before building and running the application."},{"pos":[9199,9249],"content":"Configuring the Application Definition for MSBuild","linkify":"Configuring the Application Definition for MSBuild","nodes":[{"content":"Configuring the Application Definition for MSBuild","pos":[0,50]}]},{"content":"Standalone applications and                          <ph id=\"ph1\">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]</ph> require the implementation of a certain level of infrastructure before they can run.","pos":[9253,9478],"source":"Standalone applications and                          [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] require the implementation of a certain level of infrastructure before they can run."},{"content":"The most important part of this infrastructure is the entry point.","pos":[9479,9545]},{"content":"When an application is launched by a user, the operating system calls the entry point, which is a well-known function for starting applications.","pos":[9546,9690]},{"content":"Traditionally, developers have needed to write some or all of this code for themselves, depending on the technology.","pos":[9697,9813]},{"content":"However,                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> generates this code for you when the markup file of your application definition is configured as an                          <ph id=\"ph2\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph><ph id=\"ph3\">`ApplicationDefinition`</ph> item, as shown in the following                          <ph id=\"ph4\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph> project file:","pos":[9814,10292],"source":" However,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] generates this code for you when the markup file of your application definition is configured as an                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]`ApplicationDefinition` item, as shown in the following                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] project file:"},{"pos":[10559,10753],"content":"Because the code-behind file contains code, it is marked as an                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph><ph id=\"ph2\">`Compile`</ph> item, as is normal.","source":"Because the code-behind file contains code, it is marked as an                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]`Compile` item, as is normal."},{"pos":[10760,11114],"content":"The application of these                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph> configurations to the markup and code-behind files of an application definition causes                          <ph id=\"ph2\">[!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)]</ph> to generate code like the following:","source":"The application of these                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] configurations to the markup and code-behind files of an application definition causes                          [!INCLUDE[TLA2#tla_msbuild](../../../../includes/tla2sharptla-msbuild-md.md)] to generate code like the following:"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>AppDefAugSnippets#AppDefAugCODE1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode1)</ept><ept id=\"p1\">]</ept>","pos":[11121,11269],"source":"[!code-csharp[AppDefAugSnippets#AppDefAugCODE1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>AppDefAugSnippets#AppDefAugCODE1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode1)</ept><ept id=\"p1\">]</ept>","pos":[11271,11425],"source":"[!code-vb[AppDefAugSnippets#AppDefAugCODE1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode1)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>AppDefAugSnippets#AppDefAugCODE2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode2)</ept><ept id=\"p1\">]</ept>","pos":[11428,11576],"source":"[!code-csharp[AppDefAugSnippets#AppDefAugCODE2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppDefAugSnippets/CSharp/App.cs#appdefaugcode2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>AppDefAugSnippets#AppDefAugCODE2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode2)</ept><ept id=\"p1\">]</ept>","pos":[11577,11731],"source":"[!code-vb[AppDefAugSnippets#AppDefAugCODE2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppDefAugSnippets/VisualBasic/App.vb#appdefaugcode2)]"},{"content":"The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method                          <ph id=\"ph1\">`Main`</ph>.","pos":[11738,11901],"source":"The resulting code augments your application definition with additional infrastructure code, which includes the entry-point method                          `Main`."},{"content":"The                          <ph id=\"ph1\">&lt;xref:System.STAThreadAttribute&gt;</ph> attribute is applied to the                          <ph id=\"ph2\">`Main`</ph> method to indicate that the main                          <ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> thread for the                          <ph id=\"ph4\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application is an STA thread, which is required for                          <ph id=\"ph5\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications.","pos":[11902,12420],"source":" The                          <xref:System.STAThreadAttribute> attribute is applied to the                          `Main` method to indicate that the main                          [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] thread for the                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application is an STA thread, which is required for                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications."},{"content":"When called,                          <ph id=\"ph1\">`Main`</ph> creates a new instance of                          <ph id=\"ph2\">`App`</ph> before calling the                          <ph id=\"ph3\">`InitializeComponent`</ph> method to register the events and set the properties that are implemented in markup.","pos":[12421,12673],"source":" When called,                          `Main` creates a new instance of                          `App` before calling the                          `InitializeComponent` method to register the events and set the properties that are implemented in markup."},{"content":"Because                          <ph id=\"ph1\">`InitializeComponent`</ph> is generated for you, you don't need to explicitly call                          <ph id=\"ph2\">`InitializeComponent`</ph> from an application definition like you do for                          <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Page&gt;</ph> and                          <ph id=\"ph4\">&lt;xref:System.Windows.Window&gt;</ph> implementations.","pos":[12674,13014],"source":" Because                          `InitializeComponent` is generated for you, you don't need to explicitly call                          `InitializeComponent` from an application definition like you do for                          <xref:System.Windows.Controls.Page> and                          <xref:System.Windows.Window> implementations."},{"content":"Finally, the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> method is called to start the application.","pos":[13015,13136],"source":" Finally, the                          <xref:System.Windows.Application.Run%2A> method is called to start the application."},{"pos":[13195,13226],"content":"Getting the Current Application","linkify":"Getting the Current Application","nodes":[{"content":"Getting the Current Application","pos":[0,31]}]},{"content":"Because the functionality of the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class are shared across an application, there can be only one instance of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> class per                  <ph id=\"ph3\">&lt;xref:System.AppDomain&gt;</ph>.","pos":[13230,13494],"source":"Because the functionality of the                  <xref:System.Windows.Application> class are shared across an application, there can be only one instance of the                  <xref:System.Windows.Application> class per                  <xref:System.AppDomain>."},{"content":"To enforce this, the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class is implemented as a singleton class (see                  <bpt id=\"p1\">[</bpt>Implementing Singleton in C#<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=100567)</ept>), which creates a single instance of itself and provides shared access to it with the                  <ph id=\"ph2\">`static`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> property.","pos":[13495,13874],"source":" To enforce this, the                  <xref:System.Windows.Application> class is implemented as a singleton class (see                  [Implementing Singleton in C#](http://go.microsoft.com/fwlink/?LinkId=100567)), which creates a single instance of itself and provides shared access to it with the                  `static`<xref:System.Windows.Application.Current%2A> property."},{"content":"The following code shows how to acquire a reference to the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> object for the current                  <ph id=\"ph2\">&lt;xref:System.AppDomain&gt;</ph>.","pos":[13881,14055],"source":"The following code shows how to acquire a reference to the                  <xref:System.Windows.Application> object for the current                  <xref:System.AppDomain>."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationManagementOverviewSnippets#GetCurrentAppCODE<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getcurrentappcode)</ept><ept id=\"p1\">]</ept>","pos":[14062,14268],"source":"[!code-csharp[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getcurrentappcode)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationManagementOverviewSnippets#GetCurrentAppCODE<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getcurrentappcode)</ept><ept id=\"p1\">]</ept>","pos":[14270,14482],"source":"[!code-vb[ApplicationManagementOverviewSnippets#GetCurrentAppCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getcurrentappcode)]"},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> returns a reference to an instance of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> class.","pos":[14489,14633],"source":"<xref:System.Windows.Application.Current%2A> returns a reference to an instance of the                  <xref:System.Windows.Application> class."},{"content":"If you want a reference to your                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> derived class you must cast the value of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> property, as shown in the following example.","pos":[14634,14868],"source":" If you want a reference to your                  <xref:System.Windows.Application> derived class you must cast the value of the                  <xref:System.Windows.Application.Current%2A> property, as shown in the following example."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getstcurrentappcode)</ept><ept id=\"p1\">]</ept>","pos":[14875,15085],"source":"[!code-csharp[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/MainWindow.xaml.cs#getstcurrentappcode)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getstcurrentappcode)</ept><ept id=\"p1\">]</ept>","pos":[15087,15303],"source":"[!code-vb[ApplicationManagementOverviewSnippets#GetSTCurrentAppCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/VisualBasic/MainWindow.xaml.vb#getstcurrentappcode)]"},{"content":"You can inspect the value of                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Current%2A&gt;</ph> at any point in the lifetime of an                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> object.","pos":[15310,15494],"source":"You can inspect the value of                  <xref:System.Windows.Application.Current%2A> at any point in the lifetime of an                  <xref:System.Windows.Application> object."},{"content":"However, you should be careful.","pos":[15495,15526]},{"content":"After the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> class is instantiated, there is a period during which the state of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> object is inconsistent.","pos":[15527,15733],"source":" After the                  <xref:System.Windows.Application> class is instantiated, there is a period during which the state of the                  <xref:System.Windows.Application> object is inconsistent."},{"content":"During this period,                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events.","pos":[15734,15985],"source":" During this period,                  <xref:System.Windows.Application> is performing the various initialization tasks that are required by your code to run, including establishing application infrastructure, setting properties, and registering events."},{"content":"If you try to use the                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> object during this period, your code may have unexpected results, particularly if it depends on the various                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> properties being set.","pos":[15986,16239],"source":" If you try to use the                  <xref:System.Windows.Application> object during this period, your code may have unexpected results, particularly if it depends on the various                  <xref:System.Windows.Application> properties being set."},{"content":"When                  <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> completes its initialization work, its lifetime truly begins.","pos":[16246,16363],"source":"When                  <xref:System.Windows.Application> completes its initialization work, its lifetime truly begins."},{"pos":[16411,16431],"content":"Application Lifetime","linkify":"Application Lifetime","nodes":[{"content":"Application Lifetime","pos":[0,20]}]},{"pos":[16435,16760],"content":"The lifetime of a                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application is marked by several events that are raised by                  <ph id=\"ph2\">&lt;xref:System.Windows.Application&gt;</ph> to let you know when your application has started, has been activated and deactivated, and has been shut down.","source":"The lifetime of a                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application is marked by several events that are raised by                  <xref:System.Windows.Application> to let you know when your application has started, has been activated and deactivated, and has been shut down."},{"pos":[16805,16818],"content":"Splash Screen","linkify":"Splash Screen","nodes":[{"content":"Splash Screen","pos":[0,13]}]},{"content":"Starting in                          the                         <ph id=\"ph1\">[!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)]</ph>, you can specify an image to be used in a startup window, or                          <bpt id=\"p1\">*</bpt>splash screen<ept id=\"p1\">*</ept>.","pos":[16822,17063],"source":"Starting in                          the                         [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], you can specify an image to be used in a startup window, or                          *splash screen*."},{"content":"The                          <ph id=\"ph1\">&lt;xref:System.Windows.SplashScreen&gt;</ph> class makes it easy to display a startup window while your application is loading.","pos":[17064,17210],"source":" The                          <xref:System.Windows.SplashScreen> class makes it easy to display a startup window while your application is loading."},{"content":"The                          <ph id=\"ph1\">&lt;xref:System.Windows.SplashScreen&gt;</ph> window is created and shown before                          <ph id=\"ph2\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> is called.","pos":[17211,17386],"source":" The                          <xref:System.Windows.SplashScreen> window is created and shown before                          <xref:System.Windows.Application.Run%2A> is called."},{"content":"For more information, see                          <bpt id=\"p1\">[</bpt>Application Startup Time<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/application-startup-time.md)</ept> and                          <bpt id=\"p2\">[</bpt>Add a Splash Screen to a WPF Application<ept id=\"p2\">](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md)</ept>.","pos":[17387,17705],"source":" For more information, see                          [Application Startup Time](../../../../docs/framework/wpf/advanced/application-startup-time.md) and                          [Add a Splash Screen to a WPF Application](../../../../docs/framework/wpf/app-development/how-to-add-a-splash-screen-to-a-wpf-application.md)."},{"pos":[17757,17780],"content":"Starting an Application","linkify":"Starting an Application","nodes":[{"content":"Starting an Application","pos":[0,23]}]},{"content":"After                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Run%2A&gt;</ph> is called and the application is initialized, the application is ready to run.","pos":[17784,17934],"source":"After                          <xref:System.Windows.Application.Run%2A> is called and the application is initialized, the application is ready to run."},{"content":"This moment is signified when the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event is raised:","pos":[17935,18052],"source":" This moment is signified when the                          <xref:System.Windows.Application.Startup> event is raised:"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#StartupCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[18059,18238],"source":"[!code-csharp[ApplicationStartupSnippets#StartupCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#StartupCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[18240,18433],"source":"[!code-vb[ApplicationStartupSnippets#StartupCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#StartupCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[18436,18615],"source":"[!code-csharp[ApplicationStartupSnippets#StartupCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#startupcodebehind2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#StartupCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[18616,18809],"source":"[!code-vb[ApplicationStartupSnippets#StartupCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#startupcodebehind2)]"},{"pos":[18816,18994],"content":"At this point in an application's lifetime, the most common thing to do is to show a                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>.","source":"At this point in an application's lifetime, the most common thing to do is to show a                          [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]."},{"pos":[19047,19071],"content":"Showing a User Interface","linkify":"Showing a User Interface","nodes":[{"content":"Showing a User Interface","pos":[0,24]}]},{"content":"Most standalone                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> applications open a                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> when they begin running.","pos":[19075,19288],"source":"Most standalone                          [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] applications open a                          <xref:System.Windows.Window> when they begin running."},{"content":"The                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event handler is one location from which you can do this, as demonstrated by the following code.","pos":[19289,19456],"source":" The                          <xref:System.Windows.Application.Startup> event handler is one location from which you can do this, as demonstrated by the following code."},{"pos":[19463,19634],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>AppShowWindowHardSnippets#StartupEventMARKUP<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml#startupeventmarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[AppShowWindowHardSnippets#StartupEventMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml#startupeventmarkup)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>AppShowWindowHardSnippets#StartupEventCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml.cs#startupeventcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[19641,19826],"source":"[!code-csharp[AppShowWindowHardSnippets#StartupEventCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/AppShowWindowHardSnippets/CSharp/App.xaml.cs#startupeventcodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>AppShowWindowHardSnippets#StartupEventCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppShowWindowHardSnippets/VisualBasic/Application.xaml.vb#startupeventcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[19828,20027],"source":"[!code-vb[AppShowWindowHardSnippets#StartupEventCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/AppShowWindowHardSnippets/VisualBasic/Application.xaml.vb#startupeventcodebehind)]"},{"pos":[20035,20681],"content":"[!NOTE]\n The first                              <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This                              <xref:System.Windows.Window> object is referenced by the                              <xref:System.Windows.Application.MainWindow%2A?displayProperty=fullName> property. The value of the                              <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated                              <xref:System.Windows.Window> should be the main window.","leadings":["","> "],"nodes":[{"content":"The first                              <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default. This                              <xref:System.Windows.Window> object is referenced by the                              <xref:System.Windows.Application.MainWindow%2A?displayProperty=fullName> property. The value of the                              <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated                              <xref:System.Windows.Window> should be the main window.","pos":[9,644],"nodes":[{"content":"The first                              <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> to be instantiated in a standalone application becomes the main application window by default.","pos":[0,162],"source":"The first                              <xref:System.Windows.Window> to be instantiated in a standalone application becomes the main application window by default."},{"content":"This                              <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> object is referenced by the                              <ph id=\"ph2\">&lt;xref:System.Windows.Application.MainWindow%2A?displayProperty=fullName&gt;</ph> property.","pos":[163,365],"source":" This                              <xref:System.Windows.Window> object is referenced by the                              <xref:System.Windows.Application.MainWindow%2A?displayProperty=fullName> property."},{"content":"The value of the                              <ph id=\"ph1\">&lt;xref:System.Windows.Application.MainWindow%2A&gt;</ph> property can be changed programmatically if a different window than the first instantiated                              <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> should be the main window.","pos":[366,635],"source":" The value of the                              <xref:System.Windows.Application.MainWindow%2A> property can be changed programmatically if a different window than the first instantiated                              <xref:System.Windows.Window> should be the main window."}]}]},{"content":"When an                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> first starts, it will most likely navigate to a                          <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Page&gt;</ph>.","pos":[20688,20902],"source":"When an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] first starts, it will most likely navigate to a                          <xref:System.Windows.Controls.Page>."},{"content":"This is shown in the following code.","pos":[20903,20939]},{"pos":[20946,21109],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>XBAPAppStartupSnippets#StartupXBAPMARKUP<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml#startupxbapmarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[XBAPAppStartupSnippets#StartupXBAPMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml#startupxbapmarkup)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>XBAPAppStartupSnippets#StartupXBAPCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml.cs#startupxbapcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[21116,21293],"source":"[!code-csharp[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XBAPAppStartupSnippets/CSharp/App.xaml.cs#startupxbapcodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>XBAPAppStartupSnippets#StartupXBAPCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XBAPAppStartupSnippets/VisualBasic/Application.xaml.vb#startupxbapcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[21295,21486],"source":"[!code-vb[XBAPAppStartupSnippets#StartupXBAPCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XBAPAppStartupSnippets/VisualBasic/Application.xaml.vb#startupxbapcodebehind)]"},{"pos":[21493,21804],"content":"If you handle                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> to only open a                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> or navigate to a                          <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Page&gt;</ph>, you can set the                          <ph id=\"ph4\">`StartupUri`</ph> attribute in markup instead.","source":"If you handle                          <xref:System.Windows.Application.Startup> to only open a                          <xref:System.Windows.Window> or navigate to a                          <xref:System.Windows.Controls.Page>, you can set the                          `StartupUri` attribute in markup instead."},{"content":"The following example shows how to use the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.StartupUri%2A&gt;</ph> from a standalone application to open a                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[21811,22021],"source":"The following example shows how to use the                          <xref:System.Windows.Application.StartupUri%2A> from a standalone application to open a                          <xref:System.Windows.Window>."},{"pos":[22028,22235],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationManagementOverviewSnippets#OverviewStartupUriMARKUP<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/App.xaml#overviewstartupurimarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationManagementOverviewSnippets#OverviewStartupUriMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationManagementOverviewSnippets/CSharp/App.xaml#overviewstartupurimarkup)]"},{"pos":[22242,22537],"content":"The following example shows how to use                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.StartupUri%2A&gt;</ph> from an                          <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> to navigate to a                          <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Page&gt;</ph>.","source":"The following example shows how to use                          <xref:System.Windows.Application.StartupUri%2A> from an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to navigate to a                          <xref:System.Windows.Controls.Page>."},{"pos":[22544,22693],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>PageSnippets#XBAPStartupUriMARKUP<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PageSnippets/CSharp/App.xaml#xbapstartupurimarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[PageSnippets#XBAPStartupUriMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PageSnippets/CSharp/App.xaml#xbapstartupurimarkup)]"},{"content":"This markup has the same effect as the previous code for opening a window.","pos":[22700,22774]},{"pos":[22782,22955],"content":"[!NOTE]\n For more information on navigation, see                              [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).","leadings":["","> "],"nodes":[{"content":"For more information on navigation, see                              <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/navigation-overview.md)</ept>.","pos":[9,171],"source":"For more information on navigation, see                              [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md)."}]},{"content":"You need to handle the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event to open a                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched.","pos":[22962,23368],"source":"You need to handle the                          <xref:System.Windows.Application.Startup> event to open a                          <xref:System.Windows.Window> if you need to instantiate it using a non-default constructor, or you need to set its properties or subscribe to its events before showing it, or you need to process any command-line arguments that were supplied when the application was launched."},{"pos":[23430,23463],"content":"Processing Command-Line Arguments","linkify":"Processing Command-Line Arguments","nodes":[{"content":"Processing Command-Line Arguments","pos":[0,33]}]},{"content":"In                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph>, standalone applications can be launched from either a command prompt or the desktop.","pos":[23467,23654],"source":"In                          [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)], standalone applications can be launched from either a command prompt or the desktop."},{"content":"In both cases, command-line arguments can be passed to the application.","pos":[23655,23726]},{"content":"The following example shows an application that is launched with a single command-line argument, \"/StartMinimized\":","pos":[23727,23842]},{"content":"During application initialization,                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> retrieves the command-line arguments from the operating system and passes them to the                          <ph id=\"ph2\">&lt;xref:System.Windows.Application.Startup&gt;</ph> event handler via the                          <ph id=\"ph3\">&lt;xref:System.Windows.StartupEventArgs.Args%2A&gt;</ph> property of the                          <ph id=\"ph4\">&lt;xref:System.Windows.StartupEventArgs&gt;</ph> parameter.","pos":[23892,24359],"source":"During application initialization,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] retrieves the command-line arguments from the operating system and passes them to the                          <xref:System.Windows.Application.Startup> event handler via the                          <xref:System.Windows.StartupEventArgs.Args%2A> property of the                          <xref:System.Windows.StartupEventArgs> parameter."},{"content":"You can retrieve and store the command-line arguments using code like the following.","pos":[24360,24444]},{"pos":[24451,24622],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#HandleStartupXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml#handlestartupxaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationStartupSnippets#HandleStartupXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml#handlestartupxaml)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#HandleStartupCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#handlestartupcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[24629,24818],"source":"[!code-csharp[ApplicationStartupSnippets#HandleStartupCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationStartupSnippets/CSharp/App.xaml.cs#handlestartupcodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationStartupSnippets#HandleStartupCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#handlestartupcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[24820,25023],"source":"[!code-vb[ApplicationStartupSnippets#HandleStartupCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationStartupSnippets/visualbasic/application.xaml.vb#handlestartupcodebehind)]"},{"content":"The code handles                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Startup&gt;</ph> to check whether the                          <bpt id=\"p1\">**</bpt>/StartMinimized<ept id=\"p1\">**</ept> command-line argument was provided; if so, it opens the main window with a                          <ph id=\"ph2\">&lt;xref:System.Windows.WindowState&gt;</ph> of                          <ph id=\"ph3\">&lt;xref:System.Windows.WindowState&gt;</ph>.","pos":[25030,25376],"source":"The code handles                          <xref:System.Windows.Application.Startup> to check whether the                          **/StartMinimized** command-line argument was provided; if so, it opens the main window with a                          <xref:System.Windows.WindowState> of                          <xref:System.Windows.WindowState>."},{"content":"Note that because the                          <ph id=\"ph1\">&lt;xref:System.Windows.Window.WindowState%2A&gt;</ph> property must be set programmatically, the main                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> must be opened explicitly in code.","pos":[25377,25604],"source":" Note that because the                          <xref:System.Windows.Window.WindowState%2A> property must be set programmatically, the main                          <xref:System.Windows.Window> must be opened explicitly in code."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph> cannot retrieve and process command-line arguments because they are launched using                          <ph id=\"ph2\">[!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)]</ph> deployment (see                          <bpt id=\"p1\">[</bpt>Deploying a WPF Application<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/deploying-a-wpf-application-wpf.md)</ept>).","pos":[25611,26044],"source":"[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] cannot retrieve and process command-line arguments because they are launched using                          [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] deployment (see                          [Deploying a WPF Application](../../../../docs/framework/wpf/app-development/deploying-a-wpf-application-wpf.md))."},{"content":"However, they can retrieve and process query string parameters from the URLs that are used to launch them.","pos":[26045,26151]},{"pos":[26219,26258],"content":"Application Activation and Deactivation","linkify":"Application Activation and Deactivation","nodes":[{"content":"Application Activation and Deactivation","pos":[0,39]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> allows users to switch between applications.","pos":[26262,26380],"source":"[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] allows users to switch between applications."},{"content":"The most common way is to use the ALT+TAB key combination.","pos":[26381,26439]},{"content":"An application can only be switched to if it has a visible                          <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> that a user can select.","pos":[26440,26576],"source":" An application can only be switched to if it has a visible                          <xref:System.Windows.Window> that a user can select."},{"content":"The currently selected                          <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> is the                          <bpt id=\"p1\">*</bpt>active window<ept id=\"p1\">*</ept> (also known as the                          <bpt id=\"p2\">*</bpt>foreground window<ept id=\"p2\">*</ept>) and is the                          <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> that receives user input.","pos":[26577,26857],"source":" The currently selected                          <xref:System.Windows.Window> is the                          *active window* (also known as the                          *foreground window*) and is the                          <xref:System.Windows.Window> that receives user input."},{"content":"The application with the active window is the                          <bpt id=\"p1\">*</bpt>active application<ept id=\"p1\">*</ept> (or                          <bpt id=\"p2\">*</bpt>foreground application<ept id=\"p2\">*</ept>).","pos":[26858,27005],"source":" The application with the active window is the                          *active application* (or                          *foreground application*)."},{"content":"An application becomes the active application in the following circumstances:","pos":[27006,27083]},{"content":"It is launched and shows a                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[27093,27182],"source":"It is launched and shows a                                  <xref:System.Windows.Window>."},{"content":"A user switches from another application by selecting a                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> in the application.","pos":[27192,27329],"source":"A user switches from another application by selecting a                                  <xref:System.Windows.Window> in the application."},{"content":"You can detect when an application becomes active by handling the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated?displayProperty=fullName&gt;</ph> event.","pos":[27336,27502],"source":"You can detect when an application becomes active by handling the                          <xref:System.Windows.Application.Activated?displayProperty=fullName> event."},{"content":"Likewise, an application can become inactive in the following circumstances:","pos":[27509,27585]},{"content":"A user switches to another application from the current one.","pos":[27595,27655]},{"content":"When the application shuts down.","pos":[27665,27697]},{"content":"You can detect when an application becomes inactive by handling the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Deactivated?displayProperty=fullName&gt;</ph> event.","pos":[27704,27874],"source":"You can detect when an application becomes inactive by handling the                          <xref:System.Windows.Application.Deactivated?displayProperty=fullName> event."},{"content":"The following code shows how to handle the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated&gt;</ph> and                          <ph id=\"ph2\">&lt;xref:System.Windows.Application.Deactivated&gt;</ph> events to determine whether an application is active.","pos":[27881,28121],"source":"The following code shows how to handle the                          <xref:System.Windows.Application.Activated> and                          <xref:System.Windows.Application.Deactivated> events to determine whether an application is active."},{"pos":[28128,28321],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationActivationSnippets#DetectActivationStateXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml#detectactivationstatexaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationActivationSnippets#DetectActivationStateXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml#detectactivationstatexaml)]"},{"pos":[28328,28766],"content":"[!code-csharp[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)]\n[!code-vb[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)]","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationActivationSnippets#DetectActivationStateCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)</ept><ept id=\"p1\">]</ept>","pos":[0,211],"source":"[!code-csharp[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationActivationSnippets/CSharp/App.xaml.cs#detectactivationstatecodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationActivationSnippets#DetectActivationStateCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)</ept><ept id=\"p1\">]</ept>","pos":[212,437],"source":"[!code-vb[ApplicationActivationSnippets#DetectActivationStateCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationActivationSnippets/visualbasic/application.xaml.vb#detectactivationstatecodebehind)]"}]},{"content":"A                          <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> can also be activated and deactivated.","pos":[28773,28867],"source":"A                          <xref:System.Windows.Window> can also be activated and deactivated."},{"content":"See                          <ph id=\"ph1\">&lt;xref:System.Windows.Window.Activated?displayProperty=fullName&gt;</ph> and                          <ph id=\"ph2\">&lt;xref:System.Windows.Window.Deactivated?displayProperty=fullName&gt;</ph> for more information.","pos":[28868,29077],"source":" See                          <xref:System.Windows.Window.Activated?displayProperty=fullName> and                          <xref:System.Windows.Window.Deactivated?displayProperty=fullName> for more information."},{"pos":[29085,29439],"content":"[!NOTE]\n Neither                              <xref:System.Windows.Application.Activated?displayProperty=fullName> nor                              <xref:System.Windows.Application.Deactivated?displayProperty=fullName> is raised for                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].","leadings":["","> "],"nodes":[{"content":"Neither                              <ph id=\"ph1\">&lt;xref:System.Windows.Application.Activated?displayProperty=fullName&gt;</ph> nor                              <ph id=\"ph2\">&lt;xref:System.Windows.Application.Deactivated?displayProperty=fullName&gt;</ph> is raised for                              <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>.","pos":[9,352],"source":"Neither                              <xref:System.Windows.Application.Activated?displayProperty=fullName> nor                              <xref:System.Windows.Application.Deactivated?displayProperty=fullName> is raised for                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]."}]},{"pos":[29488,29508],"content":"Application Shutdown","linkify":"Application Shutdown","nodes":[{"content":"Application Shutdown","pos":[0,20]}]},{"content":"The life of an application ends when it is shut down, which can occur for the following reasons:","pos":[29512,29608]},{"content":"A user closes every                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[29618,29700],"source":"A user closes every                                  <xref:System.Windows.Window>."},{"content":"A user closes the main                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[29710,29795],"source":"A user closes the main                                  <xref:System.Windows.Window>."},{"pos":[29805,29968],"content":"A user ends the                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> session by logging off or shutting down.","source":"A user ends the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session by logging off or shutting down."},{"content":"An application-specific condition has been met.","pos":[29978,30025]},{"content":"To help you manage application shutdown,                          <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> provides the                          <ph id=\"ph2\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method, the                          <ph id=\"ph3\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> property, and the                          <ph id=\"ph4\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> and                          <ph id=\"ph5\">&lt;xref:System.Windows.Application.Exit&gt;</ph> events.","pos":[30032,30469],"source":"To help you manage application shutdown,                          <xref:System.Windows.Application> provides the                          <xref:System.Windows.Application.Shutdown%2A> method, the                          <xref:System.Windows.Application.ShutdownMode%2A> property, and the                          <xref:System.Windows.Application.SessionEnding> and                          <xref:System.Windows.Application.Exit> events."},{"pos":[30477,31006],"content":"[!NOTE]\n <xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have                              <xref:System.Security.Permissions.UIPermission>. Standalone                              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications always have this permission. However,                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] running in the Internet zone partial-trust security sandbox do not.","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have                              <xref:System.Security.Permissions.UIPermission>. Standalone                              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications always have this permission. However,                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] running in the Internet zone partial-trust security sandbox do not.","pos":[9,527],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> can only be called from applications that have                              <ph id=\"ph2\">&lt;xref:System.Security.Permissions.UIPermission&gt;</ph>.","pos":[0,170],"source":"<xref:System.Windows.Application.Shutdown%2A> can only be called from applications that have                              <xref:System.Security.Permissions.UIPermission>."},{"content":"Standalone                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications always have this permission.","pos":[171,322],"source":" Standalone                              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications always have this permission."},{"content":"However,                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph> running in the Internet zone partial-trust security sandbox do not.","pos":[323,518],"source":" However,                              [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] running in the Internet zone partial-trust security sandbox do not."}]}]},{"pos":[31017,31030],"content":"Shutdown Mode","linkify":"Shutdown Mode","nodes":[{"content":"Shutdown Mode","pos":[0,13]}]},{"content":"Most applications shut down either when all the windows are closed or when the main window is closed.","pos":[31034,31135]},{"content":"Sometimes, however, other application-specific conditions may determine when an application shuts down.","pos":[31136,31239]},{"content":"You can specify the conditions under which your application will shut down by setting                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> with one of the following                                  <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode&gt;</ph> enumeration values:","pos":[31240,31522],"source":" You can specify the conditions under which your application will shut down by setting                                  <xref:System.Windows.Application.ShutdownMode%2A> with one of the following                                  <xref:System.Windows.ShutdownMode> enumeration values:"},{"content":"The default value of                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> is                                  <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode&gt;</ph>, which means that an application automatically shuts down when the last window in the application is closed by the user.","pos":[31661,31956],"source":"The default value of                                  <xref:System.Windows.Application.ShutdownMode%2A> is                                  <xref:System.Windows.ShutdownMode>, which means that an application automatically shuts down when the last window in the application is closed by the user."},{"content":"However, if your application should be shut down when the main window is closed,                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> automatically does that if you set                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> to                                  <ph id=\"ph3\">&lt;xref:System.Windows.ShutdownMode&gt;</ph>.","pos":[31957,32330],"source":" However, if your application should be shut down when the main window is closed,                                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] automatically does that if you set                                  <xref:System.Windows.Application.ShutdownMode%2A> to                                  <xref:System.Windows.ShutdownMode>."},{"content":"This is shown in the following example.","pos":[32331,32370]},{"pos":[32377,32568],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationShutdownModeSnippets#OnMainWindowCloseMARKUP<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationShutdownModeSnippets/CS/Page1.xaml#onmainwindowclosemarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationShutdownModeSnippets#OnMainWindowCloseMARKUP](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationShutdownModeSnippets/CS/Page1.xaml#onmainwindowclosemarkup)]"},{"content":"When you have application-specific shutdown conditions, you set                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> to                                  <ph id=\"ph2\">&lt;xref:System.Windows.ShutdownMode&gt;</ph>.","pos":[32575,32793],"source":"When you have application-specific shutdown conditions, you set                                  <xref:System.Windows.Application.ShutdownMode%2A> to                                  <xref:System.Windows.ShutdownMode>."},{"content":"In this case, it is your responsibility to shut an application down by explicitly calling the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> method; otherwise, your application will continue running even if all the windows are closed.","pos":[32794,33060],"source":" In this case, it is your responsibility to shut an application down by explicitly calling the                                  <xref:System.Windows.Application.Shutdown%2A> method; otherwise, your application will continue running even if all the windows are closed."},{"content":"Note that                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%2A&gt;</ph> is called implicitly when the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> is either                                  <ph id=\"ph3\">&lt;xref:System.Windows.ShutdownMode&gt;</ph> or                                  <ph id=\"ph4\">&lt;xref:System.Windows.ShutdownMode&gt;</ph>.","pos":[33061,33412],"source":" Note that                                  <xref:System.Windows.Application.Shutdown%2A> is called implicitly when the                                  <xref:System.Windows.Application.ShutdownMode%2A> is either                                  <xref:System.Windows.ShutdownMode> or                                  <xref:System.Windows.ShutdownMode>."},{"pos":[33420,34116],"content":"[!NOTE]\n <xref:System.Windows.Application.ShutdownMode%2A> can be set from an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], but it is ignored; an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is always shut down when it is navigated away from in a browser or when the browser that hosts the                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed. For more information, see                                      [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).","leadings":["","> "],"nodes":[{"content":"<xref:System.Windows.Application.ShutdownMode%2A> can be set from an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], but it is ignored; an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is always shut down when it is navigated away from in a browser or when the browser that hosts the                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed. For more information, see                                      [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).","pos":[9,694],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> can be set from an                                      <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph>, but it is ignored; an                                      <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> is always shut down when it is navigated away from in a browser or when the browser that hosts the                                      <ph id=\"ph4\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> is closed.","pos":[0,528],"source":"<xref:System.Windows.Application.ShutdownMode%2A> can be set from an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], but it is ignored; an                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is always shut down when it is navigated away from in a browser or when the browser that hosts the                                      [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed."},{"content":"For more information, see                                      <bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/navigation-overview.md)</ept>.","pos":[529,685],"source":" For more information, see                                      [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md)."}]}]},{"pos":[34127,34141],"content":"Session Ending","linkify":"Session Ending","nodes":[{"content":"Session Ending","pos":[0,14]}]},{"content":"The shutdown conditions that are described by the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.ShutdownMode%2A&gt;</ph> property are specific to an application.","pos":[34145,34318],"source":"The shutdown conditions that are described by the                                  <xref:System.Windows.Application.ShutdownMode%2A> property are specific to an application."},{"content":"In some cases, though, an application may shut down as a result of an external condition.","pos":[34319,34408]},{"content":"The most common external condition occurs when a user ends the                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> session by the following actions:","pos":[34409,34612],"source":" The most common external condition occurs when a user ends the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session by the following actions:"},{"content":"Logging off","pos":[34622,34633]},{"content":"Shutting down","pos":[34643,34656]},{"content":"Restarting","pos":[34666,34676]},{"content":"Hibernating","pos":[34686,34697]},{"pos":[34704,34989],"content":"To detect when a                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> session ends, you can handle the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> event, as illustrated in the following example.","source":"To detect when a                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session ends, you can handle the                                  <xref:System.Windows.Application.SessionEnding> event, as illustrated in the following example."},{"pos":[34996,35195],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationSessionEndingSnippets#HandlingSessionEndingXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml#handlingsessionendingxaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationSessionEndingSnippets#HandlingSessionEndingXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml#handlingsessionendingxaml)]"},{"pos":[35202,35652],"content":"[!code-csharp[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)]\n[!code-vb[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)]","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[0,217],"source":"[!code-csharp[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/CSharp/App.xaml.cs#handlingsessionendingcodebehind)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)</ept><ept id=\"p1\">]</ept>","pos":[218,449],"source":"[!code-vb[ApplicationSessionEndingSnippets#HandlingSessionEndingCODEBEHIND](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationSessionEndingSnippets/visualbasic/application.xaml.vb#handlingsessionendingcodebehind)]"}]},{"content":"In this example, the code inspects the                                  <ph id=\"ph1\">&lt;xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A&gt;</ph> property to determine how the                                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> session is ending.","pos":[35659,35960],"source":"In this example, the code inspects the                                  <xref:System.Windows.SessionEndingCancelEventArgs.ReasonSessionEnding%2A> property to determine how the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session is ending."},{"content":"It uses this value to display a confirmation message to the user.","pos":[35961,36026]},{"content":"If the user does not want the session to end, the code sets                                  <ph id=\"ph1\">&lt;xref:System.ComponentModel.CancelEventArgs.Cancel%2A&gt;</ph> to                                  <ph id=\"ph2\">`true`</ph> to prevent the                                  <ph id=\"ph3\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> session from ending.","pos":[36027,36360],"source":" If the user does not want the session to end, the code sets                                  <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> to                                  `true` to prevent the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] session from ending."},{"pos":[36368,36572],"content":"[!NOTE]\n <xref:System.Windows.Application.SessionEnding> is not raised for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.SessionEnding&gt;</ph> is not raised for                                      <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>.","pos":[9,202],"source":"<xref:System.Windows.Application.SessionEnding> is not raised for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]."}]},{"pos":[36583,36587],"content":"Exit","linkify":"Exit","nodes":[{"content":"Exit","pos":[0,4]}]},{"content":"When an application shuts down, it may need to perform some final processing, such as persisting application state.","pos":[36591,36706]},{"content":"For these situations, you can handle the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event.","pos":[36707,36826],"source":" For these situations, you can handle the                                  <xref:System.Windows.Application.Exit> event."},{"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml1)</ept><ept id=\"p1\">]</ept>","pos":[36833,37050],"source":"[!code-xml[HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml1)]"},{"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml2)</ept><ept id=\"p1\">]</ept>","pos":[37053,37270],"source":"[!code-xml[HOWTOApplicationModelSnippets#PersistRestoreAppScopePropertiesXAML2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml#persistrestoreappscopepropertiesxaml2)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[37277,37498],"source":"[!code-csharp[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[37500,37735],"source":"[!code-vb[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[37738,37959],"source":"[!code-csharp[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/CSharp/App.xaml.cs#persistappscopepropertiescodebehind2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[37960,38195],"source":"[!code-vb[HOWTOApplicationModelSnippets#PersistAppScopePropertiesCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HOWTOApplicationModelSnippets/visualbasic/application.xaml.vb#persistappscopepropertiescodebehind2)]"},{"pos":[38202,38444],"content":"For the complete example, see                                  <bpt id=\"p1\">[</bpt>Persist and Restore Application-Scope Properties Across Application Sessions<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md)</ept>.","source":"For the complete example, see                                  [Persist and Restore Application-Scope Properties Across Application Sessions](../../../../docs/framework/wpf/app-development/persist-and-restore-application-scope-properties.md)."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> can be handled by both standalone applications and                                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>.","pos":[38451,38664],"source":"<xref:System.Windows.Application.Exit> can be handled by both standalone applications and                                  [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]."},{"content":"For                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>,                                  <ph id=\"ph2\">&lt;xref:System.Windows.Application.Exit&gt;</ph> is raised when in the following circumstances:","pos":[38665,38911],"source":" For                                  [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)],                                  <xref:System.Windows.Application.Exit> is raised when in the following circumstances:"},{"pos":[38921,39060],"content":"An                                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> is navigated away from.","source":"An                                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is navigated away from."},{"pos":[39070,39341],"content":"In                                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)]</ph>, when the tab that is hosting the                                          <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph> is closed.","source":"In                                          [!INCLUDE[TLA2#tla_ie7](../../../../includes/tla2sharptla-ie7-md.md)], when the tab that is hosting the                                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] is closed."},{"content":"When the browser is closed.","pos":[39351,39378]},{"pos":[39389,39398],"content":"Exit Code","linkify":"Exit Code","nodes":[{"content":"Exit Code","pos":[0,9]}]},{"content":"Applications are mostly launched by the operating system in response to a user request.","pos":[39402,39489]},{"content":"However, an application can be launched by another application to perform some specific task.","pos":[39490,39583]},{"content":"When the launched application shuts down, the launching application may want to know the condition under which the launched application shut down.","pos":[39584,39730]},{"content":"In these situations,                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> allows applications to return an application exit code on shutdown.","pos":[39731,39926],"source":" In these situations,                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] allows applications to return an application exit code on shutdown."},{"content":"By default,                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications return an exit code value of 0.","pos":[39927,40086],"source":" By default,                                  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications return an exit code value of 0."},{"pos":[40094,40422],"content":"[!NOTE]\n When you debug from                                      [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], the application exit code is displayed in the                                      **Output** window when the application shuts down, in a message that looks like the following:","leadings":["","> "],"nodes":[{"content":"When you debug from                                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]</ph>, the application exit code is displayed in the                                      <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window when the application shuts down, in a message that looks like the following:","pos":[9,326],"source":"When you debug from                                      [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], the application exit code is displayed in the                                      **Output** window when the application shuts down, in a message that looks like the following:"}]},{"pos":[40524,40710],"content":"You open the                                      <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window by clicking                                      <bpt id=\"p2\">**</bpt>Output<ept id=\"p2\">**</ept> on the                                      <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","source":"You open the                                      **Output** window by clicking                                      **Output** on the                                      **View** menu."},{"content":"To change the exit code, you can call the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Shutdown%28System.Int32%29&gt;</ph> overload, which accepts an integer argument to be the exit code:","pos":[40717,40917],"source":"To change the exit code, you can call the                                  <xref:System.Windows.Application.Shutdown%28System.Int32%29> overload, which accepts an integer argument to be the exit code:"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationExitSnippets#AppExitCODE<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationExitSnippets/CSharp/MainWindow.xaml.cs#appexitcode)</ept><ept id=\"p1\">]</ept>","pos":[40924,41090],"source":"[!code-csharp[ApplicationExitSnippets#AppExitCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationExitSnippets/CSharp/MainWindow.xaml.cs#appexitcode)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationExitSnippets#AppExitCODE<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationExitSnippets/visualbasic/mainwindow.xaml.vb#appexitcode)</ept><ept id=\"p1\">]</ept>","pos":[41092,41264],"source":"[!code-vb[ApplicationExitSnippets#AppExitCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationExitSnippets/visualbasic/mainwindow.xaml.vb#appexitcode)]"},{"content":"You can detect the value of the exit code, and change it, by handling the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event.","pos":[41271,41423],"source":"You can detect the value of the exit code, and change it, by handling the                                  <xref:System.Windows.Application.Exit> event."},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph> event handler is passed an                                  <ph id=\"ph2\">&lt;xref:System.Windows.ExitEventArgs&gt;</ph> which provides access to the exit code with the                                  <ph id=\"ph3\">&lt;xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A&gt;</ph> property.","pos":[41424,41745],"source":" The                                  <xref:System.Windows.Application.Exit> event handler is passed an                                  <xref:System.Windows.ExitEventArgs> which provides access to the exit code with the                                  <xref:System.Windows.ExitEventArgs.ApplicationExitCode%2A> property."},{"content":"For more information, see                                  <ph id=\"ph1\">&lt;xref:System.Windows.Application.Exit&gt;</ph>.","pos":[41746,41844],"source":" For more information, see                                  <xref:System.Windows.Application.Exit>."},{"pos":[41852,42224],"content":"[!NOTE]\n You can set the exit code in both standalone applications and                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]. However, the exit code value is ignored for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].","leadings":["","> "],"nodes":[{"content":"You can set the exit code in both standalone applications and                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]. However, the exit code value is ignored for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)].","pos":[9,370],"nodes":[{"content":"You can set the exit code in both standalone applications and                                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>.","pos":[0,189],"source":"You can set the exit code in both standalone applications and                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]."},{"content":"However, the exit code value is ignored for                                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph>.","pos":[190,361],"source":" However, the exit code value is ignored for                                      [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]."}]}]},{"pos":[42273,42293],"content":"Unhandled Exceptions","linkify":"Unhandled Exceptions","nodes":[{"content":"Unhandled Exceptions","pos":[0,20]}]},{"content":"Sometimes an application may shut down under abnormal conditions, such as when an unanticipated exception is thrown.","pos":[42297,42413]},{"content":"In this case, the application may not have the code to detect and process the exception.","pos":[42414,42502]},{"content":"This type of exception is an unhandled exception; a notification similar to that shown in the following figure is displayed before the application is closed.","pos":[42503,42660]},{"pos":[42667,42836],"content":"<bpt id=\"p1\">![</bpt>Unhandled exception notification<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/app-development/media/applicationmanagementoverviewfigure2.png \"</bpt>ApplicationManagementOverviewFigure2<ept id=\"p2\">\")</ept>","source":"![Unhandled exception notification](../../../../docs/framework/wpf/app-development/media/applicationmanagementoverviewfigure2.png \"ApplicationManagementOverviewFigure2\")"},{"content":"From the user experience perspective, it is better for an application to avoid this default behavior by doing some or all of the following:","pos":[42843,42982]},{"content":"Displaying user-friendly information.","pos":[42992,43029]},{"content":"Attempting to keep an application running.","pos":[43039,43081]},{"pos":[43091,43277],"content":"Recording detailed, developer-friendly, exception information in the                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> event log.","source":"Recording detailed, developer-friendly, exception information in the                                  [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] event log."},{"content":"Implementing this support depends on being able to detect unhandled exceptions, which is what the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event is raised for.","pos":[43284,43490],"source":"Implementing this support depends on being able to detect unhandled exceptions, which is what the                          <xref:System.Windows.Application.DispatcherUnhandledException> event is raised for."},{"pos":[43497,43752],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml#handledispatcherunhandledexceptionxaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml#handledispatcherunhandledexceptionxaml)]"},{"pos":[43759,44893],"content":"[!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind1)]\n[!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind1)]  \n[!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind2)]\n[!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind2)]","leadings":[""," ","",""],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[0,275],"source":"[!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind1)</ept><ept id=\"p1\">]</ept>","pos":[276,565],"source":"[!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind1)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[568,843],"source":"[!code-csharp[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/CSharp/App.xaml.cs#handledispatcherunhandledexceptioncodebehind2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind2)</ept><ept id=\"p1\">]</ept>","pos":[844,1133],"source":"[!code-vb[ApplicationDispatcherUnhandledExceptionSnippets#HandleDispatcherUnhandledExceptionCODEBEHIND2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/ApplicationDispatcherUnhandledExceptionSnippets/visualbasic/application.xaml.vb#handledispatcherunhandledexceptioncodebehind2)]"}]},{"content":"The                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event handler is passed a                          <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs&gt;</ph> parameter that contains contextual information regarding the unhandled exception, including the exception itself (                         <ph id=\"ph3\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=fullName&gt;</ph>).","pos":[44900,45361],"source":"The                          <xref:System.Windows.Application.DispatcherUnhandledException> event handler is passed a                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs> parameter that contains contextual information regarding the unhandled exception, including the exception itself (                         <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Exception%2A?displayProperty=fullName>)."},{"content":"You can use this information to determine how to handle the exception.","pos":[45362,45432]},{"content":"When you handle                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph>, you should set the                          <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=fullName&gt;</ph> property to                          <ph id=\"ph3\">`true`</ph>; otherwise,                          <ph id=\"ph4\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> still considers the exception to be unhandled and reverts to the default behavior described earlier.","pos":[45439,45945],"source":"When you handle                          <xref:System.Windows.Application.DispatcherUnhandledException>, you should set the                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A?displayProperty=fullName> property to                          `true`; otherwise,                          [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] still considers the exception to be unhandled and reverts to the default behavior described earlier."},{"content":"If an unhandled exception is raised and either the                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> event is not handled, or the event is handled and                          <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A&gt;</ph> is set to                          <ph id=\"ph3\">`false`</ph>, the application shuts down immediately.","pos":[45946,46324],"source":" If an unhandled exception is raised and either the                          <xref:System.Windows.Application.DispatcherUnhandledException> event is not handled, or the event is handled and                          <xref:System.Windows.Threading.DispatcherUnhandledExceptionEventArgs.Handled%2A> is set to                          `false`, the application shuts down immediately."},{"content":"Furthermore, no other                          <ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph> events are raised.","pos":[46325,46424],"source":" Furthermore, no other                          <xref:System.Windows.Application> events are raised."},{"content":"Consequently, you need to handle                          <ph id=\"ph1\">&lt;xref:System.Windows.Application.DispatcherUnhandledException&gt;</ph> if your application has code that must run before the application shuts down.","pos":[46425,46623],"source":" Consequently, you need to handle                          <xref:System.Windows.Application.DispatcherUnhandledException> if your application has code that must run before the application shuts down."},{"content":"Although an application may shut down as a result of an unhandled exception, an application usually shuts down in response to a user request, as discussed in the next section.","pos":[46630,46805]},{"pos":[46861,46888],"content":"Application Lifetime Events","linkify":"Application Lifetime Events","nodes":[{"content":"Application Lifetime Events","pos":[0,27]}]},{"content":"Standalone applications and                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]</ph> don't have exactly the same lifetimes.","pos":[46892,47073],"source":"Standalone applications and                          [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] don't have exactly the same lifetimes."},{"content":"The following figure illustrates the key events in the lifetime of a standalone application and shows the sequence in which they are raised.","pos":[47074,47214]},{"pos":[47221,47436],"content":"<bpt id=\"p1\">![</bpt>Standalone Application &amp;#45; Application Object Events<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents.png \"</bpt>ApplicationModelOverview_ApplicationObjectEvents<ept id=\"p2\">\")</ept>","source":"![Standalone Application &#45; Application Object Events](../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents.png \"ApplicationModelOverview_ApplicationObjectEvents\")"},{"pos":[47443,47669],"content":"Likewise, the following figure illustrates the key events in the lifetime of an                          <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</ph>, and shows the sequence in which they are raised.","source":"Likewise, the following figure illustrates the key events in the lifetime of an                          [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], and shows the sequence in which they are raised."},{"pos":[47676,47883],"content":"<bpt id=\"p1\">![</bpt>XBAP &amp;#45; Application Object Events<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents-xbap.png \"</bpt>ApplicationModelOverview_ApplicationObjectEvents_xbap<ept id=\"p2\">\")</ept>","source":"![XBAP &#45; Application Object Events](../../../../docs/framework/wpf/app-development/media/applicationmodeloverview-applicationobjectevents-xbap.png \"ApplicationModelOverview_ApplicationObjectEvents_xbap\")"},{"pos":[47892,47900],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Application&gt;</ph>","pos":[47904,47937],"source":"<xref:System.Windows.Application> "},{"content":"<bpt id=\"p1\">[</bpt>WPF Windows Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[47942,48037],"source":"[WPF Windows Overview](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Navigation Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/navigation-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[48041,48134],"source":"[Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>WPF Application Resource, Content, and Data Files<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[48138,48289],"source":"[WPF Application Resource, Content, and Data Files](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md) "},{"content":"<bpt id=\"p1\">[</bpt>Pack URIs in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/pack-uris-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[48293,48380],"source":"[Pack URIs in WPF](../../../../docs/framework/wpf/app-development/pack-uris-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Application Model: How-to Topics<ept id=\"p1\">](http://msdn.microsoft.com/en-us/76771b09-3688-4d1c-8818-9b3f4cf39a30)</ept><ph id=\"ph1\"> </ph>","pos":[48384,48489],"source":"[Application Model: How-to Topics](http://msdn.microsoft.com/en-us/76771b09-3688-4d1c-8818-9b3f4cf39a30) "},{"content":"<bpt id=\"p1\">[</bpt>Application Development<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/index.md)</ept>","pos":[48493,48575],"source":"[Application Development](../../../../docs/framework/wpf/app-development/index.md)"}]}