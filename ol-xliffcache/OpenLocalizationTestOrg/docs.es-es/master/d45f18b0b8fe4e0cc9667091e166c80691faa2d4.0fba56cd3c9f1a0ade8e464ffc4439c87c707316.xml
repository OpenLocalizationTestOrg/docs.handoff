{"content":"---\ntitle: \"How to: Create Temporary Certificates for Use During Development\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"certificates [WCF], creating temporary certificates\"\n  - \"temporary certificates [WCF]\"\nms.assetid: bc5f6637-5513-4d27-99bb-51aad7741e4a\n---\n# How to: Create Temporary Certificates for Use During Development\n\nWhen developing a secure service or client using Windows Communication Foundation (WCF), it is often necessary to supply an X.509 certificate to be used as a credential. The certificate typically is part of a chain of certificates with a root authority found in the Trusted Root Certification Authorities store of the computer. Having a certificate chain enables you to scope a set of certificates where typically the root authority is from your organization or business unit. To emulate this at development time, you can create two certificates to satisfy the security requirements. The first is a self-signed certificate that is placed in the Trusted Root Certification Authorities store, and the second certificate is created from the first and is placed in either the Personal store of the Local Machine location, or the Personal store of the Current User location. This topic walks through the steps to create these two certificates using the Powershell [New-SelfSignedCertificate)](/powershell/module/pkiclient/new-selfsignedcertificate) cmdlet.\n\n> [!IMPORTANT]\n> The certificates that the New-SelfSignedCertificate cmdlet generates are provided for testing purposes only. When deploying a service or client, be sure to use an appropriate certificate provided by a certification authority. This could either be from a Windows Server certificate server in your organization or a third party.\n>\n> By default, the [New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate) cmdlet creates certificates that are self-signed and these certificates are insecure. Placing the self-signed certificates in the Trusted Root Certification Authorities store enables you to create a development environment that more closely simulates your deployment environment.\n\n For more information about creating and using certificates, see [Working with Certificates](working-with-certificates.md). For more information about using a certificate as a credential, see [Securing Services and Clients](securing-services-and-clients.md). For a tutorial about using Microsoft Authenticode technology, see [Authenticode Overviews and Tutorials](https://go.microsoft.com/fwlink/?LinkId=88919).\n\n## To create a self-signed root authority certificate and export the private key\n\nThe following command creates a self-signed certificate with a subject name of \"RootCA\" in the Current User Personal store.\n\n```powershell\nPS $rootCert = New-SelfSignedCertificate -CertStoreLocation cert:\\CurrentUser\\My -DnsName \"RootCA\" -TextExtension @(\"1.3.6.1.4.1.311.21.10={text}1.3.6.1.5.5.7.3.1,1.3.6.1.5.5.7.3.2\")\n```\n\nWe need to export the certificate to a PFX file so that it can be imported to where it's needed in a later step. When exporting a certificate with the private key, a password is needed to protect it. We save the password in a `SecureString` and use the [Export-PfxCertificate](/powershell/module/pkiclient/export-pfxcertificate) cmdlet to export the certificate with the associated private key to a PFX file. We also save just the public certificate into a CRT file using the [Export-Certificate](/powershell/module/pkiclient/export-certificate) cmdlet.\n\n```powershell\nPS [System.Security.SecureString]$rootcertPassword = ConvertTo-SecureString -String \"password\" -Force -AsPlainText\nPS [String]$rootCertPath = Join-Path -Path 'cert:\\CurrentUser\\My\\' -ChildPath \"$($rootcert.Thumbprint)\"\nPS Export-PfxCertificate -Cert $rootCertPath -FilePath 'RootCA.pfx' -Password $rootcertPassword\nPS Export-Certificate -Cert $rootCertPath -FilePath 'RootCA.crt'\n```\n\n## To create a new certificate signed by a root authority certificate\n\nThe following command creates a certificate signed by the `RootCA` with a subject name of \"SignedByRootCA\" using the private key of the issuer.\n\n```powershell\nPS $testCert = New-SelfSignedCertificate -CertStoreLocation Cert:\\LocalMachine\\My -DnsName \"SignedByRootCA\" -KeyExportPolicy Exportable -KeyLength 2048 -KeyUsage DigitalSignature,KeyEncipherment -Signer $rootCert\n```\n\nSimilarly, we save the signed certificate with private key into a PFX file and just the public key into a CRT file.\n\n```powershell\nPS [String]$testCertPath = Join-Path -Path 'cert:\\LocalMachine\\My\\' -ChildPath \"$($testCert.Thumbprint)\"\nPS Export-PfxCertificate -Cert $testCertPath -FilePath testcert.pfx -Password $rootcertPassword\nPS Export-Certificate -Cert $testCertPath -FilePath testcert.crt\n```\n\n## Installing a Certificate in the Trusted Root Certification Authorities Store\n\nOnce a self-signed certificate is created, you can install it in the Trusted Root Certification Authorities store. Any certificates that are signed with the certificate at this point are trusted by the computer. For this reason, delete the certificate from the store as soon as you no longer need it. When you delete this root authority certificate, all other certificates that signed with it become unauthorized. Root authority certificates are simply a mechanism whereby a group of certificates can be scoped as necessary. For example, in peer-to-peer applications, there is typically no need for a root authority because you simply trust the identity of an individual by its supplied certificate.\n\n### To install a self-signed certificate in the Trusted Root Certification Authorities\n\n1. Open the certificate snap-in. For more information, see [How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md).\n\n2. Open the folder to store the certificate, either the **Local Computer** or the **Current User**.\n\n3. Open the **Trusted Root Certification Authorities** folder.\n\n4. Right-click the **Certificates** folder and click **All Tasks**, then click **Import**.\n\n5. Follow the on-screen wizard instructions to import the RootCA.pfx into the store.\n\n## Using certificates With WCF\n\nOnce you have set up the temporary certificates, you can use them to develop WCF solutions that specify certificates as a client credential type. For example, the following XML configuration specifies message security and a certificate as the client credential type.\n\n### To specify a certificate as the client credential type\n\n1. In the configuration file for a service, use the following XML to set the security mode to message, and the client credential type to certificate.\n\n    ```xml\n    <bindings>\n      <wsHttpBinding>\n        <binding name=\"CertificateForClient\">\n          <security>\n            <message clientCredentialType=\"Certificate\" />\n          </security>\n        </binding>\n      </wsHttpBinding>\n    </bindings>\n    ```\n\n2. In the configuration file for a client, use the following XML to specify that the certificate is found in the user’s store, and can be found by searching the SubjectName field for the value \"CohoWinery.\"\n\n    ```xml\n    <behaviors>\n      <endpointBehaviors>\n        <behavior name=\"CertForClient\">\n          <clientCredentials>\n            <clientCertificate findValue=\"CohoWinery\" x509FindType=\"FindBySubjectName\" />\n          </clientCredentials>\n        </behavior>\n      </endpointBehaviors>\n    </behaviors>\n    ```\n\nFor more information about using certificates in WCF, see [Working with Certificates](working-with-certificates.md).\n\n## .NET Framework security\n\nBe sure to delete any temporary root authority certificates from the **Trusted Root Certification Authorities** and **Personal** folders by right-clicking the certificate, then clicking **Delete**.\n\n## See also\n\n- [Working with Certificates](working-with-certificates.md)\n- [How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md)\n- [Securing Services and Clients](securing-services-and-clients.md)\n","nodes":[{"pos":[4,263],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create Temporary Certificates for Use During Development\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"certificates [WCF], creating temporary certificates\"\n  - \"temporary certificates [WCF]\"\nms.assetid: bc5f6637-5513-4d27-99bb-51aad7741e4a","nodes":[{"content":"How to: Create Temporary Certificates for Use During Development","nodes":[{"pos":[0,64],"content":"How to: Create Temporary Certificates for Use During Development","nodes":[{"content":"How to: Create Temporary Certificates for Use During Development","pos":[0,64]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[270,334],"content":"How to: Create Temporary Certificates for Use During Development","linkify":"How to: Create Temporary Certificates for Use During Development","nodes":[{"content":"How to: Create Temporary Certificates for Use During Development","pos":[0,64]}]},{"content":"When developing a secure service or client using Windows Communication Foundation (WCF), it is often necessary to supply an X.509 certificate to be used as a credential.","pos":[336,505]},{"content":"The certificate typically is part of a chain of certificates with a root authority found in the Trusted Root Certification Authorities store of the computer.","pos":[506,663]},{"content":"Having a certificate chain enables you to scope a set of certificates where typically the root authority is from your organization or business unit.","pos":[664,812]},{"content":"To emulate this at development time, you can create two certificates to satisfy the security requirements.","pos":[813,919]},{"content":"The first is a self-signed certificate that is placed in the Trusted Root Certification Authorities store, and the second certificate is created from the first and is placed in either the Personal store of the Local Machine location, or the Personal store of the Current User location.","pos":[920,1205]},{"content":"This topic walks through the steps to create these two certificates using the Powershell <bpt id=\"p1\">[</bpt>New-SelfSignedCertificate)<ept id=\"p1\">](/powershell/module/pkiclient/new-selfsignedcertificate)</ept> cmdlet.","pos":[1206,1387],"source":" This topic walks through the steps to create these two certificates using the Powershell [New-SelfSignedCertificate)](/powershell/module/pkiclient/new-selfsignedcertificate) cmdlet."},{"pos":[1391,1732],"content":"[!IMPORTANT]\nThe certificates that the New-SelfSignedCertificate cmdlet generates are provided for testing purposes only. When deploying a service or client, be sure to use an appropriate certificate provided by a certification authority. This could either be from a Windows Server certificate server in your organization or a third party.","leadings":["","> "],"nodes":[{"content":"The certificates that the New-SelfSignedCertificate cmdlet generates are provided for testing purposes only. When deploying a service or client, be sure to use an appropriate certificate provided by a certification authority. This could either be from a Windows Server certificate server in your organization or a third party.","pos":[13,339],"nodes":[{"content":"The certificates that the New-SelfSignedCertificate cmdlet generates are provided for testing purposes only.","pos":[0,108]},{"content":"When deploying a service or client, be sure to use an appropriate certificate provided by a certification authority.","pos":[109,225]},{"content":"This could either be from a Windows Server certificate server in your organization or a third party.","pos":[226,326]}]}]},{"content":"By default, the <bpt id=\"p1\">[</bpt>New-SelfSignedCertificate<ept id=\"p1\">](/powershell/module/pkiclient/new-selfsignedcertificate)</ept> cmdlet creates certificates that are self-signed and these certificates are insecure.","pos":[1737,1922],"source":"By default, the [New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate) cmdlet creates certificates that are self-signed and these certificates are insecure."},{"content":"Placing the self-signed certificates in the Trusted Root Certification Authorities store enables you to create a development environment that more closely simulates your deployment environment.","pos":[1923,2116]},{"content":"For more information about creating and using certificates, see <bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](working-with-certificates.md)</ept>.","pos":[2119,2241],"source":"For more information about creating and using certificates, see [Working with Certificates](working-with-certificates.md)."},{"content":"For more information about using a certificate as a credential, see <bpt id=\"p1\">[</bpt>Securing Services and Clients<ept id=\"p1\">](securing-services-and-clients.md)</ept>.","pos":[2242,2376],"source":" For more information about using a certificate as a credential, see [Securing Services and Clients](securing-services-and-clients.md)."},{"content":"For a tutorial about using Microsoft Authenticode technology, see <bpt id=\"p1\">[</bpt>Authenticode Overviews and Tutorials<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=88919)</ept>.","pos":[2377,2529],"source":" For a tutorial about using Microsoft Authenticode technology, see [Authenticode Overviews and Tutorials](https://go.microsoft.com/fwlink/?LinkId=88919)."},{"pos":[2534,2611],"content":"To create a self-signed root authority certificate and export the private key","linkify":"To create a self-signed root authority certificate and export the private key","nodes":[{"content":"To create a self-signed root authority certificate and export the private key","pos":[0,77]}]},{"content":"The following command creates a self-signed certificate with a subject name of \"RootCA\" in the Current User Personal store.","pos":[2613,2736]},{"content":"We need to export the certificate to a PFX file so that it can be imported to where it's needed in a later step.","pos":[2940,3052]},{"content":"When exporting a certificate with the private key, a password is needed to protect it.","pos":[3053,3139]},{"content":"We save the password in a <ph id=\"ph1\">`SecureString`</ph> and use the <bpt id=\"p1\">[</bpt>Export-PfxCertificate<ept id=\"p1\">](/powershell/module/pkiclient/export-pfxcertificate)</ept> cmdlet to export the certificate with the associated private key to a PFX file.","pos":[3140,3348],"source":" We save the password in a `SecureString` and use the [Export-PfxCertificate](/powershell/module/pkiclient/export-pfxcertificate) cmdlet to export the certificate with the associated private key to a PFX file."},{"content":"We also save just the public certificate into a CRT file using the <bpt id=\"p1\">[</bpt>Export-Certificate<ept id=\"p1\">](/powershell/module/pkiclient/export-certificate)</ept> cmdlet.","pos":[3349,3493],"source":" We also save just the public certificate into a CRT file using the [Export-Certificate](/powershell/module/pkiclient/export-certificate) cmdlet."},{"pos":[3897,3963],"content":"To create a new certificate signed by a root authority certificate","linkify":"To create a new certificate signed by a root authority certificate","nodes":[{"content":"To create a new certificate signed by a root authority certificate","pos":[0,66]}]},{"pos":[3965,4108],"content":"The following command creates a certificate signed by the <ph id=\"ph1\">`RootCA`</ph> with a subject name of \"SignedByRootCA\" using the private key of the issuer.","source":"The following command creates a certificate signed by the `RootCA` with a subject name of \"SignedByRootCA\" using the private key of the issuer."},{"content":"Similarly, we save the signed certificate with private key into a PFX file and just the public key into a CRT file.","pos":[4342,4457]},{"pos":[4747,4823],"content":"Installing a Certificate in the Trusted Root Certification Authorities Store","linkify":"Installing a Certificate in the Trusted Root Certification Authorities Store","nodes":[{"content":"Installing a Certificate in the Trusted Root Certification Authorities Store","pos":[0,76]}]},{"content":"Once a self-signed certificate is created, you can install it in the Trusted Root Certification Authorities store.","pos":[4825,4939]},{"content":"Any certificates that are signed with the certificate at this point are trusted by the computer.","pos":[4940,5036]},{"content":"For this reason, delete the certificate from the store as soon as you no longer need it.","pos":[5037,5125]},{"content":"When you delete this root authority certificate, all other certificates that signed with it become unauthorized.","pos":[5126,5238]},{"content":"Root authority certificates are simply a mechanism whereby a group of certificates can be scoped as necessary.","pos":[5239,5349]},{"content":"For example, in peer-to-peer applications, there is typically no need for a root authority because you simply trust the identity of an individual by its supplied certificate.","pos":[5350,5524]},{"pos":[5530,5612],"content":"To install a self-signed certificate in the Trusted Root Certification Authorities","linkify":"To install a self-signed certificate in the Trusted Root Certification Authorities","nodes":[{"content":"To install a self-signed certificate in the Trusted Root Certification Authorities","pos":[0,82]}]},{"content":"Open the certificate snap-in.","pos":[5617,5646]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: View Certificates with the MMC Snap-in<ept id=\"p1\">](how-to-view-certificates-with-the-mmc-snap-in.md)</ept>.","pos":[5647,5772],"source":" For more information, see [How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md)."},{"pos":[5777,5873],"content":"Open the folder to store the certificate, either the <bpt id=\"p1\">**</bpt>Local Computer<ept id=\"p1\">**</ept> or the <bpt id=\"p2\">**</bpt>Current User<ept id=\"p2\">**</ept>.","source":"Open the folder to store the certificate, either the **Local Computer** or the **Current User**."},{"pos":[5878,5937],"content":"Open the <bpt id=\"p1\">**</bpt>Trusted Root Certification Authorities<ept id=\"p1\">**</ept> folder.","source":"Open the **Trusted Root Certification Authorities** folder."},{"pos":[5942,6029],"content":"Right-click the <bpt id=\"p1\">**</bpt>Certificates<ept id=\"p1\">**</ept> folder and click <bpt id=\"p2\">**</bpt>All Tasks<ept id=\"p2\">**</ept>, then click <bpt id=\"p3\">**</bpt>Import<ept id=\"p3\">**</ept>.","source":"Right-click the **Certificates** folder and click **All Tasks**, then click **Import**."},{"content":"Follow the on-screen wizard instructions to import the RootCA.pfx into the store.","pos":[6034,6115]},{"pos":[6120,6147],"content":"Using certificates With WCF","linkify":"Using certificates With WCF","nodes":[{"content":"Using certificates With WCF","pos":[0,27]}]},{"content":"Once you have set up the temporary certificates, you can use them to develop WCF solutions that specify certificates as a client credential type.","pos":[6149,6294]},{"content":"For example, the following XML configuration specifies message security and a certificate as the client credential type.","pos":[6295,6415]},{"pos":[6421,6475],"content":"To specify a certificate as the client credential type","linkify":"To specify a certificate as the client credential type","nodes":[{"content":"To specify a certificate as the client credential type","pos":[0,54]}]},{"content":"In the configuration file for a service, use the following XML to set the security mode to message, and the client credential type to certificate.","pos":[6480,6626]},{"content":"In the configuration file for a client, use the following XML to specify that the certificate is found in the user’s store, and can be found by searching the SubjectName field for the value \"CohoWinery.\"","pos":[6894,7097]},{"pos":[7416,7532],"content":"For more information about using certificates in WCF, see <bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](working-with-certificates.md)</ept>.","source":"For more information about using certificates in WCF, see [Working with Certificates](working-with-certificates.md)."},{"pos":[7537,7560],"content":".NET Framework security","linkify":".NET Framework security","nodes":[{"content":".NET Framework security","pos":[0,23]}]},{"pos":[7562,7759],"content":"Be sure to delete any temporary root authority certificates from the <bpt id=\"p1\">**</bpt>Trusted Root Certification Authorities<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Personal<ept id=\"p2\">**</ept> folders by right-clicking the certificate, then clicking <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept>.","source":"Be sure to delete any temporary root authority certificates from the **Trusted Root Certification Authorities** and **Personal** folders by right-clicking the certificate, then clicking **Delete**."},{"pos":[7764,7772],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7776,7833],"content":"<bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](working-with-certificates.md)</ept>","source":"[Working with Certificates](working-with-certificates.md)"},{"pos":[7836,7934],"content":"<bpt id=\"p1\">[</bpt>How to: View Certificates with the MMC Snap-in<ept id=\"p1\">](how-to-view-certificates-with-the-mmc-snap-in.md)</ept>","source":"[How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md)"},{"pos":[7937,8002],"content":"<bpt id=\"p1\">[</bpt>Securing Services and Clients<ept id=\"p1\">](securing-services-and-clients.md)</ept>","source":"[Securing Services and Clients](securing-services-and-clients.md)"}]}