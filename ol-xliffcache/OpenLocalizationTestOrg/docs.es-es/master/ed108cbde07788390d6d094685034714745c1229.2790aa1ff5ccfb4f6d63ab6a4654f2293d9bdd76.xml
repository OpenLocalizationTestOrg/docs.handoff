{"content":"---\ntitle: \"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: edacbcd3-f3e4-4429-a8be-28a58dc0dd70\ncaps.latest.revision: 4\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)\nThis example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents. This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree. A simple string search is performed in this example. However, more complex types of pattern matching can be performed with a regular expression. For more information, see [How to: Combine LINQ Queries with Regular Expressions (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md).  \n  \n## Example  \n  \n```vb  \nModule Module1  \n    'QueryContents  \n    Public Sub Main()  \n  \n        ' Modify this path as necessary.  \n        Dim startFolder = \"c:\\program files\\Microsoft Visual Studio 9.0\\VB\\\"  \n  \n        'Take a snapshot of the folder contents  \n        Dim dir As New System.IO.DirectoryInfo(startFolder)  \n        Dim fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories)  \n  \n        Dim searchTerm = \"Visual Studio\"  \n  \n        ' Search the contents of each file.  \n        ' A regular expression created with the RegEx class  \n        ' could be used instead of the Contains method.  \n        Dim queryMatchingFiles = From file In fileList _  \n                                 Where file.Extension = \".htm\" _  \n                                 Let fileText = GetFileText(file.FullName) _  \n                                 Where fileText.Contains(searchTerm) _  \n                                 Select file.FullName  \n  \n        Console.WriteLine(\"The term \" & searchTerm & \" was found in:\")  \n  \n        ' Execute the query.  \n        For Each filename In queryMatchingFiles  \n            Console.WriteLine(filename)  \n        Next  \n  \n        ' Keep the console window open in debug mode.  \n        Console.WriteLine(\"Press any key to exit\")  \n        Console.ReadKey()  \n  \n    End Sub  \n  \n    ' Read the contents of the file. This is done in a separate  \n    ' function in order to handle potential file system errors.  \n    Function GetFileText(ByVal name As String) As String  \n  \n        ' If the file has been deleted, the right thing  \n        ' to do in this case is return an empty string.  \n        Dim fileContents = String.Empty  \n  \n        ' If the file has been deleted since we took   \n        ' the snapshot, ignore it and return the empty string.  \n        If System.IO.File.Exists(name) Then  \n            fileContents = System.IO.File.ReadAllText(name)  \n        End If  \n  \n        Return fileContents  \n  \n    End Function  \nEnd Module  \n```  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace.  \n  \n## See Also  \n [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)   \n [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)","nodes":[{"pos":[12,98],"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic) | Microsoft Docs","pos":[0,86]}]},{"pos":[479,548],"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","linkify":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","pos":[0,69]}]},{"content":"This example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents.","pos":[549,672]},{"content":"This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree.","pos":[673,783]},{"content":"A simple string search is performed in this example.","pos":[784,836]},{"content":"However, more complex types of pattern matching can be performed with a regular expression.","pos":[837,928]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Combine LINQ Queries with Regular Expressions (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)</ept>.","pos":[929,1140],"source":" For more information, see [How to: Combine LINQ Queries with Regular Expressions (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)."},{"pos":[1149,1156],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3163,3181],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[3185,3348],"content":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a <ph id=\"ph1\">`Imports`</ph> statement for the System.Linq namespace.","source":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace."},{"pos":[3357,3365],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</ept><ph id=\"ph1\"> </ph>","pos":[3369,3479],"source":"[LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md) "},{"content":"<bpt id=\"p1\"> [</bpt>LINQ and File Directories (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","pos":[3482,3612],"source":" [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}