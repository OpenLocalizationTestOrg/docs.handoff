{"content":"---\ntitle: \"How to: Open files with the OpenFileDialog component\"\nms.date: \"02/11/2019\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"OpenFileDialog component [Windows Forms], opening files\"\n  - \"OpenFile method [Windows Forms], OpenFileDialog component\"\n  - \"files [Windows Forms], opening with OpenFileDialog component\"\nms.assetid: 9d88367a-cc21-4ffd-be74-89fd63767d35\n---\n# How to: Open files with the OpenFileDialog \n\nThe <xref:System.Windows.Forms.OpenFileDialog?displayProperty=nameWithType> component opens the Windows dialog box for browsing and selecting files. To open and read the selected files, you can use the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A?displayProperty=nameWithType> method, or create an instance of the <xref:System.IO.StreamReader?displayProperty=nameWithType> class. The following examples show both approaches. \n\nIn .NET Framework, to get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. The examples run a <xref:System.Security.Permissions.FileIOPermission> permission check, and can throw an exception due to insufficient privileges if run in a partial-trust context. For more information, see [Code access security basics](../../misc/code-access-security-basics.md).\n\nYou can build and run these examples as .NET Framework apps from the C# or Visual Basic command line. For more information, see [Command-line building with csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md) or [Build from the command line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md). \n\nStarting with .NET Core 3.0, you can also build and run the examples as Windows .NET Core apps from a folder that has a .NET Core Windows Forms *\\<folder name>.csproj* project file. \n\n## Example: Read a file as a stream with StreamReader  \n  \nThe following example uses the Windows Forms <xref:System.Windows.Forms.Button> control's <xref:System.Windows.Forms.Control.Click> event handler to open the <xref:System.Windows.Forms.OpenFileDialog> with the <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> method. After the user chooses a file and selects **OK**, an instance of the <xref:System.IO.StreamReader> class reads the file and displays its contents in the form's text box. For more information about reading from file streams, see <xref:System.IO.FileStream.BeginRead%2A?displayProperty=nameWithType> and <xref:System.IO.FileStream.Read%2A?displayProperty=nameWithType>.  \n\n [!code-csharp[OpenFileDialog#1](~/samples/snippets/winforms/open-files/example1/cs/Form1.cs)]\n [!code-vb[OpenFileDialog#1](~/samples/snippets/winforms/open-files/example1/vb/Form1.vb)]  \n\n## Example: Open a file from a filtered selection with OpenFile \n\nThe following example uses the <xref:System.Windows.Forms.Button> control's <xref:System.Windows.Forms.Control.Click> event handler to open the <xref:System.Windows.Forms.OpenFileDialog> with a filter that shows only text files. After the user chooses a text file and selects **OK**, the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A> method is used to open the file in Notepad.\n\n [!code-csharp[OpenFileDialog#2](~/samples/snippets/winforms/open-files/example2/cs/Form1.cs)]\n [!code-vb[OpenFileDialog#2](~/samples/snippets/winforms/open-files/example2/vb/Form1.vb)]  \n\n## See also\n\n- <xref:System.Windows.Forms.OpenFileDialog>\n- [OpenFileDialog component](openfiledialog-component-windows-forms.md)\n","nodes":[{"pos":[4,385],"embed":true,"restype":"x-metadata","content":"title: \"How to: Open files with the OpenFileDialog component\"\nms.date: \"02/11/2019\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"OpenFileDialog component [Windows Forms], opening files\"\n  - \"OpenFile method [Windows Forms], OpenFileDialog component\"\n  - \"files [Windows Forms], opening with OpenFileDialog component\"\nms.assetid: 9d88367a-cc21-4ffd-be74-89fd63767d35","nodes":[{"content":"How to: Open files with the OpenFileDialog component","nodes":[{"pos":[0,52],"content":"How to: Open files with the OpenFileDialog component","nodes":[{"content":"How to: Open files with the OpenFileDialog component","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[392,434],"content":"How to: Open files with the OpenFileDialog","linkify":"How to: Open files with the OpenFileDialog","nodes":[{"content":"How to: Open files with the OpenFileDialog","pos":[0,42]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog?displayProperty=nameWithType&gt;</ph> component opens the Windows dialog box for browsing and selecting files.","pos":[437,585],"source":"The <xref:System.Windows.Forms.OpenFileDialog?displayProperty=nameWithType> component opens the Windows dialog box for browsing and selecting files."},{"content":"To open and read the selected files, you can use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A?displayProperty=nameWithType&gt;</ph> method, or create an instance of the <ph id=\"ph2\">&lt;xref:System.IO.StreamReader?displayProperty=nameWithType&gt;</ph> class.","pos":[586,825],"source":" To open and read the selected files, you can use the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A?displayProperty=nameWithType> method, or create an instance of the <xref:System.IO.StreamReader?displayProperty=nameWithType> class."},{"content":"The following examples show both approaches.","pos":[826,870]},{"content":"In .NET Framework, to get or set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FileDialog.FileName%2A&gt;</ph> property requires a privilege level granted by the <ph id=\"ph2\">&lt;xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType&gt;</ph> class.","pos":[873,1099],"source":"In .NET Framework, to get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class."},{"content":"The examples run a <ph id=\"ph1\">&lt;xref:System.Security.Permissions.FileIOPermission&gt;</ph> permission check, and can throw an exception due to insufficient privileges if run in a partial-trust context.","pos":[1100,1281],"source":" The examples run a <xref:System.Security.Permissions.FileIOPermission> permission check, and can throw an exception due to insufficient privileges if run in a partial-trust context."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code access security basics<ept id=\"p1\">](../../misc/code-access-security-basics.md)</ept>.","pos":[1282,1381],"source":" For more information, see [Code access security basics](../../misc/code-access-security-basics.md)."},{"content":"You can build and run these examples as .NET Framework apps from the C# or Visual Basic command line.","pos":[1383,1484]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Command-line building with csc.exe<ept id=\"p1\">](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept> or <bpt id=\"p2\">[</bpt>Build from the command line<ept id=\"p2\">](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept>.","pos":[1485,1761],"source":" For more information, see [Command-line building with csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md) or [Build from the command line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)."},{"pos":[1764,1945],"content":"Starting with .NET Core 3.0, you can also build and run the examples as Windows .NET Core apps from a folder that has a .NET Core Windows Forms <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>folder name&gt;.csproj<ept id=\"p1\">*</ept> project file.","source":"Starting with .NET Core 3.0, you can also build and run the examples as Windows .NET Core apps from a folder that has a .NET Core Windows Forms *\\<folder name>.csproj* project file."},{"pos":[1951,2001],"content":"Example: Read a file as a stream with StreamReader","linkify":"Example: Read a file as a stream with StreamReader","nodes":[{"content":"Example: Read a file as a stream with StreamReader","pos":[0,50]}]},{"content":"The following example uses the Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler to open the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> with the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.CommonDialog.ShowDialog%2A&gt;</ph> method.","pos":[2007,2279],"source":"The following example uses the Windows Forms <xref:System.Windows.Forms.Button> control's <xref:System.Windows.Forms.Control.Click> event handler to open the <xref:System.Windows.Forms.OpenFileDialog> with the <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> method."},{"content":"After the user chooses a file and selects <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, an instance of the <ph id=\"ph1\">&lt;xref:System.IO.StreamReader&gt;</ph> class reads the file and displays its contents in the form's text box.","pos":[2280,2449],"source":" After the user chooses a file and selects **OK**, an instance of the <xref:System.IO.StreamReader> class reads the file and displays its contents in the form's text box."},{"content":"For more information about reading from file streams, see <ph id=\"ph1\">&lt;xref:System.IO.FileStream.BeginRead%2A?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.IO.FileStream.Read%2A?displayProperty=nameWithType&gt;</ph>.","pos":[2450,2647],"source":" For more information about reading from file streams, see <xref:System.IO.FileStream.BeginRead%2A?displayProperty=nameWithType> and <xref:System.IO.FileStream.Read%2A?displayProperty=nameWithType>."},{"pos":[2843,2903],"content":"Example: Open a file from a filtered selection with OpenFile","linkify":"Example: Open a file from a filtered selection with OpenFile","nodes":[{"content":"Example: Open a file from a filtered selection with OpenFile","pos":[0,60]}]},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler to open the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> with a filter that shows only text files.","pos":[2906,3134],"source":"The following example uses the <xref:System.Windows.Forms.Button> control's <xref:System.Windows.Forms.Control.Click> event handler to open the <xref:System.Windows.Forms.OpenFileDialog> with a filter that shows only text files."},{"content":"After the user chooses a text file and selects <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A&gt;</ph> method is used to open the file in Notepad.","pos":[3135,3292],"source":" After the user chooses a text file and selects **OK**, the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A> method is used to open the file in Notepad."},{"pos":[3486,3494],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3543,3612],"content":"<bpt id=\"p1\">[</bpt>OpenFileDialog component<ept id=\"p1\">](openfiledialog-component-windows-forms.md)</ept>","source":"[OpenFileDialog component](openfiledialog-component-windows-forms.md)"}]}