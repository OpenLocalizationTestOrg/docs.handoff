{"content":"---\ntitle: \"Durable Delay in XAMLX | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: efc38df4-2d34-453c-8e59-2c21d1307354\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Durable Delay in XAMLX\nThis sample demonstrates how to use a durable delay, which is a delay that persists the workflow to a durable device during the delay.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Services\\DurableDelayXamlx`  \n  \n## Discussion  \n The sample workflow contains two messages to a local file that are separated by a delay. When the delay is triggered, the workflow is unloaded and waits 5 seconds in the workflow instance store before being reloaded in memory.  \n  \n The .xamlx file is a workflow service that is hosted in [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]. [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)] uses Cassini that uses a workflow service host to host the workflow.  \n  \n In addition to hosting the workflow, the workflow service host manages the workflow instances by loading and unloading them. To start an instance of the [!INCLUDE[wf](../../../../includes/wf-md.md)] definition (on the workflow service host), set a client that sends a message to the <xref:System.ServiceModel.Activities.Receive> activity in the workflow. This <xref:System.ServiceModel.Activities.Receive> has its <xref:System.ServiceModel.Activities.Receive.CanCreateInstance%2A> property set to `true`, enabling it to create a new instance of the workflow once it receives a message.  \n  \n During initialization, an unload instance behavior is added to the configuration file that specifies to the workflow service host under which it should unload an instance to the persistence store (database). For this sample, it unloads the instance immediately after the workflow goes idle (when the delay is triggered).  \n  \n#### To use this sample  \n  \n1.  Open a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt.  \n  \n2.  Navigate to the DurableDelayXamlx\\CS folder.  \n  \n3.  Run Setup.cmd.  \n  \n4.  Run [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] as an administrator.  \n  \n5.  Open the DurableDelayXamlx.sln solution file.  \n  \n6.  In **Solution Explorer**, right-click the solution and select **Properties**.  \n  \n7.  Select **Multiple startup projects** and set both projects to **Start**.  \n  \n8.  To build the solution, press CTRL+SHIFT+B.  \n  \n9. To run the solution, press CTRL+F5.  \n  \n#### To uninstall this sample  \n  \n1.  Open a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt.  \n  \n2.  Navigate to the DurableDelayXamlx\\CS folder.  \n  \n3.  Run Cleanup.cmd.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Services\\DurableDelayXamlX`","nodes":[{"pos":[12,51],"content":"Durable Delay in XAMLX | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Durable Delay in XAMLX | Microsoft Docs","pos":[0,39]}]},{"pos":[316,338],"content":"Durable Delay in XAMLX","linkify":"Durable Delay in XAMLX","nodes":[{"content":"Durable Delay in XAMLX","pos":[0,22]}]},{"content":"This sample demonstrates how to use a durable delay, which is a delay that persists the workflow to a durable device during the delay.","pos":[339,473]},{"pos":[481,613],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[667,993],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[994,1044]},{"pos":[1132,1142],"content":"Discussion","linkify":"Discussion","nodes":[{"content":"Discussion","pos":[0,10]}]},{"content":"The sample workflow contains two messages to a local file that are separated by a delay.","pos":[1146,1234]},{"content":"When the delay is triggered, the workflow is unloaded and waits 5 seconds in the workflow instance store before being reloaded in memory.","pos":[1235,1372]},{"content":"The .xamlx file is a workflow service that is hosted in <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]</ph>.","pos":[1379,1509],"source":"The .xamlx file is a workflow service that is hosted in [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]</ph> uses Cassini that uses a workflow service host to host the workflow.","pos":[1510,1652],"source":"[!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)] uses Cassini that uses a workflow service host to host the workflow."},{"content":"In addition to hosting the workflow, the workflow service host manages the workflow instances by loading and unloading them.","pos":[1659,1783]},{"content":"To start an instance of the <ph id=\"ph1\">[!INCLUDE[wf](../../../../includes/wf-md.md)]</ph> definition (on the workflow service host), set a client that sends a message to the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.Receive&gt;</ph> activity in the workflow.","pos":[1784,2013],"source":" To start an instance of the [!INCLUDE[wf](../../../../includes/wf-md.md)] definition (on the workflow service host), set a client that sends a message to the <xref:System.ServiceModel.Activities.Receive> activity in the workflow."},{"content":"This <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Receive&gt;</ph> has its <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.Receive.CanCreateInstance%2A&gt;</ph> property set to <ph id=\"ph3\">`true`</ph>, enabling it to create a new instance of the workflow once it receives a message.","pos":[2014,2244],"source":" This <xref:System.ServiceModel.Activities.Receive> has its <xref:System.ServiceModel.Activities.Receive.CanCreateInstance%2A> property set to `true`, enabling it to create a new instance of the workflow once it receives a message."},{"content":"During initialization, an unload instance behavior is added to the configuration file that specifies to the workflow service host under which it should unload an instance to the persistence store (database).","pos":[2251,2458]},{"content":"For this sample, it unloads the instance immediately after the workflow goes idle (when the delay is triggered).","pos":[2459,2571]},{"pos":[2582,2600],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[2610,2686],"content":"Open a <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph> command prompt.","source":"Open a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt."},{"content":"Navigate to the DurableDelayXamlx\\CS folder.","pos":[2696,2740]},{"content":"Run Setup.cmd.","pos":[2750,2764]},{"pos":[2774,2852],"content":"Run <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph> as an administrator.","source":"Run [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] as an administrator."},{"content":"Open the DurableDelayXamlx.sln solution file.","pos":[2862,2907]},{"pos":[2917,2994],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the solution and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"In **Solution Explorer**, right-click the solution and select **Properties**."},{"pos":[3004,3076],"content":"Select <bpt id=\"p1\">**</bpt>Multiple startup projects<ept id=\"p1\">**</ept> and set both projects to <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept>.","source":"Select **Multiple startup projects** and set both projects to **Start**."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[3086,3128]},{"content":"To run the solution, press CTRL+F5.","pos":[3137,3172]},{"pos":[3183,3207],"content":"To uninstall this sample","linkify":"To uninstall this sample","nodes":[{"content":"To uninstall this sample","pos":[0,24]}]},{"pos":[3217,3293],"content":"Open a <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph> command prompt.","source":"Open a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt."},{"content":"Navigate to the DurableDelayXamlx\\CS folder.","pos":[3303,3347]},{"content":"Run Cleanup.cmd.","pos":[3357,3373]},{"pos":[3381,3513],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3567,3893],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3894,3944]}]}