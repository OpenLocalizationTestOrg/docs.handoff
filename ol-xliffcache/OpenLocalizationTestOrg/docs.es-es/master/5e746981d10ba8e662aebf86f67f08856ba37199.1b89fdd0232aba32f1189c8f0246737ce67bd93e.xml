{"content":"---\ntitle: \"Return type of function '<procedurename>' is not CLS-compliant\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"bc40027\"\n  - \"vbc40027\"\nhelpviewer_keywords: \n  - \"BC40027\"\nms.assetid: 33c088c7-48e7-400c-920e-6d8967e1f3fc\n---\n# Return type of function '\\<procedurename>' is not CLS-compliant\nA `Function` procedure is marked as `<CLSCompliant(True)>` but returns a type that is marked as `<CLSCompliant(False)>`, is not marked, or does not qualify because it is a noncompliant type.  \n  \n For a procedure to be compliant with the [Language Independence and Language-Independent Components](../../../standard/language-independence-and-language-independent-components.md) (CLS), it must use only CLS-compliant types. This applies to the types of the parameters, the return type, and the types of all its local variables.  \n  \n The following Visual Basic data types are not CLS-compliant:  \n  \n-   [SByte Data Type](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)  \n  \n-   [UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)  \n  \n-   [ULong Data Type](../../../visual-basic/language-reference/data-types/ulong-data-type.md)  \n  \n-   [UShort Data Type](../../../visual-basic/language-reference/data-types/ushort-data-type.md)  \n  \n When you apply the <xref:System.CLSCompliantAttribute> to a programming element, you set the attribute's `isCompliant` parameter to either `True` or `False` to indicate compliance or noncompliance. There is no default for this parameter, and you must supply a value.  \n  \n If you do not apply the <xref:System.CLSCompliantAttribute> to an element, it is considered to be noncompliant.  \n  \n By default, this message is a warning. For information on hiding warnings or treating warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic).  \n  \n **Error ID:** BC40027  \n  \n## To correct this error  \n  \n-   If the `Function` procedure must return this particular type, remove the <xref:System.CLSCompliantAttribute>. The procedure cannot be CLS-compliant.  \n  \n-   If the `Function` procedure must be CLS-compliant, change the return type to the closest CLS-compliant type. For example, in place of `UInteger` you might be able to use `Integer` if you do not need the value range above 2,147,483,647. If you do need the extended range, you can replace `UInteger` with `Long`.  \n  \n-   If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]. For example, `int` is often 16 bits in other environments. If you are returning a 16-bit integer to such a component, declare it as `Short` instead of `Integer` in your managed Visual Basic code.","nodes":[{"pos":[4,223],"embed":true,"restype":"x-metadata","content":"title: \"Return type of function '<procedurename>' is not CLS-compliant\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"bc40027\"\n  - \"vbc40027\"\nhelpviewer_keywords: \n  - \"BC40027\"\nms.assetid: 33c088c7-48e7-400c-920e-6d8967e1f3fc","nodes":[{"content":"Return type of function '<procedurename>' is not CLS-compliant","nodes":[{"pos":[0,62],"content":"Return type of function '<ph id=\"ph1\">&lt;procedurename&gt;</ph>' is not CLS-compliant","source":"Return type of function '<procedurename>' is not CLS-compliant"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[230,293],"content":"Return type of function '\\<procedurename>' is not CLS-compliant","linkify":"Return type of function '\\<procedurename>' is not CLS-compliant","nodes":[{"content":"Return type of function '<ph id=\"ph1\">\\&lt;</ph>procedurename&gt;' is not CLS-compliant","pos":[0,63],"source":"Return type of function '\\<procedurename>' is not CLS-compliant"}]},{"pos":[294,484],"content":"A <ph id=\"ph1\">`Function`</ph> procedure is marked as <ph id=\"ph2\">`&lt;CLSCompliant(True)&gt;`</ph> but returns a type that is marked as <ph id=\"ph3\">`&lt;CLSCompliant(False)&gt;`</ph>, is not marked, or does not qualify because it is a noncompliant type.","source":"A `Function` procedure is marked as `<CLSCompliant(True)>` but returns a type that is marked as `<CLSCompliant(False)>`, is not marked, or does not qualify because it is a noncompliant type."},{"content":"For a procedure to be compliant with the <bpt id=\"p1\">[</bpt>Language Independence and Language-Independent Components<ept id=\"p1\">](../../../standard/language-independence-and-language-independent-components.md)</ept> (CLS), it must use only CLS-compliant types.","pos":[491,716],"source":"For a procedure to be compliant with the [Language Independence and Language-Independent Components](../../../standard/language-independence-and-language-independent-components.md) (CLS), it must use only CLS-compliant types."},{"content":"This applies to the types of the parameters, the return type, and the types of all its local variables.","pos":[717,820]},{"content":"The following Visual Basic data types are not CLS-compliant:","pos":[827,887]},{"pos":[897,986],"content":"<bpt id=\"p1\">[</bpt>SByte Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)</ept>","source":"[SByte Data Type](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)"},{"pos":[996,1091],"content":"<bpt id=\"p1\">[</bpt>UInteger Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)</ept>","source":"[UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)"},{"pos":[1101,1190],"content":"<bpt id=\"p1\">[</bpt>ULong Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/ulong-data-type.md)</ept>","source":"[ULong Data Type](../../../visual-basic/language-reference/data-types/ulong-data-type.md)"},{"pos":[1200,1291],"content":"<bpt id=\"p1\">[</bpt>UShort Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/ushort-data-type.md)</ept>","source":"[UShort Data Type](../../../visual-basic/language-reference/data-types/ushort-data-type.md)"},{"content":"When you apply the <ph id=\"ph1\">&lt;xref:System.CLSCompliantAttribute&gt;</ph> to a programming element, you set the attribute's <ph id=\"ph2\">`isCompliant`</ph> parameter to either <ph id=\"ph3\">`True`</ph> or <ph id=\"ph4\">`False`</ph> to indicate compliance or noncompliance.","pos":[1298,1495],"source":"When you apply the <xref:System.CLSCompliantAttribute> to a programming element, you set the attribute's `isCompliant` parameter to either `True` or `False` to indicate compliance or noncompliance."},{"content":"There is no default for this parameter, and you must supply a value.","pos":[1496,1564]},{"pos":[1571,1682],"content":"If you do not apply the <ph id=\"ph1\">&lt;xref:System.CLSCompliantAttribute&gt;</ph> to an element, it is considered to be noncompliant.","source":"If you do not apply the <xref:System.CLSCompliantAttribute> to an element, it is considered to be noncompliant."},{"content":"By default, this message is a warning.","pos":[1689,1727]},{"content":"For information on hiding warnings or treating warnings as errors, see <bpt id=\"p1\">[</bpt>Configuring Warnings in Visual Basic<ept id=\"p1\">](/visualstudio/ide/configuring-warnings-in-visual-basic)</ept>.","pos":[1728,1894],"source":" For information on hiding warnings or treating warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic)."},{"pos":[1901,1922],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC40027","source":"**Error ID:** BC40027"},{"pos":[1931,1952],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"content":"If the <ph id=\"ph1\">`Function`</ph> procedure must return this particular type, remove the <ph id=\"ph2\">&lt;xref:System.CLSCompliantAttribute&gt;</ph>.","pos":[1962,2071],"source":"If the `Function` procedure must return this particular type, remove the <xref:System.CLSCompliantAttribute>."},{"content":"The procedure cannot be CLS-compliant.","pos":[2072,2110]},{"content":"If the <ph id=\"ph1\">`Function`</ph> procedure must be CLS-compliant, change the return type to the closest CLS-compliant type.","pos":[2120,2228],"source":"If the `Function` procedure must be CLS-compliant, change the return type to the closest CLS-compliant type."},{"content":"For example, in place of <ph id=\"ph1\">`UInteger`</ph> you might be able to use <ph id=\"ph2\">`Integer`</ph> if you do not need the value range above 2,147,483,647.","pos":[2229,2355],"source":" For example, in place of `UInteger` you might be able to use `Integer` if you do not need the value range above 2,147,483,647."},{"content":"If you do need the extended range, you can replace <ph id=\"ph1\">`UInteger`</ph> with <ph id=\"ph2\">`Long`</ph>.","pos":[2356,2430],"source":" If you do need the extended range, you can replace `UInteger` with `Long`."},{"content":"If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph>.","pos":[2440,2617],"source":"If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]."},{"content":"For example, <ph id=\"ph1\">`int`</ph> is often 16 bits in other environments.","pos":[2618,2676],"source":" For example, `int` is often 16 bits in other environments."},{"content":"If you are returning a 16-bit integer to such a component, declare it as <ph id=\"ph1\">`Short`</ph> instead of <ph id=\"ph2\">`Integer`</ph> in your managed Visual Basic code.","pos":[2677,2813],"source":" If you are returning a 16-bit integer to such a component, declare it as `Short` instead of `Integer` in your managed Visual Basic code."}]}