{"content":"---\ntitle: \"Tutorial: Hosting Visual Objects in a Win32 Application\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"visual objects in Win32 code [WPF]\"\n  - \"Win32 code [WPF], visual objects in\"\n  - \"hosting [WPF], visual objects in Win32 code\"\nms.assetid: f0e1600c-3217-43d5-875d-1864fa7fe628\n---\n# Tutorial: Hosting Visual Objects in a Win32 Application\n[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications. However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewrite your code. To provide support for [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] graphics subsystems used concurrently in an application, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a mechanism for hosting objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.  \n  \n This tutorial describes how to write a sample application, [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.  \n\n<a name=\"requirements\"></a>   \n## Requirements  \n This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming. For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md). For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, see any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.  \n  \n> [!NOTE]\n>  This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995).  \n  \n<a name=\"creating_the_host_win32_window\"></a>   \n## Creating the Host Win32 Window  \n The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class. This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing them to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.  \n  \n The following example shows the code for creating the <xref:System.Windows.Interop.HwndSource> object as the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] container window for the visual objects. To set the window style, position, and other parameters for the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, use the <xref:System.Windows.Interop.HwndSourceParameters> object.  \n  \n [!code-csharp[VisualsHitTesting#101](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyWindow.cs#101)]\n [!code-vb[VisualsHitTesting#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyWindow.vb#101)]  \n  \n> [!NOTE]\n>  The value of the <xref:System.Windows.Interop.HwndSourceParameters.ExtendedWindowStyle%2A> property cannot be set to WS_EX_TRANSPARENT. This means that the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window cannot be transparent. For this reason, the background color of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is set to the same background color as its parent window.  \n  \n<a name=\"adding_visual_objects_to_the_host_win32_window\"></a>   \n## Adding Visual Objects to the Host Win32 Window  \n Once you have created a host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] container window for the visual objects, you can add visual objects to it. You will want to ensure that any transformations of the visual objects, such as animations, do not extend beyond the bounds of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window's bounding rectangle.  \n  \n The following example shows the code for creating the <xref:System.Windows.Interop.HwndSource> object and adding visual objects to it.  \n  \n> [!NOTE]\n>  The <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object is set to the first visual object added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. The root visual object defines the top-most node of the visual object tree. Any subsequent visual objects added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window are added as child objects.  \n  \n [!code-csharp[VisualsHitTesting#100](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyWindow.cs#100)]\n [!code-vb[VisualsHitTesting#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyWindow.vb#100)]  \n  \n<a name=\"implementing_the_win32_message_filter\"></a>   \n## Implementing the Win32 Message Filter  \n The host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window for the visual objects requires a window message filter procedure to handle messages that are sent to the window from the application queue. The window procedure receives messages from the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] system. These may be input messages or window-management messages. You can optionally handle a message in your window procedure or pass the message to the system for default processing.  \n  \n The <xref:System.Windows.Interop.HwndSource> object that you defined as the parent for the visual objects must reference the window message filter procedure you provide. When you create the <xref:System.Windows.Interop.HwndSource> object, set the <xref:System.Windows.Interop.HwndSourceParameters.HwndSourceHook%2A> property to reference the window procedure.  \n  \n [!code-csharp[VisualsHitTesting#102](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyWindow.cs#102)]\n [!code-vb[VisualsHitTesting#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyWindow.vb#102)]  \n  \n The following example shows the code for handling the left and right mouse button up messages. The coordinate value of the mouse hit position is contained in the value of the `lParam` parameter.  \n  \n [!code-csharp[VisualsHitTesting#103](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyWindow.cs#103)]\n [!code-vb[VisualsHitTesting#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyWindow.vb#103)]  \n  \n<a name=\"processing_the_win32_messages\"></a>   \n## Processing the Win32 Messages  \n The code in the following example shows how a hit test is performed against the hierarchy of visual objects contained in the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify the root visual object and the coordinate value to hit test against. In this case, the root visual object is the value of the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object.  \n  \n [!code-csharp[VisualsHitTesting#104](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyCircle.cs#104)]\n [!code-vb[VisualsHitTesting#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyCircle.vb#104)]  \n  \n For more information on hit testing against visual objects, see [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md).  \n  \n## See also\n\n- <xref:System.Windows.Interop.HwndSource>\n- [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995)\n- [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)\n","nodes":[{"pos":[4,328],"embed":true,"restype":"x-metadata","content":"title: \"Tutorial: Hosting Visual Objects in a Win32 Application\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"visual objects in Win32 code [WPF]\"\n  - \"Win32 code [WPF], visual objects in\"\n  - \"hosting [WPF], visual objects in Win32 code\"\nms.assetid: f0e1600c-3217-43d5-875d-1864fa7fe628","nodes":[{"content":"Tutorial: Hosting Visual Objects in a Win32 Application","nodes":[{"pos":[0,55],"content":"Tutorial: Hosting Visual Objects in a Win32 Application","nodes":[{"content":"Tutorial: Hosting Visual Objects in a Win32 Application","pos":[0,55]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[335,390],"content":"Tutorial: Hosting Visual Objects in a Win32 Application","linkify":"Tutorial: Hosting Visual Objects in a Win32 Application","nodes":[{"content":"Tutorial: Hosting Visual Objects in a Win32 Application","pos":[0,55]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides a rich environment for creating applications.","pos":[391,525],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications."},{"content":"However, when you have a substantial investment in <ph id=\"ph1\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> code, it might be more effective to add <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> functionality to your application rather than rewrite your code.","pos":[526,835],"source":" However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewrite your code."},{"content":"To provide support for <ph id=\"ph1\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> graphics subsystems used concurrently in an application, <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a mechanism for hosting objects in a <ph id=\"ph4\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[836,1283],"source":" To provide support for [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] graphics subsystems used concurrently in an application, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a mechanism for hosting objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"pos":[1290,1636],"content":"This tutorial describes how to write a sample application, <bpt id=\"p1\">[</bpt>Hit Test with Win32 Interoperation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159995)</ept>, that hosts <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> visual objects in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","source":"This tutorial describes how to write a sample application, [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"pos":[1674,1686],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"content":"This tutorial assumes a basic familiarity with both <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> programming.","pos":[1690,1914],"source":"This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming."},{"content":"For a basic introduction to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> programming, see <bpt id=\"p1\">[</bpt>Walkthrough: My first WPF desktop application<ept id=\"p1\">](../getting-started/walkthrough-my-first-wpf-desktop-application.md)</ept>.","pos":[1915,2158],"source":" For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md)."},{"content":"For an introduction to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> programming, see any of the numerous books on the subject, in particular <bpt id=\"p1\">*</bpt>Programming Windows<ept id=\"p1\">*</ept> by Charles Petzold.","pos":[2159,2370],"source":" For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, see any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold."},{"pos":[2378,2664],"content":"[!NOTE]\n This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995).","leadings":["","> "],"nodes":[{"content":"This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995).","pos":[9,284],"nodes":[{"content":"This tutorial includes a number of code examples from the associated sample.","pos":[0,76]},{"content":"However, for readability, it does not include the complete sample code.","pos":[77,148]},{"content":"For the complete sample code, see <bpt id=\"p1\">[</bpt>Hit Test with Win32 Interoperation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159995)</ept>.","pos":[149,275],"source":" For the complete sample code, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995)."}]}]},{"pos":[2722,2752],"content":"Creating the Host Win32 Window","linkify":"Creating the Host Win32 Window","nodes":[{"content":"Creating the Host Win32 Window","pos":[0,30]}]},{"content":"The key to hosting <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> objects in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window is the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> class.","pos":[2756,3005],"source":"The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class."},{"content":"This class wraps the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> objects in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window, allowing them to be incorporated into your <ph id=\"ph3\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> as a child window.","pos":[3006,3331],"source":" This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing them to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window."},{"content":"The following example shows the code for creating the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object as the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> container window for the visual objects.","pos":[3338,3561],"source":"The following example shows the code for creating the <xref:System.Windows.Interop.HwndSource> object as the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] container window for the visual objects."},{"content":"To set the window style, position, and other parameters for the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window, use the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSourceParameters&gt;</ph> object.","pos":[3562,3774],"source":" To set the window style, position, and other parameters for the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, use the <xref:System.Windows.Interop.HwndSourceParameters> object."},{"pos":[4039,4503],"content":"[!NOTE]\n The value of the <xref:System.Windows.Interop.HwndSourceParameters.ExtendedWindowStyle%2A> property cannot be set to WS_EX_TRANSPARENT. This means that the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window cannot be transparent. For this reason, the background color of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is set to the same background color as its parent window.","leadings":["","> "],"nodes":[{"content":"The value of the <xref:System.Windows.Interop.HwndSourceParameters.ExtendedWindowStyle%2A> property cannot be set to WS_EX_TRANSPARENT. This means that the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window cannot be transparent. For this reason, the background color of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is set to the same background color as its parent window.","pos":[9,462],"nodes":[{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSourceParameters.ExtendedWindowStyle%2A&gt;</ph> property cannot be set to WS_EX_TRANSPARENT.","pos":[0,135],"source":"The value of the <xref:System.Windows.Interop.HwndSourceParameters.ExtendedWindowStyle%2A> property cannot be set to WS_EX_TRANSPARENT."},{"content":"This means that the host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window cannot be transparent.","pos":[136,264],"source":" This means that the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window cannot be transparent."},{"content":"For this reason, the background color of the host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window is set to the same background color as its parent window.","pos":[265,453],"source":" For this reason, the background color of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is set to the same background color as its parent window."}]}]},{"pos":[4577,4623],"content":"Adding Visual Objects to the Host Win32 Window","linkify":"Adding Visual Objects to the Host Win32 Window","nodes":[{"content":"Adding Visual Objects to the Host Win32 Window","pos":[0,46]}]},{"content":"Once you have created a host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> container window for the visual objects, you can add visual objects to it.","pos":[4627,4804],"source":"Once you have created a host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] container window for the visual objects, you can add visual objects to it."},{"content":"You will want to ensure that any transformations of the visual objects, such as animations, do not extend beyond the bounds of the host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window's bounding rectangle.","pos":[4805,5043],"source":" You will want to ensure that any transformations of the visual objects, such as animations, do not extend beyond the bounds of the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window's bounding rectangle."},{"pos":[5050,5184],"content":"The following example shows the code for creating the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object and adding visual objects to it.","source":"The following example shows the code for creating the <xref:System.Windows.Interop.HwndSource> object and adding visual objects to it."},{"pos":[5192,5692],"content":"[!NOTE]\n The <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object is set to the first visual object added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. The root visual object defines the top-most node of the visual object tree. Any subsequent visual objects added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window are added as child objects.","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object is set to the first visual object added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. The root visual object defines the top-most node of the visual object tree. Any subsequent visual objects added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window are added as child objects.","pos":[9,498],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource.RootVisual%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object is set to the first visual object added to the host <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[0,256],"source":"The <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object is set to the first visual object added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"The root visual object defines the top-most node of the visual object tree.","pos":[257,332]},{"content":"Any subsequent visual objects added to the host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window are added as child objects.","pos":[333,489],"source":" Any subsequent visual objects added to the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window are added as child objects."}]}]},{"pos":[6014,6051],"content":"Implementing the Win32 Message Filter","linkify":"Implementing the Win32 Message Filter","nodes":[{"content":"Implementing the Win32 Message Filter","pos":[0,37]}]},{"content":"The host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window for the visual objects requires a window message filter procedure to handle messages that are sent to the window from the application queue.","pos":[6055,6285],"source":"The host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window for the visual objects requires a window message filter procedure to handle messages that are sent to the window from the application queue."},{"content":"The window procedure receives messages from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> system.","pos":[6286,6415],"source":" The window procedure receives messages from the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] system."},{"content":"These may be input messages or window-management messages.","pos":[6416,6474]},{"content":"You can optionally handle a message in your window procedure or pass the message to the system for default processing.","pos":[6475,6593]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object that you defined as the parent for the visual objects must reference the window message filter procedure you provide.","pos":[6600,6769],"source":"The <xref:System.Windows.Interop.HwndSource> object that you defined as the parent for the visual objects must reference the window message filter procedure you provide."},{"content":"When you create the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object, set the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSourceParameters.HwndSourceHook%2A&gt;</ph> property to reference the window procedure.","pos":[6770,6959],"source":" When you create the <xref:System.Windows.Interop.HwndSource> object, set the <xref:System.Windows.Interop.HwndSourceParameters.HwndSourceHook%2A> property to reference the window procedure."},{"content":"The following example shows the code for handling the left and right mouse button up messages.","pos":[7223,7317]},{"content":"The coordinate value of the mouse hit position is contained in the value of the <ph id=\"ph1\">`lParam`</ph> parameter.","pos":[7318,7417],"source":" The coordinate value of the mouse hit position is contained in the value of the `lParam` parameter."},{"pos":[7731,7760],"content":"Processing the Win32 Messages","linkify":"Processing the Win32 Messages","nodes":[{"content":"Processing the Win32 Messages","pos":[0,29]}]},{"content":"The code in the following example shows how a hit test is performed against the hierarchy of visual objects contained in the host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[7764,7975],"source":"The code in the following example shows how a hit test is performed against the hierarchy of visual objects contained in the host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"You can identify whether a point is within the geometry of a visual object, by using the <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualTreeHelper.HitTest%2A&gt;</ph> method to specify the root visual object and the coordinate value to hit test against.","pos":[7976,8207],"source":" You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify the root visual object and the coordinate value to hit test against."},{"content":"In this case, the root visual object is the value of the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource.RootVisual%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object.","pos":[8208,8384],"source":" In this case, the root visual object is the value of the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object."},{"pos":[8648,8782],"content":"For more information on hit testing against visual objects, see <bpt id=\"p1\">[</bpt>Hit Testing in the Visual Layer<ept id=\"p1\">](hit-testing-in-the-visual-layer.md)</ept>.","source":"For more information on hit testing against visual objects, see [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)."},{"pos":[8791,8799],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8846,8937],"content":"<bpt id=\"p1\">[</bpt>Hit Test with Win32 Interoperation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159995)</ept>","source":"[Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995)"},{"pos":[8940,9009],"content":"<bpt id=\"p1\">[</bpt>Hit Testing in the Visual Layer<ept id=\"p1\">](hit-testing-in-the-visual-layer.md)</ept>","source":"[Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)"}]}