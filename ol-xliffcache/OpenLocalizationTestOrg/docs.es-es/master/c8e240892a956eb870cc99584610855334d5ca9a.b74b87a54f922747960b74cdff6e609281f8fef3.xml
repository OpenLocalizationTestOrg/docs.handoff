{"content":"---\ntitle: \"How to: Use a Custom User Name and Password Validator | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WCF, username and password\"\nms.assetid: 8e08b74b-fa44-4018-b63d-0d0805f85e3f\ncaps.latest.revision: 14\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Use a Custom User Name and Password Validator\nBy default, when a user name and password is used for authentication, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] uses Windows to validate the user name and password. However, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] allows for custom user name and password authentication schemes, also known as *validators*. To incorporate a custom user name and password validator, create a class that derives from <xref:System.IdentityModel.Selectors.UserNamePasswordValidator> and then configure it.  \n  \n For a sample application, see [User Name Password Validator](../../../../docs/framework/wcf/samples/user-name-password-validator.md).  \n  \n### To create a custom user name and password validator  \n  \n1.  Create a class that derives from <xref:System.IdentityModel.Selectors.UserNamePasswordValidator>.  \n  \n     [!code-csharp[C_CustomUsernameAndPasswordValidator#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#3)]\n     [!code-vb[C_CustomUsernameAndPasswordValidator#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#3)]  \n  \n2.  Implement the custom authentication scheme by overriding the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method.  \n  \n     Do not use the code in the following example that overrides the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method in a production environment. Replace the code with your custom user name and password validation scheme, which might involve retrieving user name and password pairs from a database.  \n  \n     To return authentication errors back to the client, throw a <xref:System.ServiceModel.FaultException> in the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method.  \n  \n     [!code-csharp[C_CustomUsernameAndPasswordValidator#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#4)]\n     [!code-vb[C_CustomUsernameAndPasswordValidator#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#4)]  \n  \n### To configure a service to use a custom user name and password validator  \n  \n1.  Configure a binding that uses message security over any transport or transport-level security over HTTP(S).  \n  \n     When using message security, add one of the system-provided bindings, such as a  [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md), or a [\\<customBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md) that supports message security and the `UserName` credential type.  \n  \n     When using transport-level security over HTTP(S), add either the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) or [\\<basicHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md), a [\\<netTcpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/nettcpbinding.md) or a [\\<customBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md) that uses HTTP(S) and the `Basic` authentication scheme.  \n  \n    > [!NOTE]\n    >  When [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later is used, you can use a custom username and password validator with message and transport security. With [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], a custom username and password validator can only be used with message security.  \n  \n    > [!TIP]\n    >  For more information on using \\<netTcpBinding> in this context, see [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-nettcpbinding.md)  \n  \n    1.  In the configuration file, under the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element.  \n  \n    2.  Add a [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) or [\\<basicHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md) element to the bindings section. [!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).  \n  \n    3.  Set the `mode` attribute of the [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md) or [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-basichttpbinding.md) to `Message`, `Transport`, `or``TransportWithMessageCredential`.  \n  \n    4.  Set the `clientCredentialType` attribute of the [\\<message>](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md) or [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md).  \n  \n         When using message security, set the `clientCredentialType` attribute of the [\\<message>](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md) to `UserName`.  \n  \n         When using transport-level security over HTTP(S), set the `clientCredentialType` attribute of the [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md) or [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-basichttpbinding.md) to `Basic`.  \n  \n        > [!NOTE]\n        >  When a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is hosted in Internet Information Services (IIS) using transport-level security and the <xref:System.ServiceModel.Security.UserNamePasswordServiceCredential.UserNamePasswordValidationMode%2A> property is set to <xref:System.ServiceModel.Security.UserNamePasswordValidationMode>, the custom authentication scheme uses a subset of Windows authentication. That is because in this scenario, IIS performs Windows authentication prior to [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] invoking the custom authenticator.  \n  \n     [!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).  \n  \n     The following example shows the configuration code for the binding.  \n  \n    ```  \n    <system.serviceModel>   \n      <bindings>  \n      <wsHttpBinding>  \n          <binding name=\"Binding1\">  \n            <security mode=\"Message\">  \n              <message clientCredentialType=\"UserName\" />  \n            </security>  \n          </binding>          \n        </wsHttpBinding>  \n      </bindings>  \n    </system.serviceModel>  \n    ```  \n  \n2.  Configure a behavior that specifies that a custom user name and password validator is used to validate user name and password pairs for incoming <xref:System.IdentityModel.Tokens.UserNameSecurityToken> security tokens.  \n  \n    1.  As a child to the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element.  \n  \n    2.  Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) to the [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element.  \n  \n    3.  Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element and set the `name` attribute to an appropriate value.  \n  \n    4.  Add a [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) to the [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element.  \n  \n    5.  Add a [\\<userNameAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md) to the [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md).  \n  \n    6.  Set the `userNamePasswordValidationMode` to `Custom`.  \n  \n        > [!IMPORTANT]\n        >  If the `userNamePasswordValidationMode` value is not set, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses Windows authentication instead of the custom user name and password validator.  \n  \n    7.  Set the `customUserNamePasswordValidatorType` to the type that represents your custom user name and password validator.  \n  \n     The following example shows the `<serviceCredentials>` fragment to this point.  \n  \n    ```  \n    <serviceCredentials>  \n      <userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"Microsoft.ServiceModel.Samples.CalculatorService.CustomUserNameValidator, service\" />  \n    </serviceCredentials>  \n    ```  \n  \n## Example  \n The following code example demonstrates how to create a custom user name and password validator. Do not use the code that overrides the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method in a production environment. Replace the code with your custom user name and password validation scheme, which might involve retrieving user name and password pairs from a database.  \n  \n [!code-csharp[C_CustomUsernameAndPasswordValidator#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#1)]\n [!code-vb[C_CustomUsernameAndPasswordValidator#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#1)]  \n[!code-csharp[C_CustomUsernameAndPasswordValidator#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#2)]\n[!code-vb[C_CustomUsernameAndPasswordValidator#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#2)]  \n  \n## See Also  \n <xref:System.IdentityModel.Selectors.UserNamePasswordValidator>   \n [How to: Use the ASP.NET Membership Provider](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-membership-provider.md)   \n [Authentication](../../../../docs/framework/wcf/feature-details/authentication-in-wcf.md)","nodes":[{"pos":[12,82],"content":"How to: Use a Custom User Name and Password Validator | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Use a Custom User Name and Password Validator | Microsoft Docs","pos":[0,70]}]},{"pos":[436,489],"content":"How to: Use a Custom User Name and Password Validator","linkify":"How to: Use a Custom User Name and Password Validator","nodes":[{"content":"How to: Use a Custom User Name and Password Validator","pos":[0,53]}]},{"content":"By default, when a user name and password is used for authentication, <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> uses Windows to validate the user name and password.","pos":[490,668],"source":"By default, when a user name and password is used for authentication, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] uses Windows to validate the user name and password."},{"content":"However, <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> allows for custom user name and password authentication schemes, also known as <bpt id=\"p1\">*</bpt>validators<ept id=\"p1\">*</ept>.","pos":[669,826],"source":" However, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] allows for custom user name and password authentication schemes, also known as *validators*."},{"content":"To incorporate a custom user name and password validator, create a class that derives from <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator&gt;</ph> and then configure it.","pos":[827,1004],"source":" To incorporate a custom user name and password validator, create a class that derives from <xref:System.IdentityModel.Selectors.UserNamePasswordValidator> and then configure it."},{"pos":[1011,1144],"content":"For a sample application, see <bpt id=\"p1\">[</bpt>User Name Password Validator<ept id=\"p1\">](../../../../docs/framework/wcf/samples/user-name-password-validator.md)</ept>.","source":"For a sample application, see [User Name Password Validator](../../../../docs/framework/wcf/samples/user-name-password-validator.md)."},{"pos":[1154,1205],"content":"To create a custom user name and password validator","linkify":"To create a custom user name and password validator","nodes":[{"content":"To create a custom user name and password validator","pos":[0,51]}]},{"content":"Create a class that derives from <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator&gt;</ph>.","pos":[1215,1312],"source":"Create a class that derives from <xref:System.IdentityModel.Selectors.UserNamePasswordValidator>."},{"pos":[1323,1650],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomUsernameAndPasswordValidator#3<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#3)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_CustomUsernameAndPasswordValidator#3<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#3)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[C_CustomUsernameAndPasswordValidator#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#3)]\n [!code-vb[C_CustomUsernameAndPasswordValidator#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#3)]"},{"content":"Implement the custom authentication scheme by overriding the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A&gt;</ph> method.","pos":[1660,1804],"source":"Implement the custom authentication scheme by overriding the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method."},{"content":"Do not use the code in the following example that overrides the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A&gt;</ph> method in a production environment.","pos":[1815,1990],"source":"Do not use the code in the following example that overrides the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method in a production environment."},{"content":"Replace the code with your custom user name and password validation scheme, which might involve retrieving user name and password pairs from a database.","pos":[1991,2143]},{"content":"To return authentication errors back to the client, throw a <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultException&gt;</ph> in the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A&gt;</ph> method.","pos":[2154,2346],"source":"To return authentication errors back to the client, throw a <xref:System.ServiceModel.FaultException> in the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method."},{"pos":[2357,2684],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomUsernameAndPasswordValidator#4<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#4)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_CustomUsernameAndPasswordValidator#4<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#4)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[C_CustomUsernameAndPasswordValidator#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#4)]\n [!code-vb[C_CustomUsernameAndPasswordValidator#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#4)]"},{"pos":[2694,2765],"content":"To configure a service to use a custom user name and password validator","linkify":"To configure a service to use a custom user name and password validator","nodes":[{"content":"To configure a service to use a custom user name and password validator","pos":[0,71]}]},{"content":"Configure a binding that uses message security over any transport or transport-level security over HTTP(S).","pos":[2775,2882]},{"pos":[2893,3236],"content":"When using message security, add one of the system-provided bindings, such as a  <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept>, or a <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>customBinding&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md)</ept> that supports message security and the <ph id=\"ph3\">`UserName`</ph> credential type.","source":"When using message security, add one of the system-provided bindings, such as a  [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md), or a [\\<customBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md) that supports message security and the `UserName` credential type."},{"pos":[3247,3765],"content":"When using transport-level security over HTTP(S), add either the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept> or <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>basicHttpBinding&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md)</ept>, a <bpt id=\"p3\">[</bpt><ph id=\"ph3\">\\&lt;</ph>netTcpBinding&gt;<ept id=\"p3\">](../../../../docs/framework/configure-apps/file-schema/wcf/nettcpbinding.md)</ept> or a <bpt id=\"p4\">[</bpt><ph id=\"ph4\">\\&lt;</ph>customBinding&gt;<ept id=\"p4\">](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md)</ept> that uses HTTP(S) and the <ph id=\"ph5\">`Basic`</ph> authentication scheme.","source":"When using transport-level security over HTTP(S), add either the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) or [\\<basicHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md), a [\\<netTcpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/nettcpbinding.md) or a [\\<customBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/custombinding.md) that uses HTTP(S) and the `Basic` authentication scheme."},{"pos":[3777,4119],"content":"[!NOTE]\nWhen [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later is used, you can use a custom username and password validator with message and transport security. With [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], a custom username and password validator can only be used with message security.","leadings":["","    >  "],"nodes":[{"content":"When [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later is used, you can use a custom username and password validator with message and transport security. With [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], a custom username and password validator can only be used with message security.","pos":[8,335],"nodes":[{"content":"When <ph id=\"ph1\">[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]</ph> or later is used, you can use a custom username and password validator with message and transport security.","pos":[0,178],"source":"When [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later is used, you can use a custom username and password validator with message and transport security."},{"content":"With <ph id=\"ph1\">[!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]</ph>, a custom username and password validator can only be used with message security.","pos":[179,327],"source":" With [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], a custom username and password validator can only be used with message security."}]}]},{"pos":[4131,4314],"content":"[!TIP]\nFor more information on using \\<netTcpBinding> in this context, see [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-nettcpbinding.md)","leadings":["","    >  "],"nodes":[{"content":"For more information on using <ph id=\"ph1\">\\&lt;</ph>netTcpBinding&gt; in this context, see <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>security&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-nettcpbinding.md)</ept>","pos":[7,176],"source":"For more information on using \\<netTcpBinding> in this context, see [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-nettcpbinding.md)"}]},{"pos":[4328,4580],"content":"In the configuration file, under the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>system.serviceModel&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md)</ept> element, add a <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>bindings&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)</ept> element.","source":"In the configuration file, under the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element."},{"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept> or <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>basicHttpBinding&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md)</ept> element to the bindings section.","pos":[4594,4831],"source":"Add a [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) or [\\<basicHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md) element to the bindings section."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> creating an <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> binding element, see <bpt id=\"p1\">[</bpt>How to: Specify a Service Binding in Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)</ept>.","pos":[4832,5115],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)."},{"pos":[5129,5435],"content":"Set the <ph id=\"ph1\">`mode`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>security&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md)</ept> or <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\&lt;</ph>security&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-basichttpbinding.md)</ept> to <ph id=\"ph4\">`Message`</ph>, <ph id=\"ph5\">`Transport`</ph>, <ph id=\"ph6\">`or``TransportWithMessageCredential`</ph>.","source":"Set the `mode` attribute of the [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md) or [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-basichttpbinding.md) to `Message`, `Transport`, `or``TransportWithMessageCredential`."},{"pos":[5449,5704],"content":"Set the <ph id=\"ph1\">`clientCredentialType`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>message&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md)</ept> or <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\&lt;</ph>transport&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md)</ept>.","source":"Set the `clientCredentialType` attribute of the [\\<message>](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md) or [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md)."},{"pos":[5719,5910],"content":"When using message security, set the <ph id=\"ph1\">`clientCredentialType`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>message&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md)</ept> to <ph id=\"ph3\">`UserName`</ph>.","source":"When using message security, set the `clientCredentialType` attribute of the [\\<message>](../../../../docs/framework/configure-apps/file-schema/wcf/message-of-wshttpbinding.md) to `UserName`."},{"pos":[5925,6248],"content":"When using transport-level security over HTTP(S), set the <ph id=\"ph1\">`clientCredentialType`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>transport&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md)</ept> or <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\&lt;</ph>transport&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-basichttpbinding.md)</ept> to <ph id=\"ph4\">`Basic`</ph>.","source":"When using transport-level security over HTTP(S), set the `clientCredentialType` attribute of the [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-wshttpbinding.md) or [\\<transport>](../../../../docs/framework/configure-apps/file-schema/wcf/transport-of-basichttpbinding.md) to `Basic`."},{"pos":[6264,6876],"content":"[!NOTE]\nWhen a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is hosted in Internet Information Services (IIS) using transport-level security and the <xref:System.ServiceModel.Security.UserNamePasswordServiceCredential.UserNamePasswordValidationMode%2A> property is set to <xref:System.ServiceModel.Security.UserNamePasswordValidationMode>, the custom authentication scheme uses a subset of Windows authentication. That is because in this scenario, IIS performs Windows authentication prior to [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] invoking the custom authenticator.","leadings":["","        >  "],"nodes":[{"content":"When a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is hosted in Internet Information Services (IIS) using transport-level security and the <xref:System.ServiceModel.Security.UserNamePasswordServiceCredential.UserNamePasswordValidationMode%2A> property is set to <xref:System.ServiceModel.Security.UserNamePasswordValidationMode>, the custom authentication scheme uses a subset of Windows authentication. That is because in this scenario, IIS performs Windows authentication prior to [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] invoking the custom authenticator.","pos":[8,601],"nodes":[{"content":"When a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> service is hosted in Internet Information Services (IIS) using transport-level security and the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Security.UserNamePasswordServiceCredential.UserNamePasswordValidationMode%2A&gt;</ph> property is set to <ph id=\"ph3\">&lt;xref:System.ServiceModel.Security.UserNamePasswordValidationMode&gt;</ph>, the custom authentication scheme uses a subset of Windows authentication.","pos":[0,423],"source":"When a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is hosted in Internet Information Services (IIS) using transport-level security and the <xref:System.ServiceModel.Security.UserNamePasswordServiceCredential.UserNamePasswordValidationMode%2A> property is set to <xref:System.ServiceModel.Security.UserNamePasswordValidationMode>, the custom authentication scheme uses a subset of Windows authentication."},{"content":"That is because in this scenario, IIS performs Windows authentication prior to <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> invoking the custom authenticator.","pos":[424,593],"source":" That is because in this scenario, IIS performs Windows authentication prior to [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] invoking the custom authenticator."}]}]},{"pos":[6887,7170],"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> creating an <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> binding element, see <bpt id=\"p1\">[</bpt>How to: Specify a Service Binding in Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)</ept>.","source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)."},{"content":"The following example shows the configuration code for the binding.","pos":[7181,7248]},{"content":"Configure a behavior that specifies that a custom user name and password validator is used to validate user name and password pairs for incoming <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.UserNameSecurityToken&gt;</ph> security tokens.","pos":[7624,7842],"source":"Configure a behavior that specifies that a custom user name and password validator is used to validate user name and password pairs for incoming <xref:System.IdentityModel.Tokens.UserNameSecurityToken> security tokens."},{"pos":[7856,8091],"content":"As a child to the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>system.serviceModel&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md)</ept> element, add a <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>behaviors&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md)</ept> element.","source":"As a child to the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element."},{"pos":[8105,8314],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)</ept> to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>behaviors&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md)</ept> element.","source":"Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) to the [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element."},{"pos":[8328,8500],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>behavior&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md)</ept> element and set the <ph id=\"ph2\">`name`</ph> attribute to an appropriate value.","source":"Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element and set the `name` attribute to an appropriate value."},{"pos":[8514,8745],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept> to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>behavior&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md)</ept> element.","source":"Add a [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) to the [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element."},{"pos":[8759,8990],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>userNameAuthentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md)</ept> to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept>.","source":"Add a [\\<userNameAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md) to the [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)."},{"pos":[9004,9057],"content":"Set the <ph id=\"ph1\">`userNamePasswordValidationMode`</ph> to <ph id=\"ph2\">`Custom`</ph>.","source":"Set the `userNamePasswordValidationMode` to `Custom`."},{"pos":[9073,9294],"content":"[!IMPORTANT]\nIf the `userNamePasswordValidationMode` value is not set, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses Windows authentication instead of the custom user name and password validator.","leadings":["","        >  "],"nodes":[{"content":"If the <ph id=\"ph1\">`userNamePasswordValidationMode`</ph> value is not set, <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> uses Windows authentication instead of the custom user name and password validator.","pos":[13,210],"source":"If the `userNamePasswordValidationMode` value is not set, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses Windows authentication instead of the custom user name and password validator."}]},{"pos":[9308,9427],"content":"Set the <ph id=\"ph1\">`customUserNamePasswordValidatorType`</ph> to the type that represents your custom user name and password validator.","source":"Set the `customUserNamePasswordValidatorType` to the type that represents your custom user name and password validator."},{"pos":[9438,9516],"content":"The following example shows the <ph id=\"ph1\">`&lt;serviceCredentials&gt;`</ph> fragment to this point.","source":"The following example shows the `<serviceCredentials>` fragment to this point."},{"pos":[9798,9805],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to create a custom user name and password validator.","pos":[9809,9905]},{"content":"Do not use the code that overrides the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A&gt;</ph> method in a production environment.","pos":[9906,10056],"source":" Do not use the code that overrides the <xref:System.IdentityModel.Selectors.UserNamePasswordValidator.Validate%2A> method in a production environment."},{"content":"Replace the code with your custom user name and password validation scheme, which might involve retrieving user name and password pairs from a database.","pos":[10057,10209]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomUsernameAndPasswordValidator#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_CustomUsernameAndPasswordValidator#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#1)</ept><ept id=\"p3\">]</ept>","pos":[10216,10539],"source":"[!code-csharp[C_CustomUsernameAndPasswordValidator#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#1)]\n [!code-vb[C_CustomUsernameAndPasswordValidator#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#1)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomUsernameAndPasswordValidator#2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#2)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_CustomUsernameAndPasswordValidator#2<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#2)</ept><ept id=\"p3\">]</ept>","pos":[10542,10864],"source":"[!code-csharp[C_CustomUsernameAndPasswordValidator#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customusernameandpasswordvalidator/cs/service.cs#2)]\n[!code-vb[C_CustomUsernameAndPasswordValidator#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customusernameandpasswordvalidator/vb/service.vb#2)]"},{"pos":[10873,10881],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.IdentityModel.Selectors.UserNamePasswordValidator&gt;</ph>","pos":[10885,10948],"source":"<xref:System.IdentityModel.Selectors.UserNamePasswordValidator> "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Use the ASP.NET Membership Provider<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-membership-provider.md)</ept><ph id=\"ph1\"> </ph>","pos":[10952,11092],"source":" [How to: Use the ASP.NET Membership Provider](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-membership-provider.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Authentication<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/authentication-in-wcf.md)</ept>","pos":[11095,11185],"source":" [Authentication](../../../../docs/framework/wcf/feature-details/authentication-in-wcf.md)"}]}