{"content":"---\ntitle: \"Performing Batch Operations Using DataAdapters\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e72ed5af-b24f-486c-8429-c8fd2208f844\n---\n# Performing Batch Operations Using DataAdapters\nBatch support in ADO.NET allows a <xref:System.Data.Common.DataAdapter> to group INSERT, UPDATE, and DELETE operations from a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> to the server, instead of sending one operation at a time. The reduction in the number of round trips to the server typically results in significant performance gains. Batch updates are supported for the .NET data providers for SQL Server (<xref:System.Data.SqlClient>) and Oracle (<xref:System.Data.OracleClient>).  \n  \n When updating a database with changes from a <xref:System.Data.DataSet> in previous versions of ADO.NET, the `Update` method of a `DataAdapter` performed updates to the database one row at a time. As it iterated through the rows in the specified <xref:System.Data.DataTable>, it examined each <xref:System.Data.DataRow> to see if it had been modified. If the row had been modified, it called the appropriate `UpdateCommand`, `InsertCommand`, or `DeleteCommand`, depending on the value of the <xref:System.Data.DataRow.RowState%2A> property for that row. Every row update involved a network round-trip to the database.  \n  \n Starting with ADO.NET 2.0, the <xref:System.Data.Common.DbDataAdapter> exposes an <xref:System.Data.Common.DbDataAdapter.UpdateBatchSize%2A> property. Setting the `UpdateBatchSize` to a positive integer value causes updates to the database to be sent as batches of the specified size. For example, setting the `UpdateBatchSize` to 10 will group 10 separate statements and submit them as single batch. Setting the `UpdateBatchSize` to 0 will cause the <xref:System.Data.Common.DataAdapter> to use the largest batch size that the server can handle. Setting it to 1 disables batch updates, as rows are sent one at a time.  \n  \n Executing an extremely large batch could decrease performance. Therefore, you should test for the optimum batch size setting before implementing your application.  \n  \n## Using the UpdateBatchSize Property  \n When batch updates are enabled, the <xref:System.Data.IDbCommand.UpdatedRowSource%2A> property value of the DataAdapter's `UpdateCommand`, `InsertCommand`, and `DeleteCommand` should be set to <xref:System.Data.UpdateRowSource.None> or <xref:System.Data.UpdateRowSource.OutputParameters>. When performing a batch update, the command's <xref:System.Data.IDbCommand.UpdatedRowSource%2A> property value of <xref:System.Data.UpdateRowSource.FirstReturnedRecord> or <xref:System.Data.UpdateRowSource.Both> is invalid.  \n  \n The following procedure demonstrates the use of the `UpdateBatchSize` property. The procedure takes two arguments, a <xref:System.Data.DataSet> object that has columns representing the **ProductCategoryID** and **Name** fields in the **Production.ProductCategory** table, and an integer representing the batch size (the number of rows in the batch). The code creates a new <xref:System.Data.SqlClient.SqlDataAdapter> object, setting its <xref:System.Data.SqlClient.SqlDataAdapter.UpdateCommand%2A>, <xref:System.Data.SqlClient.SqlDataAdapter.InsertCommand%2A>, and <xref:System.Data.SqlClient.SqlDataAdapter.DeleteCommand%2A> properties. The code assumes that the <xref:System.Data.DataSet> object has modified rows. It sets the `UpdateBatchSize` property and executes the update.  \n  \n```vb  \nPublic Sub BatchUpdate( _  \n  ByVal dataTable As DataTable, ByVal batchSize As Int32)  \n    ' Assumes GetConnectionString() returns a valid connection string.  \n    Dim connectionString As String = GetConnectionString()  \n  \n    ' Connect to the AdventureWorks database.  \n    Using connection As New SqlConnection(connectionString)  \n        ' Create a SqlDataAdapter.  \n        Dim adapter As New SqlDataAdapter()  \n  \n        'Set the UPDATE command and parameters.  \n        adapter.UpdateCommand = New SqlCommand( _  \n          \"UPDATE Production.ProductCategory SET \" _  \n          & \"Name=@Name WHERE ProductCategoryID=@ProdCatID;\", _  \n          connection)  \n        adapter.UpdateCommand.Parameters.Add(\"@Name\", _  \n          SqlDbType.NVarChar, 50, \"Name\")  \n        adapter.UpdateCommand.Parameters.Add(\"@ProdCatID\",  _  \n          SqlDbType.Int, 4, \" ProductCategoryID \")  \n        adapter.UpdateCommand.UpdatedRowSource = _  \n          UpdateRowSource.None  \n  \n        'Set the INSERT command and parameter.  \n        adapter.InsertCommand = New SqlCommand( _  \n          \"INSERT INTO Production.ProductCategory (Name) VALUES (@Name);\", _  \n  connection)  \n        adapter.InsertCommand.Parameters.Add(\"@Name\", _  \n          SqlDbType.NVarChar, 50, \"Name\")  \n        adapter.InsertCommand.UpdatedRowSource = _  \n          UpdateRowSource.None  \n  \n        'Set the DELETE command and parameter.  \n        adapter.DeleteCommand = New SqlCommand( _  \n          \"DELETE FROM Production.ProductCategory \" _  \n          & \"WHERE ProductCategoryID=@ProdCatID;\", connection)  \n        adapter.DeleteCommand.Parameters.Add(\"@ProdCatID\", _  \n           SqlDbType.Int, 4, \" ProductCategoryID \")  \n        adapter.DeleteCommand.UpdatedRowSource = UpdateRowSource.None  \n  \n        ' Set the batch size.  \n        adapter.UpdateBatchSize = batchSize  \n  \n        ' Execute the update.  \n        adapter.Update(dataTable)  \n    End Using  \nEnd Sub  \n```  \n  \n```csharp  \npublic static void BatchUpdate(DataTable dataTable,Int32 batchSize)  \n{  \n    // Assumes GetConnectionString() returns a valid connection string.  \n    string connectionString = GetConnectionString();  \n  \n    // Connect to the AdventureWorks database.  \n    using (SqlConnection connection = new   \n      SqlConnection(connectionString))  \n    {  \n  \n        // Create a SqlDataAdapter.  \n        SqlDataAdapter adapter = new SqlDataAdapter();  \n  \n        // Set the UPDATE command and parameters.  \n        adapter.UpdateCommand = new SqlCommand(  \n            \"UPDATE Production.ProductCategory SET \"  \n            + \"Name=@Name WHERE ProductCategoryID=@ProdCatID;\",   \n            connection);  \n        adapter.UpdateCommand.Parameters.Add(\"@Name\",   \n           SqlDbType.NVarChar, 50, \"Name\");  \n        adapter.UpdateCommand.Parameters.Add(\"@ProdCatID\",   \n           SqlDbType.Int, 4, \"ProductCategoryID\");  \n         adapter.UpdateCommand.UpdatedRowSource = UpdateRowSource.None;  \n  \n        // Set the INSERT command and parameter.  \n        adapter.InsertCommand = new SqlCommand(  \n            \"INSERT INTO Production.ProductCategory (Name) VALUES (@Name);\",   \n            connection);  \n        adapter.InsertCommand.Parameters.Add(\"@Name\",   \n          SqlDbType.NVarChar, 50, \"Name\");  \n        adapter.InsertCommand.UpdatedRowSource = UpdateRowSource.None;  \n  \n        // Set the DELETE command and parameter.  \n        adapter.DeleteCommand = new SqlCommand(  \n            \"DELETE FROM Production.ProductCategory \"  \n            + \"WHERE ProductCategoryID=@ProdCatID;\", connection);  \n        adapter.DeleteCommand.Parameters.Add(\"@ProdCatID\",   \n          SqlDbType.Int, 4, \"ProductCategoryID\");  \n        adapter.DeleteCommand.UpdatedRowSource = UpdateRowSource.None;  \n  \n        // Set the batch size.  \n        adapter.UpdateBatchSize = batchSize;  \n  \n        // Execute the update.  \n        adapter.Update(dataTable);  \n    }  \n}  \n```  \n  \n## Handling Batch Update-Related Events and Errors  \n The **DataAdapter** has two update-related events: **RowUpdating** and **RowUpdated**. In previous versions of ADO.NET, when batch processing is disabled, each of these events is generated once for each row processed. **RowUpdating** is generated before the update occurs, and **RowUpdated** is generated after the database update has been completed.  \n  \n### Event Behavior Changes with Batch Updates  \n When batch processing is enabled, multiple rows are updated in a single database operation. Therefore, only one `RowUpdated` event occurs for each batch, whereas the `RowUpdating` event occurs for each row processed. When batch processing is disabled, the two events are fired with one-to-one interleaving, where one `RowUpdating` event and one `RowUpdated` event fire for a row, and then one `RowUpdating` and one `RowUpdated` event fire for the next row, until all of the rows are processed.  \n  \n### Accessing Updated Rows  \n When batch processing is disabled, the row being updated can be accessed using the <xref:System.Data.Common.RowUpdatedEventArgs.Row%2A> property of the <xref:System.Data.Common.RowUpdatedEventArgs> class.  \n  \n When batch processing is enabled, a single `RowUpdated` event is generated for multiple rows. Therefore, the value of the `Row` property for each row is null. `RowUpdating` events are still generated for each row. The <xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A> method of the <xref:System.Data.Common.RowUpdatedEventArgs> class allows you to access the processed rows by copying references to the rows into an array. If no rows are being processed, `CopyToRows` throws an <xref:System.ArgumentNullException>. Use the <xref:System.Data.Common.RowUpdatedEventArgs.RowCount%2A> property to return the number of rows processed before calling the <xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A> method.  \n  \n### Handling Data Errors  \n Batch execution has the same effect as the execution of each individual statement. Statements are executed in the order that the statements were added to the batch. Errors are handled the same way in batch mode as they are when batch mode is disabled. Each row is processed separately. Only rows that have been successfully processed in the database will be updated in the corresponding <xref:System.Data.DataRow> within the <xref:System.Data.DataTable>.  \n  \n The data provider and the back-end database server determine which SQL constructs are supported for batch execution. An exception may be thrown if a non-supported statement is submitted for execution.  \n  \n## See also\n\n- [DataAdapters and DataReaders](../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)\n- [Updating Data Sources with DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md)\n- [Handling DataAdapter Events](../../../../docs/framework/data/adonet/handling-dataadapter-events.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,164],"embed":true,"restype":"x-metadata","content":"title: \"Performing Batch Operations Using DataAdapters\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e72ed5af-b24f-486c-8429-c8fd2208f844","nodes":[{"content":"Performing Batch Operations Using DataAdapters","nodes":[{"pos":[0,46],"content":"Performing Batch Operations Using DataAdapters","nodes":[{"content":"Performing Batch Operations Using DataAdapters","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[171,217],"content":"Performing Batch Operations Using DataAdapters","linkify":"Performing Batch Operations Using DataAdapters","nodes":[{"content":"Performing Batch Operations Using DataAdapters","pos":[0,46]}]},{"content":"Batch support in ADO.NET allows a <ph id=\"ph1\">&lt;xref:System.Data.Common.DataAdapter&gt;</ph> to group INSERT, UPDATE, and DELETE operations from a <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph> to the server, instead of sending one operation at a time.","pos":[218,461],"source":"Batch support in ADO.NET allows a <xref:System.Data.Common.DataAdapter> to group INSERT, UPDATE, and DELETE operations from a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> to the server, instead of sending one operation at a time."},{"content":"The reduction in the number of round trips to the server typically results in significant performance gains.","pos":[462,570]},{"content":"Batch updates are supported for the .NET data providers for SQL Server (<ph id=\"ph1\">&lt;xref:System.Data.SqlClient&gt;</ph>) and Oracle (<ph id=\"ph2\">&lt;xref:System.Data.OracleClient&gt;</ph>).","pos":[571,718],"source":" Batch updates are supported for the .NET data providers for SQL Server (<xref:System.Data.SqlClient>) and Oracle (<xref:System.Data.OracleClient>)."},{"content":"When updating a database with changes from a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> in previous versions of ADO.NET, the <ph id=\"ph2\">`Update`</ph> method of a <ph id=\"ph3\">`DataAdapter`</ph> performed updates to the database one row at a time.","pos":[725,921],"source":"When updating a database with changes from a <xref:System.Data.DataSet> in previous versions of ADO.NET, the `Update` method of a `DataAdapter` performed updates to the database one row at a time."},{"content":"As it iterated through the rows in the specified <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph>, it examined each <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> to see if it had been modified.","pos":[922,1076],"source":" As it iterated through the rows in the specified <xref:System.Data.DataTable>, it examined each <xref:System.Data.DataRow> to see if it had been modified."},{"content":"If the row had been modified, it called the appropriate <ph id=\"ph1\">`UpdateCommand`</ph>, <ph id=\"ph2\">`InsertCommand`</ph>, or <ph id=\"ph3\">`DeleteCommand`</ph>, depending on the value of the <ph id=\"ph4\">&lt;xref:System.Data.DataRow.RowState%2A&gt;</ph> property for that row.","pos":[1077,1278],"source":" If the row had been modified, it called the appropriate `UpdateCommand`, `InsertCommand`, or `DeleteCommand`, depending on the value of the <xref:System.Data.DataRow.RowState%2A> property for that row."},{"content":"Every row update involved a network round-trip to the database.","pos":[1279,1342]},{"content":"Starting with ADO.NET 2.0, the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbDataAdapter&gt;</ph> exposes an <ph id=\"ph2\">&lt;xref:System.Data.Common.DbDataAdapter.UpdateBatchSize%2A&gt;</ph> property.","pos":[1349,1499],"source":"Starting with ADO.NET 2.0, the <xref:System.Data.Common.DbDataAdapter> exposes an <xref:System.Data.Common.DbDataAdapter.UpdateBatchSize%2A> property."},{"content":"Setting the <ph id=\"ph1\">`UpdateBatchSize`</ph> to a positive integer value causes updates to the database to be sent as batches of the specified size.","pos":[1500,1633],"source":" Setting the `UpdateBatchSize` to a positive integer value causes updates to the database to be sent as batches of the specified size."},{"content":"For example, setting the <ph id=\"ph1\">`UpdateBatchSize`</ph> to 10 will group 10 separate statements and submit them as single batch.","pos":[1634,1749],"source":" For example, setting the `UpdateBatchSize` to 10 will group 10 separate statements and submit them as single batch."},{"content":"Setting the <ph id=\"ph1\">`UpdateBatchSize`</ph> to 0 will cause the <ph id=\"ph2\">&lt;xref:System.Data.Common.DataAdapter&gt;</ph> to use the largest batch size that the server can handle.","pos":[1750,1895],"source":" Setting the `UpdateBatchSize` to 0 will cause the <xref:System.Data.Common.DataAdapter> to use the largest batch size that the server can handle."},{"content":"Setting it to 1 disables batch updates, as rows are sent one at a time.","pos":[1896,1967]},{"content":"Executing an extremely large batch could decrease performance.","pos":[1974,2036]},{"content":"Therefore, you should test for the optimum batch size setting before implementing your application.","pos":[2037,2136]},{"pos":[2145,2179],"content":"Using the UpdateBatchSize Property","linkify":"Using the UpdateBatchSize Property","nodes":[{"content":"Using the UpdateBatchSize Property","pos":[0,34]}]},{"content":"When batch updates are enabled, the <ph id=\"ph1\">&lt;xref:System.Data.IDbCommand.UpdatedRowSource%2A&gt;</ph> property value of the DataAdapter's <ph id=\"ph2\">`UpdateCommand`</ph>, <ph id=\"ph3\">`InsertCommand`</ph>, and <ph id=\"ph4\">`DeleteCommand`</ph> should be set to <ph id=\"ph5\">&lt;xref:System.Data.UpdateRowSource.None&gt;</ph> or <ph id=\"ph6\">&lt;xref:System.Data.UpdateRowSource.OutputParameters&gt;</ph>.","pos":[2183,2471],"source":"When batch updates are enabled, the <xref:System.Data.IDbCommand.UpdatedRowSource%2A> property value of the DataAdapter's `UpdateCommand`, `InsertCommand`, and `DeleteCommand` should be set to <xref:System.Data.UpdateRowSource.None> or <xref:System.Data.UpdateRowSource.OutputParameters>."},{"content":"When performing a batch update, the command's <ph id=\"ph1\">&lt;xref:System.Data.IDbCommand.UpdatedRowSource%2A&gt;</ph> property value of <ph id=\"ph2\">&lt;xref:System.Data.UpdateRowSource.FirstReturnedRecord&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Data.UpdateRowSource.Both&gt;</ph> is invalid.","pos":[2472,2695],"source":" When performing a batch update, the command's <xref:System.Data.IDbCommand.UpdatedRowSource%2A> property value of <xref:System.Data.UpdateRowSource.FirstReturnedRecord> or <xref:System.Data.UpdateRowSource.Both> is invalid."},{"content":"The following procedure demonstrates the use of the <ph id=\"ph1\">`UpdateBatchSize`</ph> property.","pos":[2702,2781],"source":"The following procedure demonstrates the use of the `UpdateBatchSize` property."},{"content":"The procedure takes two arguments, a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> object that has columns representing the <bpt id=\"p1\">**</bpt>ProductCategoryID<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Name<ept id=\"p2\">**</ept> fields in the <bpt id=\"p3\">**</bpt>Production.ProductCategory<ept id=\"p3\">**</ept> table, and an integer representing the batch size (the number of rows in the batch).","pos":[2782,3051],"source":" The procedure takes two arguments, a <xref:System.Data.DataSet> object that has columns representing the **ProductCategoryID** and **Name** fields in the **Production.ProductCategory** table, and an integer representing the batch size (the number of rows in the batch)."},{"content":"The code creates a new <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataAdapter&gt;</ph> object, setting its <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlDataAdapter.UpdateCommand%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Data.SqlClient.SqlDataAdapter.InsertCommand%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Data.SqlClient.SqlDataAdapter.DeleteCommand%2A&gt;</ph> properties.","pos":[3052,3339],"source":" The code creates a new <xref:System.Data.SqlClient.SqlDataAdapter> object, setting its <xref:System.Data.SqlClient.SqlDataAdapter.UpdateCommand%2A>, <xref:System.Data.SqlClient.SqlDataAdapter.InsertCommand%2A>, and <xref:System.Data.SqlClient.SqlDataAdapter.DeleteCommand%2A> properties."},{"content":"The code assumes that the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> object has modified rows.","pos":[3340,3418],"source":" The code assumes that the <xref:System.Data.DataSet> object has modified rows."},{"content":"It sets the <ph id=\"ph1\">`UpdateBatchSize`</ph> property and executes the update.","pos":[3419,3482],"source":" It sets the `UpdateBatchSize` property and executes the update."},{"pos":[7443,7490],"content":"Handling Batch Update-Related Events and Errors","linkify":"Handling Batch Update-Related Events and Errors","nodes":[{"content":"Handling Batch Update-Related Events and Errors","pos":[0,47]}]},{"content":"The <bpt id=\"p1\">**</bpt>DataAdapter<ept id=\"p1\">**</ept> has two update-related events: <bpt id=\"p2\">**</bpt>RowUpdating<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>RowUpdated<ept id=\"p3\">**</ept>.","pos":[7494,7580],"source":"The **DataAdapter** has two update-related events: **RowUpdating** and **RowUpdated**."},{"content":"In previous versions of ADO.NET, when batch processing is disabled, each of these events is generated once for each row processed.","pos":[7581,7711]},{"content":"<bpt id=\"p1\">**</bpt>RowUpdating<ept id=\"p1\">**</ept> is generated before the update occurs, and <bpt id=\"p2\">**</bpt>RowUpdated<ept id=\"p2\">**</ept> is generated after the database update has been completed.","pos":[7712,7844],"source":"**RowUpdating** is generated before the update occurs, and **RowUpdated** is generated after the database update has been completed."},{"pos":[7854,7895],"content":"Event Behavior Changes with Batch Updates","linkify":"Event Behavior Changes with Batch Updates","nodes":[{"content":"Event Behavior Changes with Batch Updates","pos":[0,41]}]},{"content":"When batch processing is enabled, multiple rows are updated in a single database operation.","pos":[7899,7990]},{"content":"Therefore, only one <ph id=\"ph1\">`RowUpdated`</ph> event occurs for each batch, whereas the <ph id=\"ph2\">`RowUpdating`</ph> event occurs for each row processed.","pos":[7991,8115],"source":" Therefore, only one `RowUpdated` event occurs for each batch, whereas the `RowUpdating` event occurs for each row processed."},{"content":"When batch processing is disabled, the two events are fired with one-to-one interleaving, where one <ph id=\"ph1\">`RowUpdating`</ph> event and one <ph id=\"ph2\">`RowUpdated`</ph> event fire for a row, and then one <ph id=\"ph3\">`RowUpdating`</ph> and one <ph id=\"ph4\">`RowUpdated`</ph> event fire for the next row, until all of the rows are processed.","pos":[8116,8392],"source":" When batch processing is disabled, the two events are fired with one-to-one interleaving, where one `RowUpdating` event and one `RowUpdated` event fire for a row, and then one `RowUpdating` and one `RowUpdated` event fire for the next row, until all of the rows are processed."},{"pos":[8402,8424],"content":"Accessing Updated Rows","linkify":"Accessing Updated Rows","nodes":[{"content":"Accessing Updated Rows","pos":[0,22]}]},{"pos":[8428,8632],"content":"When batch processing is disabled, the row being updated can be accessed using the <ph id=\"ph1\">&lt;xref:System.Data.Common.RowUpdatedEventArgs.Row%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Data.Common.RowUpdatedEventArgs&gt;</ph> class.","source":"When batch processing is disabled, the row being updated can be accessed using the <xref:System.Data.Common.RowUpdatedEventArgs.Row%2A> property of the <xref:System.Data.Common.RowUpdatedEventArgs> class."},{"content":"When batch processing is enabled, a single <ph id=\"ph1\">`RowUpdated`</ph> event is generated for multiple rows.","pos":[8639,8732],"source":"When batch processing is enabled, a single `RowUpdated` event is generated for multiple rows."},{"content":"Therefore, the value of the <ph id=\"ph1\">`Row`</ph> property for each row is null.","pos":[8733,8797],"source":" Therefore, the value of the `Row` property for each row is null."},{"content":"<ph id=\"ph1\">`RowUpdating`</ph> events are still generated for each row.","pos":[8798,8852],"source":"`RowUpdating` events are still generated for each row."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Data.Common.RowUpdatedEventArgs&gt;</ph> class allows you to access the processed rows by copying references to the rows into an array.","pos":[8853,9071],"source":" The <xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A> method of the <xref:System.Data.Common.RowUpdatedEventArgs> class allows you to access the processed rows by copying references to the rows into an array."},{"content":"If no rows are being processed, <ph id=\"ph1\">`CopyToRows`</ph> throws an <ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>.","pos":[9072,9163],"source":" If no rows are being processed, `CopyToRows` throws an <xref:System.ArgumentNullException>."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Data.Common.RowUpdatedEventArgs.RowCount%2A&gt;</ph> property to return the number of rows processed before calling the <ph id=\"ph2\">&lt;xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A&gt;</ph> method.","pos":[9164,9364],"source":" Use the <xref:System.Data.Common.RowUpdatedEventArgs.RowCount%2A> property to return the number of rows processed before calling the <xref:System.Data.Common.RowUpdatedEventArgs.CopyToRows%2A> method."},{"pos":[9374,9394],"content":"Handling Data Errors","linkify":"Handling Data Errors","nodes":[{"content":"Handling Data Errors","pos":[0,20]}]},{"content":"Batch execution has the same effect as the execution of each individual statement.","pos":[9398,9480]},{"content":"Statements are executed in the order that the statements were added to the batch.","pos":[9481,9562]},{"content":"Errors are handled the same way in batch mode as they are when batch mode is disabled.","pos":[9563,9649]},{"content":"Each row is processed separately.","pos":[9650,9683]},{"content":"Only rows that have been successfully processed in the database will be updated in the corresponding <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> within the <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph>.","pos":[9684,9852],"source":" Only rows that have been successfully processed in the database will be updated in the corresponding <xref:System.Data.DataRow> within the <xref:System.Data.DataTable>."},{"content":"The data provider and the back-end database server determine which SQL constructs are supported for batch execution.","pos":[9859,9975]},{"content":"An exception may be thrown if a non-supported statement is submitted for execution.","pos":[9976,10059]},{"pos":[10068,10076],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[10080,10182],"content":"<bpt id=\"p1\">[</bpt>DataAdapters and DataReaders<ept id=\"p1\">](../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)</ept>","source":"[DataAdapters and DataReaders](../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)"},{"pos":[10185,10309],"content":"<bpt id=\"p1\">[</bpt>Updating Data Sources with DataAdapters<ept id=\"p1\">](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md)</ept>","source":"[Updating Data Sources with DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md)"},{"pos":[10312,10412],"content":"<bpt id=\"p1\">[</bpt>Handling DataAdapter Events<ept id=\"p1\">](../../../../docs/framework/data/adonet/handling-dataadapter-events.md)</ept>","source":"[Handling DataAdapter Events](../../../../docs/framework/data/adonet/handling-dataadapter-events.md)"},{"pos":[10415,10519],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}