{"content":"---\ntitle: \"UI Automation TextPattern Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"UI Automation, TextPattern class\"\n  - \"TextPattern class\"\n  - \"classes, TextPattern\"\nms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4\n---\n\n# UI Automation TextPattern Overview\n\n> [!NOTE]\n> This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).\n\nThis overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms. These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] equivalents.\n\nExposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream. In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes. <xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints. <xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal.\n\n> [!NOTE]\n> The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text. However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input. See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.\n\nThe functionality described in this overview is vital to assistive technology vendors and their end users. Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph).\n\n<a name=\"UI_Automation_TextPattern_vs__Cicero\"></a>\n\n## UI Automation TextPattern vs. Text Services Framework\n\n[!INCLUDE[TLA#tla_tsf](../../../includes/tlasharptla-tsf-md.md)] is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications. In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.\n\nHowever, [!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)] was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.\n\nIn short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of [!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)] for context-aware input.\n\n<a name=\"Control_Types\"></a>\n\n## Control Types\n\n#### Text\n\nThe Text control is the basic element representing a piece of text on the screen.\n\nA standalone text control can be used as a label or static text on a form. Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>.\n\n> [!NOTE]\n> Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)). This is because text controls are often displayed through the Name property of another control. For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control. Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree. The only text that shows up in the content view is text that is not redundant information. This enables any assistive technology to quickly filter only on the pieces of information that their users need.\n\n#### Edit\n\nEdit controls enable a user to view and edit a single line of text.\n\n> [!NOTE]\n> The single line of text may wrap in certain layout scenarios.\n\n#### Document\n\nDocument controls let a user navigate and obtain information from multiple pages of text.\n\n<a name=\"TextPattern_Client_API_s\"></a>\n\n## TextPattern Client APIs\n\n|||\n|-|-|\n|`System.Windows.Automation.TextPattern Class`|The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model.<br /><br /> This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.|\n|`System.Windows.Automation.Text.TextPatternRange Class`|The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>.<br /><br /> UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>. If the original text in the text control is completely replaced by new text, the current text range becomes invalid. However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text \"pointer\" with anchors (or endpoints) rather than with absolute character positioning.<br /><br /> Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with.|\n|`System.Windows.Automation.AutomationTextAttribute Class`|Used to identify the formatting attributes of a text range.|\n\n<a name=\"TextPattern_Provider_API_s\"></a>\n\n## TextPattern Provider APIs\n\nUI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.\n\nA <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes.\n\nA <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area. If the control does not support this functionality then it does not need to support either of these methods. However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property.\n\nA <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting.\n\n> [!NOTE]\n> The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.\n\n|||\n|-|-|\n|`ITextProvider Interface`|Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>).|\n|`ITextRangeProvider Interface`|Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>).|\n|`System.Windows.Automation.TextPatternIdentifiers Class`|Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>).|\n\n<a name=\"Security\"></a>\n## Security\n The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md)). However, the TextPattern classes described in this overview require some specific security considerations.\n\n- [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.\n\n- UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully \"trusted\". An example of this would be the protected Logon Desktop, where only known and trusted applications can run.\n\n- Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code. [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).\n\n- One of the most significant changes in security for [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] is broadly referred to as \"Secure Input\" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).\n\n    - UIPI prevents one program from controlling and/or monitoring another more \"privileged\" program, preventing cross-process window message attacks that spoof user input.\n\n    - LUA sets limits on the privileges of applications being run by users in the Administrators group. Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary. As a consequence, there may be some restrictions enforced in LUA scenarios. Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.\n\n<a name=\"Performance\"></a>\n\n## Performance\n\nBecause TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content. This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods.\n\nOne tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>. For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.\n\n<a name=\"Glossary\"></a>\n\n## TextPattern Terminology\n\n**Attribute**\nA formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).\n\n**Degenerate Range**\nA degenerate range is an empty or zero-character text range. For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range. If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint. <xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition. This degenerate range can be used as a starting endpoint within the text provider. <xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.\n\n**Embedded Object**\nThere are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model. They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons. For more detailed information, see [Access Embedded Objects Using UI Automation](../../../docs/framework/ui-automation/access-embedded-objects-using-ui-automation.md).\n\n**Endpoint**\nThe absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container.\n\n![TextPatternRangeEndpoints &#40;start and end&#41;.](../../../docs/framework/ui-automation/media/uia-textpattern-endpoints.PNG \"UIA_TextPattern_Endpoints\")\nThe following illustrates a set of start and end points.\n\n**TextRange**\nA representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.\n\n<xref:System.Windows.Automation.Text.TextUnit>\nA pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.\n\n## See also\n\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)\n- [Text Services Framework](/windows/desktop/api/_tsf/)\n","nodes":[{"pos":[4,229],"embed":true,"restype":"x-metadata","content":"title: \"UI Automation TextPattern Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"UI Automation, TextPattern class\"\n  - \"TextPattern class\"\n  - \"classes, TextPattern\"\nms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4","nodes":[{"content":"UI Automation TextPattern Overview","nodes":[{"pos":[0,34],"content":"UI Automation TextPattern Overview","nodes":[{"content":"UI Automation TextPattern Overview","pos":[0,34]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[237,271],"content":"UI Automation TextPattern Overview","linkify":"UI Automation TextPattern Overview","nodes":[{"content":"UI Automation TextPattern Overview","pos":[0,34]}]},{"pos":[275,737],"content":"[!NOTE]\nThis documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[8,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This overview describes how to use <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> to expose the textual content, including format and style attributes, of text controls in <ph id=\"ph2\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>-supported platforms.","pos":[739,1052],"source":"This overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms."},{"content":"These controls include, but are not limited to, the Microsoft .NET Framework <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Controls.RichTextBox&gt;</ph> as well as their <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)]</ph> equivalents.","pos":[1053,1316],"source":" These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] equivalents."},{"content":"Exposing the textual content of a control is accomplished through the use of the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> control pattern, which represents the contents of a text container as a text stream.","pos":[1318,1528],"source":"Exposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream."},{"content":"In turn, <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> requires the support of the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextPatternRange&gt;</ph> class to expose format and style attributes.","pos":[1529,1710],"source":" In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRange&gt;</ph> supports <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End&gt;</ph> endpoints.","pos":[1711,2071],"source":"<xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRange&gt;</ph> supports functionality such as selection, comparison, retrieval and traversal.","pos":[2072,2205],"source":"<xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal."},{"pos":[2209,2692],"content":"[!NOTE]\nThe <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text. However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input. See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text. However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input. See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.","pos":[8,481],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> classes do not provide a means to insert or modify text.","pos":[0,105],"source":"The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text."},{"content":"However, depending on the control, this may be accomplished by the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> or through direct keyboard input.","pos":[106,337],"source":" However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input."},{"content":"See the <bpt id=\"p1\">[</bpt>TextPattern Insert Text Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)</ept> for an example.","pos":[338,473],"source":" See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example."}]}]},{"content":"The functionality described in this overview is vital to assistive technology vendors and their end users.","pos":[2694,2800]},{"content":"Assistive technologies can use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> (character, word, line, or paragraph).","pos":[2801,3123],"source":" Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph)."},{"pos":[3181,3234],"content":"UI Automation TextPattern vs. Text Services Framework","linkify":"UI Automation TextPattern vs. Text Services Framework","nodes":[{"content":"UI Automation TextPattern vs. Text Services Framework","pos":[0,53]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_tsf](../../../includes/tlasharptla-tsf-md.md)]</ph> is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications.","pos":[3236,3445],"source":"[!INCLUDE[TLA#tla_tsf](../../../includes/tlasharptla-tsf-md.md)] is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications."},{"content":"In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.","pos":[3446,3572]},{"pos":[3574,3943],"content":"However, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)]</ph> was designed for applications that need to inject input into context-aware scenarios whereas <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.","source":"However, [!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)] was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices."},{"pos":[3945,4218],"content":"In short, accessible technologies that require read-only access to a text store can use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph>, but will need the more complex functionality of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)]</ph> for context-aware input.","source":"In short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of [!INCLUDE[TLA2#tla_tsf](../../../includes/tla2sharptla-tsf-md.md)] for context-aware input."},{"pos":[4253,4266],"content":"Control Types","linkify":"Control Types","nodes":[{"content":"Control Types","pos":[0,13]}]},{"pos":[4273,4277],"content":"Text","linkify":"Text","nodes":[{"content":"Text","pos":[0,4]}]},{"content":"The Text control is the basic element representing a piece of text on the screen.","pos":[4279,4360]},{"content":"A standalone text control can be used as a label or static text on a form.","pos":[4362,4436]},{"content":"Text controls can also be contained within the structure of a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ControlType.ListItem&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.ControlType.TreeItem&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ControlType.DataItem&gt;</ph>.","pos":[4437,4665],"source":" Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>."},{"pos":[4669,5663],"content":"[!NOTE]\nText controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)). This is because text controls are often displayed through the Name property of another control. For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control. Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree. The only text that shows up in the content view is text that is not redundant information. This enables any assistive technology to quickly filter only on the pieces of information that their users need.","leadings":["","> "],"nodes":[{"content":"Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)). This is because text controls are often displayed through the Name property of another control. For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control. Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree. The only text that shows up in the content view is text that is not redundant information. This enables any assistive technology to quickly filter only on the pieces of information that their users need.","pos":[8,992],"nodes":[{"content":"Text controls might not appear in the content view of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree (see <bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>).","pos":[0,254],"source":"Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md))."},{"content":"This is because text controls are often displayed through the Name property of another control.","pos":[255,350]},{"content":"For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control.","pos":[351,469]},{"content":"Because the Edit control is in the content view of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree, it is not necessary for the text element itself to be in that view of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree.","pos":[470,780],"source":" Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree."},{"content":"The only text that shows up in the content view is text that is not redundant information.","pos":[781,871]},{"content":"This enables any assistive technology to quickly filter only on the pieces of information that their users need.","pos":[872,984]}]}]},{"pos":[5670,5674],"content":"Edit","linkify":"Edit","nodes":[{"content":"Edit","pos":[0,4]}]},{"content":"Edit controls enable a user to view and edit a single line of text.","pos":[5676,5743]},{"pos":[5747,5818],"content":"[!NOTE]\nThe single line of text may wrap in certain layout scenarios.","leadings":["","> "],"nodes":[{"content":"The single line of text may wrap in certain layout scenarios.","pos":[8,69]}]},{"pos":[5825,5833],"content":"Document","linkify":"Document","nodes":[{"content":"Document","pos":[0,8]}]},{"content":"Document controls let a user navigate and obtain information from multiple pages of text.","pos":[5835,5924]},{"pos":[5970,5993],"content":"TextPattern Client APIs","linkify":"TextPattern Client APIs","nodes":[{"content":"TextPattern Client APIs","pos":[0,23]}]},{"content":"The entry point for the <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> text model.","pos":[6052,6170],"source":"The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model."},{"content":"This class also contains the two <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> event listeners, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.TextPattern.TextChangedEvent&gt;</ph>.","pos":[6183,6415],"source":"This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>."},{"content":"The representation of a span of text within a text container that supports <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph>.","pos":[6474,6594],"source":"The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>."},{"content":"UI Automation clients should be careful about the current validity of a text range created using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRange&gt;</ph>.","pos":[6607,6759],"source":"UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>."},{"content":"If the original text in the text control is completely replaced by new text, the current text range becomes invalid.","pos":[6760,6876]},{"content":"However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text \"pointer\" with anchors (or endpoints) rather than with absolute character positioning.","pos":[6877,7115]},{"content":"Clients can listen for a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern.TextChangedEvent&gt;</ph> for notification of any changes to the textual content they are working with.","pos":[7128,7292],"source":"Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with."},{"content":"Used to identify the formatting attributes of a text range.","pos":[7353,7412]},{"pos":[7461,7486],"content":"TextPattern Provider APIs","linkify":"TextPattern Provider APIs","nodes":[{"content":"TextPattern Provider APIs","pos":[0,25]}]},{"pos":[7488,7981],"content":"UI elements or controls that support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> by implementing the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Provider.ITextRangeProvider&gt;</ph> interfaces, either natively or through <ph id=\"ph4\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.","source":"UI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities."},{"pos":[7983,8143],"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> provider does not have to support all text attributes if the control lacks support for any particular attributes.","source":"A <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> provider must support the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern.GetSelection%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Text.TextPatternRange.Select%2A&gt;</ph> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area.","pos":[8145,8468],"source":"A <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area."},{"content":"If the control does not support this functionality then it does not need to support either of these methods.","pos":[8469,8577]},{"content":"However, the control must expose the type of text selection it supports by implementing the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A&gt;</ph> property.","pos":[8578,8761],"source":" However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property."},{"pos":[8763,9123],"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> provider must always support the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> constants <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Text.TextUnit.Character&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Automation.Text.TextUnit.Document&gt;</ph> as well as any other <ph id=\"ph5\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> constants it is capable of supporting.","source":"A <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting."},{"pos":[9127,9733],"content":"[!NOTE]\nThe provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.","leadings":["","> "],"nodes":[{"content":"The provider may skip support for a specific <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> by deferring to the next largest <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> supported in the following order: <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Text.TextUnit.Character&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Automation.Text.TextUnit.Format&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Automation.Text.TextUnit.Word&gt;</ph>, <ph id=\"ph6\">&lt;xref:System.Windows.Automation.Text.TextUnit.Line&gt;</ph>, <ph id=\"ph7\">&lt;xref:System.Windows.Automation.Text.TextUnit.Paragraph&gt;</ph>, <ph id=\"ph8\">&lt;xref:System.Windows.Automation.Text.TextUnit.Page&gt;</ph>, and <ph id=\"ph9\">&lt;xref:System.Windows.Automation.Text.TextUnit.Document&gt;</ph>.","pos":[8,604],"source":"The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>."}]},{"pos":[9772,9958],"content":"Exposes methods, properties and attributes that support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> in client applications (see <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph>).","source":"Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>)."},{"pos":[9992,10104],"content":"Represents a span of text in a text provider (see <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextRangeProvider&gt;</ph>).","source":"Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>)."},{"pos":[10164,10290],"content":"Contains values that are used as identifiers for text providers (see <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPatternIdentifiers&gt;</ph>).","source":"Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>)."},{"pos":[10320,10328],"content":"Security","linkify":"Security","nodes":[{"content":"Security","pos":[0,8]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> architecture was designed with security in mind (see <bpt id=\"p1\">[</bpt>UI Automation Security Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-security-overview.md)</ept>).","pos":[10330,10581],"source":"The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md))."},{"content":"However, the TextPattern classes described in this overview require some specific security considerations.","pos":[10582,10688]},{"pos":[10692,10890],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.","source":"[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text providers supply read-only interfaces and do not provide the ability to change the existing text in a control."},{"content":"UI Automation clients can only use <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> if they are fully \"trusted\".","pos":[10894,11040],"source":"UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully \"trusted\"."},{"content":"An example of this would be the protected Logon Desktop, where only known and trusted applications can run.","pos":[11041,11148]},{"content":"Developers of UI Automation providers should be aware that all information they choose to expose in their controls through <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> is essentially public and fully accessible by other code.","pos":[11152,11415],"source":"Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).","pos":[11416,11712],"source":"[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields)."},{"pos":[11716,12013],"content":"One of the most significant changes in security for <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)]</ph> is broadly referred to as \"Secure Input\" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).","source":"One of the most significant changes in security for [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] is broadly referred to as \"Secure Input\" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI)."},{"content":"UIPI prevents one program from controlling and/or monitoring another more \"privileged\" program, preventing cross-process window message attacks that spoof user input.","pos":[12021,12187]},{"content":"LUA sets limits on the privileges of applications being run by users in the Administrators group.","pos":[12195,12292]},{"content":"Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary.","pos":[12293,12412]},{"content":"As a consequence, there may be some restrictions enforced in LUA scenarios.","pos":[12413,12488]},{"content":"Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.","pos":[12489,12745]},{"pos":[12778,12789],"content":"Performance","linkify":"Performance","nodes":[{"content":"Performance","pos":[0,11]}]},{"content":"Because TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content.","pos":[12791,12959]},{"content":"This is unlike other control patterns in <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> that can be accessed using the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A&gt;</ph> methods.","pos":[12960,13271],"source":" This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods."},{"content":"One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A&gt;</ph>.","pos":[13273,13474],"source":"One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>."},{"content":"For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.","pos":[13475,13686]},{"pos":[13716,13739],"content":"TextPattern Terminology","linkify":"TextPattern Terminology","nodes":[{"content":"TextPattern Terminology","pos":[0,23]}]},{"pos":[13741,13943],"content":"<bpt id=\"p1\">**</bpt>Attribute<ept id=\"p1\">**</ept> A formatting characteristic of a text range (for example, <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern.IsItalicAttribute&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern.FontNameAttribute&gt;</ph>).","source":"**Attribute**\nA formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>)."},{"content":"<bpt id=\"p1\">**</bpt>Degenerate Range<ept id=\"p1\">**</ept> A degenerate range is an empty or zero-character text range.","pos":[13945,14026],"source":"**Degenerate Range**\nA degenerate range is an empty or zero-character text range."},{"content":"For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range.","pos":[14027,14156]},{"content":"If no text is selected, <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern.GetSelection%2A&gt;</ph> would return a degenerate range at the text insertion point and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A&gt;</ph> would return a degenerate range as its starting endpoint.","pos":[14157,14426],"source":" If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern.RangeFromChild%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A&gt;</ph> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition.","pos":[14427,14670],"source":"<xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition."},{"content":"This degenerate range can be used as a starting endpoint within the text provider.","pos":[14671,14753]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A&gt;</ph> return a null reference (<ph id=\"ph3\">`Nothing`</ph> in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.","pos":[14754,15033],"source":"<xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range."},{"content":"<bpt id=\"p1\">**</bpt>Embedded Object<ept id=\"p1\">**</ept> There are two types of embedded objects in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> text model.","pos":[15035,15198],"source":"**Embedded Object**\nThere are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model."},{"content":"They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons.","pos":[15199,15321]},{"content":"For more detailed information, see <bpt id=\"p1\">[</bpt>Access Embedded Objects Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/access-embedded-objects-using-ui-automation.md)</ept>.","pos":[15322,15489],"source":" For more detailed information, see [Access Embedded Objects Using UI Automation](../../../docs/framework/ui-automation/access-embedded-objects-using-ui-automation.md)."},{"pos":[15491,15702],"content":"<bpt id=\"p1\">**</bpt>Endpoint<ept id=\"p1\">**</ept> The absolute <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End&gt;</ph> point of a text range within a text container.","source":"**Endpoint**\nThe absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container."},{"pos":[15704,15917],"content":"<bpt id=\"p1\">![</bpt>TextPatternRangeEndpoints &amp;#40;start and end&amp;#41;.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/ui-automation/media/uia-textpattern-endpoints.PNG \"</bpt>UIA_TextPattern_Endpoints<ept id=\"p2\">\")</ept> The following illustrates a set of start and end points.","source":"![TextPatternRangeEndpoints &#40;start and end&#41;.](../../../docs/framework/ui-automation/media/uia-textpattern-endpoints.PNG \"UIA_TextPattern_Endpoints\")\nThe following illustrates a set of start and end points."},{"pos":[15919,16070],"content":"<bpt id=\"p1\">**</bpt>TextRange<ept id=\"p1\">**</ept> A representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.","source":"**TextRange**\nA representation of a span of text, with start and end points, in a text container including all associated attributes and functionality."},{"pos":[16072,16245],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Text.TextUnit&gt;</ph> A pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.","source":"<xref:System.Windows.Automation.Text.TextUnit>\nA pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range."},{"pos":[16250,16258],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[16262,16391],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[16394,16517],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[16520,16619],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[16622,16723],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"},{"pos":[16726,16875],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[16878,17021],"content":"<bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>","source":"[Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)"},{"pos":[17024,17077],"content":"<bpt id=\"p1\">[</bpt>Text Services Framework<ept id=\"p1\">](/windows/desktop/api/_tsf/)</ept>","source":"[Text Services Framework](/windows/desktop/api/_tsf/)"}]}