{"content":"---\ntitle: \"Walkthrough: Hosting Direct3D9 Content in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Direct3D9 [WPF interoperability], hosting Direct3D9 content\"\n  - \"WPF, hosting Direct3D9 content\"\nms.assetid: 60983736-0ab5-42cc-8b16-e9fbde261a43\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Hosting Direct3D9 Content in WPF\nThis walkthrough shows how to host Direct3D9 content in a Windows Presentation Foundation (WPF) application.  \n  \n In this walkthrough, you perform the following tasks:  \n  \n-   Create a WPF project to host the Direct3D9 content.  \n  \n-   Import the Direct3D9 content.  \n  \n-   Display the Direct3D9 content by using the <xref:System.Windows.Interop.D3DImage> class.  \n  \n When you are finished, you will know how to host Direct3D9 content in a WPF application.  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n-   DirectX SDK 9 or later.  \n  \n-   A DLL that contains Direct3D9 content in a WPF-compatible format. For more information, see [WPF and Direct3D9 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md) and [Walkthrough: Creating Direct3D9 Content for Hosting in WPF](../../../../docs/framework/wpf/advanced/walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md).  \n  \n## Creating the WPF Project  \n The first step is to create the project for the WPF application.  \n  \n#### To create the WPF project  \n  \n-   Create a new WPF Application project in Visual C# named `D3DHost`. For more information, see [How to: Create a New WPF Application Project](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82).  \n  \n     MainWindow.xaml opens in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n## Importing the Direct3D9 Content  \n You import the Direct3D9 content from an unmanaged DLL by using the `DllImport`attribute.  \n  \n#### To import Direct3D9 content  \n  \n1.  Open MainWindow.xaml.cs in the Code Editor.  \n  \n2.  Replace the automatically generated code with the following code.  \n  \n     [!code-csharp[System.Windows.Interop.D3DImage#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/CS/window1.xaml.cs#1)]  \n  \n## Hosting the Direct3D9 Content  \n Finally, use the <xref:System.Windows.Interop.D3DImage> class to host the Direct3D9 content.  \n  \n#### To host the Direct3D9 content  \n  \n1.  In MainWindow.xaml, replace the automatically generated XAML with the following XAML.  \n  \n     [!code-xml[System.Windows.Interop.D3DImage#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/CS/window1.xaml#10)]  \n  \n2.  Build the project.  \n  \n3.  Copy the DLL that contains the Direct3D9 content to the bin/Debug folder.  \n  \n4.  Press F5 to run the project.  \n  \n     The Direct3D9 content appears within the WPF application.  \n  \n## See Also  \n <xref:System.Windows.Interop.D3DImage>   \n [Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)","nodes":[{"pos":[4,500],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting Direct3D9 Content in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Direct3D9 [WPF interoperability], hosting Direct3D9 content\"\n  - \"WPF, hosting Direct3D9 content\"\nms.assetid: 60983736-0ab5-42cc-8b16-e9fbde261a43\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF | Microsoft Docs","nodes":[{"pos":[0,62],"content":"Walkthrough: Hosting Direct3D9 Content in WPF | Microsoft Docs","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF | Microsoft Docs","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[507,552],"content":"Walkthrough: Hosting Direct3D9 Content in WPF","linkify":"Walkthrough: Hosting Direct3D9 Content in WPF","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF","pos":[0,45]}]},{"content":"This walkthrough shows how to host Direct3D9 content in a Windows Presentation Foundation (WPF) application.","pos":[553,661]},{"content":"In this walkthrough, you perform the following tasks:","pos":[668,721]},{"content":"Create a WPF project to host the Direct3D9 content.","pos":[731,782]},{"content":"Import the Direct3D9 content.","pos":[792,821]},{"content":"Display the Direct3D9 content by using the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.D3DImage&gt;</ph> class.","pos":[831,919],"source":"Display the Direct3D9 content by using the <xref:System.Windows.Interop.D3DImage> class."},{"content":"When you are finished, you will know how to host Direct3D9 content in a WPF application.","pos":[926,1014]},{"pos":[1023,1036],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1040,1103]},{"pos":[1113,1181],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]."},{"content":"DirectX SDK 9 or later.","pos":[1191,1214]},{"content":"A DLL that contains Direct3D9 content in a WPF-compatible format.","pos":[1224,1289]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>WPF and Direct3D9 Interoperation<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md)</ept> and <bpt id=\"p2\">[</bpt>Walkthrough: Creating Direct3D9 Content for Hosting in WPF<ept id=\"p2\">](../../../../docs/framework/wpf/advanced/walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md)</ept>.","pos":[1290,1595],"source":" For more information, see [WPF and Direct3D9 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-direct3d9-interoperation.md) and [Walkthrough: Creating Direct3D9 Content for Hosting in WPF](../../../../docs/framework/wpf/advanced/walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md)."},{"pos":[1604,1628],"content":"Creating the WPF Project","linkify":"Creating the WPF Project","nodes":[{"content":"Creating the WPF Project","pos":[0,24]}]},{"content":"The first step is to create the project for the WPF application.","pos":[1632,1696]},{"pos":[1707,1732],"content":"To create the WPF project","linkify":"To create the WPF project","nodes":[{"content":"To create the WPF project","pos":[0,25]}]},{"content":"Create a new WPF Application project in Visual C# named <ph id=\"ph1\">`D3DHost`</ph>.","pos":[1742,1808],"source":"Create a new WPF Application project in Visual C# named `D3DHost`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a New WPF Application Project<ept id=\"p1\">](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82)</ept>.","pos":[1809,1952],"source":" For more information, see [How to: Create a New WPF Application Project](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82)."},{"pos":[1963,2084],"content":"MainWindow.xaml opens in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"MainWindow.xaml opens in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"pos":[2093,2124],"content":"Importing the Direct3D9 Content","linkify":"Importing the Direct3D9 Content","nodes":[{"content":"Importing the Direct3D9 Content","pos":[0,31]}]},{"pos":[2128,2217],"content":"You import the Direct3D9 content from an unmanaged DLL by using the <ph id=\"ph1\">`DllImport`</ph>attribute.","source":"You import the Direct3D9 content from an unmanaged DLL by using the `DllImport`attribute."},{"pos":[2228,2255],"content":"To import Direct3D9 content","linkify":"To import Direct3D9 content","nodes":[{"content":"To import Direct3D9 content","pos":[0,27]}]},{"content":"Open MainWindow.xaml.cs in the Code Editor.","pos":[2265,2308]},{"content":"Replace the automatically generated code with the following code.","pos":[2318,2383]},{"pos":[2558,2587],"content":"Hosting the Direct3D9 Content","linkify":"Hosting the Direct3D9 Content","nodes":[{"content":"Hosting the Direct3D9 Content","pos":[0,29]}]},{"content":"Finally, use the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.D3DImage&gt;</ph> class to host the Direct3D9 content.","pos":[2591,2683],"source":"Finally, use the <xref:System.Windows.Interop.D3DImage> class to host the Direct3D9 content."},{"pos":[2694,2723],"content":"To host the Direct3D9 content","linkify":"To host the Direct3D9 content","nodes":[{"content":"To host the Direct3D9 content","pos":[0,29]}]},{"content":"In MainWindow.xaml, replace the automatically generated XAML with the following XAML.","pos":[2733,2818]},{"content":"Build the project.","pos":[2990,3008]},{"content":"Copy the DLL that contains the Direct3D9 content to the bin/Debug folder.","pos":[3018,3091]},{"content":"Press F5 to run the project.","pos":[3101,3129]},{"content":"The Direct3D9 content appears within the WPF application.","pos":[3140,3197]},{"pos":[3206,3214],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Interop.D3DImage&gt;</ph>","pos":[3218,3256],"source":"<xref:System.Windows.Interop.D3DImage> "},{"content":"<bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept>","pos":[3261,3438],"source":"[Performance Considerations for Direct3D9 and WPF Interoperability](../../../../docs/framework/wpf/advanced/performance-considerations-for-direct3d9-and-wpf-interoperability.md)"}]}