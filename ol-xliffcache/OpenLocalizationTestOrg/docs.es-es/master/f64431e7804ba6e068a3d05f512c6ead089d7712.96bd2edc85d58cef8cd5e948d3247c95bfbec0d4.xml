{"content":"---\ntitle: \"Animation and Timing System Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"timing system [WPF]\"\n  - \"animation [WPF]\"\nms.assetid: 172cd5a8-a333-4c81-9456-fafccc19f382\n---\n# Animation and Timing System Overview\nThis topic describes how the timing system uses the animation, <xref:System.Windows.Media.Animation.Timeline>, and <xref:System.Windows.Media.Animation.Clock> classes to animate properties.  \n  \n<a name=\"prerequisites\"></a>   \n## Prerequisites  \n To understand this topic, you should be able to use [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations to animate properties, as described in the [Animation Overview](animation-overview.md). It also helps to be familiar with dependency properties; for more information, see the [Dependency Properties Overview](../advanced/dependency-properties-overview.md).  \n  \n<a name=\"timelinesandclocks\"></a>   \n## Timelines and Clocks  \n The [Animation Overview](animation-overview.md) described how a <xref:System.Windows.Media.Animation.Timeline> represents a segment of time, and an animation is a type of <xref:System.Windows.Media.Animation.Timeline> that produces output values. By itself, a <xref:System.Windows.Media.Animation.Timeline>, doesn't do anything other than just describe a segment of time. It's the timeline's <xref:System.Windows.Media.Animation.Clock> object that does the real work. Likewise, animation doesn't actually animate properties: an animation class describes how output values should be calculated, but it’s the <xref:System.Windows.Media.Animation.Clock> that was created for the animation that drives the animation output and applies it to properties.  \n  \n A <xref:System.Windows.Media.Animation.Clock> is a special type of object that maintains timing-related run-time state for the <xref:System.Windows.Media.Animation.Timeline>. It provides three bits of information that are essential to the animation and timing system: <xref:System.Windows.Media.Animation.Clock.CurrentTime%2A>, <xref:System.Windows.Media.Animation.Clock.CurrentProgress%2A>, and <xref:System.Windows.Media.Animation.Clock.CurrentState%2A>. A <xref:System.Windows.Media.Animation.Clock> determines its current time, progress, and state by using the timing behaviors described by its <xref:System.Windows.Media.Animation.Timeline>: <xref:System.Windows.Media.Animation.Timeline.Duration%2A>, <xref:System.Windows.Media.Animation.Timeline.RepeatBehavior%2A>, <xref:System.Windows.Media.Animation.Timeline.AutoReverse%2A>, and so on.  \n  \n In most cases, a <xref:System.Windows.Media.Animation.Clock> is created automatically for your timeline. When you animate by using a <xref:System.Windows.Media.Animation.Storyboard> or the <xref:System.Windows.Media.Animation.Animatable.BeginAnimation%2A> method, clocks are automatically created for your timelines and animations and applied to their targeted properties. You can also create a <xref:System.Windows.Media.Animation.Clock> explicitly by using the <xref:System.Windows.Media.Animation.Timeline.CreateClock%2A> method of your <xref:System.Windows.Media.Animation.Timeline>. The <xref:System.Windows.Media.MediaTimeline.CreateClock%2A?displayProperty=nameWithType> method creates a clock of the appropriate type for the <xref:System.Windows.Media.Animation.Timeline> on which it is called. If the <xref:System.Windows.Media.Animation.Timeline> contains child timelines, it creates <xref:System.Windows.Media.Animation.Clock> objects for them as well. The resulting <xref:System.Windows.Media.Animation.Clock> objects are arranged in trees that match the structure of the <xref:System.Windows.Media.Animation.Timeline> objects tree from which they are created.  \n  \n There are different types of clocks for different types of timelines. The following table shows the <xref:System.Windows.Media.Animation.Clock> types that correspond to some of the different <xref:System.Windows.Media.Animation.Timeline> types.  \n  \n|Timeline type|Clock type|Clock purpose|  \n|-------------------|----------------|-------------------|  \n|Animation (inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>)|<xref:System.Windows.Media.Animation.AnimationClock>|Generates output values for a dependency property.|  \n|<xref:System.Windows.Media.MediaTimeline>|<xref:System.Windows.Media.MediaClock>|Processes a media file.|  \n|<xref:System.Windows.Media.Animation.ParallelTimeline>|<xref:System.Windows.Media.Animation.ClockGroup>|Groups and controls its child <xref:System.Windows.Media.Animation.Clock> objects|  \n|<xref:System.Windows.Media.Animation.Storyboard>|<xref:System.Windows.Media.Animation.ClockGroup>|Groups and controls its child <xref:System.Windows.Media.Animation.Clock> objects|  \n  \n You can apply any <xref:System.Windows.Media.Animation.AnimationClock> objects you create to compatible dependency properties by using the <xref:System.Windows.Media.Animation.IAnimatable.ApplyAnimationClock%2A> method.  \n  \n In performance-intensive scenarios, such as animating large numbers of similar objects, managing your own <xref:System.Windows.Media.Animation.Clock> use can provide performance benefits.  \n  \n<a name=\"timemanager\"></a>   \n## Clocks and the Time Manager  \n When you animate objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], it’s the time manager that manages the <xref:System.Windows.Media.MediaPlayer.Clock%2A> objects created for your timelines. The time manager is the root of a tree of <xref:System.Windows.Media.MediaPlayer.Clock%2A> objects and controls the flow of time in that tree.  A time manager is automatically created for each [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application and is invisible to the application developer. The time manager \"ticks\" many times per second; the actual number of ticks that occur each second varies depending on available system resources. During each one of these ticks, the time manager computes the state of all <xref:System.Windows.Media.Animation.ClockState.Active> <xref:System.Windows.Media.Animation.Clock> objects in the timing tree.  \n  \n The following illustration shows the relationship between the time manager, and <xref:System.Windows.Media.Animation.AnimationClock>, and an animated dependency property.  \n  \n ![Timing system components](./media/graphicsmm-clocks-1clock1prop.png \"graphicsmm_clocks_1clock1prop\")  \nAnimating a property  \n  \n When the time manager ticks, it updates the time of every <xref:System.Windows.Media.Animation.ClockState.Active> <xref:System.Windows.Media.Animation.Clock> in the application. If the <xref:System.Windows.Media.Animation.Clock> is an <xref:System.Windows.Media.Animation.AnimationClock>, it uses the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method of the <xref:System.Windows.Media.Animation.AnimationTimeline> from which it was created to calculate its current output value. The <xref:System.Windows.Media.Animation.AnimationClock> supplies the <xref:System.Windows.Media.Animation.AnimationTimeline> with the current local time, an input value, which is typically the base value of the property, and a default destination value. When you retrieve the value of an animated by property using the <xref:System.Windows.DependencyObject.GetValue%2A> method or its CLR accessor, you get the output of its <xref:System.Windows.Media.Animation.AnimationClock>.  \n  \n#### Clock Groups  \n The preceding section described how there are different types of <xref:System.Windows.Media.Animation.Clock> objects for different types of timelines. The following illustration shows the relationship between the time manager, a <xref:System.Windows.Media.Animation.ClockGroup>, an <xref:System.Windows.Media.Animation.AnimationClock>, and an animated dependency property. A <xref:System.Windows.Media.Animation.ClockGroup> is created for timelines that group other timelines, such as the <xref:System.Windows.Media.Animation.Storyboard> class, which groups animations and other timelines.  \n  \n ![Timing system components](./media/graphicsmm-clocks-2clock1clockgroup2prop.png \"graphicsmm_clocks_2clock1clockgroup2prop\")  \nA ClockGroup  \n  \n#### Composition  \n It's possible to associate multiple clocks with a single property, in which case each clock uses the output value of the preceding clock as its base value. The following illustration shows three <xref:System.Windows.Media.Animation.AnimationClock> objects applied to the same property. Clock1 uses the base value of the animated property as its input and uses it to generate output. Clock2 takes the output from Clock1 as its input and uses it to generate output. Clock3 takes the output from Clock2 as its input and uses it to generate output. When multiple clocks affect the same property simultaneously, they are said to be in a composition chain.  \n  \n ![Timing system components](./media/graphicsmm-clocks-2clock1prop.png \"graphicsmm_clocks_2clock1prop\")  \nA composition chain  \n  \n Note that although a relationship is created among the input and output of the <xref:System.Windows.Media.Animation.AnimationClock> objects in the composition chain, their timing behaviors are not affected; <xref:System.Windows.Media.Animation.Clock> objects (including <xref:System.Windows.Media.Animation.AnimationClock> objects) have a hierarchical dependency on their parent <xref:System.Windows.Media.Animation.Clock> objects.  \n  \n To apply multiple clocks to the same property, use the <xref:System.Windows.Media.Animation.HandoffBehavior.Compose> <xref:System.Windows.Media.Animation.HandoffBehavior> when applying a <xref:System.Windows.Media.Animation.Storyboard>, animation, or <xref:System.Windows.Media.Animation.AnimationClock>.  \n  \n#### Ticks and Event Consolidation  \n In addition to calculating output values, the time manager does other work every time it ticks: it determines the state of each clock and raises events as appropriate.  \n  \n While ticks occur frequently, it's possible for a lot of things to happen between ticks. For example, a <xref:System.Windows.Media.Animation.Clock> might be stopped, started, and stopped again, in which case its <xref:System.Windows.Media.Animation.Clock.CurrentState%2A> value will have changed three times. In theory, the <xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated> event could be raised multiple times in a single tick; however, the timing engine consolidates events, so that the <xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated> event can be raised at most once per tick. This is true for all timing events: at most one event of each type is raised for a given <xref:System.Windows.Media.Animation.Clock> object.  \n  \n When a <xref:System.Windows.Media.Animation.Clock> switches states and returns back to its original state between ticks (such as changing from <xref:System.Windows.Media.Animation.ClockState.Active> to <xref:System.Windows.Media.Animation.ClockState.Stopped> and back to <xref:System.Windows.Media.Animation.ClockState.Active>), the associated event still occurs.  \n  \n For more information about timing events, see the [Timing Events Overview](timing-events-overview.md).  \n  \n<a name=\"currentvaluesbasevaluesofproperties\"></a>   \n## Current Values and Base Values of Properties  \n An animatable property can have two values: a base value and a current value. When you set property using its CLR accessor or the <xref:System.Windows.DependencyObject.SetValue%2A> method, you set its base value. When a property is not animated, its base and current values are the same.  \n  \n When you animate a property, the <xref:System.Windows.Media.Animation.AnimationClock> sets the property's *current* value. Retrieving the property's value through its CLR accessor or the <xref:System.Windows.DependencyObject.GetValue%2A> method returns the output of the <xref:System.Windows.Media.Animation.AnimationClock> when the <xref:System.Windows.Media.Animation.AnimationClock> is <xref:System.Windows.Media.Animation.ClockState.Active> or <xref:System.Windows.Media.Animation.ClockState.Filling>. You can retrieve the property's base value by using the <xref:System.Windows.Media.Animation.IAnimatable.GetAnimationBaseValue%2A> method.  \n  \n## See also\n\n- [Animation Overview](animation-overview.md)\n- [Timing Events Overview](timing-events-overview.md)\n- [Timing Behaviors Overview](timing-behaviors-overview.md)\n","nodes":[{"pos":[4,190],"embed":true,"restype":"x-metadata","content":"title: \"Animation and Timing System Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"timing system [WPF]\"\n  - \"animation [WPF]\"\nms.assetid: 172cd5a8-a333-4c81-9456-fafccc19f382","nodes":[{"content":"Animation and Timing System Overview","nodes":[{"pos":[0,36],"content":"Animation and Timing System Overview","nodes":[{"content":"Animation and Timing System Overview","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[197,233],"content":"Animation and Timing System Overview","linkify":"Animation and Timing System Overview","nodes":[{"content":"Animation and Timing System Overview","pos":[0,36]}]},{"pos":[234,423],"content":"This topic describes how the timing system uses the animation, <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph>, and <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> classes to animate properties.","source":"This topic describes how the timing system uses the animation, <xref:System.Windows.Media.Animation.Timeline>, and <xref:System.Windows.Media.Animation.Clock> classes to animate properties."},{"pos":[464,477],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"To understand this topic, you should be able to use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animations to animate properties, as described in the <bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept>.","pos":[481,713],"source":"To understand this topic, you should be able to use [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations to animate properties, as described in the [Animation Overview](animation-overview.md)."},{"content":"It also helps to be familiar with dependency properties; for more information, see the <bpt id=\"p1\">[</bpt>Dependency Properties Overview<ept id=\"p1\">](../advanced/dependency-properties-overview.md)</ept>.","pos":[714,881],"source":" It also helps to be familiar with dependency properties; for more information, see the [Dependency Properties Overview](../advanced/dependency-properties-overview.md)."},{"pos":[927,947],"content":"Timelines and Clocks","linkify":"Timelines and Clocks","nodes":[{"content":"Timelines and Clocks","pos":[0,20]}]},{"content":"The <bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept> described how a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> represents a segment of time, and an animation is a type of <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> that produces output values.","pos":[951,1197],"source":"The [Animation Overview](animation-overview.md) described how a <xref:System.Windows.Media.Animation.Timeline> represents a segment of time, and an animation is a type of <xref:System.Windows.Media.Animation.Timeline> that produces output values."},{"content":"By itself, a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph>, doesn't do anything other than just describe a segment of time.","pos":[1198,1322],"source":" By itself, a <xref:System.Windows.Media.Animation.Timeline>, doesn't do anything other than just describe a segment of time."},{"content":"It's the timeline's <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> object that does the real work.","pos":[1323,1418],"source":" It's the timeline's <xref:System.Windows.Media.Animation.Clock> object that does the real work."},{"content":"Likewise, animation doesn't actually animate properties: an animation class describes how output values should be calculated, but it’s the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> that was created for the animation that drives the animation output and applies it to properties.","pos":[1419,1699],"source":" Likewise, animation doesn't actually animate properties: an animation class describes how output values should be calculated, but it’s the <xref:System.Windows.Media.Animation.Clock> that was created for the animation that drives the animation output and applies it to properties."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> is a special type of object that maintains timing-related run-time state for the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph>.","pos":[1706,1880],"source":"A <xref:System.Windows.Media.Animation.Clock> is a special type of object that maintains timing-related run-time state for the <xref:System.Windows.Media.Animation.Timeline>."},{"content":"It provides three bits of information that are essential to the animation and timing system: <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentTime%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentProgress%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentState%2A&gt;</ph>.","pos":[1881,2162],"source":" It provides three bits of information that are essential to the animation and timing system: <xref:System.Windows.Media.Animation.Clock.CurrentTime%2A>, <xref:System.Windows.Media.Animation.Clock.CurrentProgress%2A>, and <xref:System.Windows.Media.Animation.Clock.CurrentState%2A>."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> determines its current time, progress, and state by using the timing behaviors described by its <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph>: <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.Timeline.Duration%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.Timeline.RepeatBehavior%2A&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Media.Animation.Timeline.AutoReverse%2A&gt;</ph>, and so on.","pos":[2163,2552],"source":" A <xref:System.Windows.Media.Animation.Clock> determines its current time, progress, and state by using the timing behaviors described by its <xref:System.Windows.Media.Animation.Timeline>: <xref:System.Windows.Media.Animation.Timeline.Duration%2A>, <xref:System.Windows.Media.Animation.Timeline.RepeatBehavior%2A>, <xref:System.Windows.Media.Animation.Timeline.AutoReverse%2A>, and so on."},{"content":"In most cases, a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> is created automatically for your timeline.","pos":[2559,2663],"source":"In most cases, a <xref:System.Windows.Media.Animation.Clock> is created automatically for your timeline."},{"content":"When you animate by using a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Storyboard&gt;</ph> or the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Animatable.BeginAnimation%2A&gt;</ph> method, clocks are automatically created for your timelines and animations and applied to their targeted properties.","pos":[2664,2931],"source":" When you animate by using a <xref:System.Windows.Media.Animation.Storyboard> or the <xref:System.Windows.Media.Animation.Animatable.BeginAnimation%2A> method, clocks are automatically created for your timelines and animations and applied to their targeted properties."},{"content":"You can also create a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> explicitly by using the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline.CreateClock%2A&gt;</ph> method of your <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph>.","pos":[2932,3146],"source":" You can also create a <xref:System.Windows.Media.Animation.Clock> explicitly by using the <xref:System.Windows.Media.Animation.Timeline.CreateClock%2A> method of your <xref:System.Windows.Media.Animation.Timeline>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.MediaTimeline.CreateClock%2A?displayProperty=nameWithType&gt;</ph> method creates a clock of the appropriate type for the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> on which it is called.","pos":[3147,3361],"source":" The <xref:System.Windows.Media.MediaTimeline.CreateClock%2A?displayProperty=nameWithType> method creates a clock of the appropriate type for the <xref:System.Windows.Media.Animation.Timeline> on which it is called."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> contains child timelines, it creates <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects for them as well.","pos":[3362,3522],"source":" If the <xref:System.Windows.Media.Animation.Timeline> contains child timelines, it creates <xref:System.Windows.Media.Animation.Clock> objects for them as well."},{"content":"The resulting <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects are arranged in trees that match the structure of the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> objects tree from which they are created.","pos":[3523,3731],"source":" The resulting <xref:System.Windows.Media.Animation.Clock> objects are arranged in trees that match the structure of the <xref:System.Windows.Media.Animation.Timeline> objects tree from which they are created."},{"content":"There are different types of clocks for different types of timelines.","pos":[3738,3807]},{"content":"The following table shows the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> types that correspond to some of the different <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> types.","pos":[3808,3982],"source":" The following table shows the <xref:System.Windows.Media.Animation.Clock> types that correspond to some of the different <xref:System.Windows.Media.Animation.Timeline> types."},{"content":"Timeline type","pos":[3989,4002]},{"content":"Clock type","pos":[4003,4013]},{"content":"Clock purpose","pos":[4014,4027]},{"pos":[4093,4174],"content":"Animation (inherits from <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph>)","source":"Animation (inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>)"},{"content":"Generates output values for a dependency property.","pos":[4228,4278]},{"content":"Processes a media file.","pos":[4364,4387]},{"pos":[4496,4577],"content":"Groups and controls its child <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects","source":"Groups and controls its child <xref:System.Windows.Media.Animation.Clock> objects"},{"pos":[4680,4761],"content":"Groups and controls its child <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects","source":"Groups and controls its child <xref:System.Windows.Media.Animation.Clock> objects"},{"pos":[4769,4988],"content":"You can apply any <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> objects you create to compatible dependency properties by using the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.IAnimatable.ApplyAnimationClock%2A&gt;</ph> method.","source":"You can apply any <xref:System.Windows.Media.Animation.AnimationClock> objects you create to compatible dependency properties by using the <xref:System.Windows.Media.Animation.IAnimatable.ApplyAnimationClock%2A> method."},{"pos":[4995,5182],"content":"In performance-intensive scenarios, such as animating large numbers of similar objects, managing your own <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> use can provide performance benefits.","source":"In performance-intensive scenarios, such as animating large numbers of similar objects, managing your own <xref:System.Windows.Media.Animation.Clock> use can provide performance benefits."},{"pos":[5221,5248],"content":"Clocks and the Time Manager","linkify":"Clocks and the Time Manager","nodes":[{"content":"Clocks and the Time Manager","pos":[0,27]}]},{"content":"When you animate objects in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, it’s the time manager that manages the <ph id=\"ph2\">&lt;xref:System.Windows.Media.MediaPlayer.Clock%2A&gt;</ph> objects created for your timelines.","pos":[5252,5486],"source":"When you animate objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], it’s the time manager that manages the <xref:System.Windows.Media.MediaPlayer.Clock%2A> objects created for your timelines."},{"content":"The time manager is the root of a tree of <ph id=\"ph1\">&lt;xref:System.Windows.Media.MediaPlayer.Clock%2A&gt;</ph> objects and controls the flow of time in that tree.","pos":[5487,5629],"source":" The time manager is the root of a tree of <xref:System.Windows.Media.MediaPlayer.Clock%2A> objects and controls the flow of time in that tree."},{"content":"A time manager is automatically created for each <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application and is invisible to the application developer.","pos":[5631,5820],"source":"  A time manager is automatically created for each [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application and is invisible to the application developer."},{"content":"The time manager \"ticks\" many times per second; the actual number of ticks that occur each second varies depending on available system resources.","pos":[5821,5966]},{"content":"During each one of these ticks, the time manager computes the state of all <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ClockState.Active&gt;</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects in the timing tree.","pos":[5967,6169],"source":" During each one of these ticks, the time manager computes the state of all <xref:System.Windows.Media.Animation.ClockState.Active> <xref:System.Windows.Media.Animation.Clock> objects in the timing tree."},{"pos":[6176,6346],"content":"The following illustration shows the relationship between the time manager, and <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>, and an animated dependency property.","source":"The following illustration shows the relationship between the time manager, and <xref:System.Windows.Media.Animation.AnimationClock>, and an animated dependency property."},{"content":"<bpt id=\"p1\">![</bpt>Timing system components<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/graphicsmm-clocks-1clock1prop.png \"</bpt>graphicsmm_clocks_1clock1prop<ept id=\"p2\">\")</ept>","pos":[6353,6455],"source":"![Timing system components](./media/graphicsmm-clocks-1clock1prop.png \"graphicsmm_clocks_1clock1prop\")"},{"content":"Animating a property","pos":[6458,6478]},{"content":"When the time manager ticks, it updates the time of every <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ClockState.Active&gt;</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> in the application.","pos":[6485,6662],"source":"When the time manager ticks, it updates the time of every <xref:System.Windows.Media.Animation.ClockState.Active> <xref:System.Windows.Media.Animation.Clock> in the application."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> is an <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>, it uses the <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A&gt;</ph> method of the <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> from which it was created to calculate its current output value.","pos":[6663,6995],"source":" If the <xref:System.Windows.Media.Animation.Clock> is an <xref:System.Windows.Media.Animation.AnimationClock>, it uses the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method of the <xref:System.Windows.Media.Animation.AnimationTimeline> from which it was created to calculate its current output value."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> supplies the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> with the current local time, an input value, which is typically the base value of the property, and a default destination value.","pos":[6996,7250],"source":" The <xref:System.Windows.Media.Animation.AnimationClock> supplies the <xref:System.Windows.Media.Animation.AnimationTimeline> with the current local time, an input value, which is typically the base value of the property, and a default destination value."},{"content":"When you retrieve the value of an animated by property using the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject.GetValue%2A&gt;</ph> method or its CLR accessor, you get the output of its <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>.","pos":[7251,7474],"source":" When you retrieve the value of an animated by property using the <xref:System.Windows.DependencyObject.GetValue%2A> method or its CLR accessor, you get the output of its <xref:System.Windows.Media.Animation.AnimationClock>."},{"pos":[7485,7497],"content":"Clock Groups","linkify":"Clock Groups","nodes":[{"content":"Clock Groups","pos":[0,12]}]},{"content":"The preceding section described how there are different types of <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects for different types of timelines.","pos":[7501,7651],"source":"The preceding section described how there are different types of <xref:System.Windows.Media.Animation.Clock> objects for different types of timelines."},{"content":"The following illustration shows the relationship between the time manager, a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ClockGroup&gt;</ph>, an <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>, and an animated dependency property.","pos":[7652,7873],"source":" The following illustration shows the relationship between the time manager, a <xref:System.Windows.Media.Animation.ClockGroup>, an <xref:System.Windows.Media.Animation.AnimationClock>, and an animated dependency property."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ClockGroup&gt;</ph> is created for timelines that group other timelines, such as the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Storyboard&gt;</ph> class, which groups animations and other timelines.","pos":[7874,8090],"source":" A <xref:System.Windows.Media.Animation.ClockGroup> is created for timelines that group other timelines, such as the <xref:System.Windows.Media.Animation.Storyboard> class, which groups animations and other timelines."},{"content":"<bpt id=\"p1\">![</bpt>Timing system components<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/graphicsmm-clocks-2clock1clockgroup2prop.png \"</bpt>graphicsmm_clocks_2clock1clockgroup2prop<ept id=\"p2\">\")</ept>","pos":[8097,8221],"source":"![Timing system components](./media/graphicsmm-clocks-2clock1clockgroup2prop.png \"graphicsmm_clocks_2clock1clockgroup2prop\")"},{"content":"A ClockGroup","pos":[8224,8236]},{"pos":[8247,8258],"content":"Composition","linkify":"Composition","nodes":[{"content":"Composition","pos":[0,11]}]},{"content":"It's possible to associate multiple clocks with a single property, in which case each clock uses the output value of the preceding clock as its base value.","pos":[8262,8417]},{"content":"The following illustration shows three <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> objects applied to the same property.","pos":[8418,8547],"source":" The following illustration shows three <xref:System.Windows.Media.Animation.AnimationClock> objects applied to the same property."},{"content":"Clock1 uses the base value of the animated property as its input and uses it to generate output.","pos":[8548,8644]},{"content":"Clock2 takes the output from Clock1 as its input and uses it to generate output.","pos":[8645,8725]},{"content":"Clock3 takes the output from Clock2 as its input and uses it to generate output.","pos":[8726,8806]},{"content":"When multiple clocks affect the same property simultaneously, they are said to be in a composition chain.","pos":[8807,8912]},{"content":"<bpt id=\"p1\">![</bpt>Timing system components<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/graphicsmm-clocks-2clock1prop.png \"</bpt>graphicsmm_clocks_2clock1prop<ept id=\"p2\">\")</ept>","pos":[8919,9021],"source":"![Timing system components](./media/graphicsmm-clocks-2clock1prop.png \"graphicsmm_clocks_2clock1prop\")"},{"content":"A composition chain","pos":[9024,9043]},{"pos":[9050,9481],"content":"Note that although a relationship is created among the input and output of the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> objects in the composition chain, their timing behaviors are not affected; <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects (including <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> objects) have a hierarchical dependency on their parent <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects.","source":"Note that although a relationship is created among the input and output of the <xref:System.Windows.Media.Animation.AnimationClock> objects in the composition chain, their timing behaviors are not affected; <xref:System.Windows.Media.Animation.Clock> objects (including <xref:System.Windows.Media.Animation.AnimationClock> objects) have a hierarchical dependency on their parent <xref:System.Windows.Media.Animation.Clock> objects."},{"pos":[9488,9792],"content":"To apply multiple clocks to the same property, use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.HandoffBehavior.Compose&gt;</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.HandoffBehavior&gt;</ph> when applying a <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.Storyboard&gt;</ph>, animation, or <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>.","source":"To apply multiple clocks to the same property, use the <xref:System.Windows.Media.Animation.HandoffBehavior.Compose> <xref:System.Windows.Media.Animation.HandoffBehavior> when applying a <xref:System.Windows.Media.Animation.Storyboard>, animation, or <xref:System.Windows.Media.Animation.AnimationClock>."},{"pos":[9803,9832],"content":"Ticks and Event Consolidation","linkify":"Ticks and Event Consolidation","nodes":[{"content":"Ticks and Event Consolidation","pos":[0,29]}]},{"content":"In addition to calculating output values, the time manager does other work every time it ticks: it determines the state of each clock and raises events as appropriate.","pos":[9836,10003]},{"content":"While ticks occur frequently, it's possible for a lot of things to happen between ticks.","pos":[10010,10098]},{"content":"For example, a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> might be stopped, started, and stopped again, in which case its <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentState%2A&gt;</ph> value will have changed three times.","pos":[10099,10318],"source":" For example, a <xref:System.Windows.Media.Animation.Clock> might be stopped, started, and stopped again, in which case its <xref:System.Windows.Media.Animation.Clock.CurrentState%2A> value will have changed three times."},{"content":"In theory, the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated&gt;</ph> event could be raised multiple times in a single tick; however, the timing engine consolidates events, so that the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated&gt;</ph> event can be raised at most once per tick.","pos":[10319,10627],"source":" In theory, the <xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated> event could be raised multiple times in a single tick; however, the timing engine consolidates events, so that the <xref:System.Windows.Media.Animation.Clock.CurrentStateInvalidated> event can be raised at most once per tick."},{"content":"This is true for all timing events: at most one event of each type is raised for a given <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> object.","pos":[10628,10768],"source":" This is true for all timing events: at most one event of each type is raised for a given <xref:System.Windows.Media.Animation.Clock> object."},{"pos":[10775,11138],"content":"When a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> switches states and returns back to its original state between ticks (such as changing from <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.ClockState.Active&gt;</ph> to <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.ClockState.Stopped&gt;</ph> and back to <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.ClockState.Active&gt;</ph>), the associated event still occurs.","source":"When a <xref:System.Windows.Media.Animation.Clock> switches states and returns back to its original state between ticks (such as changing from <xref:System.Windows.Media.Animation.ClockState.Active> to <xref:System.Windows.Media.Animation.ClockState.Stopped> and back to <xref:System.Windows.Media.Animation.ClockState.Active>), the associated event still occurs."},{"pos":[11145,11247],"content":"For more information about timing events, see the <bpt id=\"p1\">[</bpt>Timing Events Overview<ept id=\"p1\">](timing-events-overview.md)</ept>.","source":"For more information about timing events, see the [Timing Events Overview](timing-events-overview.md)."},{"pos":[11310,11354],"content":"Current Values and Base Values of Properties","linkify":"Current Values and Base Values of Properties","nodes":[{"content":"Current Values and Base Values of Properties","pos":[0,44]}]},{"content":"An animatable property can have two values: a base value and a current value.","pos":[11358,11435]},{"content":"When you set property using its CLR accessor or the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject.SetValue%2A&gt;</ph> method, you set its base value.","pos":[11436,11570],"source":" When you set property using its CLR accessor or the <xref:System.Windows.DependencyObject.SetValue%2A> method, you set its base value."},{"content":"When a property is not animated, its base and current values are the same.","pos":[11571,11645]},{"content":"When you animate a property, the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> sets the property's <bpt id=\"p1\">*</bpt>current<ept id=\"p1\">*</ept> value.","pos":[11652,11774],"source":"When you animate a property, the <xref:System.Windows.Media.Animation.AnimationClock> sets the property's *current* value."},{"content":"Retrieving the property's value through its CLR accessor or the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject.GetValue%2A&gt;</ph> method returns the output of the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> when the <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> is <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.ClockState.Active&gt;</ph> or <ph id=\"ph5\">&lt;xref:System.Windows.Media.Animation.ClockState.Filling&gt;</ph>.","pos":[11775,12157],"source":" Retrieving the property's value through its CLR accessor or the <xref:System.Windows.DependencyObject.GetValue%2A> method returns the output of the <xref:System.Windows.Media.Animation.AnimationClock> when the <xref:System.Windows.Media.Animation.AnimationClock> is <xref:System.Windows.Media.Animation.ClockState.Active> or <xref:System.Windows.Media.Animation.ClockState.Filling>."},{"content":"You can retrieve the property's base value by using the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.IAnimatable.GetAnimationBaseValue%2A&gt;</ph> method.","pos":[12158,12296],"source":" You can retrieve the property's base value by using the <xref:System.Windows.Media.Animation.IAnimatable.GetAnimationBaseValue%2A> method."},{"pos":[12305,12313],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12317,12360],"content":"<bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept>","source":"[Animation Overview](animation-overview.md)"},{"pos":[12363,12414],"content":"<bpt id=\"p1\">[</bpt>Timing Events Overview<ept id=\"p1\">](timing-events-overview.md)</ept>","source":"[Timing Events Overview](timing-events-overview.md)"},{"pos":[12417,12474],"content":"<bpt id=\"p1\">[</bpt>Timing Behaviors Overview<ept id=\"p1\">](timing-behaviors-overview.md)</ept>","source":"[Timing Behaviors Overview](timing-behaviors-overview.md)"}]}