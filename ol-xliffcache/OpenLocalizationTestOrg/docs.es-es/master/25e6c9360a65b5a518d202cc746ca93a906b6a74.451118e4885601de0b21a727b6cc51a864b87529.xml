{"content":"---\ntitle: \"How to: Control Ordering in a PLINQ Query | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"PLINQ queries, how to control ordering\"\nms.assetid: c67eccc7-004d-4b2f-987e-919cbbd62ef7\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Control Ordering in a PLINQ Query\nThese examples show how to control the ordering in a PLINQ query by using the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> extension method.  \n  \n> [!WARNING]\n>  These examples are primarily intended to demonstrate usage, and may or may not run faster than the equivalent sequential LINQ to Objects queries.  \n  \n## Example  \n The following example preserves the ordering of the source sequence. This is sometimes necessary; for example some query operators require an ordered source sequence to produce correct results.  \n  \n [!code-csharp[PLINQ#12](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#12)]\n [!code-vb[PLINQ#12](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#12)]  \n  \n## Example  \n The following example shows some query operators whose source sequence is probably expected to be ordered. These operators will work on unordered sequences, but they might produce unexpected results.  \n  \n [!code-csharp[PLINQ#14](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#14)]\n [!code-vb[PLINQ#14](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#14)]  \n  \n To run this method, paste it into the PLINQDataSample class in the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) project and press F5.  \n  \n## Example  \n The following example shows how to preserve ordering for the first part of a query, then remove the ordering to increase the performance of a join clause, and then reapply ordering to the final result sequence.  \n  \n [!code-csharp[PLINQ#15](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#15)]\n [!code-vb[PLINQ#15](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#15)]  \n  \n To run this method, paste it into the PLINQDataSample class in the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) project and press F5.  \n  \n## See Also  \n <xref:System.Linq.ParallelEnumerable>   \n [Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)","nodes":[{"pos":[12,70],"content":"How to: Control Ordering in a PLINQ Query | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Control Ordering in a PLINQ Query | Microsoft Docs","pos":[0,58]}]},{"pos":[429,470],"content":"How to: Control Ordering in a PLINQ Query","linkify":"How to: Control Ordering in a PLINQ Query","nodes":[{"content":"How to: Control Ordering in a PLINQ Query","pos":[0,41]}]},{"content":"These examples show how to control the ordering in a PLINQ query by using the <ph id=\"ph1\">&lt;xref:System.Linq.ParallelEnumerable.AsOrdered%2A&gt;</ph> extension method.","pos":[471,617],"source":"These examples show how to control the ordering in a PLINQ query by using the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> extension method."},{"pos":[625,784],"content":"[!WARNING]\n These examples are primarily intended to demonstrate usage, and may or may not run faster than the equivalent sequential LINQ to Objects queries.","leadings":["","> "],"nodes":[{"content":"These examples are primarily intended to demonstrate usage, and may or may not run faster than the equivalent sequential LINQ to Objects queries.","pos":[12,157]}]},{"pos":[793,800],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example preserves the ordering of the source sequence.","pos":[804,872]},{"content":"This is sometimes necessary; for example some query operators require an ordered source sequence to produce correct results.","pos":[873,997]},{"pos":[1004,1215],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PLINQ#12<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#12)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>PLINQ#12<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#12)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[PLINQ#12](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#12)]\n [!code-vb[PLINQ#12](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#12)]"},{"pos":[1224,1231],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows some query operators whose source sequence is probably expected to be ordered.","pos":[1235,1341]},{"content":"These operators will work on unordered sequences, but they might produce unexpected results.","pos":[1342,1434]},{"pos":[1441,1652],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PLINQ#14<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#14)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>PLINQ#14<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#14)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[PLINQ#14](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#14)]\n [!code-vb[PLINQ#14](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#14)]"},{"pos":[1659,1833],"content":"To run this method, paste it into the PLINQDataSample class in the <bpt id=\"p1\">[</bpt>PLINQ Data Sample<ept id=\"p1\">](../../../docs/standard/parallel-programming/plinq-data-sample.md)</ept> project and press F5.","source":"To run this method, paste it into the PLINQDataSample class in the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) project and press F5."},{"pos":[1842,1849],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows how to preserve ordering for the first part of a query, then remove the ordering to increase the performance of a join clause, and then reapply ordering to the final result sequence.","pos":[1853,2063]},{"pos":[2070,2281],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>PLINQ#15<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#15)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>PLINQ#15<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#15)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[PLINQ#15](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#15)]\n [!code-vb[PLINQ#15](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinqsnippets1.vb#15)]"},{"pos":[2288,2462],"content":"To run this method, paste it into the PLINQDataSample class in the <bpt id=\"p1\">[</bpt>PLINQ Data Sample<ept id=\"p1\">](../../../docs/standard/parallel-programming/plinq-data-sample.md)</ept> project and press F5.","source":"To run this method, paste it into the PLINQDataSample class in the [PLINQ Data Sample](../../../docs/standard/parallel-programming/plinq-data-sample.md) project and press F5."},{"pos":[2471,2479],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Linq.ParallelEnumerable&gt;</ph>","pos":[2483,2520],"source":"<xref:System.Linq.ParallelEnumerable> "},{"content":"<bpt id=\"p1\"> [</bpt>Parallel LINQ (PLINQ)<ept id=\"p1\">](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)</ept>","pos":[2524,2616],"source":" [Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)"}]}