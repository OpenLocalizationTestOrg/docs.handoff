{"content":"---\ntitle: \"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hosting Windows Forms control in WPF\"\nms.assetid: 1aef42cb-4cfb-44b4-9a7a-c02632d3d9c7\ncaps.latest.revision: 34\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML\n[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set. However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages. For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality.  \n  \n This walkthrough shows you how to host a Windows Forms <xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].  \n  \n For a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF by Using XAML Sample](http://go.microsoft.com/fwlink/?LinkID=160000).  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n## Hosting the Windows Forms Control  \n  \n#### To host the MaskedTextBox control  \n  \n1.  Create a WPF Application project named `HostingWfInWpfWithXaml`.  \n  \n2.  Add references to the following assemblies.  \n  \n    -   WindowsFormsIntegration  \n  \n    -   System.Windows.Forms  \n  \n3.  Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n4.  In the <xref:System.Windows.Window> element, add the following namespace mapping. The `wf` namespace mapping establishes a reference to the assembly that contains the [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] control.  \n  \n    ```xaml  \n    xmlns:wf=\"clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms\"  \n    ```  \n  \n5.  In the <xref:System.Windows.Controls.Grid> element add the following XAML.  \n  \n     The <xref:System.Windows.Forms.MaskedTextBox> control is created as a child of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control.  \n  \n     [!code-xml[HostingWfInWpfWithXaml#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWpfWithXaml/CSharp/HostingWfInWpf/Window1.xaml#3)]  \n  \n6.  Press F5 to build and run the application.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)   \n [Walkthrough: Hosting a Windows Forms Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md)   \n [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)   \n [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)   \n [Windows Forms Controls and Equivalent WPF Controls](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md)   \n [Hosting a Windows Forms Control in WPF by Using XAML Sample](http://go.microsoft.com/fwlink/?LinkID=160000)","nodes":[{"pos":[12,94],"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML | Microsoft Docs","pos":[0,82]}]},{"pos":[467,532],"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","linkify":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","pos":[0,65]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides many controls with a rich feature set.","pos":[533,662],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set."},{"content":"However, you may sometimes want to use <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls on your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> pages.","pos":[663,885],"source":" However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages."},{"content":"For example, you may have a substantial investment in existing <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls, or you may have a <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control that provides unique functionality.","pos":[886,1176],"source":" For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality."},{"pos":[1183,1486],"content":"This walkthrough shows you how to host a Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName&gt;</ph> control on a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page by using <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>.","source":"This walkthrough shows you how to host a Windows Forms <xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]."},{"pos":[1493,1674],"content":"For a complete code listing of the tasks shown in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF by Using XAML Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160000)</ept>.","source":"For a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF by Using XAML Sample](http://go.microsoft.com/fwlink/?LinkID=160000)."},{"pos":[1683,1696],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1700,1763]},{"pos":[1773,1841],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]."},{"pos":[1850,1883],"content":"Hosting the Windows Forms Control","linkify":"Hosting the Windows Forms Control","nodes":[{"content":"Hosting the Windows Forms Control","pos":[0,33]}]},{"pos":[1894,1927],"content":"To host the MaskedTextBox control","linkify":"To host the MaskedTextBox control","nodes":[{"content":"To host the MaskedTextBox control","pos":[0,33]}]},{"pos":[1937,2001],"content":"Create a WPF Application project named <ph id=\"ph1\">`HostingWfInWpfWithXaml`</ph>.","source":"Create a WPF Application project named `HostingWfInWpfWithXaml`."},{"content":"Add references to the following assemblies.","pos":[2011,2054]},{"content":"WindowsFormsIntegration","pos":[2068,2091]},{"content":"System.Windows.Forms","pos":[2105,2125]},{"pos":[2135,2255],"content":"Open MainWindow.xaml in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element, add the following namespace mapping.","pos":[2265,2346],"source":"In the <xref:System.Windows.Window> element, add the following namespace mapping."},{"content":"The <ph id=\"ph1\">`wf`</ph> namespace mapping establishes a reference to the assembly that contains the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)]</ph> control.","pos":[2347,2520],"source":" The `wf` namespace mapping establishes a reference to the assembly that contains the [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] control."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element add the following XAML.","pos":[2639,2713],"source":"In the <xref:System.Windows.Controls.Grid> element add the following XAML."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control is created as a child of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control.","pos":[2724,2872],"source":"The <xref:System.Windows.Forms.MaskedTextBox> control is created as a child of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control."},{"pos":[2883,3033],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>HostingWfInWpfWithXaml#3<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWpfWithXaml/CSharp/HostingWfInWpf/Window1.xaml#3)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[HostingWfInWpfWithXaml#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWpfWithXaml/CSharp/HostingWfInWpf/Window1.xaml#3)]"},{"content":"Press F5 to build and run the application.","pos":[3043,3085]},{"pos":[3094,3102],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph>","pos":[3106,3157],"source":"<xref:System.Windows.Forms.Integration.ElementHost> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph>","pos":[3162,3218],"source":" <xref:System.Windows.Forms.Integration.WindowsFormsHost> "},{"content":"<bpt id=\"p1\"> [</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept><ph id=\"ph1\"> </ph>","pos":[3222,3308],"source":" [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Hosting a Windows Forms Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[3311,3461],"source":" [Walkthrough: Hosting a Windows Forms Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[3464,3634],"source":" [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[3637,3807],"source":" [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Windows Forms Controls and Equivalent WPF Controls<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md)</ept><ph id=\"ph1\"> </ph>","pos":[3810,3959],"source":" [Windows Forms Controls and Equivalent WPF Controls](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hosting a Windows Forms Control in WPF by Using XAML Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160000)</ept>","pos":[3962,4071],"source":" [Hosting a Windows Forms Control in WPF by Using XAML Sample](http://go.microsoft.com/fwlink/?LinkID=160000)"}]}