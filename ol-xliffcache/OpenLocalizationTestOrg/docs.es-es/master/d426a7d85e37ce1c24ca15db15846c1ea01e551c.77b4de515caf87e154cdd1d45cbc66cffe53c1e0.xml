{"content":"---\ntitle: \"Message Security with a Windows Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 01e7d0b8-10f9-45c3-a4c5-53d44dc61eb8\ncaps.latest.revision: 13\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# Message Security with a Windows Client\nThis scenario shows a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] client and server secured by message security mode. The client and service are authenticated using Windows credentials.  \n  \n ![Message security with a Windows client](../../../../docs/framework/wcf/feature-details/media/1c8618d4-0005-4022-beb6-32fd087a8c3c.gif \"1c8618d4-0005-4022-beb6-32fd087a8c3c\")  \n  \n|Characteristic|Description|  \n|--------------------|-----------------|  \n|Security Mode|Message|  \n|Interoperability|[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Only|  \n|Authentication (Server)|Mutual authentication of the server and client|  \n|Authentication (Client)|Mutual authentication of the server and client|  \n|Integrity|Yes, using shared security context|  \n|Confidentiality|Yes, using shared security context|  \n|Transport|NET.TCP|  \n|Binding|<xref:System.ServiceModel.NetTcpBinding>|  \n  \n## Service  \n The following code and configuration are meant to run independently. Do one of the following:  \n  \n-   Create a stand-alone service using the code with no configuration.  \n  \n-   Create a service using the supplied configuration, but do not define any endpoints.  \n  \n### Code  \n The following code shows how to create a service endpoint that uses message security to establish a secure context with a Windows machine.  \n  \n [!code-csharp[C_SecurityScenarios#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#11)]\n [!code-vb[C_SecurityScenarios#11](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#11)]  \n  \n### Configuration  \n The following configuration can be used instead of the code to set up the service:  \n  \n```  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<configuration>  \n  <system.serviceModel>  \n    <services>  \n      <service behaviorConfiguration=\"\"  \n               name=\"ServiceModel.Calculator\">  \n        <endpoint address=\"net.tcp://localhost:8008/Calculator\"  \n                  binding=\"netTcpBinding\"  \n                  bindingConfiguration=\"Windows\"  \n                  name=\"WindowsOverMessage\"  \n                  contract=\"ServiceModel.ICalculator\" />  \n      </service>  \n    </services>  \n    <bindings>  \n      <netTcpBinding>  \n        <binding name=\"Windows\">  \n          <security mode=\"Message\">  \n            <message clientCredentialType=\"Windows\" />  \n          </security>  \n        </binding>  \n      </netTcpBinding>  \n    </bindings>  \n    <client />  \n  </system.serviceModel>  \n</configuration>  \n```  \n  \n## Client  \n The following code and configuration are meant to run independently. Do one of the following:  \n  \n-   Create a stand-alone client using the code (and client code).  \n  \n-   Create a client that does not define any endpoint addresses. Instead, use the client constructor that takes the configuration name as an argument. For example:  \n  \n     [!code-csharp[C_SecurityScenarios#0](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#0)]\n     [!code-vb[C_SecurityScenarios#0](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#0)]  \n  \n### Code  \n The following code creates a client. The binding is to Message mode security, and the client credential type is set to `Windows`.  \n  \n [!code-csharp[C_SecurityScenarios#18](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#18)]\n [!code-vb[C_SecurityScenarios#18](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#18)]  \n  \n### Configuration  \n The following configuration is used to set the client properties.  \n  \n```  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<configuration>  \n  <system.serviceModel>  \n    <bindings>  \n      <netTcpBinding>  \n        <binding name=\"NetTcpBinding_ICalculator\" >  \n         <security mode=\"Message\">  \n            <message clientCredentialType=\"Windows\" />  \n          </security>  \n        </binding>  \n      </netTcpBinding>  \n    </bindings>  \n    <client>  \n      <endpoint address=\"net.tcp://machineName:8008/Calculator\"   \n                binding=\"netTcpBinding\"  \n                bindingConfiguration=\"NetTcpBinding_ICalculator\"  \n                contract=\"ICalculator\"  \n                name=\"NetTcpBinding_ICalculator\">          \n      </endpoint>  \n    </client>  \n  </system.serviceModel>  \n</configuration>  \n```  \n  \n## See Also  \n [Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md)   \n [Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)","nodes":[{"pos":[4,370],"nodes":[{"content":"Message Security with a Windows Client | Microsoft Docs","nodes":[{"pos":[0,55],"content":"Message Security with a Windows Client | Microsoft Docs","nodes":[{"content":"Message Security with a Windows Client | Microsoft Docs","pos":[0,55]}]}],"pos":[6,64],"yaml":true}],"content":"title: \"Message Security with a Windows Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 01e7d0b8-10f9-45c3-a4c5-53d44dc61eb8\ncaps.latest.revision: 13\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"","yamlblock":true},{"pos":[377,415],"content":"Message Security with a Windows Client","linkify":"Message Security with a Windows Client","nodes":[{"content":"Message Security with a Windows Client","pos":[0,38]}]},{"content":"This scenario shows a <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> client and server secured by message security mode.","pos":[416,545],"source":"This scenario shows a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] client and server secured by message security mode."},{"content":"The client and service are authenticated using Windows credentials.","pos":[546,613]},{"pos":[620,795],"content":"<bpt id=\"p1\">![</bpt>Message security with a Windows client<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/feature-details/media/1c8618d4-0005-4022-beb6-32fd087a8c3c.gif \"</bpt>1c8618d4-0005-4022-beb6-32fd087a8c3c<ept id=\"p2\">\")</ept>","source":"![Message security with a Windows client](../../../../docs/framework/wcf/feature-details/media/1c8618d4-0005-4022-beb6-32fd087a8c3c.gif \"1c8618d4-0005-4022-beb6-32fd087a8c3c\")"},{"content":"Characteristic","pos":[802,816]},{"content":"Description","pos":[817,828]},{"content":"Security Mode","pos":[876,889]},{"content":"Message","pos":[890,897]},{"content":"Interoperability","pos":[902,918]},{"pos":[919,979],"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> Only","source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Only"},{"content":"Authentication (Server)","pos":[984,1007]},{"content":"Mutual authentication of the server and client","pos":[1008,1054]},{"content":"Authentication (Client)","pos":[1059,1082]},{"content":"Mutual authentication of the server and client","pos":[1083,1129]},{"content":"Integrity","pos":[1134,1143]},{"content":"Yes, using shared security context","pos":[1144,1178]},{"content":"Confidentiality","pos":[1183,1198]},{"content":"Yes, using shared security context","pos":[1199,1233]},{"content":"Transport","pos":[1238,1247]},{"content":"NET.TCP","pos":[1248,1255]},{"content":"Binding","pos":[1260,1267]},{"pos":[1318,1325],"content":"Service","linkify":"Service","nodes":[{"content":"Service","pos":[0,7]}]},{"content":"The following code and configuration are meant to run independently.","pos":[1329,1397]},{"content":"Do one of the following:","pos":[1398,1422]},{"content":"Create a stand-alone service using the code with no configuration.","pos":[1432,1498]},{"content":"Create a service using the supplied configuration, but do not define any endpoints.","pos":[1508,1591]},{"pos":[1601,1605],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"content":"The following code shows how to create a service endpoint that uses message security to establish a secure context with a Windows machine.","pos":[1609,1747]},{"pos":[1754,2011],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#11<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#11)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_SecurityScenarios#11<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#11)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[C_SecurityScenarios#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#11)]\n [!code-vb[C_SecurityScenarios#11](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#11)]"},{"pos":[2021,2034],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"content":"The following configuration can be used instead of the code to set up the service:","pos":[2038,2120]},{"pos":[2962,2968],"content":"Client","linkify":"Client","nodes":[{"content":"Client","pos":[0,6]}]},{"content":"The following code and configuration are meant to run independently.","pos":[2972,3040]},{"content":"Do one of the following:","pos":[3041,3065]},{"content":"Create a stand-alone client using the code (and client code).","pos":[3075,3136]},{"content":"Create a client that does not define any endpoint addresses.","pos":[3146,3206]},{"content":"Instead, use the client constructor that takes the configuration name as an argument.","pos":[3207,3292]},{"content":"For example:","pos":[3293,3305]},{"pos":[3316,3573],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#0<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#0)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_SecurityScenarios#0<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#0)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[C_SecurityScenarios#0](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#0)]\n [!code-vb[C_SecurityScenarios#0](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#0)]"},{"pos":[3583,3587],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"content":"The following code creates a client.","pos":[3591,3627]},{"content":"The binding is to Message mode security, and the client credential type is set to <ph id=\"ph1\">`Windows`</ph>.","pos":[3628,3720],"source":" The binding is to Message mode security, and the client credential type is set to `Windows`."},{"pos":[3727,3984],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#18<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#18)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>C_SecurityScenarios#18<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#18)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[C_SecurityScenarios#18](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#18)]\n [!code-vb[C_SecurityScenarios#18](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#18)]"},{"pos":[3994,4007],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"content":"The following configuration is used to set the client properties.","pos":[4011,4076]},{"pos":[4836,4844],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Security Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[4848,4937],"source":"[Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Security Model for Windows Server App Fabric<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=201279&amp;clcid=0x409)</ept>","pos":[4941,5046],"source":"[Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)"}]}