{"content":"---\ntitle: \"UI Automation Security Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, security model\"\n  - \"security model, UI Automation\"\nms.assetid: 1d853695-973c-48ae-b382-4132ae702805\n---\n# UI Automation Security Overview\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This overview describes the security model for [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] in [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)].  \n  \n<a name=\"User_Account_Control\"></a>   \n## User Account Control  \n Security is a major focus of [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] and among the innovations is the ability for users to run as standard (non-administrator) users without necessarily being blocked from running applications and services that require higher privileges.  \n  \n In [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)], most applications are supplied with either a standard or an administrative token. If an application cannot be identified as an administrative application, it is launched as a standard application by default. Before an application identified as administrative can be launched, [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)] prompts the user for consent to run the application as elevated. The consent prompt is displayed by default, even if the user is a member of the local Administrators group, because administrators run as standard users until an application or system component that requires administrative credentials requests permission to run.  \n  \n<a name=\"Tasks_Requiring_Higher_Privileges\"></a>   \n## Tasks Requiring Higher Privileges  \n When a user attempts to perform a task that requires administrative privileges, [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)] presents a dialog box asking the user for consent to continue. This dialog box is protected from cross-process communication, so that malicious software cannot simulate user input. Similarly, the desktop logon screen cannot normally be accessed by other processes.  \n  \n UI Automation clients must communicate with other processes, some of them perhaps running at a higher privilege level. Clients also might need access to the system dialog boxes that are not normally visible to other processes. Therefore, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] clients must be trusted by the system, and must run with special privileges.  \n  \n To be trusted to communicate with applications running at a higher privilege level, applications must be signed.  \n  \n<a name=\"Manifest_Files\"></a>   \n## Manifest Files  \n To gain access to the protected system [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], applications must be built with a manifest file that includes a special attribute in the manifest file. This `uiAccess` attribute is included in the `requestedExecutionLevel` tag, as follows:  \n  \n `<trustInfo xmlns=\"urn:0073chemas-microsoft-com:asm.v3\">`  \n  \n `<security>`  \n  \n `<requestedPrivileges>`  \n  \n `<requestedExecutionLevel`  \n  \n `level=\"highestAvailable\"`  \n  \n `UIAccess=\"true\" />`  \n  \n `</requestedPrivileges>`  \n  \n `</security>`  \n  \n `</trustInfo>`  \n  \n The value of the `level` attribute in this code is an example only.  \n  \n `UIAccess` is \"false\" by default; that is, if the attribute is omitted, or if there is no manifest for the assembly, the application will not be able to gain access to protected [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].  \n  \n For more information on [!INCLUDE[TLA#tla_longhorn2](../../../includes/tlasharptla-longhorn2-md.md)] security, on signing applications, and on creating assembly manifests, see [Developer Best Practices and Guidelines for Applications in a Least Privileged Environment](https://docs.microsoft.com/previous-versions/dotnet/articles/aa480150(v=msdn.10)).\n","nodes":[{"pos":[4,209],"embed":true,"restype":"x-metadata","content":"title: \"UI Automation Security Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, security model\"\n  - \"security model, UI Automation\"\nms.assetid: 1d853695-973c-48ae-b382-4132ae702805","nodes":[{"content":"UI Automation Security Overview","nodes":[{"pos":[0,31],"content":"UI Automation Security Overview","nodes":[{"content":"UI Automation Security Overview","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[216,247],"content":"UI Automation Security Overview","linkify":"UI Automation Security Overview","nodes":[{"content":"UI Automation Security Overview","pos":[0,31]}]},{"pos":[250,713],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[720,928],"content":"This overview describes the security model for <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> in <ph id=\"ph2\">[!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)]</ph>.","source":"This overview describes the security model for [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] in [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)]."},{"pos":[976,996],"content":"User Account Control","linkify":"User Account Control","nodes":[{"content":"User Account Control","pos":[0,20]}]},{"pos":[1000,1304],"content":"Security is a major focus of <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)]</ph> and among the innovations is the ability for users to run as standard (non-administrator) users without necessarily being blocked from running applications and services that require higher privileges.","source":"Security is a major focus of [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] and among the innovations is the ability for users to run as standard (non-administrator) users without necessarily being blocked from running applications and services that require higher privileges."},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)]</ph>, most applications are supplied with either a standard or an administrative token.","pos":[1311,1473],"source":"In [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)], most applications are supplied with either a standard or an administrative token."},{"content":"If an application cannot be identified as an administrative application, it is launched as a standard application by default.","pos":[1474,1599]},{"content":"Before an application identified as administrative can be launched, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)]</ph> prompts the user for consent to run the application as elevated.","pos":[1600,1809],"source":" Before an application identified as administrative can be launched, [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)] prompts the user for consent to run the application as elevated."},{"content":"The consent prompt is displayed by default, even if the user is a member of the local Administrators group, because administrators run as standard users until an application or system component that requires administrative credentials requests permission to run.","pos":[1810,2072]},{"pos":[2133,2166],"content":"Tasks Requiring Higher Privileges","linkify":"Tasks Requiring Higher Privileges","nodes":[{"content":"Tasks Requiring Higher Privileges","pos":[0,33]}]},{"content":"When a user attempts to perform a task that requires administrative privileges, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)]</ph> presents a dialog box asking the user for consent to continue.","pos":[2170,2389],"source":"When a user attempts to perform a task that requires administrative privileges, [!INCLUDE[TLA2#tla_winvista](../../../includes/tla2sharptla-winvista-md.md)] presents a dialog box asking the user for consent to continue."},{"content":"This dialog box is protected from cross-process communication, so that malicious software cannot simulate user input.","pos":[2390,2507]},{"content":"Similarly, the desktop logon screen cannot normally be accessed by other processes.","pos":[2508,2591]},{"content":"UI Automation clients must communicate with other processes, some of them perhaps running at a higher privilege level.","pos":[2598,2716]},{"content":"Clients also might need access to the system dialog boxes that are not normally visible to other processes.","pos":[2717,2824]},{"content":"Therefore, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> clients must be trusted by the system, and must run with special privileges.","pos":[2825,2997],"source":" Therefore, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] clients must be trusted by the system, and must run with special privileges."},{"content":"To be trusted to communicate with applications running at a higher privilege level, applications must be signed.","pos":[3004,3116]},{"pos":[3158,3172],"content":"Manifest Files","linkify":"Manifest Files","nodes":[{"content":"Manifest Files","pos":[0,14]}]},{"content":"To gain access to the protected system <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph>, applications must be built with a manifest file that includes a special attribute in the manifest file.","pos":[3176,3384],"source":"To gain access to the protected system [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], applications must be built with a manifest file that includes a special attribute in the manifest file."},{"content":"This <ph id=\"ph1\">`uiAccess`</ph> attribute is included in the <ph id=\"ph2\">`requestedExecutionLevel`</ph> tag, as follows:","pos":[3385,3472],"source":" This `uiAccess` attribute is included in the `requestedExecutionLevel` tag, as follows:"},{"pos":[3757,3824],"content":"The value of the <ph id=\"ph1\">`level`</ph> attribute in this code is an example only.","source":"The value of the `level` attribute in this code is an example only."},{"pos":[3831,4074],"content":"<ph id=\"ph1\">`UIAccess`</ph> is \"false\" by default; that is, if the attribute is omitted, or if there is no manifest for the assembly, the application will not be able to gain access to protected <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph>.","source":"`UIAccess` is \"false\" by default; that is, if the attribute is omitted, or if there is no manifest for the assembly, the application will not be able to gain access to protected [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]."},{"pos":[4081,4432],"content":"For more information on <ph id=\"ph1\">[!INCLUDE[TLA#tla_longhorn2](../../../includes/tlasharptla-longhorn2-md.md)]</ph> security, on signing applications, and on creating assembly manifests, see <bpt id=\"p1\">[</bpt>Developer Best Practices and Guidelines for Applications in a Least Privileged Environment<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/articles/aa480150(v=msdn.10))</ept>.","source":"For more information on [!INCLUDE[TLA#tla_longhorn2](../../../includes/tlasharptla-longhorn2-md.md)] security, on signing applications, and on creating assembly manifests, see [Developer Best Practices and Guidelines for Applications in a Least Privileged Environment](https://docs.microsoft.com/previous-versions/dotnet/articles/aa480150(v=msdn.10))."}]}