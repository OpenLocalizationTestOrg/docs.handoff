{"content":"---\ntitle: \"How to: Map HRESULTs and Exceptions\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"cpp\"\nhelpviewer_keywords: \n  - \"interoperation with unmanaged code, HRESULTs\"\n  - \"exceptions, HRESULTs\"\n  - \"interoperation with unmanaged code, exceptions\"\n  - \"HRESULTs\"\n  - \"COM interop, HRESULTs\"\n  - \"COM interop, exceptions\"\nms.assetid: 610b364b-2761-429d-9c4a-afbc3e66f1b9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Map HRESULTs and Exceptions\nCOM methods report errors by returning HRESULTs; .NET methods report them by throwing exceptions. The runtime handles the transition between the two. Each exception class in the .NET Framework maps to an HRESULT.  \n  \n User-defined exception classes can specify whatever HRESULT is appropriate. These exception classes can dynamically change the HRESULT to be returned when the exception is generated by setting the **HResult** field on the exception object. Additional information about the exception is provided to the client through the **IErrorInfo** interface, which is implemented on the .NET object in the unmanaged process.  \n  \n If you create a class that extends **System.Exception**, you must set the HRESULT field during construction. Otherwise, the base class assigns the HRESULT value. You can map new exception classes to an existing HRESULT by supplying the value in the exception's constructor.  \n  \n Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread.  This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error.  \n  \n### To create a new exception class and map it to an HRESULT  \n  \n1.  Use the following code to create a new exception class called `NoAccessException` and map it to the HRESULT `E_ACCESSDENIED`.  \n  \n    ```cpp  \n    Class NoAccessException : public ApplicationException  \n    {  \n        NoAccessException () {  \n        HResult = E_ACCESSDENIED;   \n    }  \n    }  \n    CMyClass::MethodThatThrows  \n    {  \n    throw new NoAccessException();  \n    }  \n    ```  \n  \n You might encounter a program (in any programming language) that uses both managed and unmanaged code at the same time. For example, the custom marshaler in the following code example uses the **Marshal.ThrowExceptionForHR(int HResult)** method to throw an exception with a specific HRESULT value. The method looks up the HRESULT and generates the appropriate exception type. For example, the HRESULT in the following code fragment generates **ArgumentException**.  \n  \n```cpp  \nCMyClass::MethodThatThrows  \n{  \n    Marshal.ThrowExceptionForHR(COR_E_ARGUMENT);  \n}  \n```  \n  \n The following table provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.  \n  \n|HRESULT|.NET exception|  \n|-------------|--------------------|  \n|**MSEE_E_APPDOMAINUNLOADED**|**AppDomainUnloadedException**|  \n|**COR_E_APPLICATION**|**ApplicationException**|  \n|**COR_E_ARGUMENT or E_INVALIDARG**|**ArgumentException**|  \n|**COR_E_ARGUMENTOUTOFRANGE**|**ArgumentOutOfRangeException**|  \n|**COR_E_ARITHMETIC or ERROR_ARITHMETIC_OVERFLOW**|**ArithmeticException**|  \n|**COR_E_ARRAYTYPEMISMATCH**|**ArrayTypeMismatchException**|  \n|**COR_E_BADIMAGEFORMAT or ERROR_BAD_FORMAT**|**BadImageFormatException**|  \n|**COR_E_COMEMULATE_ERROR**|**COMEmulateException**|  \n|**COR_E_CONTEXTMARSHAL**|**ContextMarshalException**|  \n|**COR_E_CORE**|**CoreException**|  \n|**NTE_FAIL**|**CryptographicException**|  \n|**COR_E_DIRECTORYNOTFOUND or ERROR_PATH_NOT_FOUND**|**DirectoryNotFoundException**|  \n|**COR_E_DIVIDEBYZERO**|**DivideByZeroException**|  \n|**COR_E_DUPLICATEWAITOBJECT**|**DuplicateWaitObjectException**|  \n|**COR_E_ENDOFSTREAM**|**EndOfStreamException**|  \n|**COR_E_TYPELOAD**|**EntryPointNotFoundException**|  \n|**COR_E_EXCEPTION**|**Exception**|  \n|**COR_E_EXECUTIONENGINE**|**ExecutionEngineException**|  \n|**COR_E_FIELDACCESS**|**FieldAccessException**|  \n|**COR_E_FILENOTFOUND or ERROR_FILE_NOT_FOUND**|**FileNotFoundException**|  \n|**COR_E_FORMAT**|**FormatException**|  \n|**COR_E_INDEXOUTOFRANGE**|**IndexOutOfRangeException**|  \n|**COR_E_INVALIDCAST or E_NOINTERFACE**|**InvalidCastException**|  \n|**COR_E_INVALIDCOMOBJECT**|**InvalidComObjectException**|  \n|**COR_E_INVALIDFILTERCRITERIA**|**InvalidFilterCriteriaException**|  \n|**COR_E_INVALIDOLEVARIANTTYPE**|**InvalidOleVariantTypeException**|  \n|**COR_E_INVALIDOPERATION**|**InvalidOperationException**|  \n|**COR_E_IO**|**IOException**|  \n|**COR_E_MEMBERACCESS**|**AccessException**|  \n|**COR_E_METHODACCESS**|**MethodAccessException**|  \n|**COR_E_MISSINGFIELD**|**MissingFieldException**|  \n|**COR_E_MISSINGMANIFESTRESOURCE**|**MissingManifestResourceException**|  \n|**COR_E_MISSINGMEMBER**|**MissingMemberException**|  \n|**COR_E_MISSINGMETHOD**|**MissingMethodException**|  \n|**COR_E_MULTICASTNOTSUPPORTED**|**MulticastNotSupportedException**|  \n|**COR_E_NOTFINITENUMBER**|**NotFiniteNumberException**|  \n|**E_NOTIMPL**|**NotImplementedException**|  \n|**COR_E_NOTSUPPORTED**|**NotSupportedException**|  \n|**COR_E_NULLREFERENCE orE_POINTER**|**NullReferenceException**|  \n|**COR_E_OUTOFMEMORY or**<br /><br /> **E_OUTOFMEMORY**|**OutOfMemoryException**|  \n|**COR_E_OVERFLOW**|**OverflowException**|  \n|**COR_E_PATHTOOLONG or ERROR_FILENAME_EXCED_RANGE**|**PathTooLongException**|  \n|**COR_E_RANK**|**RankException**|  \n|**COR_E_REFLECTIONTYPELOAD**|**ReflectionTypeLoadException**|  \n|**COR_E_REMOTING**|**RemotingException**|  \n|**COR_E_SAFEARRAYTYPEMISMATCH**|**SafeArrayTypeMismatchException**|  \n|**COR_E_SECURITY**|**SecurityException**|  \n|**COR_E_SERIALIZATION**|**SerializationException**|  \n|**COR_E_STACKOVERFLOW orERROR_STACK_OVERFLOW**|**StackOverflowException**|  \n|**COR_E_SYNCHRONIZATIONLOCK**|**SynchronizationLockException**|  \n|**COR_E_SYSTEM**|**SystemException**|  \n|**COR_E_TARGET**|**TargetException**|  \n|**COR_E_TARGETINVOCATION**|**TargetInvocationException**|  \n|**COR_E_TARGETPARAMCOUNT**|**TargetParameterCountException**|  \n|**COR_E_THREADABORTED**|**ThreadAbortException**|  \n|**COR_E_THREADINTERRUPTED**|**ThreadInterruptedException**|  \n|**COR_E_THREADSTATE**|**ThreadStateException**|  \n|**COR_E_THREADSTOP**|**ThreadStopException**|  \n|**COR_E_TYPELOAD**|**TypeLoadException**|  \n|**COR_E_TYPEINITIALIZATION**|**TypeInitializationException**|  \n|**COR_E_VERIFICATION**|**VerificationException**|  \n|**COR_E_WEAKREFERENCE**|**WeakReferenceException**|  \n|**COR_E_VTABLECALLSNOTSUPPORTED**|**VTableCallsNotSupportedException**|  \n|**All other HRESULTs**|**COMException**|  \n  \n To retrieve extended error information, the managed client must examine the fields of the exception object that was generated. For the exception object to provide useful information about an error, the COM object must implement the **IErrorInfo** interface. The runtime uses the information provided by **IErrorInfo** to initialize the exception object.  \n  \n If the COM object does not support **IErrorInfo**, the runtime initializes an exception object with default values. The following table lists each field associated with an exception object and identifies the source of default information when the COM object supports **IErrorInfo**.  \n  \n Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread.  This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error.  \n  \n|Exception field|Source of Information from COM|  \n|---------------------|------------------------------------|  \n|**ErrorCode**|HRESULT returned from call.|  \n|**HelpLink**|If **IErrorInfo->HelpContext** is nonzero, the string is formed by concatenating **IErrorInfo->GetHelpFile** and \"#\" and **IErrorInfo->GetHelpContext**. Otherwise the string is returned from **IErrorInfo->GetHelpFile**.|  \n|**InnerException**|Always a null reference (**Nothing** in Visual Basic).|  \n|**Message**|String returned from **IErrorInfo->GetDescription**.|  \n|**Source**|String returned from **IErrorInfo->GetSource**.|  \n|**StackTrace**|The stack trace.|  \n|**TargetSite**|The name of the method that returned the failing HRESULT.|  \n  \n Exception fields, such as **Message**, **Source**, and **StackTrace** are not available for the **StackOverflowException**.  \n  \n## See also\n\n- [Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))\n- [Exceptions](../../standard/exceptions/index.md)\n","nodes":[{"pos":[4,407],"embed":true,"restype":"x-metadata","content":"title: \"How to: Map HRESULTs and Exceptions\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"cpp\"\nhelpviewer_keywords: \n  - \"interoperation with unmanaged code, HRESULTs\"\n  - \"exceptions, HRESULTs\"\n  - \"interoperation with unmanaged code, exceptions\"\n  - \"HRESULTs\"\n  - \"COM interop, HRESULTs\"\n  - \"COM interop, exceptions\"\nms.assetid: 610b364b-2761-429d-9c4a-afbc3e66f1b9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Map HRESULTs and Exceptions","nodes":[{"pos":[0,35],"content":"How to: Map HRESULTs and Exceptions","nodes":[{"content":"How to: Map HRESULTs and Exceptions","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[414,449],"content":"How to: Map HRESULTs and Exceptions","linkify":"How to: Map HRESULTs and Exceptions","nodes":[{"content":"How to: Map HRESULTs and Exceptions","pos":[0,35]}]},{"content":"COM methods report errors by returning HRESULTs; .NET methods report them by throwing exceptions.","pos":[450,547]},{"content":"The runtime handles the transition between the two.","pos":[548,599]},{"content":"Each exception class in the .NET Framework maps to an HRESULT.","pos":[600,662]},{"content":"User-defined exception classes can specify whatever HRESULT is appropriate.","pos":[669,744]},{"content":"These exception classes can dynamically change the HRESULT to be returned when the exception is generated by setting the <bpt id=\"p1\">**</bpt>HResult<ept id=\"p1\">**</ept> field on the exception object.","pos":[745,908],"source":" These exception classes can dynamically change the HRESULT to be returned when the exception is generated by setting the **HResult** field on the exception object."},{"content":"Additional information about the exception is provided to the client through the <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept> interface, which is implemented on the .NET object in the unmanaged process.","pos":[909,1081],"source":" Additional information about the exception is provided to the client through the **IErrorInfo** interface, which is implemented on the .NET object in the unmanaged process."},{"content":"If you create a class that extends <bpt id=\"p1\">**</bpt>System.Exception<ept id=\"p1\">**</ept>, you must set the HRESULT field during construction.","pos":[1088,1196],"source":"If you create a class that extends **System.Exception**, you must set the HRESULT field during construction."},{"content":"Otherwise, the base class assigns the HRESULT value.","pos":[1197,1249]},{"content":"You can map new exception classes to an existing HRESULT by supplying the value in the exception's constructor.","pos":[1250,1361]},{"content":"Note that the runtime will sometimes ignore an <ph id=\"ph1\">`HRESULT`</ph> in cases where there is an <ph id=\"ph2\">`IErrorInfo`</ph> present on the thread.","pos":[1368,1487],"source":"Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread."},{"content":"This behavior can occur in cases where the <ph id=\"ph1\">`HRESULT`</ph> and the <ph id=\"ph2\">`IErrorInfo`</ph> do not represent the same error.","pos":[1489,1595],"source":"  This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error."},{"pos":[1605,1661],"content":"To create a new exception class and map it to an HRESULT","linkify":"To create a new exception class and map it to an HRESULT","nodes":[{"content":"To create a new exception class and map it to an HRESULT","pos":[0,56]}]},{"pos":[1671,1796],"content":"Use the following code to create a new exception class called <ph id=\"ph1\">`NoAccessException`</ph> and map it to the HRESULT <ph id=\"ph2\">`E_ACCESSDENIED`</ph>.","source":"Use the following code to create a new exception class called `NoAccessException` and map it to the HRESULT `E_ACCESSDENIED`."},{"content":"You might encounter a program (in any programming language) that uses both managed and unmanaged code at the same time.","pos":[2069,2188]},{"content":"For example, the custom marshaler in the following code example uses the <bpt id=\"p1\">**</bpt>Marshal.ThrowExceptionForHR(int HResult)<ept id=\"p1\">**</ept> method to throw an exception with a specific HRESULT value.","pos":[2189,2366],"source":" For example, the custom marshaler in the following code example uses the **Marshal.ThrowExceptionForHR(int HResult)** method to throw an exception with a specific HRESULT value."},{"content":"The method looks up the HRESULT and generates the appropriate exception type.","pos":[2367,2444]},{"content":"For example, the HRESULT in the following code fragment generates <bpt id=\"p1\">**</bpt>ArgumentException<ept id=\"p1\">**</ept>.","pos":[2445,2533],"source":" For example, the HRESULT in the following code fragment generates **ArgumentException**."},{"content":"The following table provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.","pos":[2646,2770]},{"content":"HRESULT","pos":[2777,2784]},{"content":".NET exception","pos":[2785,2799]},{"pos":[2843,2871],"content":"<bpt id=\"p1\">**</bpt>MSEE_E_APPDOMAINUNLOADED<ept id=\"p1\">**</ept>","source":"**MSEE_E_APPDOMAINUNLOADED**"},{"pos":[2872,2902],"content":"<bpt id=\"p1\">**</bpt>AppDomainUnloadedException<ept id=\"p1\">**</ept>","source":"**AppDomainUnloadedException**"},{"pos":[2907,2928],"content":"<bpt id=\"p1\">**</bpt>COR_E_APPLICATION<ept id=\"p1\">**</ept>","source":"**COR_E_APPLICATION**"},{"pos":[2929,2953],"content":"<bpt id=\"p1\">**</bpt>ApplicationException<ept id=\"p1\">**</ept>","source":"**ApplicationException**"},{"pos":[2958,2992],"content":"<bpt id=\"p1\">**</bpt>COR_E_ARGUMENT or E_INVALIDARG<ept id=\"p1\">**</ept>","source":"**COR_E_ARGUMENT or E_INVALIDARG**"},{"pos":[2993,3014],"content":"<bpt id=\"p1\">**</bpt>ArgumentException<ept id=\"p1\">**</ept>","source":"**ArgumentException**"},{"pos":[3019,3047],"content":"<bpt id=\"p1\">**</bpt>COR_E_ARGUMENTOUTOFRANGE<ept id=\"p1\">**</ept>","source":"**COR_E_ARGUMENTOUTOFRANGE**"},{"pos":[3048,3079],"content":"<bpt id=\"p1\">**</bpt>ArgumentOutOfRangeException<ept id=\"p1\">**</ept>","source":"**ArgumentOutOfRangeException**"},{"pos":[3084,3133],"content":"<bpt id=\"p1\">**</bpt>COR_E_ARITHMETIC or ERROR_ARITHMETIC_OVERFLOW<ept id=\"p1\">**</ept>","source":"**COR_E_ARITHMETIC or ERROR_ARITHMETIC_OVERFLOW**"},{"pos":[3134,3157],"content":"<bpt id=\"p1\">**</bpt>ArithmeticException<ept id=\"p1\">**</ept>","source":"**ArithmeticException**"},{"pos":[3162,3189],"content":"<bpt id=\"p1\">**</bpt>COR_E_ARRAYTYPEMISMATCH<ept id=\"p1\">**</ept>","source":"**COR_E_ARRAYTYPEMISMATCH**"},{"pos":[3190,3220],"content":"<bpt id=\"p1\">**</bpt>ArrayTypeMismatchException<ept id=\"p1\">**</ept>","source":"**ArrayTypeMismatchException**"},{"pos":[3225,3269],"content":"<bpt id=\"p1\">**</bpt>COR_E_BADIMAGEFORMAT or ERROR_BAD_FORMAT<ept id=\"p1\">**</ept>","source":"**COR_E_BADIMAGEFORMAT or ERROR_BAD_FORMAT**"},{"pos":[3270,3297],"content":"<bpt id=\"p1\">**</bpt>BadImageFormatException<ept id=\"p1\">**</ept>","source":"**BadImageFormatException**"},{"pos":[3302,3328],"content":"<bpt id=\"p1\">**</bpt>COR_E_COMEMULATE_ERROR<ept id=\"p1\">**</ept>","source":"**COR_E_COMEMULATE_ERROR**"},{"pos":[3329,3352],"content":"<bpt id=\"p1\">**</bpt>COMEmulateException<ept id=\"p1\">**</ept>","source":"**COMEmulateException**"},{"pos":[3357,3381],"content":"<bpt id=\"p1\">**</bpt>COR_E_CONTEXTMARSHAL<ept id=\"p1\">**</ept>","source":"**COR_E_CONTEXTMARSHAL**"},{"pos":[3382,3409],"content":"<bpt id=\"p1\">**</bpt>ContextMarshalException<ept id=\"p1\">**</ept>","source":"**ContextMarshalException**"},{"pos":[3414,3428],"content":"<bpt id=\"p1\">**</bpt>COR_E_CORE<ept id=\"p1\">**</ept>","source":"**COR_E_CORE**"},{"pos":[3429,3446],"content":"<bpt id=\"p1\">**</bpt>CoreException<ept id=\"p1\">**</ept>","source":"**CoreException**"},{"pos":[3451,3463],"content":"<bpt id=\"p1\">**</bpt>NTE_FAIL<ept id=\"p1\">**</ept>","source":"**NTE_FAIL**"},{"pos":[3464,3490],"content":"<bpt id=\"p1\">**</bpt>CryptographicException<ept id=\"p1\">**</ept>","source":"**CryptographicException**"},{"pos":[3495,3546],"content":"<bpt id=\"p1\">**</bpt>COR_E_DIRECTORYNOTFOUND or ERROR_PATH_NOT_FOUND<ept id=\"p1\">**</ept>","source":"**COR_E_DIRECTORYNOTFOUND or ERROR_PATH_NOT_FOUND**"},{"pos":[3547,3577],"content":"<bpt id=\"p1\">**</bpt>DirectoryNotFoundException<ept id=\"p1\">**</ept>","source":"**DirectoryNotFoundException**"},{"pos":[3582,3604],"content":"<bpt id=\"p1\">**</bpt>COR_E_DIVIDEBYZERO<ept id=\"p1\">**</ept>","source":"**COR_E_DIVIDEBYZERO**"},{"pos":[3605,3630],"content":"<bpt id=\"p1\">**</bpt>DivideByZeroException<ept id=\"p1\">**</ept>","source":"**DivideByZeroException**"},{"pos":[3635,3664],"content":"<bpt id=\"p1\">**</bpt>COR_E_DUPLICATEWAITOBJECT<ept id=\"p1\">**</ept>","source":"**COR_E_DUPLICATEWAITOBJECT**"},{"pos":[3665,3697],"content":"<bpt id=\"p1\">**</bpt>DuplicateWaitObjectException<ept id=\"p1\">**</ept>","source":"**DuplicateWaitObjectException**"},{"pos":[3702,3723],"content":"<bpt id=\"p1\">**</bpt>COR_E_ENDOFSTREAM<ept id=\"p1\">**</ept>","source":"**COR_E_ENDOFSTREAM**"},{"pos":[3724,3748],"content":"<bpt id=\"p1\">**</bpt>EndOfStreamException<ept id=\"p1\">**</ept>","source":"**EndOfStreamException**"},{"pos":[3753,3771],"content":"<bpt id=\"p1\">**</bpt>COR_E_TYPELOAD<ept id=\"p1\">**</ept>","source":"**COR_E_TYPELOAD**"},{"pos":[3772,3803],"content":"<bpt id=\"p1\">**</bpt>EntryPointNotFoundException<ept id=\"p1\">**</ept>","source":"**EntryPointNotFoundException**"},{"pos":[3808,3827],"content":"<bpt id=\"p1\">**</bpt>COR_E_EXCEPTION<ept id=\"p1\">**</ept>","source":"**COR_E_EXCEPTION**"},{"pos":[3828,3841],"content":"<bpt id=\"p1\">**</bpt>Exception<ept id=\"p1\">**</ept>","source":"**Exception**"},{"pos":[3846,3871],"content":"<bpt id=\"p1\">**</bpt>COR_E_EXECUTIONENGINE<ept id=\"p1\">**</ept>","source":"**COR_E_EXECUTIONENGINE**"},{"pos":[3872,3900],"content":"<bpt id=\"p1\">**</bpt>ExecutionEngineException<ept id=\"p1\">**</ept>","source":"**ExecutionEngineException**"},{"pos":[3905,3926],"content":"<bpt id=\"p1\">**</bpt>COR_E_FIELDACCESS<ept id=\"p1\">**</ept>","source":"**COR_E_FIELDACCESS**"},{"pos":[3927,3951],"content":"<bpt id=\"p1\">**</bpt>FieldAccessException<ept id=\"p1\">**</ept>","source":"**FieldAccessException**"},{"pos":[3956,4002],"content":"<bpt id=\"p1\">**</bpt>COR_E_FILENOTFOUND or ERROR_FILE_NOT_FOUND<ept id=\"p1\">**</ept>","source":"**COR_E_FILENOTFOUND or ERROR_FILE_NOT_FOUND**"},{"pos":[4003,4028],"content":"<bpt id=\"p1\">**</bpt>FileNotFoundException<ept id=\"p1\">**</ept>","source":"**FileNotFoundException**"},{"pos":[4033,4049],"content":"<bpt id=\"p1\">**</bpt>COR_E_FORMAT<ept id=\"p1\">**</ept>","source":"**COR_E_FORMAT**"},{"pos":[4050,4069],"content":"<bpt id=\"p1\">**</bpt>FormatException<ept id=\"p1\">**</ept>","source":"**FormatException**"},{"pos":[4074,4099],"content":"<bpt id=\"p1\">**</bpt>COR_E_INDEXOUTOFRANGE<ept id=\"p1\">**</ept>","source":"**COR_E_INDEXOUTOFRANGE**"},{"pos":[4100,4128],"content":"<bpt id=\"p1\">**</bpt>IndexOutOfRangeException<ept id=\"p1\">**</ept>","source":"**IndexOutOfRangeException**"},{"pos":[4133,4171],"content":"<bpt id=\"p1\">**</bpt>COR_E_INVALIDCAST or E_NOINTERFACE<ept id=\"p1\">**</ept>","source":"**COR_E_INVALIDCAST or E_NOINTERFACE**"},{"pos":[4172,4196],"content":"<bpt id=\"p1\">**</bpt>InvalidCastException<ept id=\"p1\">**</ept>","source":"**InvalidCastException**"},{"pos":[4201,4227],"content":"<bpt id=\"p1\">**</bpt>COR_E_INVALIDCOMOBJECT<ept id=\"p1\">**</ept>","source":"**COR_E_INVALIDCOMOBJECT**"},{"pos":[4228,4257],"content":"<bpt id=\"p1\">**</bpt>InvalidComObjectException<ept id=\"p1\">**</ept>","source":"**InvalidComObjectException**"},{"pos":[4262,4293],"content":"<bpt id=\"p1\">**</bpt>COR_E_INVALIDFILTERCRITERIA<ept id=\"p1\">**</ept>","source":"**COR_E_INVALIDFILTERCRITERIA**"},{"pos":[4294,4328],"content":"<bpt id=\"p1\">**</bpt>InvalidFilterCriteriaException<ept id=\"p1\">**</ept>","source":"**InvalidFilterCriteriaException**"},{"pos":[4333,4364],"content":"<bpt id=\"p1\">**</bpt>COR_E_INVALIDOLEVARIANTTYPE<ept id=\"p1\">**</ept>","source":"**COR_E_INVALIDOLEVARIANTTYPE**"},{"pos":[4365,4399],"content":"<bpt id=\"p1\">**</bpt>InvalidOleVariantTypeException<ept id=\"p1\">**</ept>","source":"**InvalidOleVariantTypeException**"},{"pos":[4404,4430],"content":"<bpt id=\"p1\">**</bpt>COR_E_INVALIDOPERATION<ept id=\"p1\">**</ept>","source":"**COR_E_INVALIDOPERATION**"},{"pos":[4431,4460],"content":"<bpt id=\"p1\">**</bpt>InvalidOperationException<ept id=\"p1\">**</ept>","source":"**InvalidOperationException**"},{"pos":[4465,4477],"content":"<bpt id=\"p1\">**</bpt>COR_E_IO<ept id=\"p1\">**</ept>","source":"**COR_E_IO**"},{"pos":[4478,4493],"content":"<bpt id=\"p1\">**</bpt>IOException<ept id=\"p1\">**</ept>","source":"**IOException**"},{"pos":[4498,4520],"content":"<bpt id=\"p1\">**</bpt>COR_E_MEMBERACCESS<ept id=\"p1\">**</ept>","source":"**COR_E_MEMBERACCESS**"},{"pos":[4521,4540],"content":"<bpt id=\"p1\">**</bpt>AccessException<ept id=\"p1\">**</ept>","source":"**AccessException**"},{"pos":[4545,4567],"content":"<bpt id=\"p1\">**</bpt>COR_E_METHODACCESS<ept id=\"p1\">**</ept>","source":"**COR_E_METHODACCESS**"},{"pos":[4568,4593],"content":"<bpt id=\"p1\">**</bpt>MethodAccessException<ept id=\"p1\">**</ept>","source":"**MethodAccessException**"},{"pos":[4598,4620],"content":"<bpt id=\"p1\">**</bpt>COR_E_MISSINGFIELD<ept id=\"p1\">**</ept>","source":"**COR_E_MISSINGFIELD**"},{"pos":[4621,4646],"content":"<bpt id=\"p1\">**</bpt>MissingFieldException<ept id=\"p1\">**</ept>","source":"**MissingFieldException**"},{"pos":[4651,4684],"content":"<bpt id=\"p1\">**</bpt>COR_E_MISSINGMANIFESTRESOURCE<ept id=\"p1\">**</ept>","source":"**COR_E_MISSINGMANIFESTRESOURCE**"},{"pos":[4685,4721],"content":"<bpt id=\"p1\">**</bpt>MissingManifestResourceException<ept id=\"p1\">**</ept>","source":"**MissingManifestResourceException**"},{"pos":[4726,4749],"content":"<bpt id=\"p1\">**</bpt>COR_E_MISSINGMEMBER<ept id=\"p1\">**</ept>","source":"**COR_E_MISSINGMEMBER**"},{"pos":[4750,4776],"content":"<bpt id=\"p1\">**</bpt>MissingMemberException<ept id=\"p1\">**</ept>","source":"**MissingMemberException**"},{"pos":[4781,4804],"content":"<bpt id=\"p1\">**</bpt>COR_E_MISSINGMETHOD<ept id=\"p1\">**</ept>","source":"**COR_E_MISSINGMETHOD**"},{"pos":[4805,4831],"content":"<bpt id=\"p1\">**</bpt>MissingMethodException<ept id=\"p1\">**</ept>","source":"**MissingMethodException**"},{"pos":[4836,4867],"content":"<bpt id=\"p1\">**</bpt>COR_E_MULTICASTNOTSUPPORTED<ept id=\"p1\">**</ept>","source":"**COR_E_MULTICASTNOTSUPPORTED**"},{"pos":[4868,4902],"content":"<bpt id=\"p1\">**</bpt>MulticastNotSupportedException<ept id=\"p1\">**</ept>","source":"**MulticastNotSupportedException**"},{"pos":[4907,4932],"content":"<bpt id=\"p1\">**</bpt>COR_E_NOTFINITENUMBER<ept id=\"p1\">**</ept>","source":"**COR_E_NOTFINITENUMBER**"},{"pos":[4933,4961],"content":"<bpt id=\"p1\">**</bpt>NotFiniteNumberException<ept id=\"p1\">**</ept>","source":"**NotFiniteNumberException**"},{"pos":[4966,4979],"content":"<bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>","source":"**E_NOTIMPL**"},{"pos":[4980,5007],"content":"<bpt id=\"p1\">**</bpt>NotImplementedException<ept id=\"p1\">**</ept>","source":"**NotImplementedException**"},{"pos":[5012,5034],"content":"<bpt id=\"p1\">**</bpt>COR_E_NOTSUPPORTED<ept id=\"p1\">**</ept>","source":"**COR_E_NOTSUPPORTED**"},{"pos":[5035,5060],"content":"<bpt id=\"p1\">**</bpt>NotSupportedException<ept id=\"p1\">**</ept>","source":"**NotSupportedException**"},{"pos":[5065,5100],"content":"<bpt id=\"p1\">**</bpt>COR_E_NULLREFERENCE orE_POINTER<ept id=\"p1\">**</ept>","source":"**COR_E_NULLREFERENCE orE_POINTER**"},{"pos":[5101,5127],"content":"<bpt id=\"p1\">**</bpt>NullReferenceException<ept id=\"p1\">**</ept>","source":"**NullReferenceException**"},{"content":"<bpt id=\"p1\">**</bpt>COR_E_OUTOFMEMORY or<ept id=\"p1\">**</ept>","pos":[5132,5156],"source":"**COR_E_OUTOFMEMORY or**"},{"content":"<bpt id=\"p1\">**</bpt>E_OUTOFMEMORY<ept id=\"p1\">**</ept>","pos":[5169,5186],"source":"**E_OUTOFMEMORY**"},{"pos":[5187,5211],"content":"<bpt id=\"p1\">**</bpt>OutOfMemoryException<ept id=\"p1\">**</ept>","source":"**OutOfMemoryException**"},{"pos":[5216,5234],"content":"<bpt id=\"p1\">**</bpt>COR_E_OVERFLOW<ept id=\"p1\">**</ept>","source":"**COR_E_OVERFLOW**"},{"pos":[5235,5256],"content":"<bpt id=\"p1\">**</bpt>OverflowException<ept id=\"p1\">**</ept>","source":"**OverflowException**"},{"pos":[5261,5312],"content":"<bpt id=\"p1\">**</bpt>COR_E_PATHTOOLONG or ERROR_FILENAME_EXCED_RANGE<ept id=\"p1\">**</ept>","source":"**COR_E_PATHTOOLONG or ERROR_FILENAME_EXCED_RANGE**"},{"pos":[5313,5337],"content":"<bpt id=\"p1\">**</bpt>PathTooLongException<ept id=\"p1\">**</ept>","source":"**PathTooLongException**"},{"pos":[5342,5356],"content":"<bpt id=\"p1\">**</bpt>COR_E_RANK<ept id=\"p1\">**</ept>","source":"**COR_E_RANK**"},{"pos":[5357,5374],"content":"<bpt id=\"p1\">**</bpt>RankException<ept id=\"p1\">**</ept>","source":"**RankException**"},{"pos":[5379,5407],"content":"<bpt id=\"p1\">**</bpt>COR_E_REFLECTIONTYPELOAD<ept id=\"p1\">**</ept>","source":"**COR_E_REFLECTIONTYPELOAD**"},{"pos":[5408,5439],"content":"<bpt id=\"p1\">**</bpt>ReflectionTypeLoadException<ept id=\"p1\">**</ept>","source":"**ReflectionTypeLoadException**"},{"pos":[5444,5462],"content":"<bpt id=\"p1\">**</bpt>COR_E_REMOTING<ept id=\"p1\">**</ept>","source":"**COR_E_REMOTING**"},{"pos":[5463,5484],"content":"<bpt id=\"p1\">**</bpt>RemotingException<ept id=\"p1\">**</ept>","source":"**RemotingException**"},{"pos":[5489,5520],"content":"<bpt id=\"p1\">**</bpt>COR_E_SAFEARRAYTYPEMISMATCH<ept id=\"p1\">**</ept>","source":"**COR_E_SAFEARRAYTYPEMISMATCH**"},{"pos":[5521,5555],"content":"<bpt id=\"p1\">**</bpt>SafeArrayTypeMismatchException<ept id=\"p1\">**</ept>","source":"**SafeArrayTypeMismatchException**"},{"pos":[5560,5578],"content":"<bpt id=\"p1\">**</bpt>COR_E_SECURITY<ept id=\"p1\">**</ept>","source":"**COR_E_SECURITY**"},{"pos":[5579,5600],"content":"<bpt id=\"p1\">**</bpt>SecurityException<ept id=\"p1\">**</ept>","source":"**SecurityException**"},{"pos":[5605,5628],"content":"<bpt id=\"p1\">**</bpt>COR_E_SERIALIZATION<ept id=\"p1\">**</ept>","source":"**COR_E_SERIALIZATION**"},{"pos":[5629,5655],"content":"<bpt id=\"p1\">**</bpt>SerializationException<ept id=\"p1\">**</ept>","source":"**SerializationException**"},{"pos":[5660,5706],"content":"<bpt id=\"p1\">**</bpt>COR_E_STACKOVERFLOW orERROR_STACK_OVERFLOW<ept id=\"p1\">**</ept>","source":"**COR_E_STACKOVERFLOW orERROR_STACK_OVERFLOW**"},{"pos":[5707,5733],"content":"<bpt id=\"p1\">**</bpt>StackOverflowException<ept id=\"p1\">**</ept>","source":"**StackOverflowException**"},{"pos":[5738,5767],"content":"<bpt id=\"p1\">**</bpt>COR_E_SYNCHRONIZATIONLOCK<ept id=\"p1\">**</ept>","source":"**COR_E_SYNCHRONIZATIONLOCK**"},{"pos":[5768,5800],"content":"<bpt id=\"p1\">**</bpt>SynchronizationLockException<ept id=\"p1\">**</ept>","source":"**SynchronizationLockException**"},{"pos":[5805,5821],"content":"<bpt id=\"p1\">**</bpt>COR_E_SYSTEM<ept id=\"p1\">**</ept>","source":"**COR_E_SYSTEM**"},{"pos":[5822,5841],"content":"<bpt id=\"p1\">**</bpt>SystemException<ept id=\"p1\">**</ept>","source":"**SystemException**"},{"pos":[5846,5862],"content":"<bpt id=\"p1\">**</bpt>COR_E_TARGET<ept id=\"p1\">**</ept>","source":"**COR_E_TARGET**"},{"pos":[5863,5882],"content":"<bpt id=\"p1\">**</bpt>TargetException<ept id=\"p1\">**</ept>","source":"**TargetException**"},{"pos":[5887,5913],"content":"<bpt id=\"p1\">**</bpt>COR_E_TARGETINVOCATION<ept id=\"p1\">**</ept>","source":"**COR_E_TARGETINVOCATION**"},{"pos":[5914,5943],"content":"<bpt id=\"p1\">**</bpt>TargetInvocationException<ept id=\"p1\">**</ept>","source":"**TargetInvocationException**"},{"pos":[5948,5974],"content":"<bpt id=\"p1\">**</bpt>COR_E_TARGETPARAMCOUNT<ept id=\"p1\">**</ept>","source":"**COR_E_TARGETPARAMCOUNT**"},{"pos":[5975,6008],"content":"<bpt id=\"p1\">**</bpt>TargetParameterCountException<ept id=\"p1\">**</ept>","source":"**TargetParameterCountException**"},{"pos":[6013,6036],"content":"<bpt id=\"p1\">**</bpt>COR_E_THREADABORTED<ept id=\"p1\">**</ept>","source":"**COR_E_THREADABORTED**"},{"pos":[6037,6061],"content":"<bpt id=\"p1\">**</bpt>ThreadAbortException<ept id=\"p1\">**</ept>","source":"**ThreadAbortException**"},{"pos":[6066,6093],"content":"<bpt id=\"p1\">**</bpt>COR_E_THREADINTERRUPTED<ept id=\"p1\">**</ept>","source":"**COR_E_THREADINTERRUPTED**"},{"pos":[6094,6124],"content":"<bpt id=\"p1\">**</bpt>ThreadInterruptedException<ept id=\"p1\">**</ept>","source":"**ThreadInterruptedException**"},{"pos":[6129,6150],"content":"<bpt id=\"p1\">**</bpt>COR_E_THREADSTATE<ept id=\"p1\">**</ept>","source":"**COR_E_THREADSTATE**"},{"pos":[6151,6175],"content":"<bpt id=\"p1\">**</bpt>ThreadStateException<ept id=\"p1\">**</ept>","source":"**ThreadStateException**"},{"pos":[6180,6200],"content":"<bpt id=\"p1\">**</bpt>COR_E_THREADSTOP<ept id=\"p1\">**</ept>","source":"**COR_E_THREADSTOP**"},{"pos":[6201,6224],"content":"<bpt id=\"p1\">**</bpt>ThreadStopException<ept id=\"p1\">**</ept>","source":"**ThreadStopException**"},{"pos":[6229,6247],"content":"<bpt id=\"p1\">**</bpt>COR_E_TYPELOAD<ept id=\"p1\">**</ept>","source":"**COR_E_TYPELOAD**"},{"pos":[6248,6269],"content":"<bpt id=\"p1\">**</bpt>TypeLoadException<ept id=\"p1\">**</ept>","source":"**TypeLoadException**"},{"pos":[6274,6302],"content":"<bpt id=\"p1\">**</bpt>COR_E_TYPEINITIALIZATION<ept id=\"p1\">**</ept>","source":"**COR_E_TYPEINITIALIZATION**"},{"pos":[6303,6334],"content":"<bpt id=\"p1\">**</bpt>TypeInitializationException<ept id=\"p1\">**</ept>","source":"**TypeInitializationException**"},{"pos":[6339,6361],"content":"<bpt id=\"p1\">**</bpt>COR_E_VERIFICATION<ept id=\"p1\">**</ept>","source":"**COR_E_VERIFICATION**"},{"pos":[6362,6387],"content":"<bpt id=\"p1\">**</bpt>VerificationException<ept id=\"p1\">**</ept>","source":"**VerificationException**"},{"pos":[6392,6415],"content":"<bpt id=\"p1\">**</bpt>COR_E_WEAKREFERENCE<ept id=\"p1\">**</ept>","source":"**COR_E_WEAKREFERENCE**"},{"pos":[6416,6442],"content":"<bpt id=\"p1\">**</bpt>WeakReferenceException<ept id=\"p1\">**</ept>","source":"**WeakReferenceException**"},{"pos":[6447,6480],"content":"<bpt id=\"p1\">**</bpt>COR_E_VTABLECALLSNOTSUPPORTED<ept id=\"p1\">**</ept>","source":"**COR_E_VTABLECALLSNOTSUPPORTED**"},{"pos":[6481,6517],"content":"<bpt id=\"p1\">**</bpt>VTableCallsNotSupportedException<ept id=\"p1\">**</ept>","source":"**VTableCallsNotSupportedException**"},{"pos":[6522,6544],"content":"<bpt id=\"p1\">**</bpt>All other HRESULTs<ept id=\"p1\">**</ept>","source":"**All other HRESULTs**"},{"pos":[6545,6561],"content":"<bpt id=\"p1\">**</bpt>COMException<ept id=\"p1\">**</ept>","source":"**COMException**"},{"content":"To retrieve extended error information, the managed client must examine the fields of the exception object that was generated.","pos":[6569,6695]},{"content":"For the exception object to provide useful information about an error, the COM object must implement the <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept> interface.","pos":[6696,6826],"source":" For the exception object to provide useful information about an error, the COM object must implement the **IErrorInfo** interface."},{"content":"The runtime uses the information provided by <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept> to initialize the exception object.","pos":[6827,6922],"source":" The runtime uses the information provided by **IErrorInfo** to initialize the exception object."},{"content":"If the COM object does not support <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept>, the runtime initializes an exception object with default values.","pos":[6929,7044],"source":"If the COM object does not support **IErrorInfo**, the runtime initializes an exception object with default values."},{"content":"The following table lists each field associated with an exception object and identifies the source of default information when the COM object supports <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept>.","pos":[7045,7211],"source":" The following table lists each field associated with an exception object and identifies the source of default information when the COM object supports **IErrorInfo**."},{"content":"Note that the runtime will sometimes ignore an <ph id=\"ph1\">`HRESULT`</ph> in cases where there is an <ph id=\"ph2\">`IErrorInfo`</ph> present on the thread.","pos":[7218,7337],"source":"Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread."},{"content":"This behavior can occur in cases where the <ph id=\"ph1\">`HRESULT`</ph> and the <ph id=\"ph2\">`IErrorInfo`</ph> do not represent the same error.","pos":[7339,7445],"source":"  This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error."},{"content":"Exception field","pos":[7452,7467]},{"content":"Source of Information from COM","pos":[7468,7498]},{"pos":[7566,7579],"content":"<bpt id=\"p1\">**</bpt>ErrorCode<ept id=\"p1\">**</ept>","source":"**ErrorCode**"},{"content":"HRESULT returned from call.","pos":[7580,7607]},{"pos":[7612,7624],"content":"<bpt id=\"p1\">**</bpt>HelpLink<ept id=\"p1\">**</ept>","source":"**HelpLink**"},{"content":"If <bpt id=\"p1\">**</bpt>IErrorInfo-&gt;HelpContext<ept id=\"p1\">**</ept> is nonzero, the string is formed by concatenating <bpt id=\"p2\">**</bpt>IErrorInfo-&gt;GetHelpFile<ept id=\"p2\">**</ept> and \"#\" and <bpt id=\"p3\">**</bpt>IErrorInfo-&gt;GetHelpContext<ept id=\"p3\">**</ept>.","pos":[7625,7777],"source":"If **IErrorInfo->HelpContext** is nonzero, the string is formed by concatenating **IErrorInfo->GetHelpFile** and \"#\" and **IErrorInfo->GetHelpContext**."},{"content":"Otherwise the string is returned from <bpt id=\"p1\">**</bpt>IErrorInfo-&gt;GetHelpFile<ept id=\"p1\">**</ept>.","pos":[7778,7844],"source":" Otherwise the string is returned from **IErrorInfo->GetHelpFile**."},{"pos":[7849,7867],"content":"<bpt id=\"p1\">**</bpt>InnerException<ept id=\"p1\">**</ept>","source":"**InnerException**"},{"pos":[7868,7922],"content":"Always a null reference (<bpt id=\"p1\">**</bpt>Nothing<ept id=\"p1\">**</ept> in Visual Basic).","source":"Always a null reference (**Nothing** in Visual Basic)."},{"pos":[7927,7938],"content":"<bpt id=\"p1\">**</bpt>Message<ept id=\"p1\">**</ept>","source":"**Message**"},{"pos":[7939,7991],"content":"String returned from <bpt id=\"p1\">**</bpt>IErrorInfo-&gt;GetDescription<ept id=\"p1\">**</ept>.","source":"String returned from **IErrorInfo->GetDescription**."},{"pos":[7996,8006],"content":"<bpt id=\"p1\">**</bpt>Source<ept id=\"p1\">**</ept>","source":"**Source**"},{"pos":[8007,8054],"content":"String returned from <bpt id=\"p1\">**</bpt>IErrorInfo-&gt;GetSource<ept id=\"p1\">**</ept>.","source":"String returned from **IErrorInfo->GetSource**."},{"pos":[8059,8073],"content":"<bpt id=\"p1\">**</bpt>StackTrace<ept id=\"p1\">**</ept>","source":"**StackTrace**"},{"content":"The stack trace.","pos":[8074,8090]},{"pos":[8095,8109],"content":"<bpt id=\"p1\">**</bpt>TargetSite<ept id=\"p1\">**</ept>","source":"**TargetSite**"},{"content":"The name of the method that returned the failing HRESULT.","pos":[8110,8167]},{"pos":[8175,8298],"content":"Exception fields, such as <bpt id=\"p1\">**</bpt>Message<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Source<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>StackTrace<ept id=\"p3\">**</ept> are not available for the <bpt id=\"p4\">**</bpt>StackOverflowException<ept id=\"p4\">**</ept>.","source":"Exception fields, such as **Message**, **Source**, and **StackTrace** are not available for the **StackOverflowException**."},{"pos":[8307,8315],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8319,8439],"content":"<bpt id=\"p1\">[</bpt>Advanced COM Interoperability<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</ept>","source":"[Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))"},{"pos":[8442,8490],"content":"<bpt id=\"p1\">[</bpt>Exceptions<ept id=\"p1\">](../../standard/exceptions/index.md)</ept>","source":"[Exceptions](../../standard/exceptions/index.md)"}]}