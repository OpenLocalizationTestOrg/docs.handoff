{"content":"---\ntitle: \"How to: Create a Key In the Registry (Visual C#)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry, adding keys and values [C#]\"\n  - \"registry keys, creating [C#]\"\n  - \"keys, creating in registry\"\nms.assetid: 8fa475b0-e01f-483a-9327-fd03488fdf5d\n---\n# How to: Create a Key In the Registry (Visual C#)\nThis example adds the value pair, \"Name\" and \"Isabella\", to the current user's registry, under the key \"Names\".  \n  \n## Example  \n  \n```csharp  \nMicrosoft.Win32.RegistryKey key;  \nkey = Microsoft.Win32.Registry.CurrentUser.CreateSubKey(\"Names\");  \nkey.SetValue(\"Name\", \"Isabella\");  \nkey.Close();  \n```  \n  \n## Compiling the Code  \n  \n-   Copy the code and paste it into the `Main` method of a console application.  \n  \n-   Replace the `Names` parameter with the name of a key that exists directly under the HKEY_CURRENT_USER node of the registry.  \n  \n-   Replace the `Name` parameter with the name of a value that exists directly under the Names node.  \n  \n## Robust Programming  \n Examine the registry structure to find a suitable location for your key. For example, you might want to open the Software key of the current user, and create a key with your company's name. Then add the registry values to your company's key.  \n  \n The following conditions might cause an exception:  \n  \n-   The name of the key is null.  \n  \n-   The user does not have permissions to create registry keys.  \n  \n-   The key name exceeds the 255-character limit.  \n  \n-   The key is closed.  \n  \n-   The registry key is read-only.  \n  \n## .NET Framework Security  \n It is more secure to write data to the user folder — `Microsoft.Win32.Registry.CurrentUser` — rather than to the local computer — `Microsoft.Win32.Registry.LocalMachine`.  \n  \n When you create a registry value, you need to decide what to do if that value already exists. Another process, perhaps a malicious one, may have already created the value and have access to it. When you put data in the registry value, the data is available to the other process. To prevent this, use the.`Overload:Microsoft.Win32.RegistryKey.GetValue` method. It returns null if the key does not already exist.  \n  \n It is not secure to store secrets, such as passwords, in the registry as plain text, even if the registry key is protected by access control lists (ACL).  \n  \n## See also\n\n- <xref:System.IO?displayProperty=nameWithType>\n- [C# Programming Guide](../../../csharp/programming-guide/index.md)\n- [File System and the Registry (C# Programming Guide)](../../../csharp/programming-guide/file-system/index.md)\n- [Read, write and delete from the registry with C#](https://www.codeproject.com/Articles/3389/Read-write-and-delete-from-registry-with-C)\n","nodes":[{"pos":[4,264],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Key In the Registry (Visual C#)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry, adding keys and values [C#]\"\n  - \"registry keys, creating [C#]\"\n  - \"keys, creating in registry\"\nms.assetid: 8fa475b0-e01f-483a-9327-fd03488fdf5d","nodes":[{"content":"How to: Create a Key In the Registry (Visual C#)","nodes":[{"pos":[0,48],"content":"How to: Create a Key In the Registry (Visual C#)","nodes":[{"content":"How to: Create a Key In the Registry (Visual C#)","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[271,319],"content":"How to: Create a Key In the Registry (Visual C#)","linkify":"How to: Create a Key In the Registry (Visual C#)","nodes":[{"content":"How to: Create a Key In the Registry (Visual C#)","pos":[0,48]}]},{"content":"This example adds the value pair, \"Name\" and \"Isabella\", to the current user's registry, under the key \"Names\".","pos":[320,431]},{"pos":[440,447],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[631,649],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[659,734],"content":"Copy the code and paste it into the <ph id=\"ph1\">`Main`</ph> method of a console application.","source":"Copy the code and paste it into the `Main` method of a console application."},{"pos":[744,867],"content":"Replace the <ph id=\"ph1\">`Names`</ph> parameter with the name of a key that exists directly under the HKEY_CURRENT_USER node of the registry.","source":"Replace the `Names` parameter with the name of a key that exists directly under the HKEY_CURRENT_USER node of the registry."},{"pos":[877,973],"content":"Replace the <ph id=\"ph1\">`Name`</ph> parameter with the name of a value that exists directly under the Names node.","source":"Replace the `Name` parameter with the name of a value that exists directly under the Names node."},{"pos":[982,1000],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"Examine the registry structure to find a suitable location for your key.","pos":[1004,1076]},{"content":"For example, you might want to open the Software key of the current user, and create a key with your company's name.","pos":[1077,1193]},{"content":"Then add the registry values to your company's key.","pos":[1194,1245]},{"content":"The following conditions might cause an exception:","pos":[1252,1302]},{"content":"The name of the key is null.","pos":[1312,1340]},{"content":"The user does not have permissions to create registry keys.","pos":[1350,1409]},{"content":"The key name exceeds the 255-character limit.","pos":[1419,1464]},{"content":"The key is closed.","pos":[1474,1492]},{"content":"The registry key is read-only.","pos":[1502,1532]},{"pos":[1541,1564],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"pos":[1568,1738],"content":"It is more secure to write data to the user folder — <ph id=\"ph1\">`Microsoft.Win32.Registry.CurrentUser`</ph> — rather than to the local computer — <ph id=\"ph2\">`Microsoft.Win32.Registry.LocalMachine`</ph>.","source":"It is more secure to write data to the user folder — `Microsoft.Win32.Registry.CurrentUser` — rather than to the local computer — `Microsoft.Win32.Registry.LocalMachine`."},{"content":"When you create a registry value, you need to decide what to do if that value already exists.","pos":[1745,1838]},{"content":"Another process, perhaps a malicious one, may have already created the value and have access to it.","pos":[1839,1938]},{"content":"When you put data in the registry value, the data is available to the other process.","pos":[1939,2023]},{"content":"To prevent this, use the.<ph id=\"ph1\">`Overload:Microsoft.Win32.RegistryKey.GetValue`</ph>","pos":[2024,2096],"source":" To prevent this, use the.`Overload:Microsoft.Win32.RegistryKey.GetValue`"},{"content":"method.","pos":[2097,2104]},{"content":"It returns null if the key does not already exist.","pos":[2105,2155]},{"content":"It is not secure to store secrets, such as passwords, in the registry as plain text, even if the registry key is protected by access control lists (ACL).","pos":[2162,2315]},{"pos":[2324,2332],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2384,2450],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"},{"pos":[2453,2562],"content":"<bpt id=\"p1\">[</bpt>File System and the Registry (C# Programming Guide)<ept id=\"p1\">](../../../csharp/programming-guide/file-system/index.md)</ept>","source":"[File System and the Registry (C# Programming Guide)](../../../csharp/programming-guide/file-system/index.md)"},{"pos":[2565,2701],"content":"<bpt id=\"p1\">[</bpt>Read, write and delete from the registry with C#<ept id=\"p1\">](https://www.codeproject.com/Articles/3389/Read-write-and-delete-from-registry-with-C)</ept>","source":"[Read, write and delete from the registry with C#](https://www.codeproject.com/Articles/3389/Read-write-and-delete-from-registry-with-C)"}]}