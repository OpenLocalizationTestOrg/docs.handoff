{"content":"---\ntitle: \"CertTimestampAuthenticodeLicense Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"CertTimestampAuthenticodeLicense\"\napi_location: \n  - \"clr.dll\"\napi_type: \n  - \"DLLExport\"\ndev_langs: \n  - \"C++\"\nms.assetid: d468325a-21c5-43ce-8567-84e342b22308\ncaps.latest.revision: 6\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# CertTimestampAuthenticodeLicense Function\nTime-stamps an Authenticode XrML license.  \n  \n## Syntax  \n  \n```  \nHRESULT CertTimestampAuthenticodeLicense (  \n    [in]  PCRYPT_DATA_BLOB   pSignedLicenseBlob,  \n    [in]  LPCWSTR            pwszTimestampURI,  \n    [out] PCRYPT_DATA_BLOB   pTimestampSignatureBlob  \n);  \n```  \n  \n#### Parameters  \n `pSignedLicenseBlob`  \n [in] The signed Authenticode XrML license to be time-stamped. See the [CRYPTOAPI_BLOB](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx) structure.  \n  \n `pwszTimestampURI`  \n [in] The time-stamp server's URI.  \n  \n `pTimestampSignatureBlob`  \n [out] A pointer to CRYPT_DATA_BLOB to receive the base64-encoded time-stamp signature. It is the caller's responsibility to free `pTimestampSignatureBlob`->`pbData` with `HepFree()` after use. See the [CRYPTOAPI_BLOB](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx) structure.  \n  \n## Remarks  \n The time-stamp signature is actually a PKCS #7 SignedData message whose content is the binary form of the SignatureValue from the license's signature. Basically, this acts as a counter-signature of the license.  \n  \n## Return Value  \n `S_OK` if the function succeeds. Otherwise, returns an error code.  \n  \n## See Also  \n [Authenticode](../../../../docs/framework/unmanaged-api/authenticode/index.md)","nodes":[{"pos":[12,70],"content":"CertTimestampAuthenticodeLicense Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CertTimestampAuthenticodeLicense Function | Microsoft Docs","pos":[0,58]}]},{"pos":[503,544],"content":"CertTimestampAuthenticodeLicense Function","linkify":"CertTimestampAuthenticodeLicense Function","nodes":[{"content":"CertTimestampAuthenticodeLicense Function","pos":[0,41]}]},{"content":"Time-stamps an Authenticode XrML license.","pos":[545,586]},{"pos":[595,601],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[832,842],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The signed Authenticode XrML license to be time-stamped.","pos":[870,931]},{"content":"See the <bpt id=\"p1\">[</bpt>CRYPTOAPI_BLOB<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx)</ept> structure.","pos":[932,1032],"source":" See the [CRYPTOAPI_BLOB](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx) structure."},{"content":"[in] The time-stamp server's URI.","pos":[1061,1094]},{"content":"[out] A pointer to CRYPT_DATA_BLOB to receive the base64-encoded time-stamp signature.","pos":[1130,1216]},{"content":"It is the caller's responsibility to free <ph id=\"ph1\">`pTimestampSignatureBlob`</ph><ph id=\"ph2\">-&gt;</ph><ph id=\"ph3\">`pbData`</ph> with <ph id=\"ph4\">`HepFree()`</ph> after use.","pos":[1217,1322],"source":" It is the caller's responsibility to free `pTimestampSignatureBlob`->`pbData` with `HepFree()` after use."},{"content":"See the <bpt id=\"p1\">[</bpt>CRYPTOAPI_BLOB<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx)</ept> structure.","pos":[1323,1423],"source":" See the [CRYPTOAPI_BLOB](http://msdn.microsoft.com/library/windows/desktop/aa380238.aspx) structure."},{"pos":[1432,1439],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The time-stamp signature is actually a PKCS #7 SignedData message whose content is the binary form of the SignatureValue from the license's signature.","pos":[1443,1593]},{"content":"Basically, this acts as a counter-signature of the license.","pos":[1594,1653]},{"pos":[1662,1674],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"<ph id=\"ph1\">`S_OK`</ph> if the function succeeds.","pos":[1678,1710],"source":"`S_OK` if the function succeeds."},{"content":"Otherwise, returns an error code.","pos":[1711,1744]},{"pos":[1753,1761],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[1765,1843],"content":"<bpt id=\"p1\">[</bpt>Authenticode<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/authenticode/index.md)</ept>","source":"[Authenticode](../../../../docs/framework/unmanaged-api/authenticode/index.md)"}]}