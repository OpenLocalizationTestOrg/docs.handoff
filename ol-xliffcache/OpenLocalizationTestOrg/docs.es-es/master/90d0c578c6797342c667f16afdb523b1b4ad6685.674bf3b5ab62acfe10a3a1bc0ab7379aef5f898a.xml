{"content":"---\ntitle: \"Walkthrough: Hosting Direct3D9 Content in WPF\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"Direct3D9 [WPF interoperability], hosting Direct3D9 content\"\n  - \"WPF [WPF], hosting Direct3D9 content\"\nms.assetid: 60983736-0ab5-42cc-8b16-e9fbde261a43\n---\n# Walkthrough: Hosting Direct3D9 Content in WPF\nThis walkthrough shows how to host Direct3D9 content in a Windows Presentation Foundation (WPF) application.  \n  \n In this walkthrough, you perform the following tasks:  \n  \n-   Create a WPF project to host the Direct3D9 content.  \n  \n-   Import the Direct3D9 content.  \n  \n-   Display the Direct3D9 content by using the <xref:System.Windows.Interop.D3DImage> class.  \n  \n When you are finished, you will know how to host Direct3D9 content in a WPF application.  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   Visual Studio.  \n  \n-   DirectX SDK 9 or later.  \n  \n-   A DLL that contains Direct3D9 content in a WPF-compatible format. For more information, see [WPF and Direct3D9 Interoperation](wpf-and-direct3d9-interoperation.md) and [Walkthrough: Creating Direct3D9 Content for Hosting in WPF](walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md).  \n  \n## Creating the WPF Project  \n The first step is to create the project for the WPF application.  \n  \n#### To create the WPF project  \n  \n-   Create a new WPF Application project in Visual C# named `D3DHost`. For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md).  \n  \n     MainWindow.xaml opens in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n## Importing the Direct3D9 Content  \n You import the Direct3D9 content from an unmanaged DLL by using the `DllImport` attribute.  \n  \n#### To import Direct3D9 content  \n  \n1.  Open MainWindow.xaml.cs in the Code Editor.  \n  \n2.  Replace the automatically generated code with the following code.  \n  \n     [!code-csharp[System.Windows.Interop.D3DImage#1](~/samples/snippets/csharp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/CS/window1.xaml.cs#1)]  \n  \n## Hosting the Direct3D9 Content  \n Finally, use the <xref:System.Windows.Interop.D3DImage> class to host the Direct3D9 content.  \n  \n#### To host the Direct3D9 content  \n  \n1.  In MainWindow.xaml, replace the automatically generated XAML with the following XAML.  \n  \n     [!code-xaml[System.Windows.Interop.D3DImage#10](~/samples/snippets/csharp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/CS/window1.xaml#10)]  \n  \n2.  Build the project.  \n  \n3.  Copy the DLL that contains the Direct3D9 content to the bin/Debug folder.  \n  \n4.  Press F5 to run the project.  \n  \n     The Direct3D9 content appears within the WPF application.  \n  \n## See also\n\n- <xref:System.Windows.Interop.D3DImage>\n- [Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md)\n","nodes":[{"pos":[4,259],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting Direct3D9 Content in WPF\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"Direct3D9 [WPF interoperability], hosting Direct3D9 content\"\n  - \"WPF [WPF], hosting Direct3D9 content\"\nms.assetid: 60983736-0ab5-42cc-8b16-e9fbde261a43","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF","nodes":[{"pos":[0,45],"content":"Walkthrough: Hosting Direct3D9 Content in WPF","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[266,311],"content":"Walkthrough: Hosting Direct3D9 Content in WPF","linkify":"Walkthrough: Hosting Direct3D9 Content in WPF","nodes":[{"content":"Walkthrough: Hosting Direct3D9 Content in WPF","pos":[0,45]}]},{"content":"This walkthrough shows how to host Direct3D9 content in a Windows Presentation Foundation (WPF) application.","pos":[312,420]},{"content":"In this walkthrough, you perform the following tasks:","pos":[427,480]},{"content":"Create a WPF project to host the Direct3D9 content.","pos":[490,541]},{"content":"Import the Direct3D9 content.","pos":[551,580]},{"pos":[590,678],"content":"Display the Direct3D9 content by using the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.D3DImage&gt;</ph> class.","source":"Display the Direct3D9 content by using the <xref:System.Windows.Interop.D3DImage> class."},{"content":"When you are finished, you will know how to host Direct3D9 content in a WPF application.","pos":[685,773]},{"pos":[782,795],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[799,862]},{"content":"Visual Studio.","pos":[872,886]},{"content":"DirectX SDK 9 or later.","pos":[896,919]},{"content":"A DLL that contains Direct3D9 content in a WPF-compatible format.","pos":[929,994]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>WPF and Direct3D9 Interoperation<ept id=\"p1\">](wpf-and-direct3d9-interoperation.md)</ept> and <bpt id=\"p2\">[</bpt>Walkthrough: Creating Direct3D9 Content for Hosting in WPF<ept id=\"p2\">](walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md)</ept>.","pos":[995,1220],"source":" For more information, see [WPF and Direct3D9 Interoperation](wpf-and-direct3d9-interoperation.md) and [Walkthrough: Creating Direct3D9 Content for Hosting in WPF](walkthrough-creating-direct3d9-content-for-hosting-in-wpf.md)."},{"pos":[1229,1253],"content":"Creating the WPF Project","linkify":"Creating the WPF Project","nodes":[{"content":"Creating the WPF Project","pos":[0,24]}]},{"content":"The first step is to create the project for the WPF application.","pos":[1257,1321]},{"pos":[1332,1357],"content":"To create the WPF project","linkify":"To create the WPF project","nodes":[{"content":"To create the WPF project","pos":[0,25]}]},{"content":"Create a new WPF Application project in Visual C# named <ph id=\"ph1\">`D3DHost`</ph>.","pos":[1367,1433],"source":"Create a new WPF Application project in Visual C# named `D3DHost`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: My first WPF desktop application<ept id=\"p1\">](../getting-started/walkthrough-my-first-wpf-desktop-application.md)</ept>.","pos":[1434,1576],"source":" For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md)."},{"pos":[1587,1708],"content":"MainWindow.xaml opens in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"MainWindow.xaml opens in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"pos":[1717,1748],"content":"Importing the Direct3D9 Content","linkify":"Importing the Direct3D9 Content","nodes":[{"content":"Importing the Direct3D9 Content","pos":[0,31]}]},{"pos":[1752,1842],"content":"You import the Direct3D9 content from an unmanaged DLL by using the <ph id=\"ph1\">`DllImport`</ph> attribute.","source":"You import the Direct3D9 content from an unmanaged DLL by using the `DllImport` attribute."},{"pos":[1853,1880],"content":"To import Direct3D9 content","linkify":"To import Direct3D9 content","nodes":[{"content":"To import Direct3D9 content","pos":[0,27]}]},{"content":"Open MainWindow.xaml.cs in the Code Editor.","pos":[1890,1933]},{"content":"Replace the automatically generated code with the following code.","pos":[1943,2008]},{"pos":[2173,2202],"content":"Hosting the Direct3D9 Content","linkify":"Hosting the Direct3D9 Content","nodes":[{"content":"Hosting the Direct3D9 Content","pos":[0,29]}]},{"pos":[2206,2298],"content":"Finally, use the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.D3DImage&gt;</ph> class to host the Direct3D9 content.","source":"Finally, use the <xref:System.Windows.Interop.D3DImage> class to host the Direct3D9 content."},{"pos":[2309,2338],"content":"To host the Direct3D9 content","linkify":"To host the Direct3D9 content","nodes":[{"content":"To host the Direct3D9 content","pos":[0,29]}]},{"content":"In MainWindow.xaml, replace the automatically generated XAML with the following XAML.","pos":[2348,2433]},{"content":"Build the project.","pos":[2596,2614]},{"content":"Copy the DLL that contains the Direct3D9 content to the bin/Debug folder.","pos":[2624,2697]},{"content":"Press F5 to run the project.","pos":[2707,2735]},{"content":"The Direct3D9 content appears within the WPF application.","pos":[2746,2803]},{"pos":[2812,2820],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2865,3002],"content":"<bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept>","source":"[Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md)"}]}