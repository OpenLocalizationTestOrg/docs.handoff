{"content":"---\ntitle: \"gcUnmanagedToManaged MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), garbage collection\"\n  - \"GC unmanaged to managed\"\n  - \"transitioning threads unmanaged to managed code\"\n  - \"GcUnmanagedToManaged MDA\"\n  - \"threading [.NET Framework], garbage collection\"\n  - \"managed debugging assistants (MDAs), garbage collection\"\n  - \"threading [.NET Framework], managed debugging assistants\"\n  - \"garbage collection, run-time errors\"\n  - \"unmanaged to managed garbage collection\"\nms.assetid: 103eb3a3-1cf0-4406-8a9a-a7798fdc22d1\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# gcUnmanagedToManaged MDA\nThe `gcUnmanagedToManaged` managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code.  \n  \n## Symptoms  \n An application running unmanaged user components using COM and platform invoke is causing a nondeterministic access violation in the CLR.  \n  \n## Cause  \n If an application is running unmanaged user components, then those components might have corrupted the garbage-collected heap. This causes an access violation in the CLR when the garbage collector tries to walk the object graph.  \n  \n## Resolution  \n Enabling this assistant reduces the time between when the unmanaged component corrupts the garbage-collected heap and when the access violation happens by forcing a garbage collection to occur before every managed transition.  \n  \n## Effect on the Runtime  \n Causes a garbage collection whenever a thread transitions from unmanaged to managed code.  \n  \n## Output  \n This MDA produces no output.  \n  \n## Configuration  \n  \n```xml  \n<mdaConfig>  \n  <assistants>  \n    <gcUnmanagedToManaged/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See also\n\n- <xref:System.Runtime.InteropServices.MarshalAsAttribute>\n- [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)\n- [gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)\n- [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)\n","nodes":[{"pos":[4,610],"embed":true,"restype":"x-metadata","content":"title: \"gcUnmanagedToManaged MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), garbage collection\"\n  - \"GC unmanaged to managed\"\n  - \"transitioning threads unmanaged to managed code\"\n  - \"GcUnmanagedToManaged MDA\"\n  - \"threading [.NET Framework], garbage collection\"\n  - \"managed debugging assistants (MDAs), garbage collection\"\n  - \"threading [.NET Framework], managed debugging assistants\"\n  - \"garbage collection, run-time errors\"\n  - \"unmanaged to managed garbage collection\"\nms.assetid: 103eb3a3-1cf0-4406-8a9a-a7798fdc22d1\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"gcUnmanagedToManaged MDA","nodes":[{"pos":[0,24],"content":"gcUnmanagedToManaged MDA","nodes":[{"content":"gcUnmanagedToManaged MDA","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[617,641],"content":"gcUnmanagedToManaged MDA","linkify":"gcUnmanagedToManaged MDA","nodes":[{"content":"gcUnmanagedToManaged MDA","pos":[0,24]}]},{"pos":[642,792],"content":"The <ph id=\"ph1\">`gcUnmanagedToManaged`</ph> managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code.","source":"The `gcUnmanagedToManaged` managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code."},{"pos":[801,809],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"An application running unmanaged user components using COM and platform invoke is causing a nondeterministic access violation in the CLR.","pos":[813,950]},{"pos":[959,964],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"If an application is running unmanaged user components, then those components might have corrupted the garbage-collected heap.","pos":[968,1094]},{"content":"This causes an access violation in the CLR when the garbage collector tries to walk the object graph.","pos":[1095,1196]},{"pos":[1205,1215],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Enabling this assistant reduces the time between when the unmanaged component corrupts the garbage-collected heap and when the access violation happens by forcing a garbage collection to occur before every managed transition.","pos":[1219,1444]},{"pos":[1453,1474],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"Causes a garbage collection whenever a thread transitions from unmanaged to managed code.","pos":[1478,1567]},{"pos":[1576,1582],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"This MDA produces no output.","pos":[1586,1614]},{"pos":[1623,1636],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1757,1765],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1828,1981],"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"},{"pos":[1984,2079],"content":"<bpt id=\"p1\">[</bpt>gcManagedToUnmanaged<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)</ept>","source":"[gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)"},{"pos":[2082,2157],"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}