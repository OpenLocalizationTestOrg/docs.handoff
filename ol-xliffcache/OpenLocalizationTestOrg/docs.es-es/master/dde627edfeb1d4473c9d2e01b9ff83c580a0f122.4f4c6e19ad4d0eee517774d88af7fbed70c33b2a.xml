{"content":"---\ntitle: \"How to: Combine Data with LINQ by Using Joins (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], joins\"\n  - \"joins [LINQ in Visual Basic]\"\n  - \"Join clause [LINQ in Visual Basic]\"\n  - \"Group Join clause [Visual Basic]\"\n  - \"joining [LINQ in Visual Basic]\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\nms.assetid: 5b00a478-035b-41c6-8918-be1a97728396\n---\n# How to: Combine Data with LINQ by Using Joins (Visual Basic)\nVisual Basic provides the `Join` and `Group Join` query clauses to enable you to combine the contents of multiple collections based on common values between the collections. These values are known as *key* values. Developers familiar with relational database concepts will recognize the `Join` clause as an INNER JOIN and the `Group Join` clause as, effectively, a LEFT OUTER JOIN.  \n  \n The examples in this topic demonstrate a few ways to combine data by using the `Join` and `Group Join` query clauses.  \n  \n## Create a Project and Add Sample Data  \n  \n#### To create a project that contains sample data and types  \n  \n1.  To run the samples in this topic, open Visual Studio and add a new Visual Basic Console Application project. Double-click the Module1.vb file created by Visual Basic.  \n  \n2.  The samples in this topic use the `Person` and `Pet` types and data from the following code example. Copy this code into the default `Module1` module created by Visual Basic.  \n  \n     [!code-vb[VbLINQHowTos#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#1)]  \n    [!code-vb[VbLINQHowTos#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#2)]  \n  \n## Perform an Inner Join by Using the Join Clause  \n An INNER JOIN combines data from two collections. Items for which the specified key values match are included. Any items from either collection that do not have a matching item in the other collection are excluded.  \n  \n In Visual Basic, LINQ provides two options for performing an INNER JOIN: an implicit join and an explicit join.  \n  \n An implicit join specifies the collections to be joined in a `From` clause and identifies the matching key fields in a `Where` clause. Visual Basic implicitly joins the two collections based on the specified key fields.  \n  \n You can specify an explicit join by using the `Join` clause when you want to be specific about which key fields to use in the join. In this case, a `Where` clause can still be used to filter the query results.  \n  \n#### To perform an Inner Join by using the Join clause  \n  \n1.  Add the following code to the `Module1` module in your project to see examples of both an implicit and explicit inner join.  \n  \n     [!code-vb[VbLINQHowTos#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#4)]  \n  \n## Perform a Left Outer Join by Using the Group Join Clause  \n A LEFT OUTER JOIN includes all the items from the left-side collection of the join and only matching values from the right-side collection of the join. Any items from the right-side collection of the join that do not have a matching item in the left-side collection are excluded from the query result.  \n  \n The `Group Join` clause performs, in effect, a LEFT OUTER JOIN. The difference between what is typically known as a LEFT OUTER JOIN and what the `Group Join` clause returns is that the `Group Join` clause groups results from the right-side collection of the join for each item in the left-side collection. In a relational database, a LEFT OUTER JOIN returns an ungrouped result in which each item in the query result contains matching items from both collections in the join. In this case, the items from the left-side collection of the join are repeated for each matching item from the right-side collection. You will see what this looks like when you complete the next procedure.  \n  \n You can retrieve the results of a `Group Join` query as an ungrouped result by extending your query to return an item for each grouped query result. To accomplish this, you have to ensure that you query on the `DefaultIfEmpty` method of the grouped collection. This ensures that items from the left-side collection of the join are still included in the query result even if they have no matching results from the right-side collection. You can add code to your query to provide a default result value when there is no matching value from the right-side collection of the join.  \n  \n#### To perform a Left Outer Join by using the Group Join clause  \n  \n1.  Add the following code to the `Module1` module in your project to see examples of both a grouped left outer join and an ungrouped left outer join.  \n  \n     [!code-vb[VbLINQHowTos#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#3)]  \n  \n## Perform a Join by Using a Composite Key  \n You can use the `And` keyword in a `Join` or `Group Join` clause to identify multiple key fields to use when matching values from the collections being joined. The `And` keyword specifies that all specified key fields must match for items to be joined.  \n  \n#### To perform a Join by using a composite key  \n  \n1.  Add the following code to the `Module1` module in your project to see examples of a join that uses a composite key.  \n  \n     [!code-vb[VbLINQHowTos#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#5)]  \n  \n## Run the Code  \n  \n#### To add code to run the examples  \n  \n1.  Replace the `Sub Main` in the `Module1` module in your project with the following code to run the examples in this topic.  \n  \n     [!code-vb[VbLINQHowTos#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#6)]  \n  \n2.  Press F5 to run the examples.  \n  \n## See also\n\n- [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)\n- [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)\n- [Join Clause](../../../../visual-basic/language-reference/queries/join-clause.md)\n- [Group Join Clause](../../../../visual-basic/language-reference/queries/group-join-clause.md)\n- [From Clause](../../../../visual-basic/language-reference/queries/from-clause.md)\n- [Where Clause](../../../../visual-basic/language-reference/queries/where-clause.md)\n- [Queries](../../../../visual-basic/language-reference/queries/index.md)\n- [Data Transformations with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/data-transformations-with-linq.md)\n","nodes":[{"pos":[4,412],"embed":true,"restype":"x-metadata","content":"title: \"How to: Combine Data with LINQ by Using Joins (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], joins\"\n  - \"joins [LINQ in Visual Basic]\"\n  - \"Join clause [LINQ in Visual Basic]\"\n  - \"Group Join clause [Visual Basic]\"\n  - \"joining [LINQ in Visual Basic]\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\nms.assetid: 5b00a478-035b-41c6-8918-be1a97728396","nodes":[{"content":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","nodes":[{"pos":[0,60],"content":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","nodes":[{"content":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","pos":[0,60]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[419,479],"content":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","linkify":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","nodes":[{"content":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","pos":[0,60]}]},{"content":"Visual Basic provides the <ph id=\"ph1\">`Join`</ph> and <ph id=\"ph2\">`Group Join`</ph> query clauses to enable you to combine the contents of multiple collections based on common values between the collections.","pos":[480,653],"source":"Visual Basic provides the `Join` and `Group Join` query clauses to enable you to combine the contents of multiple collections based on common values between the collections."},{"content":"These values are known as <bpt id=\"p1\">*</bpt>key<ept id=\"p1\">*</ept> values.","pos":[654,693],"source":" These values are known as *key* values."},{"content":"Developers familiar with relational database concepts will recognize the <ph id=\"ph1\">`Join`</ph> clause as an INNER JOIN and the <ph id=\"ph2\">`Group Join`</ph> clause as, effectively, a LEFT OUTER JOIN.","pos":[694,861],"source":" Developers familiar with relational database concepts will recognize the `Join` clause as an INNER JOIN and the `Group Join` clause as, effectively, a LEFT OUTER JOIN."},{"pos":[868,985],"content":"The examples in this topic demonstrate a few ways to combine data by using the <ph id=\"ph1\">`Join`</ph> and <ph id=\"ph2\">`Group Join`</ph> query clauses.","source":"The examples in this topic demonstrate a few ways to combine data by using the `Join` and `Group Join` query clauses."},{"pos":[994,1030],"content":"Create a Project and Add Sample Data","linkify":"Create a Project and Add Sample Data","nodes":[{"content":"Create a Project and Add Sample Data","pos":[0,36]}]},{"pos":[1041,1096],"content":"To create a project that contains sample data and types","linkify":"To create a project that contains sample data and types","nodes":[{"content":"To create a project that contains sample data and types","pos":[0,55]}]},{"content":"To run the samples in this topic, open Visual Studio and add a new Visual Basic Console Application project.","pos":[1106,1214]},{"content":"Double-click the Module1.vb file created by Visual Basic.","pos":[1215,1272]},{"content":"The samples in this topic use the <ph id=\"ph1\">`Person`</ph> and <ph id=\"ph2\">`Pet`</ph> types and data from the following code example.","pos":[1282,1382],"source":"The samples in this topic use the `Person` and `Pet` types and data from the following code example."},{"content":"Copy this code into the default <ph id=\"ph1\">`Module1`</ph> module created by Visual Basic.","pos":[1383,1456],"source":" Copy this code into the default `Module1` module created by Visual Basic."},{"pos":[1467,1690],"content":"[!code-vb[VbLINQHowTos#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#1)]  \n[!code-vb[VbLINQHowTos#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQHowTos/VB/Module1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[1699,1745],"content":"Perform an Inner Join by Using the Join Clause","linkify":"Perform an Inner Join by Using the Join Clause","nodes":[{"content":"Perform an Inner Join by Using the Join Clause","pos":[0,46]}]},{"content":"An INNER JOIN combines data from two collections.","pos":[1749,1798]},{"content":"Items for which the specified key values match are included.","pos":[1799,1859]},{"content":"Any items from either collection that do not have a matching item in the other collection are excluded.","pos":[1860,1963]},{"content":"In Visual Basic, LINQ provides two options for performing an INNER JOIN: an implicit join and an explicit join.","pos":[1970,2081]},{"content":"An implicit join specifies the collections to be joined in a <ph id=\"ph1\">`From`</ph> clause and identifies the matching key fields in a <ph id=\"ph2\">`Where`</ph> clause.","pos":[2088,2222],"source":"An implicit join specifies the collections to be joined in a `From` clause and identifies the matching key fields in a `Where` clause."},{"content":"Visual Basic implicitly joins the two collections based on the specified key fields.","pos":[2223,2307]},{"content":"You can specify an explicit join by using the <ph id=\"ph1\">`Join`</ph> clause when you want to be specific about which key fields to use in the join.","pos":[2314,2445],"source":"You can specify an explicit join by using the `Join` clause when you want to be specific about which key fields to use in the join."},{"content":"In this case, a <ph id=\"ph1\">`Where`</ph> clause can still be used to filter the query results.","pos":[2446,2523],"source":" In this case, a `Where` clause can still be used to filter the query results."},{"pos":[2534,2583],"content":"To perform an Inner Join by using the Join clause","linkify":"To perform an Inner Join by using the Join clause","nodes":[{"content":"To perform an Inner Join by using the Join clause","pos":[0,49]}]},{"pos":[2593,2716],"content":"Add the following code to the <ph id=\"ph1\">`Module1`</ph> module in your project to see examples of both an implicit and explicit inner join.","source":"Add the following code to the `Module1` module in your project to see examples of both an implicit and explicit inner join."},{"pos":[2844,2900],"content":"Perform a Left Outer Join by Using the Group Join Clause","linkify":"Perform a Left Outer Join by Using the Group Join Clause","nodes":[{"content":"Perform a Left Outer Join by Using the Group Join Clause","pos":[0,56]}]},{"content":"A LEFT OUTER JOIN includes all the items from the left-side collection of the join and only matching values from the right-side collection of the join.","pos":[2904,3055]},{"content":"Any items from the right-side collection of the join that do not have a matching item in the left-side collection are excluded from the query result.","pos":[3056,3205]},{"content":"The <ph id=\"ph1\">`Group Join`</ph> clause performs, in effect, a LEFT OUTER JOIN.","pos":[3212,3275],"source":"The `Group Join` clause performs, in effect, a LEFT OUTER JOIN."},{"content":"The difference between what is typically known as a LEFT OUTER JOIN and what the <ph id=\"ph1\">`Group Join`</ph> clause returns is that the <ph id=\"ph2\">`Group Join`</ph> clause groups results from the right-side collection of the join for each item in the left-side collection.","pos":[3276,3517],"source":" The difference between what is typically known as a LEFT OUTER JOIN and what the `Group Join` clause returns is that the `Group Join` clause groups results from the right-side collection of the join for each item in the left-side collection."},{"content":"In a relational database, a LEFT OUTER JOIN returns an ungrouped result in which each item in the query result contains matching items from both collections in the join.","pos":[3518,3687]},{"content":"In this case, the items from the left-side collection of the join are repeated for each matching item from the right-side collection.","pos":[3688,3821]},{"content":"You will see what this looks like when you complete the next procedure.","pos":[3822,3893]},{"content":"You can retrieve the results of a <ph id=\"ph1\">`Group Join`</ph> query as an ungrouped result by extending your query to return an item for each grouped query result.","pos":[3900,4048],"source":"You can retrieve the results of a `Group Join` query as an ungrouped result by extending your query to return an item for each grouped query result."},{"content":"To accomplish this, you have to ensure that you query on the <ph id=\"ph1\">`DefaultIfEmpty`</ph> method of the grouped collection.","pos":[4049,4160],"source":" To accomplish this, you have to ensure that you query on the `DefaultIfEmpty` method of the grouped collection."},{"content":"This ensures that items from the left-side collection of the join are still included in the query result even if they have no matching results from the right-side collection.","pos":[4161,4335]},{"content":"You can add code to your query to provide a default result value when there is no matching value from the right-side collection of the join.","pos":[4336,4476]},{"pos":[4487,4546],"content":"To perform a Left Outer Join by using the Group Join clause","linkify":"To perform a Left Outer Join by using the Group Join clause","nodes":[{"content":"To perform a Left Outer Join by using the Group Join clause","pos":[0,59]}]},{"pos":[4556,4702],"content":"Add the following code to the <ph id=\"ph1\">`Module1`</ph> module in your project to see examples of both a grouped left outer join and an ungrouped left outer join.","source":"Add the following code to the `Module1` module in your project to see examples of both a grouped left outer join and an ungrouped left outer join."},{"pos":[4830,4869],"content":"Perform a Join by Using a Composite Key","linkify":"Perform a Join by Using a Composite Key","nodes":[{"content":"Perform a Join by Using a Composite Key","pos":[0,39]}]},{"content":"You can use the <ph id=\"ph1\">`And`</ph> keyword in a <ph id=\"ph2\">`Join`</ph> or <ph id=\"ph3\">`Group Join`</ph> clause to identify multiple key fields to use when matching values from the collections being joined.","pos":[4873,5032],"source":"You can use the `And` keyword in a `Join` or `Group Join` clause to identify multiple key fields to use when matching values from the collections being joined."},{"content":"The <ph id=\"ph1\">`And`</ph> keyword specifies that all specified key fields must match for items to be joined.","pos":[5033,5125],"source":" The `And` keyword specifies that all specified key fields must match for items to be joined."},{"pos":[5136,5178],"content":"To perform a Join by using a composite key","linkify":"To perform a Join by using a composite key","nodes":[{"content":"To perform a Join by using a composite key","pos":[0,42]}]},{"pos":[5188,5303],"content":"Add the following code to the <ph id=\"ph1\">`Module1`</ph> module in your project to see examples of a join that uses a composite key.","source":"Add the following code to the `Module1` module in your project to see examples of a join that uses a composite key."},{"pos":[5431,5443],"content":"Run the Code","linkify":"Run the Code","nodes":[{"content":"Run the Code","pos":[0,12]}]},{"pos":[5454,5485],"content":"To add code to run the examples","linkify":"To add code to run the examples","nodes":[{"content":"To add code to run the examples","pos":[0,31]}]},{"pos":[5495,5616],"content":"Replace the <ph id=\"ph1\">`Sub Main`</ph> in the <ph id=\"ph2\">`Module1`</ph> module in your project with the following code to run the examples in this topic.","source":"Replace the `Sub Main` in the `Module1` module in your project with the following code to run the examples in this topic."},{"content":"Press F5 to run the examples.","pos":[5745,5774]},{"pos":[5783,5791],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5795,5877],"content":"<bpt id=\"p1\">[</bpt>LINQ<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/index.md)</ept>","source":"[LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)"},{"pos":[5880,6009],"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>","source":"[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)"},{"pos":[6012,6093],"content":"<bpt id=\"p1\">[</bpt>Join Clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/join-clause.md)</ept>","source":"[Join Clause](../../../../visual-basic/language-reference/queries/join-clause.md)"},{"pos":[6096,6189],"content":"<bpt id=\"p1\">[</bpt>Group Join Clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/group-join-clause.md)</ept>","source":"[Group Join Clause](../../../../visual-basic/language-reference/queries/group-join-clause.md)"},{"pos":[6192,6273],"content":"<bpt id=\"p1\">[</bpt>From Clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/from-clause.md)</ept>","source":"[From Clause](../../../../visual-basic/language-reference/queries/from-clause.md)"},{"pos":[6276,6359],"content":"<bpt id=\"p1\">[</bpt>Where Clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/where-clause.md)</ept>","source":"[Where Clause](../../../../visual-basic/language-reference/queries/where-clause.md)"},{"pos":[6362,6433],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../../visual-basic/language-reference/queries/index.md)"},{"pos":[6436,6559],"content":"<bpt id=\"p1\">[</bpt>Data Transformations with LINQ (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/data-transformations-with-linq.md)</ept>","source":"[Data Transformations with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/data-transformations-with-linq.md)"}]}