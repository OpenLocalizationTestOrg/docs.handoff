{"content":"---\ntitle: \"How to: Enumerate a Subset of Print Queues\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"enumerating [WPF], subset of print queues\"\n  - \"print queues [WPF], enumerating subset of\"\nms.assetid: cc4a1b5b-d46f-4c5e-bc26-22c226e4bee0\n---\n# How to: Enumerate a Subset of Print Queues\nA common situation faced by information technology (IT) professionals managing a company-wide set of printers is to generate a list of printers having certain characteristics. This functionality is provided by the <xref:System.Printing.PrintServer.GetPrintQueues%2A> method of a <xref:System.Printing.PrintServer> object and the <xref:System.Printing.EnumeratedPrintQueueTypes> enumeration.  \n  \n## Example  \n In the example below, the code begins by creating an array of flags that specify the characteristics of the print queues we want to list. In this example, we are looking for print queues that are installed locally on the print server and are shared. The <xref:System.Printing.EnumeratedPrintQueueTypes> enumeration provides many other possibilities.  \n  \n The code then creates a <xref:System.Printing.LocalPrintServer> object, a class derived from <xref:System.Printing.PrintServer>. The local print server is the computer on which the application is running.  \n  \n The last significant step is to pass the array to the <xref:System.Printing.PrintServer.GetPrintQueues%2A> method.  \n  \n Finally, the results are presented to the user.  \n  \n [!code-cpp[EnumerateSubsetOfPrintQueues#ListSubsetOfPrintQueues](~/samples/snippets/cpp/VS_Snippets_Wpf/EnumerateSubsetOfPrintQueues/CPP/Program.cpp#listsubsetofprintqueues)]\n [!code-csharp[EnumerateSubsetOfPrintQueues#ListSubsetOfPrintQueues](~/samples/snippets/csharp/VS_Snippets_Wpf/EnumerateSubsetOfPrintQueues/CSharp/Program.cs#listsubsetofprintqueues)]\n [!code-vb[EnumerateSubsetOfPrintQueues#ListSubsetOfPrintQueues](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EnumerateSubsetOfPrintQueues/visualbasic/program.vb#listsubsetofprintqueues)]  \n  \n You could extend this example by having the `foreach` loop that steps through each print queue do further screening. For example, you could screen out printers that do not support two-sided printing by having the loop call each print queue's <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A> method and test the returned value for the presence of duplexing.  \n  \n## See also\n\n- <xref:System.Printing.PrintServer.GetPrintQueues%2A>\n- <xref:System.Printing.PrintServer>\n- <xref:System.Printing.LocalPrintServer>\n- <xref:System.Printing.EnumeratedPrintQueueTypes>\n- <xref:System.Printing.PrintQueue>\n- <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A>\n- [Documents in WPF](documents-in-wpf.md)\n- [Printing Overview](printing-overview.md)\n- [Microsoft XPS Document Writer](https://go.microsoft.com/fwlink/?LinkId=147319)\n","nodes":[{"pos":[4,288],"embed":true,"restype":"x-metadata","content":"title: \"How to: Enumerate a Subset of Print Queues\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"enumerating [WPF], subset of print queues\"\n  - \"print queues [WPF], enumerating subset of\"\nms.assetid: cc4a1b5b-d46f-4c5e-bc26-22c226e4bee0","nodes":[{"content":"How to: Enumerate a Subset of Print Queues","nodes":[{"pos":[0,42],"content":"How to: Enumerate a Subset of Print Queues","nodes":[{"content":"How to: Enumerate a Subset of Print Queues","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[295,337],"content":"How to: Enumerate a Subset of Print Queues","linkify":"How to: Enumerate a Subset of Print Queues","nodes":[{"content":"How to: Enumerate a Subset of Print Queues","pos":[0,42]}]},{"content":"A common situation faced by information technology (IT) professionals managing a company-wide set of printers is to generate a list of printers having certain characteristics.","pos":[338,513]},{"content":"This functionality is provided by the <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer.GetPrintQueues%2A&gt;</ph> method of a <ph id=\"ph2\">&lt;xref:System.Printing.PrintServer&gt;</ph> object and the <ph id=\"ph3\">&lt;xref:System.Printing.EnumeratedPrintQueueTypes&gt;</ph> enumeration.","pos":[514,728],"source":" This functionality is provided by the <xref:System.Printing.PrintServer.GetPrintQueues%2A> method of a <xref:System.Printing.PrintServer> object and the <xref:System.Printing.EnumeratedPrintQueueTypes> enumeration."},{"pos":[737,744],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the example below, the code begins by creating an array of flags that specify the characteristics of the print queues we want to list.","pos":[748,885]},{"content":"In this example, we are looking for print queues that are installed locally on the print server and are shared.","pos":[886,997]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.EnumeratedPrintQueueTypes&gt;</ph> enumeration provides many other possibilities.","pos":[998,1097],"source":" The <xref:System.Printing.EnumeratedPrintQueueTypes> enumeration provides many other possibilities."},{"content":"The code then creates a <ph id=\"ph1\">&lt;xref:System.Printing.LocalPrintServer&gt;</ph> object, a class derived from <ph id=\"ph2\">&lt;xref:System.Printing.PrintServer&gt;</ph>.","pos":[1104,1232],"source":"The code then creates a <xref:System.Printing.LocalPrintServer> object, a class derived from <xref:System.Printing.PrintServer>."},{"content":"The local print server is the computer on which the application is running.","pos":[1233,1308]},{"pos":[1315,1429],"content":"The last significant step is to pass the array to the <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer.GetPrintQueues%2A&gt;</ph> method.","source":"The last significant step is to pass the array to the <xref:System.Printing.PrintServer.GetPrintQueues%2A> method."},{"content":"Finally, the results are presented to the user.","pos":[1436,1483]},{"content":"You could extend this example by having the <ph id=\"ph1\">`foreach`</ph> loop that steps through each print queue do further screening.","pos":[2045,2161],"source":"You could extend this example by having the `foreach` loop that steps through each print queue do further screening."},{"content":"For example, you could screen out printers that do not support two-sided printing by having the loop call each print queue's <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.GetPrintCapabilities%2A&gt;</ph> method and test the returned value for the presence of duplexing.","pos":[2162,2410],"source":" For example, you could screen out printers that do not support two-sided printing by having the loop call each print queue's <xref:System.Printing.PrintQueue.GetPrintCapabilities%2A> method and test the returned value for the presence of duplexing."},{"pos":[2419,2427],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2712,2751],"content":"<bpt id=\"p1\">[</bpt>Documents in WPF<ept id=\"p1\">](documents-in-wpf.md)</ept>","source":"[Documents in WPF](documents-in-wpf.md)"},{"pos":[2754,2795],"content":"<bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](printing-overview.md)</ept>","source":"[Printing Overview](printing-overview.md)"},{"pos":[2798,2877],"content":"<bpt id=\"p1\">[</bpt>Microsoft XPS Document Writer<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=147319)</ept>","source":"[Microsoft XPS Document Writer](https://go.microsoft.com/fwlink/?LinkId=147319)"}]}